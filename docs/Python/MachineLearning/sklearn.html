
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>sklearn · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../markdown.html">
            
                <a href="../../markdown.html">
            
                    
                    Help
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    专业课
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../Courses/计算机组成原理.html">
            
                <a href="../../Courses/计算机组成原理.html">
            
                    
                    计算机组成原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../Courses/计算机网络.html">
            
                <a href="../../Courses/计算机网络.html">
            
                    
                    计算机网络
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" >
            
                <span>
            
                    
                    概率论与数理统计
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../../Courses/概率论与数理统计/1. 概念.html">
            
                <a href="../../Courses/概率论与数理统计/1. 概念.html">
            
                    
                    概念
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../../Courses/概率论与数理统计/2. 随机变量及其分布.html">
            
                <a href="../../Courses/概率论与数理统计/2. 随机变量及其分布.html">
            
                    
                    随机变量及其分布
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../../Courses/概率论与数理统计/3. 多维随机变量及其分布.html">
            
                <a href="../../Courses/概率论与数理统计/3. 多维随机变量及其分布.html">
            
                    
                    多维随机变量及其分布
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../../Courses/概率论与数理统计/4. 随机变量的数字特征.html">
            
                <a href="../../Courses/概率论与数理统计/4. 随机变量的数字特征.html">
            
                    
                    随机变量的数字特征
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="../../Courses/概率论与数理统计/5. 大数定律与中心极限定理.html">
            
                <a href="../../Courses/概率论与数理统计/5. 大数定律与中心极限定理.html">
            
                    
                    大数定律与中心极限定理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.6" data-path="../../Courses/概率论与数理统计/6. 样本及抽样分布.html">
            
                <a href="../../Courses/概率论与数理统计/6. 样本及抽样分布.html">
            
                    
                    样本及抽样分布
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.7" data-path="../../Courses/概率论与数理统计/7. 参数估计.html">
            
                <a href="../../Courses/概率论与数理统计/7. 参数估计.html">
            
                    
                    参数估计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.8" data-path="../../Courses/概率论与数理统计/8. 假设检验.html">
            
                <a href="../../Courses/概率论与数理统计/8. 假设检验.html">
            
                    
                    假设检验
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    离散数学
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../../Courses/离散数学/离散数学1.html">
            
                <a href="../../Courses/离散数学/离散数学1.html">
            
                    
                    离散一
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../../Courses/离散数学/离散数学2.html">
            
                <a href="../../Courses/离散数学/离散数学2.html">
            
                    
                    离散二
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Python
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../BasicGrammar.html">
            
                <a href="../BasicGrammar.html">
            
                    
                    基本语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    爬虫
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../Crawler/Basic Knowledge.html">
            
                <a href="../Crawler/Basic Knowledge.html">
            
                    
                    基础知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../Crawler/BeautifulSoup4.html">
            
                <a href="../Crawler/BeautifulSoup4.html">
            
                    
                    BeautifulSoup4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../Crawler/PyQuery.html">
            
                <a href="../Crawler/PyQuery.html">
            
                    
                    PyQuery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../Crawler/RegularExpression.html">
            
                <a href="../Crawler/RegularExpression.html">
            
                    
                    RegularExpression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../Crawler/Requests.html">
            
                <a href="../Crawler/Requests.html">
            
                    
                    Requests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../Crawler/Selenium.html">
            
                <a href="../Crawler/Selenium.html">
            
                    
                    Selenium
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.7" data-path="../Crawler/XPath.html">
            
                <a href="../Crawler/XPath.html">
            
                    
                    XPath
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    数据分析
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../DataAnalysis/Matplotlib.html">
            
                <a href="../DataAnalysis/Matplotlib.html">
            
                    
                    matplotlib
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../DataAnalysis/Numpy.html">
            
                <a href="../DataAnalysis/Numpy.html">
            
                    
                    numpy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../DataAnalysis/Pandas.html">
            
                <a href="../DataAnalysis/Pandas.html">
            
                    
                    pandas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4" data-path="../DataAnalysis/Seaborn.html">
            
                <a href="../DataAnalysis/Seaborn.html">
            
                    
                    seaborn
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    [机器学习()
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.4.1" data-path="sklearn.html">
            
                <a href="sklearn.html">
            
                    
                    sklearn
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    后端
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../WEB backend/Django.html">
            
                <a href="../WEB backend/Django.html">
            
                    
                    Django
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../WEB backend/FastAPI.html">
            
                <a href="../WEB backend/FastAPI.html">
            
                    
                    FastAPI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.3" data-path="../WEB backend/Flask.html">
            
                <a href="../WEB backend/Flask.html">
            
                    
                    Flask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.4" data-path="../WEB backend/sqlalchemy.html">
            
                <a href="../WEB backend/sqlalchemy.html">
            
                    
                    sqlalchemy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../内建函数.html">
            
                <a href="../内建函数.html">
            
                    
                    内建函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" >
            
                <span>
            
                    
                    可视化
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1" data-path="../可视化/DearPyGui.html">
            
                <a href="../可视化/DearPyGui.html">
            
                    
                    DearPyGui
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.2" data-path="../可视化/PyQt5.html">
            
                <a href="../可视化/PyQt5.html">
            
                    
                    PyQt5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.3" data-path="../可视化/manim.html">
            
                <a href="../可视化/manim.html">
            
                    
                    Manim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.4" data-path="../可视化/tkinter.html">
            
                <a href="../可视化/tkinter.html">
            
                    
                    Tkinter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.5" data-path="../可视化/wordcloud.html">
            
                <a href="../可视化/wordcloud.html">
            
                    
                    Wordcloud
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8" >
            
                <span>
            
                    
                    常用库
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.1" data-path="../常用库/aiohttp.html">
            
                <a href="../常用库/aiohttp.html">
            
                    
                    aiohttp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2" data-path="../常用库/bisect.html">
            
                <a href="../常用库/bisect.html">
            
                    
                    bisect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.3" data-path="../常用库/collections.html">
            
                <a href="../常用库/collections.html">
            
                    
                    collections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.4" data-path="../常用库/datetime.html">
            
                <a href="../常用库/datetime.html">
            
                    
                    datetime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.5" data-path="../常用库/getpot.html">
            
                <a href="../常用库/getpot.html">
            
                    
                    getpot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.6" data-path="../常用库/iohttp.html">
            
                <a href="../常用库/iohttp.html">
            
                    
                    iohttp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.7" data-path="../常用库/logging.html">
            
                <a href="../常用库/logging.html">
            
                    
                    logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.8" data-path="../常用库/loguru.html">
            
                <a href="../常用库/loguru.html">
            
                    
                    loguru
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.9" data-path="../常用库/os.html">
            
                <a href="../常用库/os.html">
            
                    
                    os
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.10" data-path="../常用库/pyinstaller.html">
            
                <a href="../常用库/pyinstaller.html">
            
                    
                    pyinstaller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.11" data-path="../常用库/random.html">
            
                <a href="../常用库/random.html">
            
                    
                    random
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.12" data-path="../常用库/threading.html">
            
                <a href="../常用库/threading.html">
            
                    
                    threading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.13" data-path="../常用库/time.html">
            
                <a href="../常用库/time.html">
            
                    
                    time
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.14" data-path="../常用库/tqdm.html">
            
                <a href="../常用库/tqdm.html">
            
                    
                    tqdm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    前端
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../Frontend/CSS.html">
            
                <a href="../../Frontend/CSS.html">
            
                    
                    CSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../Frontend/HTML.html">
            
                <a href="../../Frontend/HTML.html">
            
                    
                    HTML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" >
            
                <span>
            
                    
                    JavaScript
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="../../Frontend/JavaScript/BasicGrammar.html">
            
                <a href="../../Frontend/JavaScript/BasicGrammar.html">
            
                    
                    基本语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="../../Frontend/JavaScript/DOM.html">
            
                <a href="../../Frontend/JavaScript/DOM.html">
            
                    
                    DOM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.3" data-path="../../Frontend/JavaScript/标准对象.html">
            
                <a href="../../Frontend/JavaScript/标准对象.html">
            
                    
                    标准对象
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" >
            
                <span>
            
                    
                    前端框架
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.1" data-path="../../Frontend/框架/API 规范.html">
            
                <a href="../../Frontend/框架/API 规范.html">
            
                    
                    API 规范
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.2" data-path="../../Frontend/框架/VUE.html">
            
                <a href="../../Frontend/框架/VUE.html">
            
                    
                    VUE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.3" data-path="../../Frontend/框架/Vuetify.html">
            
                <a href="../../Frontend/框架/Vuetify.html">
            
                    
                    Vuetify
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Linux
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../Linux/BasicGrammar.html">
            
                <a href="../../Linux/BasicGrammar.html">
            
                    
                    基本操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" >
            
                <span>
            
                    
                    收集
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../../Linux/useful/Install.html">
            
                <a href="../../Linux/useful/Install.html">
            
                    
                    Install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="../../Linux/useful/apt-get.html">
            
                <a href="../../Linux/useful/apt-get.html">
            
                    
                    Apt Get
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="../../Linux/useful/screen.html">
            
                <a href="../../Linux/useful/screen.html">
            
                    
                    Screen
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    教程配置
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../useful/配置 SSH.html">
            
                <a href="../../useful/配置 SSH.html">
            
                    
                    配置 SSH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../useful/配置 WIndows Terminal.html">
            
                <a href="../../useful/配置 WIndows Terminal.html">
            
                    
                    配置 WIndows Terminal
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    效率工具
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../效率工具/Git.html">
            
                <a href="../../效率工具/Git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../效率工具/LaTeX数学公式.html">
            
                <a href="../../效率工具/LaTeX数学公式.html">
            
                    
                    LaTeX数学公式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../效率工具/Vim.html">
            
                <a href="../../效率工具/Vim.html">
            
                    
                    Vim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../../效率工具/mermaid.html">
            
                <a href="../../效率工具/mermaid.html">
            
                    
                    Mermaid
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    C艹
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../Cpp/类.html">
            
                <a href="../../Cpp/类.html">
            
                    
                    类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../../Cpp/要点.html">
            
                <a href="../../Cpp/要点.html">
            
                    
                    一些要点
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    机器学习
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../../ML/MachineLearning.html">
            
                <a href="../../ML/MachineLearning.html">
            
                    
                    MachineLearning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    Java
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../../Java/BasicGrammar.html">
            
                <a href="../../Java/BasicGrammar.html">
            
                    
                    基本语法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >sklearn</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x4E00;&#x3001;&#x7B80;&#x4ECB;">&#x4E00;&#x3001;&#x7B80;&#x4ECB;</h1>
<h1 id="&#x4E8C;&#x3001;&#x7279;&#x5F81;&#x5DE5;&#x7A0B;">&#x4E8C;&#x3001;&#x7279;&#x5F81;&#x5DE5;&#x7A0B;</h1>
<p>(Feature Engineering)</p>
<p>&#x7279;&#x5F81;&#x5DE5;&#x7A0B;&#x662F;&#x4F7F;&#x7528;&#x4E13;&#x4E1A;&#x80CC;&#x666F;&#x77E5;&#x8BC6;&#x548C;&#x6280;&#x5DE7;&#x5904;&#x7406;&#x6570;&#x636E;<strong>&#xFF0C;</strong>&#x4F7F;&#x5F97;&#x7279;&#x5F81;&#x80FD;&#x5728;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x7B97;&#x6CD5;&#x4E0A;&#x53D1;&#x6325;&#x66F4;&#x597D;&#x7684;&#x4F5C;&#x7528;&#x7684;&#x8FC7;&#x7A0B;</p>
<h2 id="21-&#x6570;&#x636E;&#x96C6;">2.1 &#x6570;&#x636E;&#x96C6;</h2>
<p><em>scikit-learn</em> &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x6807;&#x51C6;&#x6570;&#x636E;&#x96C6;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets
</code></pre>
<h3 id="211-&#x5C0F;&#x89C4;&#x6A21;-load">2.1.1 &#x5C0F;&#x89C4;&#x6A21; load_*()</h3>
<p><strong><em>datasets.load_\</em>()*</strong></p>
<p>&#x83B7;&#x53D6;&#x5C0F;&#x89C4;&#x6A21;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x6570;&#x636E;&#x5305;&#x542B;&#x5728;datasets&#x91CC;</p>
<pre><code class="lang-python">data1 = datasets.load_iris()
data2 = datasets.load_boston()
</code></pre>
<h3 id="212-&#x5927;&#x89C4;&#x6A21;-fetch">2.1.2 &#x5927;&#x89C4;&#x6A21; fetch_*()</h3>
<p><strong><em>datasets.fetch_\</em>(data_home, subset)*</strong></p>
<p>&#x83B7;&#x53D6;&#x5927;&#x89C4;&#x6A21;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x9700;&#x8981;&#x4ECE;&#x7F51;&#x7EDC;&#x4E0A;&#x4E0B;&#x8F7D;</p>
<ul>
<li><em>data_home</em>&#xFF1A;&#x6570;&#x636E;&#x96C6;&#x4E0B;&#x8F7D;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F; ~/scikit_learn_data/</li>
<li><em>subset</em>&#xFF1A;&#x9009;&#x62E9;&#x8981;&#x52A0;&#x8F7D;&#x7684;&#x6570;&#x636E;&#x96C6;&#x3002;&apos;train&apos;&#x6216;&#x8005;&apos;test&apos;&#xFF0C;&apos;all&apos;&#xFF0C;&#x53EF;&#x9009;</li>
</ul>
<h3 id="213-&#x8FD4;&#x56DE;&#x503C;">2.1.3 &#x8FD4;&#x56DE;&#x503C;</h3>
<p>load &#x548C; fetch &#x8FD4;&#x56DE;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E3A; <em>datasets.base.Bunch</em> (&#x5B57;&#x5178;&#x7EE7;&#x627F;)</p>
<ul>
<li><em>data</em>&#xFF1A;&#x7279;&#x5F81;&#x6570;&#x636E;&#x6570;&#x7EC4;&#xFF0C;&#x662F;&#x4E8C;&#x7EF4; numpy.ndarray &#x6570;&#x7EC4;</li>
<li><em>target&#xFF1A;</em>&#x6807;&#x7B7E;&#x6570;&#x7EC4;&#xFF0C;&#x662F; n_samples &#x7684;&#x4E00;&#x7EF4; numpy.ndarray &#x6570;&#x7EC4;</li>
<li><em>DESCR</em>&#xFF1A;&#x6570;&#x636E;&#x63CF;&#x8FF0;</li>
<li><em>feature_names</em>&#xFF1A;&#x7279;&#x5F81;&#x540D;,&#x65B0;&#x95FB;&#x6570;&#x636E;&#xFF0C;&#x624B;&#x5199;&#x6570;&#x5B57;&#x3001;&#x56DE;&#x5F52;&#x6570;&#x636E;&#x96C6;&#x6CA1;&#x6709;</li>
<li><em>target_names</em>&#xFF1A;&#x6807;&#x7B7E;&#x540D;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_iris
<span class="hljs-comment"># &#x83B7;&#x53D6;&#x9E22;&#x5C3E;&#x82B1;&#x6570;&#x636E;&#x96C6;</span>
iris = load_iris()
print(<span class="hljs-string">&quot;&#x9E22;&#x5C3E;&#x82B1;&#x6570;&#x636E;&#x96C6;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF1A;\n&quot;</span>, iris) <span class="hljs-comment"># &#x5C06;&#x6240;&#x6709;&#x53C2;&#x6570;&#x5168;&#x90E8;&#x8FD4;&#x56DE;&#xFF0C;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x7EE7;&#x627F;&#x81EA;&#x5B57;&#x5178;&#x7684;Bench</span>
print(<span class="hljs-string">&quot;&#x9E22;&#x5C3E;&#x82B1;&#x7684;&#x7279;&#x5F81;&#x503C;:\n&quot;</span>, iris.data)
print(<span class="hljs-string">&quot;&#x9E22;&#x5C3E;&#x82B1;&#x7684;&#x76EE;&#x6807;&#x503C;&#xFF1A;\n&quot;</span>, iris.target)
print(<span class="hljs-string">&quot;&#x9E22;&#x5C3E;&#x82B1;&#x7279;&#x5F81;&#x7684;&#x540D;&#x5B57;&#xFF1A;\n&quot;</span>, iris.feature_names)
print(<span class="hljs-string">&quot;&#x9E22;&#x5C3E;&#x82B1;&#x76EE;&#x6807;&#x503C;&#x7684;&#x540D;&#x5B57;&#xFF1A;\n&quot;</span>, iris.target_names)
print(<span class="hljs-string">&quot;&#x9E22;&#x5C3E;&#x82B1;&#x7684;&#x63CF;&#x8FF0;&#xFF1A;\n&quot;</span>, iris.DESCR)

<span class="hljs-comment"># &#x540C;&#x6837;&#x53EF;&#x4EE5;&#x5199;&#x4F5C;&#x8BF8;&#x5982;iris[&apos;data&apos;]&#x7684;&#x683C;&#x5F0F;</span>
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-pyhton"> &#x9E22;&#x5C3E;&#x82B1;&#x7684;&#x7279;&#x5F81;&#x503C;:
 [[5.1 3.5 1.4 0.2]
 [4.9 3.  1.4 0.2]
 [4.7 3.2 1.3 0.2]
 [4.6 3.1 1.5 0.2]
 ...
 [6.3 2.5 5.  1.9]
 [6.5 3.  5.2 2. ]
 [6.2 3.4 5.4 2.3]
 [5.9 3.  5.1 1.8]]

 &#x9E22;&#x5C3E;&#x82B1;&#x7684;&#x76EE;&#x6807;&#x503C;&#xFF1A;
 [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2]

 &#x9E22;&#x5C3E;&#x82B1;&#x7279;&#x5F81;&#x7684;&#x540D;&#x5B57;&#xFF1A;
 [&apos;sepal length (cm)&apos;, &apos;sepal width (cm)&apos;, &apos;petal length (cm)&apos;, &apos;petal width (cm)&apos;]

 &#x9E22;&#x5C3E;&#x82B1;&#x76EE;&#x6807;&#x503C;&#x7684;&#x540D;&#x5B57;&#xFF1A;
 [&apos;setosa&apos; &apos;versicolor&apos; &apos;virginica&apos;]

 &#x9E22;&#x5C3E;&#x82B1;&#x7684;&#x63CF;&#x8FF0;&#xFF1A;
 .. _iris_dataset:

Iris plants dataset
--------------------

**Data Set Characteristics:**

    :Number of Instances: 150 (50 in each of three classes)
 ...
   - Many, many more ...
</code></pre>
<h2 id="22-&#x6570;&#x636E;&#x96C6;&#x5212;&#x5206;">2.2 &#x6570;&#x636E;&#x96C6;&#x5212;&#x5206;</h2>
<h3 id="221-&#x7B80;&#x5355;&#x5212;&#x5206;-traintestsplit">2.2.1 &#x7B80;&#x5355;&#x5212;&#x5206; train_test_split</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
</code></pre>
<p><strong><em>train_test_split ( arrays, \</em>options )*</strong></p>
<ul>
<li>x&#xFF1A;&#x6570;&#x636E;&#x96C6;&#x7684;&#x7279;&#x5F81;&#x503C;</li>
<li>y&#xFF1A;&#x6570;&#x636E;&#x96C6;&#x7684;&#x6807;&#x7B7E;&#x503C;</li>
<li>test_size&#xFF1A;&#x6D4B;&#x8BD5;&#x96C6;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4E00;&#x822C;&#x4E3A;float</li>
<li>random_state&#xFF1A;&#x968F;&#x673A;&#x6570;&#x79CD;&#x5B50;,&#x4E0D;&#x540C;&#x7684;&#x79CD;&#x5B50;&#x4F1A;&#x9020;&#x6210;&#x4E0D;&#x540C;&#x7684;&#x968F;&#x673A;&#x91C7;&#x6837;&#x7ED3;&#x679C;&#x3002;&#x76F8;&#x540C;&#x7684;&#x79CD;&#x5B50;&#x91C7;&#x6837;&#x7ED3;&#x679C;&#x76F8;&#x540C;&#x3002;</li>
</ul>
<p>&#x8FD4;&#x56DE;&#xFF1A;&#x6D4B;&#x8BD5;&#x96C6;&#x7279;&#x5F81;&#x503C;&#xFF0C;&#x6D4B;&#x8BD5;&#x96C6;&#x6807;&#x7B7E;&#xFF0C;&#x8BAD;&#x7EC3;&#x96C6;&#x7279;&#x5F81;&#x503C;&#xFF0C;&#x8BAD;&#x7EC3;&#x96C6;&#x6807;&#x7B7E;&#xFF08;&#x9ED8;&#x8BA4;&#x968F;&#x673A;&#x53D6;&#xFF09;</p>
<pre><code class="lang-python">x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, random_state=<span class="hljs-number">22</span>)
</code></pre>
<h3 id="222-k&#x6298;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;">2.2.2 K&#x6298;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;</h3>
<p>&#xFF08;KFold Cross Validation&#xFF09;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> KFold
</code></pre>
<p><strong><em>KFold ( n_splits=5, \</em>, shuffle=False, random_state=None )*</strong></p>
<p>&#x53C2;&#x6570;</p>
<ul>
<li><em>n_splits</em>&#xFF1A;K&#x5B50;&#x96C6;&#x4E2A;&#x6570;&#xFF0C;int, default=5</li>
<li><em>shuffle</em>&#xFF1A;&#x662F;&#x5426;&#x8981;&#x6D17;&#x724C;&#xFF08;&#x6253;&#x4E71;&#x6570;&#x636E;&#xFF09;&#xFF0C;bool, default=False</li>
<li><em>random_state</em>&#xFF1A;int or RandomState instance, default=None</li>
</ul>
<p>&#x65B9;&#x6CD5;</p>
<ul>
<li><em>get_n_splits([X, y, groups])</em>&#xFF1A;&#x8FD4;&#x56DE;&#x8FED;&#x4EE3;&#x6B21;&#x6570;&#xFF0C;Returns the number of splitting iterations in the cross-validator</li>
<li><em>split(X)</em>&#xFF1A;&#x751F;&#x6210;&#x5668;&#xFF0C;&#x8FD4;&#x56DE;&#x8BAD;&#x7EC3;&#x548C;&#x6D4B;&#x8BD5;&#x96C6;&#x7684;&#x7D22;&#x5F15;&#x503C;&#xFF0C;Generate indices to split data into training and test set.</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> KFold
<span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets

<span class="hljs-comment"># &#x6570;&#x636E;&#x96C6;&#x5BFC;&#x5165;</span>
iris = datasets.load_iris()
x = iris.data
y = iris.target
<span class="hljs-comment"># KFold</span>
kf = KFold(n_splits=<span class="hljs-number">5</span>)
<span class="hljs-comment"># &#x8F93;&#x51FA;&#x5212;&#x5206;&#x6570;</span>
print(kf.get_n_splits(x))
<span class="hljs-comment"># &#x5212;&#x5206;&#x6570;&#x636E;&#x96C6;</span>
<span class="hljs-keyword">for</span> train_index, test_index <span class="hljs-keyword">in</span> kf.split(x):
    print(<span class="hljs-string">&quot;TRAIN:&quot;</span>, train_index, <span class="hljs-string">&quot;\nTEST:&quot;</span>, test_index)
    x_train, x_test = x[train_index], x[test_index]
    y_train, y_test = y[train_index], y[test_index]
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python"><span class="hljs-number">5</span>

TRAIN: [ <span class="hljs-number">30</span>  <span class="hljs-number">31</span>  <span class="hljs-number">32</span>  <span class="hljs-number">33</span>  <span class="hljs-number">34</span>  <span class="hljs-number">35</span>  <span class="hljs-number">36</span>  <span class="hljs-number">37</span>  <span class="hljs-number">38</span>  <span class="hljs-number">39</span>  <span class="hljs-number">40</span>  <span class="hljs-number">41</span>  <span class="hljs-number">42</span>  <span class="hljs-number">43</span>  <span class="hljs-number">44</span>  <span class="hljs-number">45</span>  <span class="hljs-number">46</span>  <span class="hljs-number">47</span>
  <span class="hljs-number">48</span>  <span class="hljs-number">49</span>  <span class="hljs-number">50</span>  <span class="hljs-number">51</span>  <span class="hljs-number">52</span>  <span class="hljs-number">53</span>  <span class="hljs-number">54</span>  <span class="hljs-number">55</span>  <span class="hljs-number">56</span>  <span class="hljs-number">57</span>  <span class="hljs-number">58</span>  <span class="hljs-number">59</span>  <span class="hljs-number">60</span>  <span class="hljs-number">61</span>  <span class="hljs-number">62</span>  <span class="hljs-number">63</span>  <span class="hljs-number">64</span>  <span class="hljs-number">65</span>
  <span class="hljs-number">66</span>  <span class="hljs-number">67</span>  <span class="hljs-number">68</span>  <span class="hljs-number">69</span>  <span class="hljs-number">70</span>  <span class="hljs-number">71</span>  <span class="hljs-number">72</span>  <span class="hljs-number">73</span>  <span class="hljs-number">74</span>  <span class="hljs-number">75</span>  <span class="hljs-number">76</span>  <span class="hljs-number">77</span>  <span class="hljs-number">78</span>  <span class="hljs-number">79</span>  <span class="hljs-number">80</span>  <span class="hljs-number">81</span>  <span class="hljs-number">82</span>  <span class="hljs-number">83</span>
  <span class="hljs-number">84</span>  <span class="hljs-number">85</span>  <span class="hljs-number">86</span>  <span class="hljs-number">87</span>  <span class="hljs-number">88</span>  <span class="hljs-number">89</span>  <span class="hljs-number">90</span>  <span class="hljs-number">91</span>  <span class="hljs-number">92</span>  <span class="hljs-number">93</span>  <span class="hljs-number">94</span>  <span class="hljs-number">95</span>  <span class="hljs-number">96</span>  <span class="hljs-number">97</span>  <span class="hljs-number">98</span>  <span class="hljs-number">99</span> <span class="hljs-number">100</span> <span class="hljs-number">101</span>
 <span class="hljs-number">102</span> <span class="hljs-number">103</span> <span class="hljs-number">104</span> <span class="hljs-number">105</span> <span class="hljs-number">106</span> <span class="hljs-number">107</span> <span class="hljs-number">108</span> <span class="hljs-number">109</span> <span class="hljs-number">110</span> <span class="hljs-number">111</span> <span class="hljs-number">112</span> <span class="hljs-number">113</span> <span class="hljs-number">114</span> <span class="hljs-number">115</span> <span class="hljs-number">116</span> <span class="hljs-number">117</span> <span class="hljs-number">118</span> <span class="hljs-number">119</span>
 <span class="hljs-number">120</span> <span class="hljs-number">121</span> <span class="hljs-number">122</span> <span class="hljs-number">123</span> <span class="hljs-number">124</span> <span class="hljs-number">125</span> <span class="hljs-number">126</span> <span class="hljs-number">127</span> <span class="hljs-number">128</span> <span class="hljs-number">129</span> <span class="hljs-number">130</span> <span class="hljs-number">131</span> <span class="hljs-number">132</span> <span class="hljs-number">133</span> <span class="hljs-number">134</span> <span class="hljs-number">135</span> <span class="hljs-number">136</span> <span class="hljs-number">137</span>
 <span class="hljs-number">138</span> <span class="hljs-number">139</span> <span class="hljs-number">140</span> <span class="hljs-number">141</span> <span class="hljs-number">142</span> <span class="hljs-number">143</span> <span class="hljs-number">144</span> <span class="hljs-number">145</span> <span class="hljs-number">146</span> <span class="hljs-number">147</span> <span class="hljs-number">148</span> <span class="hljs-number">149</span>] 
TEST: [ <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">12</span> <span class="hljs-number">13</span> <span class="hljs-number">14</span> <span class="hljs-number">15</span> <span class="hljs-number">16</span> <span class="hljs-number">17</span> <span class="hljs-number">18</span> <span class="hljs-number">19</span> <span class="hljs-number">20</span> <span class="hljs-number">21</span> <span class="hljs-number">22</span> <span class="hljs-number">23</span>
 <span class="hljs-number">24</span> <span class="hljs-number">25</span> <span class="hljs-number">26</span> <span class="hljs-number">27</span> <span class="hljs-number">28</span> <span class="hljs-number">29</span>]

TRAIN: [  <span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>   <span class="hljs-number">5</span>   <span class="hljs-number">6</span>   <span class="hljs-number">7</span>   <span class="hljs-number">8</span>   <span class="hljs-number">9</span>  <span class="hljs-number">10</span>  <span class="hljs-number">11</span>  <span class="hljs-number">12</span>  <span class="hljs-number">13</span>  <span class="hljs-number">14</span>  <span class="hljs-number">15</span>  <span class="hljs-number">16</span>  <span class="hljs-number">17</span>
  <span class="hljs-number">18</span>  <span class="hljs-number">19</span>  <span class="hljs-number">20</span>  <span class="hljs-number">21</span>  <span class="hljs-number">22</span>  <span class="hljs-number">23</span>  <span class="hljs-number">24</span>  <span class="hljs-number">25</span>  <span class="hljs-number">26</span>  <span class="hljs-number">27</span>  <span class="hljs-number">28</span>  <span class="hljs-number">29</span>  <span class="hljs-number">60</span>  <span class="hljs-number">61</span>  <span class="hljs-number">62</span>  <span class="hljs-number">63</span>  <span class="hljs-number">64</span>  <span class="hljs-number">65</span>
  <span class="hljs-number">66</span>  <span class="hljs-number">67</span>  <span class="hljs-number">68</span>  <span class="hljs-number">69</span>  <span class="hljs-number">70</span>  <span class="hljs-number">71</span>  <span class="hljs-number">72</span>  <span class="hljs-number">73</span>  <span class="hljs-number">74</span>  <span class="hljs-number">75</span>  <span class="hljs-number">76</span>  <span class="hljs-number">77</span>  <span class="hljs-number">78</span>  <span class="hljs-number">79</span>  <span class="hljs-number">80</span>  <span class="hljs-number">81</span>  <span class="hljs-number">82</span>  <span class="hljs-number">83</span>
  <span class="hljs-number">84</span>  <span class="hljs-number">85</span>  <span class="hljs-number">86</span>  <span class="hljs-number">87</span>  <span class="hljs-number">88</span>  <span class="hljs-number">89</span>  <span class="hljs-number">90</span>  <span class="hljs-number">91</span>  <span class="hljs-number">92</span>  <span class="hljs-number">93</span>  <span class="hljs-number">94</span>  <span class="hljs-number">95</span>  <span class="hljs-number">96</span>  <span class="hljs-number">97</span>  <span class="hljs-number">98</span>  <span class="hljs-number">99</span> <span class="hljs-number">100</span> <span class="hljs-number">101</span>
 <span class="hljs-number">102</span> <span class="hljs-number">103</span> <span class="hljs-number">104</span> <span class="hljs-number">105</span> <span class="hljs-number">106</span> <span class="hljs-number">107</span> <span class="hljs-number">108</span> <span class="hljs-number">109</span> <span class="hljs-number">110</span> <span class="hljs-number">111</span> <span class="hljs-number">112</span> <span class="hljs-number">113</span> <span class="hljs-number">114</span> <span class="hljs-number">115</span> <span class="hljs-number">116</span> <span class="hljs-number">117</span> <span class="hljs-number">118</span> <span class="hljs-number">119</span>
 <span class="hljs-number">120</span> <span class="hljs-number">121</span> <span class="hljs-number">122</span> <span class="hljs-number">123</span> <span class="hljs-number">124</span> <span class="hljs-number">125</span> <span class="hljs-number">126</span> <span class="hljs-number">127</span> <span class="hljs-number">128</span> <span class="hljs-number">129</span> <span class="hljs-number">130</span> <span class="hljs-number">131</span> <span class="hljs-number">132</span> <span class="hljs-number">133</span> <span class="hljs-number">134</span> <span class="hljs-number">135</span> <span class="hljs-number">136</span> <span class="hljs-number">137</span>
 <span class="hljs-number">138</span> <span class="hljs-number">139</span> <span class="hljs-number">140</span> <span class="hljs-number">141</span> <span class="hljs-number">142</span> <span class="hljs-number">143</span> <span class="hljs-number">144</span> <span class="hljs-number">145</span> <span class="hljs-number">146</span> <span class="hljs-number">147</span> <span class="hljs-number">148</span> <span class="hljs-number">149</span>] 
TEST: [<span class="hljs-number">30</span> <span class="hljs-number">31</span> <span class="hljs-number">32</span> <span class="hljs-number">33</span> <span class="hljs-number">34</span> <span class="hljs-number">35</span> <span class="hljs-number">36</span> <span class="hljs-number">37</span> <span class="hljs-number">38</span> <span class="hljs-number">39</span> <span class="hljs-number">40</span> <span class="hljs-number">41</span> <span class="hljs-number">42</span> <span class="hljs-number">43</span> <span class="hljs-number">44</span> <span class="hljs-number">45</span> <span class="hljs-number">46</span> <span class="hljs-number">47</span> <span class="hljs-number">48</span> <span class="hljs-number">49</span> <span class="hljs-number">50</span> <span class="hljs-number">51</span> <span class="hljs-number">52</span> <span class="hljs-number">53</span>
 <span class="hljs-number">54</span> <span class="hljs-number">55</span> <span class="hljs-number">56</span> <span class="hljs-number">57</span> <span class="hljs-number">58</span> <span class="hljs-number">59</span>]

TRAIN: [  <span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>   <span class="hljs-number">5</span>   <span class="hljs-number">6</span>   <span class="hljs-number">7</span>   <span class="hljs-number">8</span>   <span class="hljs-number">9</span>  <span class="hljs-number">10</span>  <span class="hljs-number">11</span>  <span class="hljs-number">12</span>  <span class="hljs-number">13</span>  <span class="hljs-number">14</span>  <span class="hljs-number">15</span>  <span class="hljs-number">16</span>  <span class="hljs-number">17</span>
  <span class="hljs-number">18</span>  <span class="hljs-number">19</span>  <span class="hljs-number">20</span>  <span class="hljs-number">21</span>  <span class="hljs-number">22</span>  <span class="hljs-number">23</span>  <span class="hljs-number">24</span>  <span class="hljs-number">25</span>  <span class="hljs-number">26</span>  <span class="hljs-number">27</span>  <span class="hljs-number">28</span>  <span class="hljs-number">29</span>  <span class="hljs-number">30</span>  <span class="hljs-number">31</span>  <span class="hljs-number">32</span>  <span class="hljs-number">33</span>  <span class="hljs-number">34</span>  <span class="hljs-number">35</span>
  <span class="hljs-number">36</span>  <span class="hljs-number">37</span>  <span class="hljs-number">38</span>  <span class="hljs-number">39</span>  <span class="hljs-number">40</span>  <span class="hljs-number">41</span>  <span class="hljs-number">42</span>  <span class="hljs-number">43</span>  <span class="hljs-number">44</span>  <span class="hljs-number">45</span>  <span class="hljs-number">46</span>  <span class="hljs-number">47</span>  <span class="hljs-number">48</span>  <span class="hljs-number">49</span>  <span class="hljs-number">50</span>  <span class="hljs-number">51</span>  <span class="hljs-number">52</span>  <span class="hljs-number">53</span>
  <span class="hljs-number">54</span>  <span class="hljs-number">55</span>  <span class="hljs-number">56</span>  <span class="hljs-number">57</span>  <span class="hljs-number">58</span>  <span class="hljs-number">59</span>  <span class="hljs-number">90</span>  <span class="hljs-number">91</span>  <span class="hljs-number">92</span>  <span class="hljs-number">93</span>  <span class="hljs-number">94</span>  <span class="hljs-number">95</span>  <span class="hljs-number">96</span>  <span class="hljs-number">97</span>  <span class="hljs-number">98</span>  <span class="hljs-number">99</span> <span class="hljs-number">100</span> <span class="hljs-number">101</span>
 <span class="hljs-number">102</span> <span class="hljs-number">103</span> <span class="hljs-number">104</span> <span class="hljs-number">105</span> <span class="hljs-number">106</span> <span class="hljs-number">107</span> <span class="hljs-number">108</span> <span class="hljs-number">109</span> <span class="hljs-number">110</span> <span class="hljs-number">111</span> <span class="hljs-number">112</span> <span class="hljs-number">113</span> <span class="hljs-number">114</span> <span class="hljs-number">115</span> <span class="hljs-number">116</span> <span class="hljs-number">117</span> <span class="hljs-number">118</span> <span class="hljs-number">119</span>
 <span class="hljs-number">120</span> <span class="hljs-number">121</span> <span class="hljs-number">122</span> <span class="hljs-number">123</span> <span class="hljs-number">124</span> <span class="hljs-number">125</span> <span class="hljs-number">126</span> <span class="hljs-number">127</span> <span class="hljs-number">128</span> <span class="hljs-number">129</span> <span class="hljs-number">130</span> <span class="hljs-number">131</span> <span class="hljs-number">132</span> <span class="hljs-number">133</span> <span class="hljs-number">134</span> <span class="hljs-number">135</span> <span class="hljs-number">136</span> <span class="hljs-number">137</span>
 <span class="hljs-number">138</span> <span class="hljs-number">139</span> <span class="hljs-number">140</span> <span class="hljs-number">141</span> <span class="hljs-number">142</span> <span class="hljs-number">143</span> <span class="hljs-number">144</span> <span class="hljs-number">145</span> <span class="hljs-number">146</span> <span class="hljs-number">147</span> <span class="hljs-number">148</span> <span class="hljs-number">149</span>] 
TEST: [<span class="hljs-number">60</span> <span class="hljs-number">61</span> <span class="hljs-number">62</span> <span class="hljs-number">63</span> <span class="hljs-number">64</span> <span class="hljs-number">65</span> <span class="hljs-number">66</span> <span class="hljs-number">67</span> <span class="hljs-number">68</span> <span class="hljs-number">69</span> <span class="hljs-number">70</span> <span class="hljs-number">71</span> <span class="hljs-number">72</span> <span class="hljs-number">73</span> <span class="hljs-number">74</span> <span class="hljs-number">75</span> <span class="hljs-number">76</span> <span class="hljs-number">77</span> <span class="hljs-number">78</span> <span class="hljs-number">79</span> <span class="hljs-number">80</span> <span class="hljs-number">81</span> <span class="hljs-number">82</span> <span class="hljs-number">83</span>
 <span class="hljs-number">84</span> <span class="hljs-number">85</span> <span class="hljs-number">86</span> <span class="hljs-number">87</span> <span class="hljs-number">88</span> <span class="hljs-number">89</span>]

TRAIN: [  <span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>   <span class="hljs-number">5</span>   <span class="hljs-number">6</span>   <span class="hljs-number">7</span>   <span class="hljs-number">8</span>   <span class="hljs-number">9</span>  <span class="hljs-number">10</span>  <span class="hljs-number">11</span>  <span class="hljs-number">12</span>  <span class="hljs-number">13</span>  <span class="hljs-number">14</span>  <span class="hljs-number">15</span>  <span class="hljs-number">16</span>  <span class="hljs-number">17</span>
  <span class="hljs-number">18</span>  <span class="hljs-number">19</span>  <span class="hljs-number">20</span>  <span class="hljs-number">21</span>  <span class="hljs-number">22</span>  <span class="hljs-number">23</span>  <span class="hljs-number">24</span>  <span class="hljs-number">25</span>  <span class="hljs-number">26</span>  <span class="hljs-number">27</span>  <span class="hljs-number">28</span>  <span class="hljs-number">29</span>  <span class="hljs-number">30</span>  <span class="hljs-number">31</span>  <span class="hljs-number">32</span>  <span class="hljs-number">33</span>  <span class="hljs-number">34</span>  <span class="hljs-number">35</span>
  <span class="hljs-number">36</span>  <span class="hljs-number">37</span>  <span class="hljs-number">38</span>  <span class="hljs-number">39</span>  <span class="hljs-number">40</span>  <span class="hljs-number">41</span>  <span class="hljs-number">42</span>  <span class="hljs-number">43</span>  <span class="hljs-number">44</span>  <span class="hljs-number">45</span>  <span class="hljs-number">46</span>  <span class="hljs-number">47</span>  <span class="hljs-number">48</span>  <span class="hljs-number">49</span>  <span class="hljs-number">50</span>  <span class="hljs-number">51</span>  <span class="hljs-number">52</span>  <span class="hljs-number">53</span>
  <span class="hljs-number">54</span>  <span class="hljs-number">55</span>  <span class="hljs-number">56</span>  <span class="hljs-number">57</span>  <span class="hljs-number">58</span>  <span class="hljs-number">59</span>  <span class="hljs-number">60</span>  <span class="hljs-number">61</span>  <span class="hljs-number">62</span>  <span class="hljs-number">63</span>  <span class="hljs-number">64</span>  <span class="hljs-number">65</span>  <span class="hljs-number">66</span>  <span class="hljs-number">67</span>  <span class="hljs-number">68</span>  <span class="hljs-number">69</span>  <span class="hljs-number">70</span>  <span class="hljs-number">71</span>
  <span class="hljs-number">72</span>  <span class="hljs-number">73</span>  <span class="hljs-number">74</span>  <span class="hljs-number">75</span>  <span class="hljs-number">76</span>  <span class="hljs-number">77</span>  <span class="hljs-number">78</span>  <span class="hljs-number">79</span>  <span class="hljs-number">80</span>  <span class="hljs-number">81</span>  <span class="hljs-number">82</span>  <span class="hljs-number">83</span>  <span class="hljs-number">84</span>  <span class="hljs-number">85</span>  <span class="hljs-number">86</span>  <span class="hljs-number">87</span>  <span class="hljs-number">88</span>  <span class="hljs-number">89</span>
 <span class="hljs-number">120</span> <span class="hljs-number">121</span> <span class="hljs-number">122</span> <span class="hljs-number">123</span> <span class="hljs-number">124</span> <span class="hljs-number">125</span> <span class="hljs-number">126</span> <span class="hljs-number">127</span> <span class="hljs-number">128</span> <span class="hljs-number">129</span> <span class="hljs-number">130</span> <span class="hljs-number">131</span> <span class="hljs-number">132</span> <span class="hljs-number">133</span> <span class="hljs-number">134</span> <span class="hljs-number">135</span> <span class="hljs-number">136</span> <span class="hljs-number">137</span>
 <span class="hljs-number">138</span> <span class="hljs-number">139</span> <span class="hljs-number">140</span> <span class="hljs-number">141</span> <span class="hljs-number">142</span> <span class="hljs-number">143</span> <span class="hljs-number">144</span> <span class="hljs-number">145</span> <span class="hljs-number">146</span> <span class="hljs-number">147</span> <span class="hljs-number">148</span> <span class="hljs-number">149</span>] 
TEST: [ <span class="hljs-number">90</span>  <span class="hljs-number">91</span>  <span class="hljs-number">92</span>  <span class="hljs-number">93</span>  <span class="hljs-number">94</span>  <span class="hljs-number">95</span>  <span class="hljs-number">96</span>  <span class="hljs-number">97</span>  <span class="hljs-number">98</span>  <span class="hljs-number">99</span> <span class="hljs-number">100</span> <span class="hljs-number">101</span> <span class="hljs-number">102</span> <span class="hljs-number">103</span> <span class="hljs-number">104</span> <span class="hljs-number">105</span> <span class="hljs-number">106</span> <span class="hljs-number">107</span>
 <span class="hljs-number">108</span> <span class="hljs-number">109</span> <span class="hljs-number">110</span> <span class="hljs-number">111</span> <span class="hljs-number">112</span> <span class="hljs-number">113</span> <span class="hljs-number">114</span> <span class="hljs-number">115</span> <span class="hljs-number">116</span> <span class="hljs-number">117</span> <span class="hljs-number">118</span> <span class="hljs-number">119</span>]

TRAIN: [  <span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">3</span>   <span class="hljs-number">4</span>   <span class="hljs-number">5</span>   <span class="hljs-number">6</span>   <span class="hljs-number">7</span>   <span class="hljs-number">8</span>   <span class="hljs-number">9</span>  <span class="hljs-number">10</span>  <span class="hljs-number">11</span>  <span class="hljs-number">12</span>  <span class="hljs-number">13</span>  <span class="hljs-number">14</span>  <span class="hljs-number">15</span>  <span class="hljs-number">16</span>  <span class="hljs-number">17</span>
  <span class="hljs-number">18</span>  <span class="hljs-number">19</span>  <span class="hljs-number">20</span>  <span class="hljs-number">21</span>  <span class="hljs-number">22</span>  <span class="hljs-number">23</span>  <span class="hljs-number">24</span>  <span class="hljs-number">25</span>  <span class="hljs-number">26</span>  <span class="hljs-number">27</span>  <span class="hljs-number">28</span>  <span class="hljs-number">29</span>  <span class="hljs-number">30</span>  <span class="hljs-number">31</span>  <span class="hljs-number">32</span>  <span class="hljs-number">33</span>  <span class="hljs-number">34</span>  <span class="hljs-number">35</span>
  <span class="hljs-number">36</span>  <span class="hljs-number">37</span>  <span class="hljs-number">38</span>  <span class="hljs-number">39</span>  <span class="hljs-number">40</span>  <span class="hljs-number">41</span>  <span class="hljs-number">42</span>  <span class="hljs-number">43</span>  <span class="hljs-number">44</span>  <span class="hljs-number">45</span>  <span class="hljs-number">46</span>  <span class="hljs-number">47</span>  <span class="hljs-number">48</span>  <span class="hljs-number">49</span>  <span class="hljs-number">50</span>  <span class="hljs-number">51</span>  <span class="hljs-number">52</span>  <span class="hljs-number">53</span>
  <span class="hljs-number">54</span>  <span class="hljs-number">55</span>  <span class="hljs-number">56</span>  <span class="hljs-number">57</span>  <span class="hljs-number">58</span>  <span class="hljs-number">59</span>  <span class="hljs-number">60</span>  <span class="hljs-number">61</span>  <span class="hljs-number">62</span>  <span class="hljs-number">63</span>  <span class="hljs-number">64</span>  <span class="hljs-number">65</span>  <span class="hljs-number">66</span>  <span class="hljs-number">67</span>  <span class="hljs-number">68</span>  <span class="hljs-number">69</span>  <span class="hljs-number">70</span>  <span class="hljs-number">71</span>
  <span class="hljs-number">72</span>  <span class="hljs-number">73</span>  <span class="hljs-number">74</span>  <span class="hljs-number">75</span>  <span class="hljs-number">76</span>  <span class="hljs-number">77</span>  <span class="hljs-number">78</span>  <span class="hljs-number">79</span>  <span class="hljs-number">80</span>  <span class="hljs-number">81</span>  <span class="hljs-number">82</span>  <span class="hljs-number">83</span>  <span class="hljs-number">84</span>  <span class="hljs-number">85</span>  <span class="hljs-number">86</span>  <span class="hljs-number">87</span>  <span class="hljs-number">88</span>  <span class="hljs-number">89</span>
  <span class="hljs-number">90</span>  <span class="hljs-number">91</span>  <span class="hljs-number">92</span>  <span class="hljs-number">93</span>  <span class="hljs-number">94</span>  <span class="hljs-number">95</span>  <span class="hljs-number">96</span>  <span class="hljs-number">97</span>  <span class="hljs-number">98</span>  <span class="hljs-number">99</span> <span class="hljs-number">100</span> <span class="hljs-number">101</span> <span class="hljs-number">102</span> <span class="hljs-number">103</span> <span class="hljs-number">104</span> <span class="hljs-number">105</span> <span class="hljs-number">106</span> <span class="hljs-number">107</span>
 <span class="hljs-number">108</span> <span class="hljs-number">109</span> <span class="hljs-number">110</span> <span class="hljs-number">111</span> <span class="hljs-number">112</span> <span class="hljs-number">113</span> <span class="hljs-number">114</span> <span class="hljs-number">115</span> <span class="hljs-number">116</span> <span class="hljs-number">117</span> <span class="hljs-number">118</span> <span class="hljs-number">119</span>] 
TEST: [<span class="hljs-number">120</span> <span class="hljs-number">121</span> <span class="hljs-number">122</span> <span class="hljs-number">123</span> <span class="hljs-number">124</span> <span class="hljs-number">125</span> <span class="hljs-number">126</span> <span class="hljs-number">127</span> <span class="hljs-number">128</span> <span class="hljs-number">129</span> <span class="hljs-number">130</span> <span class="hljs-number">131</span> <span class="hljs-number">132</span> <span class="hljs-number">133</span> <span class="hljs-number">134</span> <span class="hljs-number">135</span> <span class="hljs-number">136</span> <span class="hljs-number">137</span>
 <span class="hljs-number">138</span> <span class="hljs-number">139</span> <span class="hljs-number">140</span> <span class="hljs-number">141</span> <span class="hljs-number">142</span> <span class="hljs-number">143</span> <span class="hljs-number">144</span> <span class="hljs-number">145</span> <span class="hljs-number">146</span> <span class="hljs-number">147</span> <span class="hljs-number">148</span> <span class="hljs-number">149</span>]
</code></pre>
<h2 id="23-&#x7279;&#x5F81;&#x62BD;&#x53D6;">2.3 &#x7279;&#x5F81;&#x62BD;&#x53D6;</h2>
<p>&#xFF08;feature extraction&#xFF09;</p>
<p>&#x5C06;&#x4EFB;&#x610F;&#x6570;&#x636E;&#xFF08;&#x5982;&#x6587;&#x672C;&#x6216;&#x56FE;&#x50CF;&#xFF09;&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x7528;&#x4E8E;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x7684;&#x6570;&#x5B57;&#x7279;&#x5F81;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> sklearn.feature_extraction
</code></pre>
<h3 id="231-&#x5B57;&#x5178;&#x7279;&#x5F81;&#x63D0;&#x53D6;-dictvectorizer">2.3.1 &#x5B57;&#x5178;&#x7279;&#x5F81;&#x63D0;&#x53D6; DictVectorizer</h3>
<p>&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#xFF0C;&#x5E94;&#x7528;&#x65F6;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5B9E;&#x4F8B;&#x5316;</p>
<h4 id="1&#xFF09;api">1&#xFF09;API</h4>
<p><strong><em>sklearn.feature_extraction.DictVectorizer(sparse=True,&#x2026;)</em></strong></p>
<ul>
<li><em>DictVectorizer.fit_transform(X)</em><ul>
<li>X&#xFF1A;&#x5B57;&#x5178;&#x6216;&#x8005;&#x5305;&#x542B;&#x5B57;&#x5178;&#x7684;&#x8FED;&#x4EE3;&#x5668;</li>
<li>&#x8FD4;&#x56DE;sparse&#x77E9;&#x9635;&#x6216;array&#x6570;&#x7EC4;</li>
</ul>
</li>
<li><em>DictVectorizer.inverse_transform(X)</em><ul>
<li>X&#xFF1A;array&#x6570;&#x7EC4;&#x6216;&#x8005;sparse&#x77E9;&#x9635; </li>
<li>&#x8FD4;&#x56DE;&#x8F6C;&#x6362;&#x4E4B;&#x524D;&#x6570;&#x636E;&#x683C;&#x5F0F;</li>
</ul>
</li>
<li><em>DictVectorizer.get_feature_names()</em> <ul>
<li>&#x8FD4;&#x56DE;&#x7C7B;&#x522B;&#x540D;&#x79F0;</li>
</ul>
</li>
</ul>
<h4 id="2&#xFF09;&#x4F8B;">2&#xFF09;&#x4F8B;</h4>
<p>&#x6D41;&#x7A0B;&#x5206;&#x6790;</p>
<ul>
<li>&#x5B9E;&#x4F8B;&#x5316;&#x7C7B; DictVectorizer</li>
<li>&#x8C03;&#x7528; fit_transform &#x65B9;&#x6CD5;&#x8F93;&#x5165;&#x6570;&#x636E;&#x5E76;&#x8F6C;&#x6362;&#xFF08;&#x6CE8;&#x610F;&#x8FD4;&#x56DE;&#x683C;&#x5F0F;&#xFF09;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.feature_extraction <span class="hljs-keyword">import</span> DictVectorizer

data = [{<span class="hljs-string">&apos;city&apos;</span>: <span class="hljs-string">&apos;&#x5317;&#x4EAC;&apos;</span>,<span class="hljs-string">&apos;temperature&apos;</span>:<span class="hljs-number">100</span>}, {<span class="hljs-string">&apos;city&apos;</span>: <span class="hljs-string">&apos;&#x4E0A;&#x6D77;&apos;</span>,<span class="hljs-string">&apos;temperature&apos;</span>:<span class="hljs-number">60</span>}, {<span class="hljs-string">&apos;city&apos;</span>: <span class="hljs-string">&apos;&#x6DF1;&#x5733;&apos;</span>,<span class="hljs-string">&apos;temperature&apos;</span>:<span class="hljs-number">30</span>}]

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = DictVectorizer(sparse=<span class="hljs-keyword">False</span>)<span class="hljs-comment"># &#x62D2;&#x7EDD;&#x8FD4;&#x56DE;&#x7A00;&#x758F;&#x77E9;&#x9635;</span>
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(data)

print(<span class="hljs-string">&quot;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;:\n&quot;</span>, data)
print(<span class="hljs-string">&quot;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;\n&quot;</span>, transfer.get_feature_names())
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;:
[[  <span class="hljs-number">0.</span>   <span class="hljs-number">1.</span>   <span class="hljs-number">0.</span> <span class="hljs-number">100.</span>]
 [  <span class="hljs-number">1.</span>   <span class="hljs-number">0.</span>   <span class="hljs-number">0.</span>  <span class="hljs-number">60.</span>]
 [  <span class="hljs-number">0.</span>   <span class="hljs-number">0.</span>   <span class="hljs-number">1.</span>  <span class="hljs-number">30.</span>]]
&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;
 [<span class="hljs-string">&apos;city=&#x4E0A;&#x6D77;&apos;</span>, <span class="hljs-string">&apos;city=&#x5317;&#x4EAC;&apos;</span>, <span class="hljs-string">&apos;city=&#x6DF1;&#x5733;&apos;</span>, <span class="hljs-string">&apos;temperature&apos;</span>]
</code></pre>
<p>&#x82E5;&#x8FD4;&#x56DE;&#x7A00;&#x758F;&#x77E9;&#x9635;&#xFF0C;&#x6539;sparse=True</p>
<pre><code class="lang-python">&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;:
(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)    <span class="hljs-number">1.0</span>
(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)    <span class="hljs-number">100.0</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)    <span class="hljs-number">1.0</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)    <span class="hljs-number">60.0</span>
(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)    <span class="hljs-number">1.0</span>
(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)    <span class="hljs-number">30.0</span>
&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;
 [<span class="hljs-string">&apos;city=&#x4E0A;&#x6D77;&apos;</span>, <span class="hljs-string">&apos;city=&#x5317;&#x4EAC;&apos;</span>, <span class="hljs-string">&apos;city=&#x6DF1;&#x5733;&apos;</span>, <span class="hljs-string">&apos;temperature&apos;</span>]
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x5904;&#x7406;&#x6570;&#x636E;&#x7684;&#x6280;&#x5DE7;&#x53EB;&#x505A; <em>one-hot</em> &#x7F16;&#x7801;</p>
<h3 id="232-&#x6587;&#x672C;&#x8BCD;&#x9891;&#x7279;&#x5F81;&#x63D0;&#x53D6;-textcountvectorizer">2.3.2 &#x6587;&#x672C;&#x8BCD;&#x9891;&#x7279;&#x5F81;&#x63D0;&#x53D6; text.CountVectorizer</h3>
<p>&#x5BF9;&#x6587;&#x672C;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x8BCD;&#x9891;&#x7279;&#x5F81;&#x503C;&#x5316;</p>
<p>&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#xFF0C;&#x5E94;&#x7528;&#x65F6;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5B9E;&#x4F8B;&#x5316;</p>
<h4 id="1&#xFF09;api">1&#xFF09;API</h4>
<p><strong><em>CountVectorizer(stop_words=[])</em></strong></p>
<ul>
<li>CountVectorizer.fit_transform(X)<ul>
<li>X&#xFF1A;&#x6587;&#x672C;&#x6216;&#x8005;&#x5305;&#x542B;&#x6587;&#x672C;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x53EF;&#x8FED;&#x4EE3;&#x5BF9;&#x8C61;</li>
<li>&#x8FD4;&#x56DE;sparse&#x77E9;&#x9635;</li>
</ul>
</li>
<li>CountVectorizer.inverse_transform(X)<ul>
<li>X&#xFF1A;array&#x6570;&#x7EC4;&#x6216;&#x8005;sparse&#x77E9;&#x9635; </li>
<li>&#x8FD4;&#x56DE;&#x8F6C;&#x6362;&#x4E4B;&#x524D;&#x6570;&#x636E;&#x683C;</li>
</ul>
</li>
<li>CountVectorizer.get_feature_names() <ul>
<li>&#x8FD4;&#x56DE;&#x503C;&#x5355;&#x8BCD;&#x5217;&#x8868;</li>
</ul>
</li>
</ul>
<h4 id="2&#xFF09;&#x4F8B;">2&#xFF09;&#x4F8B;</h4>
<p>&#x6D41;&#x7A0B;&#x5206;&#x6790;</p>
<ul>
<li>&#x5B9E;&#x4F8B;&#x5316;&#x7C7B; CountVectorizer</li>
<li>&#x8C03;&#x7528; fit_transform &#x65B9;&#x6CD5;&#x8F93;&#x5165;&#x6570;&#x636E;&#x5E76;&#x8F6C;&#x6362; &#xFF08;&#x6CE8;&#x610F;&#x8FD4;&#x56DE;&#x683C;&#x5F0F;&#xFF0C;&#x5229;&#x7528; toarray() &#x8FDB;&#x884C; sparse &#x77E9;&#x9635;&#x8F6C;&#x6362; array &#x6570;&#x7EC4;&#xFF09;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> CountVectorizer

data = [<span class="hljs-string">&quot;life is short,i like like python&quot;</span>,
        <span class="hljs-string">&quot;life is too long,i dislike python&quot;</span>]

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = CountVectorizer()
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(data)

print(<span class="hljs-string">&quot;&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;\n&quot;</span>, data.toarray())
print(<span class="hljs-string">&quot;&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;\n&quot;</span>, transfer.get_feature_names())
</code></pre>
<p>&#x8F93;&#x51FA;&#xFF08;&#x56E0;&#x4E3A;&#x6CA1;&#x6709; sparse &#x53C2;&#x6570;&#xFF0C;&#x82E5;&#x8981;&#x8F6C;&#x6362;&#x6210;&#x4E8C;&#x7EF4;&#x6570;&#x7EC4;&#x5F62;&#x5F0F;&#xFF0C;&#x9700;&#x8981;&#x5229;&#x7528;toarray()&#xFF09;</p>
<pre><code class="lang-python">&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;
 [[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>]
 [<span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>]]
&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;
 [<span class="hljs-string">&apos;dislike&apos;</span>, <span class="hljs-string">&apos;is&apos;</span>, <span class="hljs-string">&apos;life&apos;</span>, <span class="hljs-string">&apos;like&apos;</span>, <span class="hljs-string">&apos;long&apos;</span>, <span class="hljs-string">&apos;python&apos;</span>, <span class="hljs-string">&apos;short&apos;</span>, <span class="hljs-string">&apos;too&apos;</span>]
</code></pre>
<p>&#x82E5;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7A00;&#x758F;&#x77E9;&#x9635;</p>
<pre><code class="lang-python">&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;
(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">0</span>, <span class="hljs-number">6</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)    <span class="hljs-number">2</span>
(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">7</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>)    <span class="hljs-number">1</span>
(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)    <span class="hljs-number">1</span>
&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;
 [<span class="hljs-string">&apos;dislike&apos;</span>, <span class="hljs-string">&apos;is&apos;</span>, <span class="hljs-string">&apos;life&apos;</span>, <span class="hljs-string">&apos;like&apos;</span>, <span class="hljs-string">&apos;long&apos;</span>, <span class="hljs-string">&apos;python&apos;</span>, <span class="hljs-string">&apos;short&apos;</span>, <span class="hljs-string">&apos;too&apos;</span>]
</code></pre>
<h4 id="3&#xFF09;&#x4E2D;&#x6587;&#x5904;&#x7406;">3&#xFF09;&#x4E2D;&#x6587;&#x5904;&#x7406;</h4>
<p>&#x4F7F;&#x7528; jieba &#x5206;&#x8BCD;&#x5E93;</p>
<p><strong><em>jieba.cut()</em></strong></p>
<ul>
<li>&#x8FD4;&#x56DE;&#x8BCD;&#x8BED;&#x7EC4;&#x6210;&#x7684;&#x751F;&#x6210;&#x5668;</li>
</ul>
<p>&#x5206;&#x6790;</p>
<ul>
<li>&#x51C6;&#x5907;&#x53E5;&#x5B50;&#xFF0C;&#x5229;&#x7528;jieba.cut&#x8FDB;&#x884C;&#x5206;&#x8BCD;</li>
<li>&#x5B9E;&#x4F8B;&#x5316;CountVectorizer</li>
<li>&#x5C06;&#x5206;&#x8BCD;&#x7ED3;&#x679C;&#x53D8;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#x5F53;&#x4F5C;fit_transform&#x7684;&#x8F93;&#x5165;&#x503C;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> CountVectorizer
<span class="hljs-keyword">import</span> jieba


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cut_word</span><span class="hljs-params">(text)</span>:</span>
    <span class="hljs-comment"># &#x7528;&#x7ED3;&#x5DF4;&#x5BF9;&#x4E2D;&#x6587;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x884C;&#x5206;&#x8BCD;</span>
    text = <span class="hljs-string">&quot; &quot;</span>.join(list(jieba.cut(text)))
    <span class="hljs-keyword">return</span> text


data = [<span class="hljs-string">&quot;&#x4E00;&#x79CD;&#x8FD8;&#x662F;&#x4E00;&#x79CD;&#x4ECA;&#x5929;&#x5F88;&#x6B8B;&#x9177;&#xFF0C;&#x660E;&#x5929;&#x66F4;&#x6B8B;&#x9177;&#xFF0C;&#x540E;&#x5929;&#x5F88;&#x7F8E;&#x597D;&#xFF0C;&#x4F46;&#x7EDD;&#x5BF9;&#x5927;&#x90E8;&#x5206;&#x662F;&#x6B7B;&#x5728;&#x660E;&#x5929;&#x665A;&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x6BCF;&#x4E2A;&#x4EBA;&#x4E0D;&#x8981;&#x653E;&#x5F03;&#x4ECA;&#x5929;&#x3002;&quot;</span>,
        <span class="hljs-string">&quot;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x7684;&#x4ECE;&#x5F88;&#x8FDC;&#x661F;&#x7CFB;&#x6765;&#x7684;&#x5149;&#x662F;&#x5728;&#x51E0;&#x767E;&#x4E07;&#x5E74;&#x4E4B;&#x524D;&#x53D1;&#x51FA;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x5B87;&#x5B99;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x662F;&#x5728;&#x770B;&#x5B83;&#x7684;&#x8FC7;&#x53BB;&#x3002;&quot;</span>,
        <span class="hljs-string">&quot;&#x5982;&#x679C;&#x53EA;&#x7528;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x4E86;&#x89E3;&#x67D0;&#x6837;&#x4E8B;&#x7269;&#xFF0C;&#x4F60;&#x5C31;&#x4E0D;&#x4F1A;&#x771F;&#x6B63;&#x4E86;&#x89E3;&#x5B83;&#x3002;&#x4E86;&#x89E3;&#x4E8B;&#x7269;&#x771F;&#x6B63;&#x542B;&#x4E49;&#x7684;&#x79D8;&#x5BC6;&#x53D6;&#x51B3;&#x4E8E;&#x5982;&#x4F55;&#x5C06;&#x5176;&#x4E0E;&#x6211;&#x4EEC;&#x6240;&#x4E86;&#x89E3;&#x7684;&#x4E8B;&#x7269;&#x76F8;&#x8054;&#x7CFB;&#x3002;&quot;</span>]

<span class="hljs-comment"># &#x5C06;&#x539F;&#x59CB;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x6210;&#x5206;&#x597D;&#x8BCD;&#x7684;&#x5F62;&#x5F0F;</span>
text_list = []
<span class="hljs-keyword">for</span> sent <span class="hljs-keyword">in</span> data:
    text_list.append(cut_word(sent))
print(text_list)

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = CountVectorizer()
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(text_list)

print(<span class="hljs-string">&quot;&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;\n&quot;</span>, data.toarray())
print(<span class="hljs-string">&quot;&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;\n&quot;</span>, transfer.get_feature_names())
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">
[<span class="hljs-string">&apos;&#x4E00;&#x79CD; &#x8FD8;&#x662F; &#x4E00;&#x79CD; &#x4ECA;&#x5929; &#x5F88; &#x6B8B;&#x9177; &#xFF0C; &#x660E;&#x5929; &#x66F4; &#x6B8B;&#x9177; &#xFF0C; &#x540E;&#x5929; &#x5F88; &#x7F8E;&#x597D; &#xFF0C; &#x4F46; &#x7EDD;&#x5BF9; &#x5927;&#x90E8;&#x5206; &#x662F; &#x6B7B; &#x5728; &#x660E;&#x5929; &#x665A;&#x4E0A; &#xFF0C; &#x6240;&#x4EE5; &#x6BCF;&#x4E2A; &#x4EBA; &#x4E0D;&#x8981; &#x653E;&#x5F03; &#x4ECA;&#x5929; &#x3002;&apos;</span>, <span class="hljs-string">&apos;&#x6211;&#x4EEC; &#x770B;&#x5230; &#x7684; &#x4ECE; &#x5F88; &#x8FDC; &#x661F;&#x7CFB; &#x6765; &#x7684; &#x5149;&#x662F;&#x5728; &#x51E0;&#x767E;&#x4E07;&#x5E74; &#x4E4B;&#x524D; &#x53D1;&#x51FA; &#x7684; &#xFF0C; &#x8FD9;&#x6837; &#x5F53; &#x6211;&#x4EEC; &#x770B;&#x5230; &#x5B87;&#x5B99; &#x65F6; &#xFF0C; &#x6211;&#x4EEC; &#x662F; &#x5728; &#x770B; &#x5B83; &#x7684; &#x8FC7;&#x53BB; &#x3002;&apos;</span>, <span class="hljs-string">&apos;&#x5982;&#x679C; &#x53EA;&#x7528; &#x4E00;&#x79CD; &#x65B9;&#x5F0F; &#x4E86;&#x89E3; &#x67D0;&#x6837; &#x4E8B;&#x7269; &#xFF0C; &#x4F60; &#x5C31; &#x4E0D;&#x4F1A; &#x771F;&#x6B63; &#x4E86;&#x89E3; &#x5B83; &#x3002; &#x4E86;&#x89E3; &#x4E8B;&#x7269; &#x771F;&#x6B63; &#x542B;&#x4E49; &#x7684; &#x79D8;&#x5BC6; &#x53D6;&#x51B3;&#x4E8E; &#x5982;&#x4F55; &#x5C06; &#x5176; &#x4E0E; &#x6211;&#x4EEC; &#x6240; &#x4E86;&#x89E3; &#x7684; &#x4E8B;&#x7269; &#x76F8; &#x8054;&#x7CFB; &#x3002;&apos;</span>]

&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;
 [[<span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>
  <span class="hljs-number">0</span>]
 [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
  <span class="hljs-number">1</span>]
 [<span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
  <span class="hljs-number">0</span>]]
&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;
 [<span class="hljs-string">&apos;&#x4E00;&#x79CD;&apos;</span>, <span class="hljs-string">&apos;&#x4E0D;&#x4F1A;&apos;</span>, <span class="hljs-string">&apos;&#x4E0D;&#x8981;&apos;</span>, <span class="hljs-string">&apos;&#x4E4B;&#x524D;&apos;</span>, <span class="hljs-string">&apos;&#x4E86;&#x89E3;&apos;</span>, <span class="hljs-string">&apos;&#x4E8B;&#x7269;&apos;</span>, <span class="hljs-string">&apos;&#x4ECA;&#x5929;&apos;</span>, <span class="hljs-string">&apos;&#x5149;&#x662F;&#x5728;&apos;</span>, <span class="hljs-string">&apos;&#x51E0;&#x767E;&#x4E07;&#x5E74;&apos;</span>, <span class="hljs-string">&apos;&#x53D1;&#x51FA;&apos;</span>, <span class="hljs-string">&apos;&#x53D6;&#x51B3;&#x4E8E;&apos;</span>, <span class="hljs-string">&apos;&#x53EA;&#x7528;&apos;</span>, <span class="hljs-string">&apos;&#x540E;&#x5929;&apos;</span>, <span class="hljs-string">&apos;&#x542B;&#x4E49;&apos;</span>, <span class="hljs-string">&apos;&#x5927;&#x90E8;&#x5206;&apos;</span>, <span class="hljs-string">&apos;&#x5982;&#x4F55;&apos;</span>, <span class="hljs-string">&apos;&#x5982;&#x679C;&apos;</span>, <span class="hljs-string">&apos;&#x5B87;&#x5B99;&apos;</span>, <span class="hljs-string">&apos;&#x6211;&#x4EEC;&apos;</span>, <span class="hljs-string">&apos;&#x6240;&#x4EE5;&apos;</span>, <span class="hljs-string">&apos;&#x653E;&#x5F03;&apos;</span>, <span class="hljs-string">&apos;&#x65B9;&#x5F0F;&apos;</span>, <span class="hljs-string">&apos;&#x660E;&#x5929;&apos;</span>, <span class="hljs-string">&apos;&#x661F;&#x7CFB;&apos;</span>, <span class="hljs-string">&apos;&#x665A;&#x4E0A;&apos;</span>, <span class="hljs-string">&apos;&#x67D0;&#x6837;&apos;</span>, <span class="hljs-string">&apos;&#x6B8B;&#x9177;&apos;</span>, <span class="hljs-string">&apos;&#x6BCF;&#x4E2A;&apos;</span>, <span class="hljs-string">&apos;&#x770B;&#x5230;&apos;</span>, <span class="hljs-string">&apos;&#x771F;&#x6B63;&apos;</span>, <span class="hljs-string">&apos;&#x79D8;&#x5BC6;&apos;</span>, <span class="hljs-string">&apos;&#x7EDD;&#x5BF9;&apos;</span>, <span class="hljs-string">&apos;&#x7F8E;&#x597D;&apos;</span>, <span class="hljs-string">&apos;&#x8054;&#x7CFB;&apos;</span>, <span class="hljs-string">&apos;&#x8FC7;&#x53BB;&apos;</span>, <span class="hljs-string">&apos;&#x8FD8;&#x662F;&apos;</span>, <span class="hljs-string">&apos;&#x8FD9;&#x6837;&apos;</span>]
</code></pre>
<h3 id="233-tf-idf&#x6587;&#x672C;&#x7279;&#x5F81;&#x63D0;&#x53D6;-texttfidfvectorizer">2.3.3 Tf-idf&#x6587;&#x672C;&#x7279;&#x5F81;&#x63D0;&#x53D6; text.TfidfVectorizer</h3>
<p>TF-IDF&#x7684;&#x4E3B;&#x8981;&#x601D;&#x60F3;&#x662F;&#xFF1A;&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x8BCD;&#x6216;&#x77ED;&#x8BED;&#x5728;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6982;&#x7387;&#x9AD8;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x5176;&#x4ED6;&#x6587;&#x7AE0;&#x4E2D;&#x5F88;&#x5C11;&#x51FA;&#x73B0;&#xFF0C;&#x5219;&#x8BA4;&#x4E3A;&#x6B64;&#x8BCD;&#x6216;&#x8005;&#x77ED;&#x8BED;&#x5177;&#x6709;&#x5F88;&#x597D;&#x7684;&#x7C7B;&#x522B;&#x533A;&#x5206;&#x80FD;&#x529B;&#xFF0C;&#x9002;&#x5408;&#x7528;&#x6765;&#x5206;&#x7C7B;&#x3002;</p>
<p>TF-IDF&#x4F5C;&#x7528;&#xFF1A;&#x7528;&#x4EE5;&#x8BC4;&#x4F30;&#x4E00;&#x5B57;&#x8BCD;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x96C6;&#x6216;&#x4E00;&#x4E2A;&#x8BED;&#x6599;&#x5E93;&#x4E2D;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4EFD;&#x6587;&#x4EF6;&#x7684;&#x91CD;&#x8981;&#x7A0B;&#x5EA6;&#x3002;</p>
<h4 id="1&#xFF09;&#x516C;&#x5F0F;">1&#xFF09;&#x516C;&#x5F0F;</h4>
<ul>
<li>&#x8BCD;&#x9891;&#xFF08;term frequency&#xFF0C;tf&#xFF09;&#x6307;&#x7684;&#x662F;&#x67D0;&#x4E00;&#x4E2A;&#x7ED9;&#x5B9A;&#x7684;&#x8BCD;&#x8BED;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x9891;&#x7387;</li>
<li>&#x9006;&#x5411;&#x6587;&#x6863;&#x9891;&#x7387;&#xFF08;inverse document frequency&#xFF0C;idf&#xFF09;&#x662F;&#x4E00;&#x4E2A;&#x8BCD;&#x8BED;&#x666E;&#x904D;&#x91CD;&#x8981;&#x6027;&#x7684;&#x5EA6;&#x91CF;&#x3002;&#x7531;&#x603B;&#x6587;&#x4EF6;&#x6570;&#x76EE;&#x9664;&#x4EE5;&#x5305;&#x542B;&#x8BE5;&#x8BCD;&#x8BED;&#x4E4B;&#x6587;&#x4EF6;&#x7684;&#x6570;&#x76EE;&#xFF0C;&#x518D;&#x5C06;&#x5F97;&#x5230;&#x7684;&#x5546;&#x53D6;&#x4EE5;10&#x4E3A;&#x5E95;&#x7684;&#x5BF9;&#x6570;&#x5F97;&#x5230;</li>
</ul>
<p>$$
tfidf<em>{i,j}=tf</em>{i,j}\times idf_i</p>
<p>$$</p>
<blockquote>
<p> &#x5047;&#x5982;&#x4E00;&#x7BC7;&#x6587;&#x4EF6;&#x7684;&#x603B;&#x8BCD;&#x8BED;&#x6570;&#x662F;100&#x4E2A;&#xFF0C;&#x800C;&#x8BCD;&#x8BED;&quot;&#x975E;&#x5E38;&quot;&#x51FA;&#x73B0;&#x4E86;5&#x6B21;&#xFF0C;&#x90A3;&#x4E48;&quot;&#x975E;&#x5E38;&quot;&#x4E00;&#x8BCD;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x8BCD;&#x9891;&#x5C31;&#x662F;5/100=0.05&#x3002;&#x800C;&#x8BA1;&#x7B97;&#x6587;&#x4EF6;&#x9891;&#x7387;&#xFF08;IDF&#xFF09;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x4EE5;&#x6587;&#x4EF6;&#x96C6;&#x7684;&#x6587;&#x4EF6;&#x603B;&#x6570;&#xFF0C;&#x9664;&#x4EE5;&#x51FA;&#x73B0;&quot;&#x975E;&#x5E38;&quot;&#x4E00;&#x8BCD;&#x7684;&#x6587;&#x4EF6;&#x6570;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5982;&#x679C;&quot;&#x975E;&#x5E38;&quot;&#x4E00;&#x8BCD;&#x5728;1,000&#x4EFD;&#x6587;&#x4EF6;&#x51FA;&#x73B0;&#x8FC7;&#xFF0C;&#x800C;&#x6587;&#x4EF6;&#x603B;&#x6570;&#x662F;10,000,000&#x4EFD;&#x7684;&#x8BDD;&#xFF0C;&#x5176;&#x9006;&#x5411;&#x6587;&#x4EF6;&#x9891;&#x7387;&#x5C31;&#x662F;lg&#xFF08;10,000,000 / 1,0000&#xFF09;=3&#x3002;&#x6700;&#x540E;&quot;&#x975E;&#x5E38;&quot;&#x5BF9;&#x4E8E;&#x8FD9;&#x7BC7;&#x6587;&#x6863;&#x7684;tf-idf&#x7684;&#x5206;&#x6570;&#x4E3A;0.05 * 3=0.15</p>
</blockquote>
<h4 id="2&#xFF09;api">2&#xFF09;API</h4>
<p><strong><em>TfidfVectorizer(stop_words=[])</em></strong></p>
<ul>
<li>TfidfVectorizer.fit_transform(X)<ul>
<li>X&#xFF1A;&#x6587;&#x672C;&#x6216;&#x8005;&#x5305;&#x542B;&#x6587;&#x672C;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x53EF;&#x8FED;&#x4EE3;&#x5BF9;&#x8C61;</li>
<li>&#x8FD4;&#x56DE;sparse&#x77E9;&#x9635;</li>
</ul>
</li>
<li>TfidfVectorizer.inverse_transform(X)<ul>
<li>X&#xFF1A;array&#x6570;&#x7EC4;&#x6216;&#x8005;sparse&#x77E9;&#x9635; </li>
<li>&#x8FD4;&#x56DE;&#x8F6C;&#x6362;&#x4E4B;&#x524D;&#x6570;&#x636E;&#x683C;</li>
</ul>
</li>
<li>TfidfVectorizer.get_feature_names() <ul>
<li>&#x8FD4;&#x56DE;&#x503C;&#x5355;&#x8BCD;&#x5217;&#x8868;</li>
</ul>
</li>
</ul>
<h4 id="3&#xFF09;&#x4F8B;">3&#xFF09;&#x4F8B;</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> TfidfVectorizer
<span class="hljs-keyword">import</span> jieba

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cut_word</span><span class="hljs-params">(text)</span>:</span>
    <span class="hljs-comment"># &#x7528;&#x7ED3;&#x5DF4;&#x5BF9;&#x4E2D;&#x6587;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x884C;&#x5206;&#x8BCD;</span>
    text = <span class="hljs-string">&quot; &quot;</span>.join(list(jieba.cut(text)))
    <span class="hljs-keyword">return</span> text

data = [<span class="hljs-string">&quot;&#x4E00;&#x79CD;&#x8FD8;&#x662F;&#x4E00;&#x79CD;&#x4ECA;&#x5929;&#x5F88;&#x6B8B;&#x9177;&#xFF0C;&#x660E;&#x5929;&#x66F4;&#x6B8B;&#x9177;&#xFF0C;&#x540E;&#x5929;&#x5F88;&#x7F8E;&#x597D;&#xFF0C;&#x4F46;&#x7EDD;&#x5BF9;&#x5927;&#x90E8;&#x5206;&#x662F;&#x6B7B;&#x5728;&#x660E;&#x5929;&#x665A;&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x6BCF;&#x4E2A;&#x4EBA;&#x4E0D;&#x8981;&#x653E;&#x5F03;&#x4ECA;&#x5929;&#x3002;&quot;</span>,
        <span class="hljs-string">&quot;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x7684;&#x4ECE;&#x5F88;&#x8FDC;&#x661F;&#x7CFB;&#x6765;&#x7684;&#x5149;&#x662F;&#x5728;&#x51E0;&#x767E;&#x4E07;&#x5E74;&#x4E4B;&#x524D;&#x53D1;&#x51FA;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x5B87;&#x5B99;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x662F;&#x5728;&#x770B;&#x5B83;&#x7684;&#x8FC7;&#x53BB;&#x3002;&quot;</span>,
        <span class="hljs-string">&quot;&#x5982;&#x679C;&#x53EA;&#x7528;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x4E86;&#x89E3;&#x67D0;&#x6837;&#x4E8B;&#x7269;&#xFF0C;&#x4F60;&#x5C31;&#x4E0D;&#x4F1A;&#x771F;&#x6B63;&#x4E86;&#x89E3;&#x5B83;&#x3002;&#x4E86;&#x89E3;&#x4E8B;&#x7269;&#x771F;&#x6B63;&#x542B;&#x4E49;&#x7684;&#x79D8;&#x5BC6;&#x53D6;&#x51B3;&#x4E8E;&#x5982;&#x4F55;&#x5C06;&#x5176;&#x4E0E;&#x6211;&#x4EEC;&#x6240;&#x4E86;&#x89E3;&#x7684;&#x4E8B;&#x7269;&#x76F8;&#x8054;&#x7CFB;&#x3002;&quot;</span>]

<span class="hljs-comment"># &#x5C06;&#x539F;&#x59CB;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x6210;&#x5206;&#x597D;&#x8BCD;&#x7684;&#x5F62;&#x5F0F;</span>
text_list = []
<span class="hljs-keyword">for</span> sent <span class="hljs-keyword">in</span> data:
    text_list.append(cut_word(sent))
print(text_list)

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = TfidfVectorizer(stop_words=[<span class="hljs-string">&apos;&#x4E00;&#x79CD;&apos;</span>, <span class="hljs-string">&apos;&#x4E0D;&#x4F1A;&apos;</span>, <span class="hljs-string">&apos;&#x4E0D;&#x8981;&apos;</span>])
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(text_list)

print(<span class="hljs-string">&quot;&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;\n&quot;</span>, data.toarray())
print(<span class="hljs-string">&quot;&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;\n&quot;</span>, transfer.get_feature_names())
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">[<span class="hljs-string">&apos;&#x4E00;&#x79CD; &#x8FD8;&#x662F; &#x4E00;&#x79CD; &#x4ECA;&#x5929; &#x5F88; &#x6B8B;&#x9177; &#xFF0C; &#x660E;&#x5929; &#x66F4; &#x6B8B;&#x9177; &#xFF0C; &#x540E;&#x5929; &#x5F88; &#x7F8E;&#x597D; &#xFF0C; &#x4F46; &#x7EDD;&#x5BF9; &#x5927;&#x90E8;&#x5206; &#x662F; &#x6B7B; &#x5728; &#x660E;&#x5929; &#x665A;&#x4E0A; &#xFF0C; &#x6240;&#x4EE5; &#x6BCF;&#x4E2A; &#x4EBA; &#x4E0D;&#x8981; &#x653E;&#x5F03; &#x4ECA;&#x5929; &#x3002;&apos;</span>, <span class="hljs-string">&apos;&#x6211;&#x4EEC; &#x770B;&#x5230; &#x7684; &#x4ECE; &#x5F88; &#x8FDC; &#x661F;&#x7CFB; &#x6765; &#x7684; &#x5149;&#x662F;&#x5728; &#x51E0;&#x767E;&#x4E07;&#x5E74; &#x4E4B;&#x524D; &#x53D1;&#x51FA; &#x7684; &#xFF0C; &#x8FD9;&#x6837; &#x5F53; &#x6211;&#x4EEC; &#x770B;&#x5230; &#x5B87;&#x5B99; &#x65F6; &#xFF0C; &#x6211;&#x4EEC; &#x662F; &#x5728; &#x770B; &#x5B83; &#x7684; &#x8FC7;&#x53BB; &#x3002;&apos;</span>, <span class="hljs-string">&apos;&#x5982;&#x679C; &#x53EA;&#x7528; &#x4E00;&#x79CD; &#x65B9;&#x5F0F; &#x4E86;&#x89E3; &#x67D0;&#x6837; &#x4E8B;&#x7269; &#xFF0C; &#x4F60; &#x5C31; &#x4E0D;&#x4F1A; &#x771F;&#x6B63; &#x4E86;&#x89E3; &#x5B83; &#x3002; &#x4E86;&#x89E3; &#x4E8B;&#x7269; &#x771F;&#x6B63; &#x542B;&#x4E49; &#x7684; &#x79D8;&#x5BC6; &#x53D6;&#x51B3;&#x4E8E; &#x5982;&#x4F55; &#x5C06; &#x5176; &#x4E0E; &#x6211;&#x4EEC; &#x6240; &#x4E86;&#x89E3; &#x7684; &#x4E8B;&#x7269; &#x76F8; &#x8054;&#x7CFB; &#x3002;&apos;</span>]

&#x6587;&#x672C;&#x7279;&#x5F81;&#x62BD;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#xFF1A;
 [[<span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.43643578</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.21821789</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.21821789</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.21821789</span> <span class="hljs-number">0.21821789</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.43643578</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.21821789</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.43643578</span>
  <span class="hljs-number">0.21821789</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.21821789</span> <span class="hljs-number">0.21821789</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.21821789</span> <span class="hljs-number">0.</span>        ]
 [<span class="hljs-number">0.2410822</span>  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.2410822</span>  <span class="hljs-number">0.2410822</span>
  <span class="hljs-number">0.2410822</span>  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.2410822</span>  <span class="hljs-number">0.55004769</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.2410822</span>  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.48216441</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.2410822</span>  <span class="hljs-number">0.</span>         <span class="hljs-number">0.2410822</span> ]
 [<span class="hljs-number">0.</span>         <span class="hljs-number">0.644003</span>   <span class="hljs-number">0.48300225</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>
  <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.12244522</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>
  <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.3220015</span>  <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>
  <span class="hljs-number">0.16100075</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>         <span class="hljs-number">0.</span>        ]]
&#x8FD4;&#x56DE;&#x7279;&#x5F81;&#x540D;&#x5B57;&#xFF1A;
 [<span class="hljs-string">&apos;&#x4E4B;&#x524D;&apos;</span>, <span class="hljs-string">&apos;&#x4E86;&#x89E3;&apos;</span>, <span class="hljs-string">&apos;&#x4E8B;&#x7269;&apos;</span>, <span class="hljs-string">&apos;&#x4ECA;&#x5929;&apos;</span>, <span class="hljs-string">&apos;&#x5149;&#x662F;&#x5728;&apos;</span>, <span class="hljs-string">&apos;&#x51E0;&#x767E;&#x4E07;&#x5E74;&apos;</span>, <span class="hljs-string">&apos;&#x53D1;&#x51FA;&apos;</span>, <span class="hljs-string">&apos;&#x53D6;&#x51B3;&#x4E8E;&apos;</span>, <span class="hljs-string">&apos;&#x53EA;&#x7528;&apos;</span>, <span class="hljs-string">&apos;&#x540E;&#x5929;&apos;</span>, <span class="hljs-string">&apos;&#x542B;&#x4E49;&apos;</span>, <span class="hljs-string">&apos;&#x5927;&#x90E8;&#x5206;&apos;</span>, <span class="hljs-string">&apos;&#x5982;&#x4F55;&apos;</span>, <span class="hljs-string">&apos;&#x5982;&#x679C;&apos;</span>, <span class="hljs-string">&apos;&#x5B87;&#x5B99;&apos;</span>, <span class="hljs-string">&apos;&#x6211;&#x4EEC;&apos;</span>, <span class="hljs-string">&apos;&#x6240;&#x4EE5;&apos;</span>, <span class="hljs-string">&apos;&#x653E;&#x5F03;&apos;</span>, <span class="hljs-string">&apos;&#x65B9;&#x5F0F;&apos;</span>, <span class="hljs-string">&apos;&#x660E;&#x5929;&apos;</span>, <span class="hljs-string">&apos;&#x661F;&#x7CFB;&apos;</span>, <span class="hljs-string">&apos;&#x665A;&#x4E0A;&apos;</span>, <span class="hljs-string">&apos;&#x67D0;&#x6837;&apos;</span>, <span class="hljs-string">&apos;&#x6B8B;&#x9177;&apos;</span>, <span class="hljs-string">&apos;&#x6BCF;&#x4E2A;&apos;</span>, <span class="hljs-string">&apos;&#x770B;&#x5230;&apos;</span>, <span class="hljs-string">&apos;&#x771F;&#x6B63;&apos;</span>, <span class="hljs-string">&apos;&#x79D8;&#x5BC6;&apos;</span>, <span class="hljs-string">&apos;&#x7EDD;&#x5BF9;&apos;</span>, <span class="hljs-string">&apos;&#x7F8E;&#x597D;&apos;</span>, <span class="hljs-string">&apos;&#x8054;&#x7CFB;&apos;</span>, <span class="hljs-string">&apos;&#x8FC7;&#x53BB;&apos;</span>, <span class="hljs-string">&apos;&#x8FD8;&#x662F;&apos;</span>, <span class="hljs-string">&apos;&#x8FD9;&#x6837;&apos;</span>]
</code></pre>
<h2 id="24-&#x7279;&#x5F81;&#x9884;&#x5904;&#x7406;">2.4 &#x7279;&#x5F81;&#x9884;&#x5904;&#x7406;</h2>
<p>&#xFF08;feature preprocessing&#xFF09;</p>
<p>&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x8F6C;&#x6362;&#x51FD;&#x6570;&#x5C06;&#x7279;&#x5F81;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x6210;&#x66F4;&#x52A0;&#x9002;&#x5408;&#x7B97;&#x6CD5;&#x6A21;&#x578B;&#x7684;&#x7279;&#x5F81;&#x6570;&#x636E;&#x8FC7;&#x7A0B;</p>
<p>&#x6570;&#x636E;&#x7684;&#x65E0;&#x91CF;&#x7EB2;&#x5904;&#x7406;&#xFF1A;<strong>&#x4F7F;&#x4E0D;&#x540C;&#x89C4;&#x683C;&#x7684;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x5230;&#x540C;&#x4E00;&#x89C4;&#x683C;</strong></p>
<ul>
<li>&#x5F52;&#x4E00;&#x5316;</li>
<li>&#x6807;&#x51C6;&#x5316;</li>
</ul>
<p>&#x7279;&#x5F81;&#x7684;&#x5355;&#x4F4D;&#x6216;&#x8005;&#x5927;&#x5C0F;&#x76F8;&#x5DEE;&#x8F83;&#x5927;&#xFF0C;&#x6216;&#x8005;&#x67D0;&#x7279;&#x5F81;&#x7684;&#x65B9;&#x5DEE;&#x76F8;&#x6BD4;&#x5176;&#x4ED6;&#x7684;&#x7279;&#x5F81;&#x8981;&#x5927;&#x51FA;&#x51E0;&#x4E2A;&#x6570;&#x91CF;&#x7EA7;<strong>&#xFF0C;</strong>&#x5BB9;&#x6613;&#x5F71;&#x54CD;&#xFF08;&#x652F;&#x914D;&#xFF09;&#x76EE;&#x6807;&#x7ED3;&#x679C;&#xFF0C;&#x4F7F;&#x5F97;&#x4E00;&#x4E9B;&#x7B97;&#x6CD5;&#x65E0;&#x6CD5;&#x5B66;&#x4E60;&#x5230;&#x5176;&#x5B83;&#x7684;&#x7279;&#x5F81;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x8FDB;&#x884C;&#x5F52;&#x4E00;&#x5316;/&#x6807;&#x51C6;&#x5316;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> sklearn.preprocessing
</code></pre>
<h3 id="241-&#x5F52;&#x4E00;&#x5316;">2.4.1 &#x5F52;&#x4E00;&#x5316;</h3>
<p>&#x901A;&#x8FC7;&#x5BF9;&#x539F;&#x59CB;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x53D8;&#x6362;&#x628A;&#x6570;&#x636E;&#x6620;&#x5C04;&#x5230;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;&#xFF09;[0,1] &#x4E4B;&#x95F4;</p>
<h4 id="1&#xFF09;&#x516C;&#x5F0F;">1&#xFF09;&#x516C;&#x5F0F;</h4>
<p>$$
X&apos;=\cfrac{x-min}{max-min}\
X&apos;&apos;=X&apos;*(mx-mi)+mi</p>
<p>$$</p>
<blockquote>
<p> &#x4F5C;&#x7528;&#x4E8E;&#x6BCF;&#x4E00;&#x5217;&#xFF0C;max &#x4E3A;&#x4E00;&#x5217;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF0C;min &#x4E3A;&#x4E00;&#x5217;&#x7684;&#x6700;&#x5C0F;&#x503C;&#xFF0C;X&#x2019;&#x2019;&#x4E3A;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#xFF0C;mx&#xFF0C;mi&#x5206;&#x522B;&#x4E3A;&#x6307;&#x5B9A;&#x533A;&#x95F4;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;mx&#x4E3A;1&#xFF0C;mi&#x4E3A;0</p>
</blockquote>
<h4 id="2&#xFF09;api">2&#xFF09;API</h4>
<p><strong><em>MinMaxScaler (feature_range=(0,1)&#x2026; )</em></strong></p>
<ul>
<li><em>MinMaxScalar.fit_transform(X)</em><ul>
<li>X&#xFF1A;numpy array&#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E; [n_samples,n_features]</li>
<li>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x8F6C;&#x6362;&#x540E;&#x7684;&#x5F62;&#x72B6;&#x76F8;&#x540C;&#x7684;array</li>
</ul>
</li>
</ul>
<h4 id="3&#xFF09;&#x4F8B;">3&#xFF09;&#x4F8B;</h4>
<p>&#x4EE5;&#x4E0B;&#x4E3A;&#x6570;&#x636E;&#x5B9E;&#x4F8B;</p>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/image-20210118192214857.png" alt="image-20210118192214857" style="zoom:80%;"></p>
<ul>
<li><p>&#x5B9E;&#x4F8B;&#x5316; MinMaxScalar</p>
</li>
<li><p>&#x901A;&#x8FC7; fit_transform &#x8F6C;&#x6362;</p>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> MinMaxScaler
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

path = <span class="hljs-string">&quot;../Data/Dating.txt&quot;</span>
data = pd.read_csv(path)

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = MinMaxScaler(feature_range=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) <span class="hljs-comment"># &#x9ED8;&#x8BA4; MIN=0, MAX=1</span>
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(data[[<span class="hljs-string">&apos;milage&apos;</span>,<span class="hljs-string">&apos;Liters&apos;</span>,<span class="hljs-string">&apos;Consumtime&apos;</span>]]) <span class="hljs-comment"># &#x9700;&#x8981;&#x4F20;numpy array&#x683C;&#x5F0F;, &#x8FD4;&#x56DE;array</span>

print(<span class="hljs-string">&quot;&#x6700;&#x5C0F;&#x503C;&#x6700;&#x5927;&#x503C;&#x5F52;&#x4E00;&#x5316;&#x5904;&#x7406;&#x7684;&#x7ED3;&#x679C;&#xFF1A;\n&quot;</span>, data)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x6700;&#x5C0F;&#x503C;&#x6700;&#x5927;&#x503C;&#x5F52;&#x4E00;&#x5316;&#x5904;&#x7406;&#x7684;&#x7ED3;&#x679C;&#xFF1A;
 [[<span class="hljs-number">0.43582641</span> <span class="hljs-number">0.58819286</span> <span class="hljs-number">0.53237967</span>]
 [<span class="hljs-number">0.</span>         <span class="hljs-number">0.48794044</span> <span class="hljs-number">1.</span>        ]
 [<span class="hljs-number">0.19067405</span> <span class="hljs-number">0.</span>         <span class="hljs-number">0.43571351</span>]
 [<span class="hljs-number">1.</span>         <span class="hljs-number">1.</span>         <span class="hljs-number">0.19139157</span>]
 [<span class="hljs-number">0.3933518</span>  <span class="hljs-number">0.01947089</span> <span class="hljs-number">0.</span>        ]]
</code></pre>
<p>&#x6CE8;&#x610F;&#x6700;&#x5927;&#x503C;&#x6700;&#x5C0F;&#x503C;&#x662F;&#x53D8;&#x5316;&#x7684;&#xFF0C;&#x53E6;&#x5916;&#xFF0C;&#x6700;&#x5927;&#x503C;&#x4E0E;&#x6700;&#x5C0F;&#x503C;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x53D7;&#x5F02;&#x5E38;&#x70B9;&#x5F71;&#x54CD;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x9C81;&#x68D2;&#x6027;&#x8F83;&#x5DEE;&#xFF0C;&#x53EA;&#x9002;&#x5408;&#x4F20;&#x7EDF;&#x7CBE;&#x786E;&#x5C0F;&#x6570;&#x636E;&#x573A;&#x666F;</p>
<h3 id="242-&#x6807;&#x51C6;&#x5316;">2.4.2 &#x6807;&#x51C6;&#x5316;</h3>
<p>&#x901A;&#x8FC7;&#x5BF9;&#x539F;&#x59CB;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x53D8;&#x6362;&#x628A;&#x6570;&#x636E;&#x53D8;&#x6362;&#x5230;&#x5747;&#x503C;&#x4E3A;0&#xFF0C;&#x6807;&#x51C6;&#x5DEE;&#x4E3A;1&#x7684;&#x8303;&#x56F4;&#x5185;</p>
<p>&#x4F18;&#x52BF;</p>
<ul>
<li>&#x5BF9;&#x4E8E;&#x5F52;&#x4E00;&#x5316;&#x6765;&#x8BF4;&#xFF1A;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x70B9;&#xFF0C;&#x5F71;&#x54CD;&#x4E86;&#x6700;&#x5927;&#x503C;&#x548C;&#x6700;&#x5C0F;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x7ED3;&#x679C;&#x663E;&#x7136;&#x4F1A;&#x53D1;&#x751F;&#x6539;&#x53D8;</li>
<li>&#x5BF9;&#x4E8E;&#x6807;&#x51C6;&#x5316;&#x6765;&#x8BF4;&#xFF1A;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x70B9;&#xFF0C;&#x7531;&#x4E8E;&#x5177;&#x6709;&#x4E00;&#x5B9A;&#x6570;&#x636E;&#x91CF;&#xFF0C;&#x5C11;&#x91CF;&#x7684;&#x5F02;&#x5E38;&#x70B9;&#x5BF9;&#x4E8E;&#x5E73;&#x5747;&#x503C;&#x7684;&#x5F71;&#x54CD;&#x5E76;&#x4E0D;&#x5927;&#xFF0C;&#x4ECE;&#x800C;&#x65B9;&#x5DEE;&#x6539;&#x53D8;&#x8F83;&#x5C0F;</li>
</ul>
<h4 id="1&#xFF09;&#x516C;&#x5F0F;">1&#xFF09;&#x516C;&#x5F0F;</h4>
<p>$$
X&apos;=\cfrac{x-mean}{\sigma}</p>
<p>$$</p>
<blockquote>
<p>&#x4F5C;&#x7528;&#x4E8E;&#x6BCF;&#x4E00;&#x5217;&#xFF0C;mean &#x4E3A;&#x5E73;&#x5747;&#x503C;&#xFF0C;&#x3C3; &#x4E3A;&#x6807;&#x51C6;&#x5DEE;</p>
</blockquote>
<h4 id="2&#xFF09;api">2&#xFF09;API</h4>
<p><strong><em>StandardScaler( )</em></strong></p>
<ul>
<li><em>StandardScaler.fit_transform(X)</em><ul>
<li>X&#xFF1A;numpy array &#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E;[n_samples, n_features]</li>
<li>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x8F6C;&#x6362;&#x540E;&#x7684;&#x5F62;&#x72B6;&#x76F8;&#x540C;&#x7684;array</li>
</ul>
</li>
<li><em>StandardScaler.mean_</em><ul>
<li>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x6BCF;&#x4E00;&#x5217;&#x7279;&#x5F81;&#x7684;&#x5E73;&#x5747;&#x503C;</li>
</ul>
</li>
<li><em>StandardScaler.var_</em><ul>
<li>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x6BCF;&#x4E00;&#x5217;&#x7279;&#x5F81;&#x7684;&#x65B9;&#x5DEE;</li>
</ul>
</li>
</ul>
<h4 id="3&#xFF09;&#x4F8B;">3&#xFF09;&#x4F8B;</h4>
<p>&#x540C;&#x6837;&#x5BF9; 2.4.1 &#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5904;&#x7406;</p>
<ul>
<li><p>&#x5B9E;&#x4F8B;&#x5316; StandardScaler</p>
</li>
<li><p>&#x901A;&#x8FC7;fit_transform&#x8F6C;&#x6362;</p>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler

data = pd.read_csv(path)

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = StandardScaler() <span class="hljs-comment"># &#x503C;&#x90FD;&#x5728;0&#x9644;&#x8FD1;,&#x6240;&#x4EE5;&#x6709;&#x8D1F;&#x6570;&#x662F;&#x6B63;&#x5E38;&#x7684;</span>
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(data[[<span class="hljs-string">&apos;milage&apos;</span>,<span class="hljs-string">&apos;Liters&apos;</span>,<span class="hljs-string">&apos;Consumtime&apos;</span>]]) 

print(<span class="hljs-string">&quot;&#x6807;&#x51C6;&#x5316;&#x7684;&#x7ED3;&#x679C;:\n&quot;</span>, data)
print(<span class="hljs-string">&quot;&#x6BCF;&#x4E00;&#x5217;&#x7279;&#x5F81;&#x7684;&#x5E73;&#x5747;&#x503C;&#xFF1A;\n&quot;</span>, transfer.mean_)
print(<span class="hljs-string">&quot;&#x6BCF;&#x4E00;&#x5217;&#x7279;&#x5F81;&#x7684;&#x65B9;&#x5DEE;&#xFF1A;\n&quot;</span>, transfer.var_)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x6807;&#x51C6;&#x5316;&#x7684;&#x7ED3;&#x679C;:
[[ <span class="hljs-number">0.0947602</span>   <span class="hljs-number">0.44990013</span>  <span class="hljs-number">0.29573441</span>]
 [<span class="hljs-number">-1.20166916</span>  <span class="hljs-number">0.18312874</span>  <span class="hljs-number">1.67200507</span>]
 [<span class="hljs-number">-0.63448132</span> <span class="hljs-number">-1.11527928</span>  <span class="hljs-number">0.01123265</span>]
 [ <span class="hljs-number">1.77297701</span>  <span class="hljs-number">1.54571769</span> <span class="hljs-number">-0.70784025</span>]
 [<span class="hljs-number">-0.03158673</span> <span class="hljs-number">-1.06346729</span> <span class="hljs-number">-1.27113187</span>]]
&#x6BCF;&#x4E00;&#x5217;&#x7279;&#x5F81;&#x7684;&#x5E73;&#x5747;&#x503C;&#xFF1A;
 [<span class="hljs-number">3.8988000e+04</span> <span class="hljs-number">6.3478996e+00</span> <span class="hljs-number">7.9924800e-01</span>]
&#x6BCF;&#x4E00;&#x5217;&#x7279;&#x5F81;&#x7684;&#x65B9;&#x5DEE;&#xFF1A;
 [<span class="hljs-number">4.15683072e+08</span> <span class="hljs-number">1.93505309e+01</span> <span class="hljs-number">2.73652475e-01</span>]
</code></pre>
<h2 id="25-&#x7279;&#x5F81;&#x964D;&#x7EF4;">2.5 &#x7279;&#x5F81;&#x964D;&#x7EF4;</h2>
<p>&#xFF08;Feature Dimension Reduce&#xFF09;</p>
<p>&#x964D;&#x7EF4;&#x662F;&#x6307;&#x5728;&#x67D0;&#x4E9B;&#x9650;&#x5B9A;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C;&#x964D;&#x4F4E;&#x968F;&#x673A;&#x53D8;&#x91CF;&#xFF08;&#x7279;&#x5F81;&#xFF09;&#x4E2A;&#x6570;&#xFF0C;&#x5F97;&#x5230;&#x4E00;&#x7EC4;&#x201C;&#x4E0D;&#x76F8;&#x5173;&#x201D;&#x4E3B;&#x53D8;&#x91CF;&#x7684;&#x8FC7;&#x7A0B;</p>
<p>&#x4E24;&#x79CD;&#x65B9;&#x5F0F;</p>
<ul>
<li>&#x7279;&#x5F81;&#x9009;&#x62E9;</li>
<li>&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;&#xFF08;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E00;&#x79CD;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7684;&#x65B9;&#x5F0F;&#xFF09;</li>
</ul>
<h3 id="251-&#x7279;&#x5F81;&#x9009;&#x62E9;">2.5.1 &#x7279;&#x5F81;&#x9009;&#x62E9;</h3>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> sklearn.feature_selection
</code></pre>
<p>&#x6570;&#x636E;&#x4E2D;&#x5305;&#x542B;&#x5197;&#x4F59;&#x6216;&#x65E0;&#x5173;&#x53D8;&#x91CF;&#xFF08;&#x6216;&#x79F0;&#x7279;&#x5F81;&#x3001;&#x5C5E;&#x6027;&#x3001;&#x6307;&#x6807;&#x7B49;&#xFF09;&#xFF0C;&#x65E8;&#x5728;&#x4ECE;&#x539F;&#x6709;&#x7279;&#x5F81;&#x4E2D;&#x627E;&#x51FA;&#x4E3B;&#x8981;&#x7279;&#x5F81;</p>
<p>&#x65B9;&#x6CD5;</p>
<ul>
<li>&#x8FC7;&#x6EE4;&#x5F0F;&#xFF08;Filter&#xFF09;&#xFF1A;&#x4E3B;&#x8981;&#x63A2;&#x7A76;&#x7279;&#x5F81;&#x672C;&#x8EAB;&#x7279;&#x70B9;&#x3001;&#x7279;&#x5F81;&#x4E0E;&#x7279;&#x5F81;&#x548C;&#x76EE;&#x6807;&#x503C;&#x4E4B;&#x95F4;&#x5173;&#x8054;<ul>
<li>&#x65B9;&#x5DEE;&#x9009;&#x62E9;&#x6CD5;&#xFF1A;&#x4F4E;&#x65B9;&#x5DEE;&#x7279;&#x5F81;&#x8FC7;&#x6EE4;</li>
<li>&#x76F8;&#x5173;&#x7CFB;&#x6570;</li>
</ul>
</li>
<li>&#x5D4C;&#x5165;&#x5F0F;&#xFF08;Embedded&#xFF09;&#xFF1A;&#x7B97;&#x6CD5;&#x81EA;&#x52A8;&#x9009;&#x62E9;&#x7279;&#x5F81;&#xFF08;&#x7279;&#x5F81;&#x4E0E;&#x76EE;&#x6807;&#x503C;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#xFF09;<ul>
<li>&#x51B3;&#x7B56;&#x6811;&#xFF1A;&#x4FE1;&#x606F;&#x71B5;&#x3001;&#x4FE1;&#x606F;&#x589E;&#x76CA;</li>
<li>&#x6B63;&#x5219;&#x5316;&#xFF1A;L1&#x3001;L2</li>
<li>&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#xFF1A;&#x5377;&#x79EF;&#x7B49;</li>
</ul>
</li>
</ul>
<h4 id="1&#xFF09;&#x4F4E;&#x65B9;&#x5DEE;&#x7279;&#x5F81;&#x8FC7;&#x6EE4;">1&#xFF09;&#x4F4E;&#x65B9;&#x5DEE;&#x7279;&#x5F81;&#x8FC7;&#x6EE4;</h4>
<p>&#x5220;&#x9664;&#x4F4E;&#x65B9;&#x5DEE;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x5F81;</p>
<h5 id="api">API</h5>
<p><strong><em>VarianceThreshold(threshold = 0.0)</em></strong></p>
<ul>
<li><em>Variance.fit_transform(X)</em><ul>
<li>X&#xFF1A;numpy array &#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E; [n_samples, n_features]</li>
<li>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x8BAD;&#x7EC3;&#x96C6;&#x5DEE;&#x5F02;&#x4F4E;&#x4E8E; threshold &#x7684;&#x7279;&#x5F81;&#x5C06;&#x88AB;&#x5220;&#x9664;&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x662F;&#x4FDD;&#x7559;&#x6240;&#x6709;&#x975E;&#x96F6;&#x65B9;&#x5DEE;&#x7279;&#x5F81;&#xFF0C;&#x5373;&#x5220;&#x9664;&#x6240;&#x6709;&#x6837;&#x672C;&#x4E2D;&#x5177;&#x6709;&#x76F8;&#x540C;&#x503C;&#x7684;&#x7279;&#x5F81;&#x3002;</li>
</ul>
</li>
</ul>
<h5 id="&#x4F8B;">&#x4F8B;</h5>
<p>&#x5904;&#x7406;&#x4EE5;&#x4E0B;&#x4F8B;&#x5B50;</p>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/image-20210118192214857.png" alt="image-20210118192214857" style="zoom:80%;"></p>
<p>&#x5206;&#x6790;</p>
<ul>
<li><p>&#x521D;&#x59CB;&#x5316; VarianceThreshold &#xFF0C;&#x6307;&#x5B9A;&#x9600;&#x503C;&#x65B9;&#x5DEE;</p>
</li>
<li><p>&#x8C03;&#x7528; fit_transform</p>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.feature_selection <span class="hljs-keyword">import</span> VarianceThreshold
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

path=<span class="hljs-string">&quot;../Data/Dating.txt&quot;</span>
data = pd.read_csv(path)

<span class="hljs-comment"># 1&#x3001;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;</span>
transfer = VarianceThreshold(threshold=<span class="hljs-number">1</span>)
<span class="hljs-comment"># 2&#x3001;&#x8C03;&#x7528;fit_transform</span>
data = transfer.fit_transform(data.iloc[:, <span class="hljs-number">0</span>:<span class="hljs-number">-1</span>])

print(<span class="hljs-string">&quot;&#x5220;&#x9664;&#x4F4E;&#x65B9;&#x5DEE;&#x7279;&#x5F81;&#x7684;&#x7ED3;&#x679C;&#xFF1A;\n&quot;</span>, data)
print(<span class="hljs-string">&quot;&#x5F62;&#x72B6;&#xFF1A;\n&quot;</span>, data.shape)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x5220;&#x9664;&#x4F4E;&#x65B9;&#x5DEE;&#x7279;&#x5F81;&#x7684;&#x7ED3;&#x679C;&#xFF1A;
 [[<span class="hljs-number">4.0920000e+04</span> <span class="hljs-number">8.3269760e+00</span>]
 [<span class="hljs-number">1.4488000e+04</span> <span class="hljs-number">7.1534690e+00</span>]
 [<span class="hljs-number">2.6052000e+04</span> <span class="hljs-number">1.4418710e+00</span>]
 [<span class="hljs-number">7.5136000e+04</span> <span class="hljs-number">1.3147394e+01</span>]
 [<span class="hljs-number">3.8344000e+04</span> <span class="hljs-number">1.6697880e+00</span>]]
&#x5F62;&#x72B6;&#xFF1A;
 (<span class="hljs-number">5</span>, <span class="hljs-number">2</span>)
</code></pre>
<h4 id="2&#xFF09;&#x76F8;&#x5173;&#x7CFB;&#x6570;">2&#xFF09;&#x76F8;&#x5173;&#x7CFB;&#x6570;</h4>
<p>&#x53BB;&#x9664;&#x76F8;&#x5173;&#x7279;&#x5F81;&#xFF08;correlated feature&#xFF09;&#x7684;&#x5F71;&#x54CD;</p>
<p>&#x4F7F;&#x7528; Scipy &#x5B9E;&#x73B0;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> pearsonr
</code></pre>
<h5 id="&#x539F;&#x7406;">&#x539F;&#x7406;</h5>
<p>&#x76AE;&#x5C14;&#x900A;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#xFF08;Pearson Correlation Coefficient&#xFF09;&#xFF1A;&#x53CD;&#x6620;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x76F8;&#x5173;&#x5173;&#x7CFB;&#x5BC6;&#x5207;&#x7A0B;&#x5EA6;&#x7684;&#x7EDF;&#x8BA1;&#x6307;&#x6807;</p>
<p>$$
r=\cfrac{n\sum xy=\sum x\sum y}{\sqrt{n\sum x^2 -(\sum x)^2}\sqrt{n\sum y^2-(\sum y)^2}}</p>
<p>$$
&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x7684;&#x503C;&#x4ECB;&#x4E8E;&#x2013;1&#x4E0E;+1&#x4E4B;&#x95F4;&#xFF0C;&#x5373;&#x2013;1&#x2264; r &#x2264;+1&#x3002;&#x5176;&#x6027;&#x8D28;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x5F53;r &gt; 0&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x4E24;&#x53D8;&#x91CF;&#x6B63;&#x76F8;&#x5173;&#xFF0C;r &lt; 0&#x65F6;&#xFF0C;&#x4E24;&#x53D8;&#x91CF;&#x4E3A;&#x8D1F;&#x76F8;&#x5173;</li>
<li>&#x5F53;|r|=1&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x4E24;&#x53D8;&#x91CF;&#x4E3A;&#x5B8C;&#x5168;&#x76F8;&#x5173;&#xFF0C;&#x5F53; r=0 &#x65F6;&#xFF0C;&#x8868;&#x793A;&#x4E24;&#x53D8;&#x91CF;&#x95F4;&#x65E0;&#x76F8;&#x5173;&#x5173;&#x7CFB;</li>
<li>&#x5F53;0&lt;|r|&lt;1&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x4E24;&#x53D8;&#x91CF;&#x5B58;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x7684;&#x76F8;&#x5173;&#x3002;&#x4E14;|r|&#x8D8A;&#x63A5;&#x8FD1;1&#xFF0C;&#x4E24;&#x53D8;&#x91CF;&#x95F4;&#x7EBF;&#x6027;&#x5173;&#x7CFB;&#x8D8A;&#x5BC6;&#x5207;&#xFF1B;|r|&#x8D8A;&#x63A5;&#x8FD1;&#x4E8E;0&#xFF0C;&#x8868;&#x793A;&#x4E24;&#x53D8;&#x91CF;&#x7684;&#x7EBF;&#x6027;&#x76F8;&#x5173;&#x8D8A;&#x5F31;</li>
<li>&#x4E00;&#x822C;&#x53EF;&#x6309;&#x4E09;&#x7EA7;&#x5212;&#x5206;&#xFF1A;|r|&lt;0.4&#x4E3A;&#x4F4E;&#x5EA6;&#x76F8;&#x5173;&#xFF1B;0.4&#x2264;|r|&lt;0.7&#x4E3A;&#x663E;&#x8457;&#x6027;&#x76F8;&#x5173;&#xFF1B;0.7&#x2264;|r|&lt;1&#x4E3A;&#x9AD8;&#x5EA6;&#x7EBF;&#x6027;&#x76F8;&#x5173;</li>
</ul>
<h5 id="api">API</h5>
<p><strong><em>pearsonr(X, Y)</em></strong></p>
<ul>
<li>X&#xFF1A;numpy array &#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E;</li>
<li>Y&#xFF1A;numpy array &#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E;</li>
<li>&#x8FD4;&#x56DE;&#x503C;<ul>
<li>r&#xFF1A;&#x76F8;&#x5173;&#x7CFB;&#x6570; [-1&#xFF0C;1] &#x4E4B;&#x95F4;</li>
<li>p-value&#xFF1A;p&#x503C;&#xFF08;p&#x503C;&#x8D8A;&#x5C0F;&#xFF0C;&#x8868;&#x793A;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x8D8A;&#x663E;&#x8457;&#xFF0C;&#x4E00;&#x822C;p&#x503C;&#x5728;500&#x4E2A;&#x6837;&#x672C;&#x4EE5;&#x4E0A;&#x65F6;&#x6709;&#x8F83;&#x9AD8;&#x7684;&#x53EF;&#x9760;&#x6027;&#xFF09;</li>
</ul>
</li>
</ul>
<p>&#x5982;&#x679C;&#x76F8;&#x5173;&#x6027;&#x9AD8;&#x53EF;&#x7528;&#x4EE5;&#x4E0B;&#x65B9;&#x6CD5;:</p>
<ol>
<li><p>&#x9009;&#x53D6;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x7279;&#x5F81;</p>
</li>
<li><p>&#x4E24;&#x4E2A;&#x7279;&#x5F81;&#x52A0;&#x6743;&#x6C42;&#x548C;</p>
</li>
<li><p>&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;&#xFF08;&#x9AD8;&#x7EF4;&#x6570;&#x636E;&#x53D8;&#x4F4E;&#x7EF4;&#xFF0C;&#x820D;&#x5F03;&#x539F;&#x7531;&#x6570;&#x636E;&#xFF0C;&#x521B;&#x9020;&#x65B0;&#x6570;&#x636E;&#xFF0C;&#x5982;&#xFF1A;&#x538B;&#x7F29;&#x6570;&#x636E;&#x7EF4;&#x6570;&#xFF0C;&#x964D;&#x4F4E;&#x539F;&#x6570;&#x636E;&#x590D;&#x6742;&#x5EA6;&#xFF0C;&#x635F;&#x5931;&#x5C11;&#x4E86;&#x4FE1;&#x606F;&#xFF09;</p>
</li>
</ol>
<h5 id="&#x4F8B;">&#x4F8B;</h5>
<p>&#x4E24;&#x4E24;&#x7279;&#x5F81;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x76F8;&#x5173;&#x6027;&#x8BA1;&#x7B97;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> pearsonr
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

path=<span class="hljs-string">&quot;../Data/Dating.txt&quot;</span>
data = pd.read_csv(path)

<span class="hljs-comment"># &#x76AE;&#x5C14;&#x900A;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x8303;&#x56F4;[-1,1], &#x5982;&#x679C;&#x5927;&#x4E8E;0&#x5C31;&#x662F;&#x6B63;&#x76F8;&#x5173;(&#x8D8A;&#x63A5;&#x8FD1;1&#x5C31;&#x8D8A;&#x76F8;&#x5173;), &#x53CD;&#x4E4B;&#x4EA6;&#x7136;</span>
r = pearsonr(data[<span class="hljs-string">&quot;milage&quot;</span>], data[<span class="hljs-string">&quot;Liters&quot;</span>])
print(<span class="hljs-string">&quot;milage&#x548C;Liters&#x7684;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x4E3A;:\n&quot;</span>, r)

r = pearsonr(data[<span class="hljs-string">&quot;milage&quot;</span>], data[<span class="hljs-string">&quot;Consumtime&quot;</span>])
print(<span class="hljs-string">&quot;milage&#x548C;Liters&#x7684;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x4E3A;:\n&quot;</span>, r)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">milage&#x548C;Liters&#x7684;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x4E3A;:
(<span class="hljs-number">0.660861943290103</span>, <span class="hljs-number">0.2246299034335304</span>)
milage&#x548C;Liters&#x7684;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x4E3A;:
(<span class="hljs-number">-0.6406267138718624</span>, <span class="hljs-number">0.2441916485876286</span>)
</code></pre>
<h3 id="252-&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;">2.5.2 &#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;</h3>
<p>&#xFF08;PCA&#xFF09;&#x5C06;&#x6570;&#x636E;&#x5206;&#x89E3;&#x4E3A;&#x8F83;&#x4F4E;&#x7EF4;&#x6570;&#x7A7A;&#x95F4;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA
</code></pre>
<h4 id="1&#xFF09;&#x6982;&#x5FF5;">1&#xFF09;&#x6982;&#x5FF5;</h4>
<ul>
<li>&#x5B9A;&#x4E49;&#xFF1A;&#x9AD8;&#x7EF4;&#x6570;&#x636E;&#x8F6C;&#x5316;&#x4E3A;&#x4F4E;&#x7EF4;&#x6570;&#x636E;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x5728;&#x6B64;&#x8FC7;&#x7A0B;&#x4E2D;&#x53EF;&#x80FD;&#x4F1A;&#x820D;&#x5F03;&#x539F;&#x6709;&#x6570;&#x636E;&#x3001;&#x521B;&#x9020;&#x65B0;&#x7684;&#x53D8;&#x91CF;</li>
<li>&#x4F5C;&#x7528;&#xFF1A;&#x662F;&#x6570;&#x636E;&#x7EF4;&#x6570;&#x538B;&#x7F29;&#xFF0C;&#x5C3D;&#x53EF;&#x80FD;&#x964D;&#x4F4E;&#x539F;&#x6570;&#x636E;&#x7684;&#x7EF4;&#x6570;&#xFF08;&#x590D;&#x6742;&#x5EA6;&#xFF09;&#xFF0C;&#x635F;&#x5931;&#x5C11;&#x91CF;&#x4FE1;&#x606F;</li>
<li>&#x5E94;&#x7528;&#xFF1A;&#x56DE;&#x5F52;&#x5206;&#x6790;&#x6216;&#x8005;&#x805A;&#x7C7B;&#x5206;&#x6790;&#x5F53;&#x4E2D;</li>
</ul>
<h4 id="2&#xFF09;api">2&#xFF09;API</h4>
<p><strong><em>PCA(n_components=None)</em></strong></p>
<ul>
<li><p>&#x53C2;&#x6570;&#xFF1A;<em>n_components</em></p>
<ul>
<li>&#x5C0F;&#x6570;&#xFF1A;&#x8868;&#x793A;&#x4FDD;&#x7559;&#x767E;&#x5206;&#x4E4B;&#x591A;&#x5C11;&#x7684;&#x4FE1;&#x606F;</li>
<li>&#x6574;&#x6570;&#xFF1A;&#x51CF;&#x5C11;&#x5230;&#x591A;&#x5C11;&#x7279;&#x5F81;</li>
</ul>
</li>
<li><p><em>PCA.fit_transform(X)</em></p>
<ul>
<li>X&#xFF1A;numpy array &#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E; [n_samples,n_features]</li>
<li>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x8F6C;&#x6362;&#x540E;&#x6307;&#x5B9A;&#x7EF4;&#x5EA6;&#x7684; array</li>
</ul>
</li>
</ul>
<h4 id="3&#xFF09;&#x4F8B;">3&#xFF09;&#x4F8B;</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA

data = [[<span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]]  <span class="hljs-comment"># 3*4&#x77E9;&#x9635; &#x5305;&#x542B;&#x56DB;&#x4E2A;&#x7279;&#x5F81;</span>

transfer = PCA(n_components=<span class="hljs-number">3</span>) <span class="hljs-comment"># &#x4E3A;&#x6574;&#x6570;&#x5C31;&#x662F;&#x8F6C;&#x4E3A;&#x591A;&#x5C11;&#x4E2A;&#x7279;&#x5F81;  &#x4FDD;&#x7559;&#x7684;&#x81F3;&#x5C11;&#x90FD;&#x6BD4;&#x539F;&#x7279;&#x5F81;&#x503C;&#x5C11;&#x4E00;&#x4E2A;</span>
data_new = transfer.fit_transform(data)
print(<span class="hljs-string">&quot;(&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;)PCA&#x964D;&#x7EF4;:\n&quot;</span>, data_new)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">(&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;)PCA&#x964D;&#x7EF4;:
[[<span class="hljs-number">-3.57495904e+00</span> <span class="hljs-number">-6.64748145e-01</span>  <span class="hljs-number">1.07947657e-16</span>]
 [<span class="hljs-number">-3.17447323e+00</span>  <span class="hljs-number">6.91574499e-01</span>  <span class="hljs-number">1.07947657e-16</span>]
 [ <span class="hljs-number">6.74943227e+00</span> <span class="hljs-number">-2.68263539e-02</span>  <span class="hljs-number">1.07947657e-16</span>]]
</code></pre>
<p>&#x82E5; n_components &#x8BBE;&#x4E3A;0.95</p>
<pre><code class="lang-python">(&#x4E3B;&#x6210;&#x5206;&#x5206;&#x6790;)PCA&#x964D;&#x7EF4;:
[[<span class="hljs-number">-3.57495904</span>]
 [<span class="hljs-number">-3.17447323</span>]
 [ <span class="hljs-number">6.74943227</span>]]
</code></pre>
<h1 id="&#x4E09;&#x3001;&#x8F6C;&#x6362;&#x5668;&#x548C;&#x4F30;&#x8BA1;&#x5668;">&#x4E09;&#x3001;&#x8F6C;&#x6362;&#x5668;&#x548C;&#x4F30;&#x8BA1;&#x5668;</h1>
<h2 id="31-&#x8F6C;&#x6362;&#x5668;">3.1 &#x8F6C;&#x6362;&#x5668;</h2>
<p>&#xFF08;transformer&#xFF09;</p>
<p>&#x7279;&#x5F81;&#x5DE5;&#x7A0B;&#x7684;&#x63A5;&#x53E3;&#x79F0;&#x4E4B;&#x4E3A;&#x8F6C;&#x6362;&#x5668;&#xFF1B;&#x8F6C;&#x6362;&#x5668;&#x662F;&#x7279;&#x5F81;&#x5DE5;&#x7A0B;&#x7684;&#x7236;&#x7C7B;</p>
<p>&#x8C03;&#x7528;&#x6B65;&#x9AA4;</p>
<ol>
<li><p>&#x5B9E;&#x4F8B;&#x5316; (&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#x7C7B;(Transformer))</p>
</li>
<li><p>&#x8C03;&#x7528;fit_transform(&#x5BF9;&#x4E8E;&#x6587;&#x6863;&#x5EFA;&#x7ACB;&#x5206;&#x7C7B;&#x8BCD;&#x9891;&#x77E9;&#x9635;&#xFF0C;&#x4E0D;&#x80FD;&#x540C;&#x65F6;&#x8C03;&#x7528;)</p>
</li>
</ol>
<p>&#x8F6C;&#x6362;&#x5668;&#x8C03;&#x7528;&#x5F62;&#x5F0F;</p>
<ul>
<li>fit_transform()</li>
<li>fit()<ul>
<li>&#x6309;&#x516C;&#x5F0F;&#x8BA1;&#x7B97;</li>
</ul>
</li>
<li>transform()<ul>
<li>&#x8FDB;&#x884C;&#x6700;&#x7EC8;&#x7684;&#x8F6C;&#x6362;</li>
</ul>
</li>
</ul>
<h2 id="32-&#x4F30;&#x8BA1;&#x5668;">3.2 &#x4F30;&#x8BA1;&#x5668;</h2>
<p>&#xFF08;estimator&#xFF09;</p>
<p>&#x4F30;&#x8BA1;&#x5668;&#x5B9E;&#x73B0;&#x4E86;&#x7B97;&#x6CD5;&#x7684;API&#xFF0C;&#x4F30;&#x8BA1;&#x5668;&#x662F;&#x7B97;&#x6CD5;&#x7684;&#x7236;&#x7C7B;</p>
<ul>
<li>&#x7528;&#x4E8E;&#x5206;&#x7C7B;&#x7684;&#x4F30;&#x8BA1;&#x5668;&#xFF1A;<ul>
<li>sklearn.neighbors k-&#x8FD1;&#x90BB;&#x7B97;&#x6CD5;</li>
<li>sklearn.naive_bayes &#x8D1D;&#x53F6;&#x65AF;</li>
<li>sklearn.linear_model.LogisticRegression &#x903B;&#x8F91;&#x56DE;&#x5F52;</li>
<li>sklearn.tree &#x51B3;&#x7B56;&#x6811;&#x4E0E;&#x968F;&#x673A;&#x68EE;&#x6797;</li>
</ul>
</li>
<li>&#x7528;&#x4E8E;&#x56DE;&#x5F52;&#x7684;&#x4F30;&#x8BA1;&#x5668;&#xFF1A;<ul>
<li>sklearn.linear_model.LinearRegression &#x7EBF;&#x6027;&#x56DE;&#x5F52;</li>
<li>sklearn.linear_model.Ridge &#x5CAD;&#x56DE;&#x5F52;</li>
</ul>
</li>
<li>&#x7528;&#x4E8E;&#x65E0;&#x76D1;&#x7763;&#x5B66;&#x4E60;&#x7684;&#x4F30;&#x8BA1;&#x5668;<ul>
<li>sklearn.cluster.KMeans &#x805A;&#x7C7B;</li>
</ul>
</li>
</ul>
<p>&#x8C03;&#x7528;&#x6B65;&#x9AA4;</p>
<ol>
<li><p>&#x5B9E;&#x4F8B;&#x5316;&#x4F30;&#x8BA1;&#x5668;&#x7C7B;estimator</p>
</li>
<li><p>&#x8FDB;&#x884C;&#x8BAD;&#x7EC3;&#xFF0C;&#x4E00;&#x65E6;&#x8C03;&#x7528;&#x5B8C;&#x6BD5;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x6A21;&#x578B;&#x751F;&#x6210;</p>
<ul>
<li><em>estimator.fit(x_train, y_train)</em></li>
</ul>
</li>
<li><p>&#x6A21;&#x578B;&#x8BC4;&#x4F30;</p>
<ul>
<li><p>&#x76F4;&#x63A5;&#x6BD4;&#x5BF9;&#x771F;&#x5B9E;&#x503C;&#x548C;&#x9884;&#x6D4B;&#x503C;</p>
<p><em>y_predict = estimator.predict(x_test)</em></p>
<p><em>y_test == y_predict</em></p>
</li>
<li><p>&#x8BA1;&#x7B97;&#x51C6;&#x786E;&#x7387;</p>
<p><em>accuracy = estimator.score(x_test, y_test)</em></p>
</li>
</ul>
</li>
</ol>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/&#x4F30;&#x8BA1;&#x5668;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;.png" alt="&#x4F30;&#x8BA1;&#x5668;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;" style="zoom:67%;"></p>
<h2 id="33-&#x6A21;&#x578B;&#x9009;&#x62E9;&#x4E0E;&#x8C03;&#x4F18;">3.3 &#x6A21;&#x578B;&#x9009;&#x62E9;&#x4E0E;&#x8C03;&#x4F18;</h2>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV
</code></pre>
<h3 id="331-&#x6982;&#x5FF5;">3.3.1 &#x6982;&#x5FF5;</h3>
<h4 id="1&#xFF09;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;">1&#xFF09;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;</h4>
<p>&#xFF08;cross validation&#xFF09;</p>
<p>&#x5C06;&#x62FF;&#x5230;&#x7684;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#xFF0C;&#x5206;&#x4E3A;&#x8BAD;&#x7EC3;&#x548C;&#x9A8C;&#x8BC1;&#x96C6;</p>
<h4 id="2&#xFF09;&#x8D85;&#x53C2;&#x6570;&#x641C;&#x7D22;-&#x7F51;&#x683C;&#x641C;&#x7D22;">2&#xFF09;&#x8D85;&#x53C2;&#x6570;&#x641C;&#x7D22;-&#x7F51;&#x683C;&#x641C;&#x7D22;</h4>
<p>&#xFF08;Grid Search&#xFF09;</p>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6709;&#x5F88;&#x591A;&#x53C2;&#x6570;&#x662F;&#x9700;&#x8981;&#x624B;&#x52A8;&#x6307;&#x5B9A;&#x7684;&#xFF08;&#x5982;k-&#x8FD1;&#x90BB;&#x7B97;&#x6CD5;&#x4E2D;&#x7684;K&#x503C;&#xFF09;&#xFF0C;&#x8FD9;&#x79CD;&#x53EB;&#x8D85;&#x53C2;&#x6570;&#x3002;&#x4F46;&#x662F;&#x624B;&#x52A8;&#x8FC7;&#x7A0B;&#x7E41;&#x6742;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5BF9;&#x6A21;&#x578B;&#x9884;&#x8BBE;&#x51E0;&#x79CD;&#x8D85;&#x53C2;&#x6570;&#x7EC4;&#x5408;&#x3002;&#x6BCF;&#x7EC4;&#x8D85;&#x53C2;&#x6570;&#x90FD;&#x91C7;&#x7528;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x6765;&#x8FDB;&#x884C;&#x8BC4;&#x4F30;&#x3002;&#x6700;&#x540E;&#x9009;&#x51FA;&#x6700;&#x4F18;&#x53C2;&#x6570;&#x7EC4;&#x5408;&#x5EFA;&#x7ACB;&#x6A21;&#x578B;&#x3002;</p>
<h3 id="332-api">3.3.2 API</h3>
<p><strong><em>GridSearchCV(estimator, param_grid=None,cv=None)</em></strong></p>
<p>&#x5BF9;&#x4F30;&#x8BA1;&#x5668;&#x7684;&#x6307;&#x5B9A;&#x53C2;&#x6570;&#x503C;&#x8FDB;&#x884C;&#x8BE6;&#x5C3D;&#x641C;&#x7D22;</p>
<ul>
<li>&#x53C2;&#x6570;<ul>
<li><em>estimator</em>&#xFF1A;&#x4F30;&#x8BA1;&#x5668;&#x5BF9;&#x8C61;</li>
<li><em>param_grid</em>&#xFF1A;&#x4F30;&#x8BA1;&#x5668;&#x53C2;&#x6570; <code>(dict){&#x201C;n_neighbors&#x201D;:[1,3,5]}</code></li>
<li><em>cv</em>&#xFF1A;&#x6307;&#x5B9A;&#x51E0;&#x6298;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;</li>
</ul>
</li>
<li>&#x65B9;&#x6CD5;<ul>
<li><em>fit</em>&#xFF1A;&#x8F93;&#x5165;&#x8BAD;&#x7EC3;&#x6570;&#x636E;</li>
<li><em>score</em>&#xFF1A;&#x51C6;&#x786E;&#x7387;</li>
</ul>
</li>
<li>&#x7ED3;&#x679C;&#x5206;&#x6790;&#xFF1A;<ul>
<li><em>best<em>params</em></em>&#xFF1A;&#x5728;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x4E2D;&#x9A8C;&#x8BC1;&#x7684;&#x6700;&#x597D;&#x8D85;&#x53C2;&#x6570;</li>
<li><em>best<em>score</em></em>&#xFF1A;&#x5728;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x4E2D;&#x9A8C;&#x8BC1;&#x7684;&#x6700;&#x597D;&#x7ED3;&#x679C;</li>
<li><em>best<em>estimator</em></em>&#xFF1A;&#x6700;&#x597D;&#x7684;&#x53C2;&#x6570;&#x6A21;&#x578B;</li>
<li><em>cv<em>results</em></em>&#xFF1A;&#x6BCF;&#x6B21;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x540E;&#x7684;&#x9A8C;&#x8BC1;&#x96C6;&#x51C6;&#x786E;&#x7387;&#x7ED3;&#x679C;&#x548C;&#x8BAD;&#x7EC3;&#x96C6;&#x51C6;&#x786E;&#x7387;&#x7ED3;&#x679C;</li>
</ul>
</li>
</ul>
<h2 id="34-&#x5206;&#x7C7B;&#x7684;&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;">3.4 &#x5206;&#x7C7B;&#x7684;&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;</h2>
<h3 id="341-&#x5206;&#x7C7B;&#x8BC4;&#x4F30;&#x62A5;&#x544A;api">3.4.1 &#x5206;&#x7C7B;&#x8BC4;&#x4F30;&#x62A5;&#x544A;API</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
</code></pre>
<p><strong><em>classification_report(y_true, y_pred, labels=[], target_names=None )</em></strong></p>
<ul>
<li><em>y_true</em>&#xFF1A;&#x771F;&#x5B9E;&#x76EE;&#x6807;&#x503C;</li>
<li><em>y_pred</em>&#xFF1A;&#x4F30;&#x8BA1;&#x5668;&#x9884;&#x6D4B;&#x76EE;&#x6807;&#x503C;</li>
<li><em>labels</em>&#xFF1A;&#x6307;&#x5B9A;&#x7C7B;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x5B57;</li>
<li><em>target_names</em>&#xFF1A;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x540D;&#x79F0;</li>
<li><em>return</em>&#xFF1A;&#x6BCF;&#x4E2A;&#x7C7B;&#x522B;&#x7CBE;&#x786E;&#x7387;&#x4E0E;&#x53EC;&#x56DE;&#x7387;</li>
</ul>
<h3 id="342-roc&#x66F2;&#x7EBF;&#x4E0E;auc&#x6307;&#x6807;">3.4.2 ROC&#x66F2;&#x7EBF;&#x4E0E;AUC&#x6307;&#x6807;</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> roc_auc_score
</code></pre>
<ul>
<li>AUC &#x53EA;&#x80FD;&#x7528;&#x6765;&#x8BC4;&#x4EF7;&#x4E8C;&#x5206;&#x7C7B;</li>
<li>AUC &#x975E;&#x5E38;&#x9002;&#x5408;&#x8BC4;&#x4EF7;&#x6837;&#x672C;&#x4E0D;&#x5E73;&#x8861;&#x4E2D;&#x7684;&#x5206;&#x7C7B;&#x5668;&#x6027;&#x80FD;</li>
</ul>
<h4 id="1&#xFF09;tpr&#x4E0E;fpr">1&#xFF09;TPR&#x4E0E;FPR</h4>
<ul>
<li>TPR = TP / (TP + FN)<ul>
<li>&#x6240;&#x6709;&#x771F;&#x5B9E;&#x7C7B;&#x522B;&#x4E3A;1&#x7684;&#x6837;&#x672C;&#x4E2D;&#xFF0C;&#x9884;&#x6D4B;&#x7C7B;&#x522B;&#x4E3A;1&#x7684;&#x6BD4;&#x4F8B;</li>
<li>&#x5373;&#x4E3A;&#x53EC;&#x56DE;&#x7387;&#xFF08;&#x67E5;&#x5168;&#x7387;&#xFF09;</li>
</ul>
</li>
<li>FPR = FP / (FP + FN)<ul>
<li>&#x6240;&#x6709;&#x771F;&#x5B9E;&#x7C7B;&#x522B;&#x4E3A;0&#x7684;&#x6837;&#x672C;&#x4E2D;&#xFF0C;&#x9884;&#x6D4B;&#x7C7B;&#x522B;&#x4E3A;1&#x7684;&#x6BD4;&#x4F8B;</li>
</ul>
</li>
</ul>
<h4 id="2&#xFF09;roc-&#x66F2;&#x7EBF;">2&#xFF09;ROC &#x66F2;&#x7EBF;</h4>
<ul>
<li>ROC &#x66F2;&#x7EBF;&#x7684;&#x6A2A;&#x8F74;&#x5C31;&#x662F; FPRate&#xFF0C;&#x7EB5;&#x8F74;&#x5C31;&#x662F; TPRate&#xFF0C;&#x5F53;&#x4E8C;&#x8005;&#x76F8;&#x7B49;&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x7684;&#x610F;&#x4E49;&#x5219;&#x662F;&#xFF1A;&#x5BF9;&#x4E8E;&#x4E0D;&#x8BBA;&#x771F;&#x5B9E;&#x7C7B;&#x522B;&#x662F; 1 &#x8FD8;&#x662F; 0 &#x7684;&#x6837;&#x672C;&#xFF0C;&#x5206;&#x7C7B;&#x5668;&#x9884;&#x6D4B;&#x4E3A; 1 &#x7684;&#x6982;&#x7387;&#x662F;&#x76F8;&#x7B49;&#x7684;&#xFF0C;&#x6B64;&#x65F6; AUC &#x4E3A; 0.5</li>
</ul>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/ROC.png" alt="ROC" style="zoom:67%;"></p>
<h4 id="3&#xFF09;auc-&#x6307;&#x6807;">3&#xFF09;AUC &#x6307;&#x6807;</h4>
<ul>
<li>AUC &#x7684;&#x6982;&#x7387;&#x610F;&#x4E49;&#x662F;&#x968F;&#x673A;&#x53D6;&#x4E00;&#x5BF9;&#x6B63;&#x8D1F;&#x6837;&#x672C;&#xFF0C;&#x6B63;&#x6837;&#x672C;&#x5F97;&#x5206;&#x5927;&#x4E8E;&#x8D1F;&#x6837;&#x672C;&#x7684;&#x6982;&#x7387;</li>
<li>AUC &#x7684;&#x6700;&#x5C0F;&#x503C;&#x4E3A; 0.5&#xFF0C;&#x6700;&#x5927;&#x503C;&#x4E3A; 1&#xFF0C;&#x53D6;&#x503C;&#x8D8A;&#x9AD8;&#x8D8A;&#x597D;</li>
<li>AUC=1&#xFF0C;&#x5B8C;&#x7F8E;&#x5206;&#x7C7B;&#x5668;&#xFF0C;&#x91C7;&#x7528;&#x8FD9;&#x4E2A;&#x9884;&#x6D4B;&#x6A21;&#x578B;&#x65F6;&#xFF0C;&#x4E0D;&#x7BA1;&#x8BBE;&#x5B9A;&#x4EC0;&#x4E48;&#x9608;&#x503C;&#x90FD;&#x80FD;&#x5F97;&#x51FA;&#x5B8C;&#x7F8E;&#x9884;&#x6D4B;&#x3002;&#x7EDD;&#x5927;&#x591A;&#x6570;&#x9884;&#x6D4B;&#x7684;&#x573A;&#x5408;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5B8C;&#x7F8E;&#x5206;&#x7C7B;&#x5668;&#x3002;</li>
<li>0.5&lt;AUC&lt;1&#xFF0C;&#x4F18;&#x4E8E;&#x968F;&#x673A;&#x731C;&#x6D4B;&#x3002;&#x8FD9;&#x4E2A;&#x5206;&#x7C7B;&#x5668;&#xFF08;&#x6A21;&#x578B;&#xFF09;&#x59A5;&#x5584;&#x8BBE;&#x5B9A;&#x9608;&#x503C;&#x7684;&#x8BDD;&#xFF0C;&#x80FD;&#x6709;&#x9884;&#x6D4B;&#x4EF7;&#x503C;&#x3002;</li>
</ul>
<blockquote>
<p><strong>&#x6700;&#x7EC8;AUC&#x7684;&#x8303;&#x56F4;&#x5728; [0.5, 1] &#x4E4B;&#x95F4;&#xFF0C;&#x5E76;&#x4E14;&#x8D8A;&#x63A5;&#x8FD1;1&#x8D8A;&#x597D;</strong></p>
</blockquote>
<h4 id="4&#xFF09;api">4&#xFF09;API</h4>
<p><strong><em>roc_auc_score(y_true, y_score)</em></strong></p>
<ul>
<li>&#x8BA1;&#x7B97; ROC &#x66F2;&#x7EBF;&#x9762;&#x79EF;&#xFF0C;&#x5373; AUC &#x503C;</li>
<li><em>y_true</em>&#xFF1A;&#x6BCF;&#x4E2A;&#x6837;&#x672C;&#x7684;&#x771F;&#x5B9E;&#x7C7B;&#x522B;&#xFF0C;&#x5FC5;&#x987B;&#x4E3A; 0 (&#x53CD;&#x4F8B;), 1 (&#x6B63;&#x4F8B;)&#x6807;&#x8BB0;</li>
<li><em>y_score</em>&#xFF1A;&#x6BCF;&#x4E2A;&#x6837;&#x672C;&#x9884;&#x6D4B;&#x7684;&#x6982;&#x7387;&#x503C;</li>
</ul>
<h2 id="35-&#x6A21;&#x578B;&#x4FDD;&#x5B58;&#x548C;&#x52A0;&#x8F7D;">3.5 &#x6A21;&#x578B;&#x4FDD;&#x5B58;&#x548C;&#x52A0;&#x8F7D;</h2>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> joblib
</code></pre>
<ul>
<li>&#x4FDD;&#x5B58;&#xFF1A;joblib.dump( estimator, &apos;XXX.pkl&apos; )</li>
<li>&#x52A0;&#x8F7D;&#xFF1A;estimator = joblib.load( &apos;XXX.pkl&apos; )</li>
</ul>
<p>&#x4F8B;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> joblib

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">store_model</span><span class="hljs-params">(estimator, name)</span>:</span>
    joblib.dump(estimator, <span class="hljs-string">&quot;../../models/&quot;</span>+name)
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;SUCCESS&quot;</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_model</span><span class="hljs-params">(name)</span>:</span>
    model = joblib.load(<span class="hljs-string">&quot;../../models/&quot;</span>+name)
    <span class="hljs-keyword">return</span> model
</code></pre>
<h1 id="&#x56DB;&#x3001;&#x5206;&#x7C7B;">&#x56DB;&#x3001;&#x5206;&#x7C7B;</h1>
<h2 id="41-knn-&#x7B97;&#x6CD5;">4.1 KNN &#x7B97;&#x6CD5;</h2>
<blockquote>
<p>&#x6839;&#x636E;&#x90BB;&#x5C45;&#xFF0C;&#x5224;&#x65AD;&#x7C7B;&#x522B;</p>
</blockquote>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier
</code></pre>
<p>&#xFF08;K Nearest Neighbor&#xFF09;&#x5373;K - &#x8FD1;&#x90BB;&#x7B97;&#x6CD5;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x6837;&#x672C;&#x5728;&#x7279;&#x5F81;&#x7A7A;&#x95F4;&#x4E2D;&#x7684;<strong>k&#x4E2A;&#x6700;&#x76F8;&#x4F3C;(&#x5373;&#x7279;&#x5F81;&#x7A7A;&#x95F4;&#x4E2D;&#x6700;&#x90BB;&#x8FD1;)&#x7684;&#x6837;&#x672C;&#x4E2D;&#x7684;&#x5927;&#x591A;&#x6570;&#x5C5E;&#x4E8E;&#x67D0;&#x4E00;&#x4E2A;&#x7C7B;&#x522B;</strong>&#xFF0C;&#x5219;&#x8BE5;&#x6837;&#x672C;&#x4E5F;&#x5C5E;&#x4E8E;&#x8FD9;&#x4E2A;&#x7C7B;&#x522B;&#x3002;</p>
<ul>
<li>&#x4F18;&#x70B9;&#xFF1A;<ul>
<li>&#x7B80;&#x5355;&#xFF0C;&#x6613;&#x4E8E;&#x7406;&#x89E3;&#xFF0C;&#x6613;&#x4E8E;&#x5B9E;&#x73B0;&#xFF0C;&#x65E0;&#x9700;&#x8BAD;&#x7EC3;</li>
</ul>
</li>
<li>&#x7F3A;&#x70B9;&#xFF1A;<ul>
<li>&#x61D2;&#x60F0;&#x7B97;&#x6CD5;&#xFF0C;&#x5BF9;&#x6D4B;&#x8BD5;&#x6837;&#x672C;&#x5206;&#x7C7B;&#x65F6;&#x7684;&#x8BA1;&#x7B97;&#x91CF;&#x5927;&#xFF0C;&#x5185;&#x5B58;&#x5F00;&#x9500;&#x5927;</li>
<li>&#x5FC5;&#x987B;&#x6307;&#x5B9A;K&#x503C;&#xFF0C;K&#x503C;&#x9009;&#x62E9;&#x4E0D;&#x5F53;&#x5219;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;</li>
</ul>
</li>
<li>&#x4F7F;&#x7528;&#x573A;&#x666F;&#xFF1A;&#x5C0F;&#x6570;&#x636E;&#x573A;&#x666F;&#xFF0C;&#x51E0;&#x5343;&#xFF5E;&#x51E0;&#x4E07;&#x6837;&#x672C;&#xFF0C;&#x5177;&#x4F53;&#x573A;&#x666F;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x53BB;&#x6D4B;&#x8BD5;</li>
</ul>
<h3 id="411-api">4.1.1 API</h3>
<p><strong><em>KNeighborsClassifier(n_neighbors=5,algorithm=&apos;auto&apos;)</em></strong></p>
<ul>
<li>n_neighbors&#xFF1A;int&#xFF0C;&#x53EF;&#x9009;&#xFF08;&#x9ED8;&#x8BA4;= 5&#xFF09;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x90BB;&#x5C45;&#x6570;</li>
<li>algorithm&#xFF1A;<em>{&#x2018;auto&#x2019;&#xFF0C;&#x2018;ball_tree&#x2019;&#xFF0C;&#x2018;kd_tree&#x2019;&#xFF0C;&#x2018;brute&#x2019;}</em>&#xFF0C;&#x53EF;&#x9009;&#x7528;&#x4E8E;&#x8BA1;&#x7B97;&#x6700;&#x8FD1;&#x90BB;&#x5C45;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x4E0D;&#x540C;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x5F71;&#x54CD;&#x6548;&#x7387;<ul>
<li><em>&#x2018;ball_tree&#x2019;</em> &#x5C06;&#x4F1A;&#x4F7F;&#x7528; BallTree</li>
<li><em>&#x2018;kd_tree&#x2019;</em> &#x5C06;&#x4F7F;&#x7528; KDTree</li>
<li><em>&#x2018;auto&#x2019;</em> &#x5C06;&#x5C1D;&#x8BD5;&#x6839;&#x636E;&#x4F20;&#x9012;&#x7ED9;fit&#x65B9;&#x6CD5;&#x7684;&#x503C;&#x6765;&#x51B3;&#x5B9A;&#x6700;&#x5408;&#x9002;&#x7684;&#x7B97;&#x6CD5;</li>
</ul>
</li>
</ul>
<h3 id="412-&#x4F8B;">4.1.2 &#x4F8B;</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split, GridSearchCV
<span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># &#x6570;&#x636E;&#x96C6;&#x5BFC;&#x5165;</span>
iris = datasets.load_iris()

<span class="hljs-comment"># &#x6570;&#x636E;&#x96C6;&#x5212;&#x5206;</span>
x_train, x_test, y_train, y_test = train_test_split(
    iris.data, iris.target, random_state=<span class="hljs-number">43</span>)

<span class="hljs-comment"># &#x6807;&#x51C6;&#x5316;</span>
transfer_std = StandardScaler()
x_train_std = transfer_std.fit_transform(x_train)
x_test_std = transfer_std.transform(x_test)  <span class="hljs-comment"># &#x6D4B;&#x8BD5;&#x96C6;&#x4E0D;&#x8981;&#x7528;fit, &#x56E0;&#x4E3A;&#x8981;&#x4FDD;&#x6301;&#x548C;&#x8BAD;&#x7EC3;&#x96C6;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x4E00;&#x81F4;</span>

<span class="hljs-comment"># KNN</span>
estimator_knn = KNeighborsClassifier(n_neighbors=<span class="hljs-number">3</span>)

<span class="hljs-comment"># &#x8C03;&#x4F18;</span>
param_dict = {<span class="hljs-string">&quot;n_neighbors&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>]}
estimator_knn = GridSearchCV(
    estimator_knn, param_grid=param_dict, cv=<span class="hljs-number">10</span>)  <span class="hljs-comment"># 10&#x6298;</span>

<span class="hljs-comment"># &#x8BAD;&#x7EC3;&#x6A21;&#x578B;</span>
estimator_knn.fit(x_train_std, y_train)
y_pred = estimator_knn.predict(x_test_std)

print(<span class="hljs-string">&quot;&#x9884;&#x6D4B;&#x503C;&#x4E3A;:&quot;</span>, y_pred, <span class="hljs-string">&quot;\n&#x771F;&#x5B9E;&#x503C;&#x4E3A;:&quot;</span>, y_test, <span class="hljs-string">&quot;\n&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;:&quot;</span>, y_test == y_pred)
print(<span class="hljs-string">&quot;&#x51C6;&#x786E;&#x7387;&#x4E3A;&#xFF1A;\n&quot;</span>, estimator_knn.score(x_test_std, y_test))

print(<span class="hljs-string">&quot;&#x6700;&#x4F73;&#x53C2;&#x6570;:\n&quot;</span>, estimator_knn.best_params_)
print(<span class="hljs-string">&quot;&#x6700;&#x4F73;&#x7ED3;&#x679C;:\n&quot;</span>, estimator_knn.best_score_)
print(<span class="hljs-string">&quot;&#x6700;&#x4F73;&#x4F30;&#x8BA1;&#x5668;:\n&quot;</span>, estimator_knn.best_estimator_)
print(<span class="hljs-string">&quot;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x7ED3;&#x679C;:\n&quot;</span>, estimator_knn.cv_results_)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x9884;&#x6D4B;&#x503C;&#x4E3A;: [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span>
 <span class="hljs-number">2</span>] 
&#x771F;&#x5B9E;&#x503C;&#x4E3A;: [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span>
 <span class="hljs-number">2</span>] 
&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;: [ <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>]
&#x51C6;&#x786E;&#x7387;&#x4E3A;&#xFF1A;
 <span class="hljs-number">0.9736842105263158</span>
&#x6700;&#x4F73;&#x53C2;&#x6570;:
{<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">1</span>}
&#x6700;&#x4F73;&#x7ED3;&#x679C;:
 <span class="hljs-number">0.9469696969696969</span>
&#x6700;&#x4F73;&#x4F30;&#x8BA1;&#x5668;:
 KNeighborsClassifier(n_neighbors=<span class="hljs-number">1</span>)
&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x7ED3;&#x679C;:
{<span class="hljs-string">&apos;mean_fit_time&apos;</span>: array([<span class="hljs-number">0.00029657</span>, <span class="hljs-number">0.00039995</span>, <span class="hljs-number">0.00039968</span>, <span class="hljs-number">0.00049977</span>, <span class="hljs-number">0.00029998</span>,
       <span class="hljs-number">0.00040131</span>]), <span class="hljs-string">&apos;std_fit_time&apos;</span>: array([<span class="hljs-number">0.00045309</span>, <span class="hljs-number">0.00048983</span>, <span class="hljs-number">0.00048951</span>, <span class="hljs-number">0.00049977</span>, <span class="hljs-number">0.00045822</span>,
       <span class="hljs-number">0.0004915</span> ]), <span class="hljs-string">&apos;mean_score_time&apos;</span>: array([<span class="hljs-number">0.00089977</span>, <span class="hljs-number">0.00080023</span>, <span class="hljs-number">0.00110025</span>, <span class="hljs-number">0.00080018</span>, <span class="hljs-number">0.00079889</span>,
       <span class="hljs-number">0.00080283</span>]), <span class="hljs-string">&apos;std_score_time&apos;</span>: array([<span class="hljs-number">0.00029992</span>, <span class="hljs-number">0.0004004</span> , <span class="hljs-number">0.00030082</span>, <span class="hljs-number">0.00040009</span>, <span class="hljs-number">0.00039965</span>,
       <span class="hljs-number">0.00040154</span>]), <span class="hljs-string">&apos;param_n_neighbors&apos;</span>: masked_array(data=[<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>],
             mask=[<span class="hljs-keyword">False</span>, <span class="hljs-keyword">False</span>, <span class="hljs-keyword">False</span>, <span class="hljs-keyword">False</span>, <span class="hljs-keyword">False</span>, <span class="hljs-keyword">False</span>],
       fill_value=<span class="hljs-string">&apos;?&apos;</span>,
            dtype=object), <span class="hljs-string">&apos;params&apos;</span>: [{<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">1</span>}, {<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">3</span>}, {<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">5</span>}, {<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">7</span>}, {<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">9</span>}, {<span class="hljs-string">&apos;n_neighbors&apos;</span>: <span class="hljs-number">11</span>}], <span class="hljs-string">&apos;split0_test_score&apos;</span>: array([<span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.91666667</span>,
       <span class="hljs-number">0.91666667</span>]), <span class="hljs-string">&apos;split1_test_score&apos;</span>: array([<span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.83333333</span>, <span class="hljs-number">0.91666667</span>, <span class="hljs-number">0.91666667</span>,
       <span class="hljs-number">0.91666667</span>]), <span class="hljs-string">&apos;split2_test_score&apos;</span>: array([<span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>,
       <span class="hljs-number">1.</span>        ]), <span class="hljs-string">&apos;split3_test_score&apos;</span>: array([<span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>,
       <span class="hljs-number">0.81818182</span>]), <span class="hljs-string">&apos;split4_test_score&apos;</span>: array([<span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>]), <span class="hljs-string">&apos;split5_test_score&apos;</span>: array([<span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.90909091</span>, <span class="hljs-number">1.</span>        , <span class="hljs-number">1.</span>        , <span class="hljs-number">1.</span>        ,
       <span class="hljs-number">1.</span>        ]), <span class="hljs-string">&apos;split6_test_score&apos;</span>: array([<span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>]), <span class="hljs-string">&apos;split7_test_score&apos;</span>: array([<span class="hljs-number">0.90909091</span>, <span class="hljs-number">0.81818182</span>, <span class="hljs-number">0.81818182</span>, <span class="hljs-number">0.81818182</span>, <span class="hljs-number">0.81818182</span>,
       <span class="hljs-number">0.81818182</span>]), <span class="hljs-string">&apos;split8_test_score&apos;</span>: array([<span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>]), <span class="hljs-string">&apos;split9_test_score&apos;</span>: array([<span class="hljs-number">1.</span>        , <span class="hljs-number">0.90909091</span>, <span class="hljs-number">1.</span>        , <span class="hljs-number">1.</span>        , <span class="hljs-number">1.</span>        ,
       <span class="hljs-number">0.90909091</span>]), <span class="hljs-string">&apos;mean_test_score&apos;</span>: array([<span class="hljs-number">0.9469697</span> , <span class="hljs-number">0.92878788</span>, <span class="hljs-number">0.93863636</span>, <span class="hljs-number">0.9469697</span> , <span class="hljs-number">0.9469697</span> ,
       <span class="hljs-number">0.93787879</span>]), <span class="hljs-string">&apos;std_test_score&apos;</span>: array([<span class="hljs-number">0.04338734</span>, <span class="hljs-number">0.05412294</span>, <span class="hljs-number">0.06830376</span>, <span class="hljs-number">0.05945884</span>, <span class="hljs-number">0.05945884</span>,
       <span class="hljs-number">0.07048305</span>]), <span class="hljs-string">&apos;rank_test_score&apos;</span>: array([<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>])}
</code></pre>
<h2 id="42-&#x6734;&#x7D20;&#x8D1D;&#x53F6;&#x65AF;&#x7B97;&#x6CD5;">4.2 &#x6734;&#x7D20;&#x8D1D;&#x53F6;&#x65AF;&#x7B97;&#x6CD5;</h2>
<p>&#xFF08;Naive Bayes&#xFF09;</p>
<blockquote>
<p>&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#x7684;&#x7279;&#x5F81; + &#x8D1D;&#x53F6;&#x65AF;&#x516C;&#x5F0F;</p>
</blockquote>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.naive_bayes <span class="hljs-keyword">import</span> MultinomialNB
</code></pre>
<p>&#x6734;&#x7D20;&#xFF1A;&#x7279;&#x5F81;&#x4E0E;&#x7279;&#x5F81;&#x4E4B;&#x95F4;&#x662F;&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#x7684;</p>
<p>&#x6734;&#x7D20;&#x8D1D;&#x53F6;&#x65AF;&#x7B97;&#x6CD5;&#x7ECF;&#x5E38;&#x7528;&#x4E8E;&#x6587;&#x672C;&#x5206;&#x7C7B;, &#x56E0;&#x4E3A;&#x6587;&#x7AE0;&#x8F6C;&#x6362;&#x6210;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x7B97;&#x6CD5;&#x8BC6;&#x522B;&#x7684;&#x6570;&#x636E;&#x662F;&#x4EE5;&#x5355;&#x8BCD;&#x4E3A;&#x7279;&#x5F81;&#x7684;</p>
<ul>
<li>&#x4F18;&#x70B9;&#xFF1A;<ul>
<li>&#x6734;&#x7D20;&#x8D1D;&#x53F6;&#x65AF;&#x6A21;&#x578B;&#x53D1;&#x6E90;&#x4E8E;&#x53E4;&#x5178;&#x6570;&#x5B66;&#x7406;&#x8BBA;&#xFF0C;&#x6709;&#x7A33;&#x5B9A;&#x7684;&#x5206;&#x7C7B;&#x6548;&#x7387;&#x3002;</li>
<li>&#x5BF9;&#x7F3A;&#x5931;&#x6570;&#x636E;&#x4E0D;&#x592A;&#x654F;&#x611F;&#xFF0C;&#x7B97;&#x6CD5;&#x4E5F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x5E38;&#x7528;&#x4E8E;&#x6587;&#x672C;&#x5206;&#x7C7B;&#x3002;</li>
<li>&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x5EA6;&#x9AD8;&#xFF0C;&#x901F;&#x5EA6;&#x5FEB;</li>
</ul>
</li>
<li>&#x7F3A;&#x70B9;&#xFF1A;<ul>
<li>&#x7531;&#x4E8E;&#x4F7F;&#x7528;&#x4E86;&#x6837;&#x672C;&#x5C5E;&#x6027;&#x72EC;&#x7ACB;&#x6027;&#x7684;&#x5047;&#x8BBE;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x7279;&#x5F81;&#x5C5E;&#x6027;&#x6709;&#x5173;&#x8054;&#x65F6;&#x5176;&#x6548;&#x679C;&#x4E0D;&#x597D;</li>
</ul>
</li>
</ul>
<h3 id="421-&#x539F;&#x7406;">4.2.1 &#x539F;&#x7406;</h3>
<h4 id="1&#xFF09;&#x8D1D;&#x53F6;&#x65AF;&#x516C;&#x5F0F;">1&#xFF09;&#x8D1D;&#x53F6;&#x65AF;&#x516C;&#x5F0F;</h4>
<p>&#x4EE5;&#x6587;&#x672C;&#x5206;&#x7C7B;&#x4E3A;&#x4F8B;</p>
<p>$$
P(C|F_1,F_2,\ldots)=\cfrac{P(F_1,F_2,\ldots|C)P(C)}{P(F_1,F_2,\ldots)}</p>
<p>$$</p>
<ul>
<li>$P(C)$&#xFF1A;&#x6BCF;&#x4E2A;&#x6587;&#x6863;&#x7C7B;&#x522B;&#x7684;&#x6982;&#x7387;(&#x67D0;&#x6587;&#x6863;&#x7C7B;&#x522B;&#x6570;&#xFF0F;&#x603B;&#x6587;&#x6863;&#x6570;&#x91CF;)</li>
<li>$P(W&#x2502;C)$&#xFF1A;&#x7ED9;&#x5B9A;&#x7C7B;&#x522B;&#x4E0B;&#x7279;&#x5F81;&#xFF08;&#x88AB;&#x9884;&#x6D4B;&#x6587;&#x6863;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x8BCD;&#xFF09;&#x7684;&#x6982;&#x7387;<ul>
<li>$W$ &#x4E3A;&#x7ED9;&#x5B9A;&#x6587;&#x6863;&#x7684;&#x7279;&#x5F81;&#x503C;&#xFF08;&#x9891;&#x6570;&#x7EDF;&#x8BA1;&#xFF09;</li>
<li>&#x8BA1;&#x7B97;&#x65B9;&#x6CD5;&#xFF1A;$P(F_1&#x2502;C)=N_i/N$ &#xFF08;&#x8BAD;&#x7EC3;&#x6587;&#x6863;&#x4E2D;&#x53BB;&#x8BA1;&#x7B97;&#xFF09;<ul>
<li>$N_i$&#xFF1A;&#x8BE5; $F_1$ &#x8BCD;&#x5728; $C$ &#x7C7B;&#x522B;&#x6240;&#x6709;&#x6587;&#x6863;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;</li>
<li>$N$&#xFF1A;&#x6240;&#x5C5E;&#x7C7B;&#x522B; $C$ &#x4E0B;&#x7684;&#x6587;&#x6863;&#x7684;&#x6587;&#x672C;&#x603B;&#x548C;</li>
</ul>
</li>
</ul>
</li>
<li>$P(F_1,F_2,\ldots)$ &#x9884;&#x6D4B;&#x6587;&#x6863;&#x4E2D;&#x6BCF;&#x4E2A;&#x8BCD;&#x7684;&#x6982;&#x7387;</li>
</ul>
<h4 id="2&#xFF09;&#x62C9;&#x666E;&#x62C9;&#x65AF;&#x5E73;&#x6ED1;&#x7CFB;&#x6570;">2&#xFF09;&#x62C9;&#x666E;&#x62C9;&#x65AF;&#x5E73;&#x6ED1;&#x7CFB;&#x6570;</h4>
<p>&#x76EE;&#x7684;&#xFF1A;&#x9632;&#x6B62;&#x8BA1;&#x7B97;&#x51FA;&#x7684;&#x5206;&#x7C7B;&#x6982;&#x7387;&#x4E3A;0</p>
<p>$$
P(F_1|C)=\cfrac{N_i+\alpha}{N+\alpha m}</p>
<p>$$</p>
<ul>
<li>$\alpha$&#xFF1A;&#x9884;&#x5148;&#x6307;&#x5B9A;&#x7684;&#x7CFB;&#x6570;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A; 1</li>
<li>$m$&#xFF1A;&#x8BAD;&#x7EC3;&#x6587;&#x6863;&#x4E2D;&#x7279;&#x5F81;&#x8BCD;&#x7684;&#x79CD;&#x7C7B;&#x6570;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-comment"># &#x56E0;&#x4E3A;&#x6837;&#x672C;&#x6570;&#x91CF;&#x4E0D;&#x591F;&#xFF0C;&#x4F1A;&#x51FA;&#x73B0;&#x7279;&#x5F81;&#x8BCD;&#x4E0D;&#x5728;&#x4E00;&#x7C7B;&#x6587;&#x672C;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x60C5;&#x51B5;</span>
P(&#x5A31;&#x4E50;|&#x5F71;&#x9662;,&#x652F;&#x4ED8;&#x5B9D;,&#x4E91;&#x8BA1;&#x7B97;) = &#x1D443;(&#x5F71;&#x9662;,&#x652F;&#x4ED8;&#x5B9D;,&#x4E91;&#x8BA1;&#x7B97;|&#x5A31;&#x4E50;)&#x2217;P(&#x5A31;&#x4E50;)=(<span class="hljs-number">56</span>/<span class="hljs-number">121</span>)&#x2217;(<span class="hljs-number">15</span>/<span class="hljs-number">121</span>)&#x2217;(<span class="hljs-number">0</span>/<span class="hljs-number">121</span>)&#x2217;(<span class="hljs-number">60</span>/<span class="hljs-number">90</span>) = <span class="hljs-number">0</span>
<span class="hljs-comment"># &#x6B64;&#x65F6;&#x9700;&#x8981;&#x5B9E;&#x7528;&#x5230;&#x62C9;&#x666E;&#x62C9;&#x65AF;&#x5E73;&#x6ED1;&#x7CFB;&#x6570;</span>
P(&#x5A31;&#x4E50;|&#x5F71;&#x9662;,&#x652F;&#x4ED8;&#x5B9D;,&#x4E91;&#x8BA1;&#x7B97;) =P(&#x5F71;&#x9662;,&#x652F;&#x4ED8;&#x5B9D;,&#x4E91;&#x8BA1;&#x7B97;|&#x5A31;&#x4E50;)P(&#x5A31;&#x4E50;)=(<span class="hljs-number">56</span>+<span class="hljs-number">1</span>/<span class="hljs-number">121</span>+<span class="hljs-number">4</span>)(<span class="hljs-number">15</span>+<span class="hljs-number">1</span>/<span class="hljs-number">121</span>+<span class="hljs-number">4</span>)(<span class="hljs-number">0</span>+<span class="hljs-number">1</span>/<span class="hljs-number">121</span>+<span class="hljs-number">1</span>*<span class="hljs-number">4</span>)(<span class="hljs-number">60</span>/<span class="hljs-number">90</span>) = <span class="hljs-number">0.00002</span>
</code></pre>
<h3 id="422-api">4.2.2 API</h3>
<p><strong><em>MultinomialNB(alpha = 1.0)</em></strong></p>
<ul>
<li><em>alpha</em>&#xFF1A;&#x62C9;&#x666E;&#x62C9;&#x65AF;&#x5E73;&#x6ED1;&#x7CFB;&#x6570;</li>
</ul>
<h3 id="423-&#x4F8B;&#xFF1A;20&#x7C7B;&#x65B0;&#x95FB;&#x5206;&#x7C7B;">4.2.3 &#x4F8B;&#xFF1A;20&#x7C7B;&#x65B0;&#x95FB;&#x5206;&#x7C7B;</h3>
<p>&#x5206;&#x6790;</p>
<ul>
<li>&#x5212;&#x5206;&#x6570;&#x636E;&#x96C6;</li>
<li>tfidf &#x8FDB;&#x884C;&#x7684;&#x7279;&#x5F81;&#x62BD;&#x53D6;</li>
<li>&#x6734;&#x7D20;&#x8D1D;&#x53F6;&#x65AF;&#x9884;&#x6D4B;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> fetch_20newsgroups, load_files
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> TfidfVectorizer
<span class="hljs-keyword">from</span> sklearn.naive_bayes <span class="hljs-keyword">import</span> MultinomialNB
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

data = fetch_20newsgroups(subset=<span class="hljs-string">&quot;all&quot;</span>) 
x_train, x_test, y_train, y_test = \
        train_test_split(data.data, data.target, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">22</span>)
<span class="hljs-comment"># &#x6587;&#x672C;&#x5206;&#x7C7B;</span>
transfer = TfidfVectorizer()  
x_train = transfer.fit_transform(x_train)
x_test = transfer.transform(x_test)  
<span class="hljs-comment"># &#x6734;&#x7D20;&#x8D1D;&#x53F6;&#x65AF;</span>
estimator = MultinomialNB()
estimator.fit(x_train, y_train)
y_predict = estimator.predict(x_test)

print(<span class="hljs-string">&quot;&#x9884;&#x6D4B;&#x503C;&#x4E3A;:&quot;</span>, y_predict, <span class="hljs-string">&quot;\n&#x771F;&#x5B9E;&#x503C;&#x4E3A;:&quot;</span>, y_test, <span class="hljs-string">&quot;\n&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;:&quot;</span>, y_test == y_predict)
score = estimator.score(x_test, y_test)
print(<span class="hljs-string">&quot;&#x51C6;&#x786E;&#x7387;&#x4E3A;: &quot;</span>, score)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x9884;&#x6D4B;&#x503C;&#x4E3A;: [<span class="hljs-number">15</span> <span class="hljs-number">13</span> <span class="hljs-number">16</span> ... <span class="hljs-number">13</span>  <span class="hljs-number">2</span> <span class="hljs-number">13</span>] 
&#x771F;&#x5B9E;&#x503C;&#x4E3A;: [<span class="hljs-number">15</span> <span class="hljs-number">13</span> <span class="hljs-number">16</span> ... <span class="hljs-number">13</span>  <span class="hljs-number">2</span> <span class="hljs-number">13</span>] 
&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;: [ <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> ...  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>]
&#x51C6;&#x786E;&#x7387;&#x4E3A;:  <span class="hljs-number">0.8511936339522547</span>
</code></pre>
<h2 id="43-&#x51B3;&#x7B56;&#x6811;">4.3 &#x51B3;&#x7B56;&#x6811;</h2>
<p>&#xFF08;Decision Tree&#xFF09;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier
</code></pre>
<blockquote>
<p>if - else &#x6839;&#x636E;&#x7279;&#x5F81;&#x7684;&#x4FE1;&#x606F;&#x71B5;&#x7B5B;&#x9009;</p>
</blockquote>
<h3 id="431-&#x539F;&#x7406;">4.3.1 &#x539F;&#x7406;</h3>
<h4 id="1&#xFF09;&#x4FE1;&#x606F;&#x71B5;">1&#xFF09;&#x4FE1;&#x606F;&#x71B5;</h4>
<p>$$
H(X)=-\sum\limits_{i=1}^n P(x_i)log_bP(x_i)</p>
<p>$$</p>
<h4 id="2&#xFF09;&#x6761;&#x4EF6;&#x4FE1;&#x606F;&#x71B5;">2&#xFF09;&#x6761;&#x4EF6;&#x4FE1;&#x606F;&#x71B5;</h4>
<p>$$
H(D|A)=\sum\limits_{i=1}^n \cfrac{|D_i|}{|D|}H(D_i)</p>
<p>$$</p>
<h4 id="3&#xFF09;&#x4FE1;&#x606F;&#x589E;&#x76CA;">3&#xFF09;&#x4FE1;&#x606F;&#x589E;&#x76CA;</h4>
<p>&#x51B3;&#x7B56;&#x6811;&#x7684;&#x5212;&#x5206;&#x4F9D;&#x636E;&#x4E4B;&#x4E00;</p>
<p>&#x7279;&#x5F81; $A$ &#x5BF9;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x96C6; $D$ &#x7684;&#x4FE1;&#x606F;&#x589E;&#x76CA; $g(D,A)$,&#x5B9A;&#x4E49;&#x4E3A;&#x96C6;&#x5408; D &#x7684;&#x4FE1;&#x606F;&#x71B5; $H(D)$ &#x4E0E;&#x7279;&#x5F81; $A$ &#x7ED9;&#x5B9A;&#x6761;&#x4EF6;&#x4E0B; $D$ &#x7684;&#x4FE1;&#x606F;&#x6761;&#x4EF6;&#x71B5; $H(D|A)$ &#x4E4B;&#x5DEE;</p>
<p>$$
g(D,A)=H(D)=H(D|A)</p>
<p>$$</p>
<h4 id="4&#xFF09;&#x4E09;&#x79CD;&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;">4&#xFF09;&#x4E09;&#x79CD;&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;</h4>
<ul>
<li>ID3<ul>
<li>&#x4FE1;&#x606F;&#x589E;&#x76CA; &#x6700;&#x5927;&#x7684;&#x51C6;&#x5219;</li>
</ul>
</li>
<li>C4.5<ul>
<li>&#x4FE1;&#x606F;&#x589E;&#x76CA;&#x6BD4; &#x6700;&#x5927;&#x7684;&#x51C6;&#x5219;</li>
</ul>
</li>
<li>CART<ul>
<li>&#x5206;&#x7C7B;&#x6811;: &#x57FA;&#x5C3C;&#x7CFB;&#x6570; &#x6700;&#x5C0F;&#x7684;&#x51C6;&#x5219; &#x5728;sklearn&#x4E2D;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5212;&#x5206;&#x7684;&#x9ED8;&#x8BA4;&#x539F;&#x5219;</li>
<li>&#x4F18;&#x52BF;&#xFF1A;&#x5212;&#x5206;&#x66F4;&#x52A0;&#x7EC6;&#x81F4;&#xFF08;&#x4ECE;&#x540E;&#x9762;&#x4F8B;&#x5B50;&#x7684;&#x6811;&#x663E;&#x793A;&#x6765;&#x7406;&#x89E3;&#xFF09;</li>
</ul>
</li>
</ul>
<h3 id="432-api">4.3.2 API</h3>
<p><strong><em>DecisionTreeClassifier(criterion=&#x2019;gini&#x2019;, max_depth=None,random_state=None)</em></strong></p>
<p>&#x51B3;&#x7B56;&#x6811;&#x5206;&#x7C7B;&#x5668;</p>
<ul>
<li>criterion&#xFF1A;&#x9ED8;&#x8BA4;&#x662F;&#x2019;gini&#x2019;&#x7CFB;&#x6570;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x4FE1;&#x606F;&#x589E;&#x76CA;&#x7684;&#x71B5;&#x2019;entropy&#x2019;</li>
<li>max_depth&#xFF1A;&#x6811;&#x7684;&#x6DF1;&#x5EA6;&#x5927;&#x5C0F;</li>
<li>random_state&#xFF1A;&#x968F;&#x673A;&#x6570;&#x79CD;&#x5B50;</li>
</ul>
<h3 id="433-&#x4FDD;&#x5B58;&#x6811;&#x7684;&#x7ED3;&#x6784;">4.3.3 &#x4FDD;&#x5B58;&#x6811;&#x7684;&#x7ED3;&#x6784;</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> export_graphviz
</code></pre>
<p><strong><em>export_graphviz()</em></strong> </p>
<p>&#x8BE5;&#x51FD;&#x6570;&#x80FD;&#x591F;&#x5BFC;&#x51FA;DOT&#x683C;&#x5F0F;</p>
<ul>
<li>tree.export_graphviz(estimator, out_file=path, feature_names)</li>
</ul>
<h3 id="434-&#x4F8B;">4.3.4 &#x4F8B;</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier, export_graphviz

iris = datasets.load_iris()
x_train, x_test, y_train, y_test = train_test_split(
    iris.data, iris.target, random_state=<span class="hljs-number">22</span>)
<span class="hljs-comment"># &#x51B3;&#x7B56;&#x6811;&#x8BAD;&#x7EC3;</span>
estimator = DecisionTreeClassifier(criterion=<span class="hljs-string">&quot;entropy&quot;</span>)
estimator.fit(x_train, y_train)
<span class="hljs-comment"># &#x751F;&#x6210;&#x6811;&#x6587;&#x4EF6;</span>
export_graphviz(estimator, out_file=<span class="hljs-string">&quot;tree.dot&quot;</span>,
                feature_names=iris.feature_names)

y_pred = estimator.predict(x_test)
print(<span class="hljs-string">&quot;&#x9884;&#x6D4B;&#x503C;&#x4E3A;:&quot;</span>, y_pred, <span class="hljs-string">&quot;\n&#x771F;&#x5B9E;&#x503C;&#x4E3A;:&quot;</span>, y_test, <span class="hljs-string">&quot;\n&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;:&quot;</span>, y_test == y_pred)
score = estimator.score(x_test, y_test)
print(<span class="hljs-string">&quot;&#x51C6;&#x786E;&#x7387;&#x4E3A;: &quot;</span>, score)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x9884;&#x6D4B;&#x503C;&#x4E3A;: [<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
 <span class="hljs-number">0</span>] 
&#x771F;&#x5B9E;&#x503C;&#x4E3A;: [<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
 <span class="hljs-number">0</span>] 
&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;: [ <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>]
&#x51C6;&#x786E;&#x7387;&#x4E3A;:  <span class="hljs-number">0.9210526315789473</span>
</code></pre>
<h2 id="44-&#x968F;&#x673A;&#x68EE;&#x6797;">4.4 &#x968F;&#x673A;&#x68EE;&#x6797;</h2>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
</code></pre>
<p><strong>&#x968F;&#x673A;&#x68EE;&#x6797;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x51B3;&#x7B56;&#x6811;&#x7684;&#x5206;&#x7C7B;&#x5668;</strong>&#xFF0C;&#x5E76;&#x4E14;&#x5176;&#x8F93;&#x51FA;&#x7684;&#x7C7B;&#x522B;&#x662F;&#x7531;&#x4E2A;&#x522B;&#x6811;&#x8F93;&#x51FA;&#x7684;&#x7C7B;&#x522B;&#x7684;&#x4F17;&#x6570;&#x800C;&#x5B9A;&#x3002;</p>
<h3 id="441-&#x539F;&#x7406;">4.4.1 &#x539F;&#x7406;</h3>
<p>&#x5B66;&#x4E60;&#x7B97;&#x6CD5;&#x6839;&#x636E;&#x4E0B;&#x5217;&#x7B97;&#x6CD5;&#x800C;&#x5EFA;&#x9020;&#x6BCF;&#x68F5;&#x6811;</p>
<ul>
<li>&#x7528; N &#x6765;&#x8868;&#x793A; &#x6837;&#x672C;&#x4E2A;&#x6570;&#xFF0C;M &#x8868;&#x793A;&#x7279;&#x5F81;&#x6570;&#x76EE;&#x3002;<ul>
<li>1&#x3001;&#x6709;&#x653E;&#x56DE;&#x5730;&#x62BD;&#x6837;&#xFF08;bootstrap&#xFF09;&#xFF0C;&#x4E00;&#x6B21;&#x968F;&#x673A;&#x9009;&#x51FA;&#x4E00;&#x4E2A;&#x6837;&#x672C;&#xFF0C;&#x91CD;&#x590D; N &#x6B21;</li>
<li>2&#x3001;&#x968F;&#x673A;&#x9009;&#x51FA; m &#x4E2A;&#x7279;&#x5F81;, m &lt;&lt;M&#xFF0C;&#x5EFA;&#x7ACB;&#x51B3;&#x7B56;&#x6811;</li>
</ul>
</li>
</ul>
<h3 id="442-api">4.4.2 API</h3>
<p><strong><em>RandomForestClassifier(n_estimators=10, criterion=&#x2019;gini&#x2019;, max_depth=None, bootstrap=True, random_state=None, min_samples_split=2)</em></strong></p>
<ul>
<li>&#x968F;&#x673A;&#x68EE;&#x6797;&#x5206;&#x7C7B;&#x5668;</li>
<li><em>n_estimators</em>&#xFF1A;integer&#xFF0C;optional&#xFF08;default = 10&#xFF09;&#x68EE;&#x6797;&#x91CC;&#x7684;&#x6811;&#x6728;&#x6570;&#x91CF; 120,200,300,500,800,1200</li>
<li><em>criteria</em>&#xFF1A;string&#xFF0C;&#x53EF;&#x9009;&#xFF08;default =&#x201C;gini&#x201D;&#xFF09;&#x5206;&#x5272;&#x7279;&#x5F81;&#x7684;&#x6D4B;&#x91CF;&#x65B9;&#x6CD5;</li>
<li><em>max_depth</em>&#xFF1A;integer &#x6216; None&#xFF0C;&#x53EF;&#x9009;&#xFF08;&#x9ED8;&#x8BA4;=&#x65E0;&#xFF09;&#x6811;&#x7684;&#x6700;&#x5927;&#x6DF1;&#x5EA6; 5,8,15,25,30</li>
<li><em>max_features=&quot;auto&#x201D;</em>&#xFF1A;&#x6BCF;&#x4E2A;&#x51B3;&#x7B56;&#x6811;&#x7684;&#x6700;&#x5927;&#x7279;&#x5F81;&#x6570;&#x91CF;<ul>
<li>If &quot;auto&quot;, then <code>max_features=sqrt(n_features)</code>.</li>
<li>If &quot;sqrt&quot;, then <code>max_features=sqrt(n_features)</code> (same as &quot;auto&quot;).</li>
<li>If &quot;log2&quot;, then <code>max_features=log2(n_features)</code>.</li>
<li>If None, then <code>max_features=n_features</code>.</li>
</ul>
</li>
<li><em>bootstrap</em>&#xFF1A;boolean&#xFF0C;optional&#xFF08;default = True&#xFF09;&#x662F;&#x5426;&#x5728;&#x6784;&#x5EFA;&#x6811;&#x65F6;&#x4F7F;&#x7528;&#x653E;&#x56DE;&#x62BD;&#x6837;</li>
<li><em>min_samples_split</em>&#xFF1A;&#x8282;&#x70B9;&#x5212;&#x5206;&#x6700;&#x5C11;&#x6837;&#x672C;&#x6570;</li>
<li><p><em>min_samples_leaf</em>&#xFF1A;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x7684;&#x6700;&#x5C0F;&#x6837;&#x672C;&#x6570;</p>
</li>
<li><p>&#x8D85;&#x53C2;&#x6570;&#xFF1A;n_estimator, max_depth, min_samples_split,min_samples_leaf</p>
</li>
</ul>
<h4 id="443-&#x4F8B;">4.4.3 &#x4F8B;</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV

iris = datasets.load_iris()
<span class="hljs-comment"># &#x6570;&#x636E;&#x96C6;&#x5212;&#x5206;</span>
x_train, x_test, y_train, y_test = train_test_split(
    iris.data, iris.target, random_state=<span class="hljs-number">22</span>)
<span class="hljs-comment"># RandomForest</span>
estimator_rf = RandomForestClassifier() 
<span class="hljs-comment"># &#x8D85;&#x53C2;&#x8C03;&#x4F18;</span>
param_dict = {<span class="hljs-string">&quot;n_estimators&quot;</span>: [<span class="hljs-number">120</span>,<span class="hljs-number">200</span>,<span class="hljs-number">300</span>,<span class="hljs-number">500</span>,<span class="hljs-number">800</span>,<span class="hljs-number">1200</span>], <span class="hljs-string">&quot;max_depth&quot;</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>, <span class="hljs-number">30</span>]}
estimator_rf = GridSearchCV(estimator_rf, param_grid=param_dict,cv=<span class="hljs-number">5</span>)
<span class="hljs-comment"># &#x8BAD;&#x7EC3;</span>
estimator_rf.fit(x_train,y_train)
y_pred = estimator_rf.predict(x_test)
<span class="hljs-comment"># &#x8F93;&#x51FA;&#x7ED3;&#x679C;</span>
print(<span class="hljs-string">&quot;&#x9884;&#x6D4B;&#x503C;&#x4E3A;:&quot;</span>, y_pred, <span class="hljs-string">&quot;\n&#x771F;&#x5B9E;&#x503C;&#x4E3A;:&quot;</span>, y_test, <span class="hljs-string">&quot;\n&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;:&quot;</span>, y_test == y_pred)
print(<span class="hljs-string">&quot;&#x51C6;&#x786E;&#x7387;&#x4E3A;&#xFF1A;\n&quot;</span>, estimator_rf.score(x_test, y_test))

print(<span class="hljs-string">&quot;&#x6700;&#x4F73;&#x53C2;&#x6570;:\n&quot;</span>, estimator_rf.best_params_)
print(<span class="hljs-string">&quot;&#x6700;&#x4F73;&#x7ED3;&#x679C;:\n&quot;</span>, estimator_rf.best_score_)
print(<span class="hljs-string">&quot;&#x6700;&#x4F73;&#x4F30;&#x8BA1;&#x5668;:\n&quot;</span>, estimator_rf.best_estimator_)
print(<span class="hljs-string">&quot;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x7ED3;&#x679C;:\n&quot;</span>, estimator_rf.cv_results_)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x9884;&#x6D4B;&#x503C;&#x4E3A;: [<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
 <span class="hljs-number">0</span>] 
&#x771F;&#x5B9E;&#x503C;&#x4E3A;: [<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
 <span class="hljs-number">0</span>] 
&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x4E3A;: [ <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span> <span class="hljs-keyword">False</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>
  <span class="hljs-keyword">True</span>  <span class="hljs-keyword">True</span>]
&#x51C6;&#x786E;&#x7387;&#x4E3A;&#xFF1A;
 <span class="hljs-number">0.9210526315789473</span>
&#x6700;&#x4F73;&#x53C2;&#x6570;:
{<span class="hljs-string">&apos;max_depth&apos;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&apos;n_estimators&apos;</span>: <span class="hljs-number">120</span>}
&#x6700;&#x4F73;&#x7ED3;&#x679C;:
 <span class="hljs-number">0.9553571428571429</span>
&#x6700;&#x4F73;&#x4F30;&#x8BA1;&#x5668;:
 RandomForestClassifier(bootstrap=<span class="hljs-keyword">True</span>, class_weight=<span class="hljs-keyword">None</span>, criterion=<span class="hljs-string">&apos;gini&apos;</span>,
            max_depth=<span class="hljs-number">5</span>, max_features=<span class="hljs-string">&apos;auto&apos;</span>, max_leaf_nodes=<span class="hljs-keyword">None</span>,
            min_impurity_decrease=<span class="hljs-number">0.0</span>, min_impurity_split=<span class="hljs-keyword">None</span>,
            min_samples_leaf=<span class="hljs-number">1</span>, min_samples_split=<span class="hljs-number">2</span>,
            min_weight_fraction_leaf=<span class="hljs-number">0.0</span>, n_estimators=<span class="hljs-number">120</span>, n_jobs=<span class="hljs-number">1</span>,
            oob_score=<span class="hljs-keyword">False</span>, random_state=<span class="hljs-keyword">None</span>, verbose=<span class="hljs-number">0</span>,
            warm_start=<span class="hljs-keyword">False</span>)
&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x7ED3;&#x679C;:
 {<span class="hljs-string">&apos;mean_fit_time&apos;</span>: array([<span class="hljs-number">0.32009826</span>, <span class="hljs-number">0.57197742</span>, ......., <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>])}
</code></pre>
<h2 id="45-&#x903B;&#x8F91;&#x56DE;&#x5F52;">4.5 &#x903B;&#x8F91;&#x56DE;&#x5F52;</h2>
<p>&#xFF08;Logistic Regression&#xFF09;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression
</code></pre>
<p>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x662F;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x4E2D;&#x7684;&#x4E00;&#x79CD;&#x5206;&#x7C7B;&#x6A21;&#x578B;&#xFF0C;&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x662F;&#x4E00;&#x79CD;&#x5206;&#x7C7B;&#x7B97;&#x6CD5;&#xFF0C;&#x867D;&#x7136;&#x540D;&#x5B57;&#x4E2D;&#x5E26;&#x6709;&#x56DE;&#x5F52;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4E0E;&#x56DE;&#x5F52;&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x8054;&#x7CFB;&#x3002;</p>
<h3 id="451-&#x539F;&#x7406;">4.5.1 &#x539F;&#x7406;</h3>
<h4 id="1&#xFF09;&#x8F93;&#x5165;">1&#xFF09;&#x8F93;&#x5165;</h4>
<p>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x7684;&#x8F93;&#x5165;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>$$
h(w)=w_1x_1+w_2x_2+w_3x_3\ldots+b</p>
<p>$$</p>
<h4 id="2&#xFF09;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;">2&#xFF09;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;</h4>
<p>sigmoid &#x51FD;&#x6570;</p>
<p>$$
g(\theta^Tx)=\frac{1}{1+e^{-\theta^Tx}}</p>
<p>$$
&#x5206;&#x6790;</p>
<ul>
<li>&#x56DE;&#x5F52;&#x7684;&#x7ED3;&#x679C;&#x8F93;&#x5165;&#x5230; sigmoid &#x51FD;&#x6570;&#x5F53;&#x4E2D;</li>
<li>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;[0, 1] &#x533A;&#x95F4;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6982;&#x7387;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A; 0.5 &#x4E3A;&#x9608;&#x503C;</li>
</ul>
<blockquote>
<p>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x6700;&#x7EC8;&#x7684;&#x5206;&#x7C7B;&#x662F;&#x901A;&#x8FC7;&#x5C5E;&#x4E8E;&#x67D0;&#x4E2A;&#x7C7B;&#x522B;&#x7684;&#x6982;&#x7387;&#x503C;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5C5E;&#x4E8E;&#x67D0;&#x4E2A;&#x7C7B;&#x522B;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E2A;&#x7C7B;&#x522B;&#x9ED8;&#x8BA4;&#x6807;&#x8BB0;&#x4E3A; 1 (&#x6B63;&#x4F8B;),&#x53E6;&#x5916;&#x7684;&#x4E00;&#x4E2A;&#x7C7B;&#x522B;&#x4F1A;&#x6807;&#x8BB0;&#x4E3A; 0 (&#x53CD;&#x4F8B;)&#x3002;&#xFF08;&#x65B9;&#x4FBF;&#x635F;&#x5931;&#x8BA1;&#x7B97;&#xFF09;</p>
</blockquote>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x8FD0;&#x7B97;&#x8FC7;&#x7A0B;.png" alt="&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x8FD0;&#x7B97;&#x8FC7;&#x7A0B;" style="zoom: 67%;"></p>
<h4 id="3&#xFF09;&#x635F;&#x5931;&#x51FD;&#x6570;">3&#xFF09;&#x635F;&#x5931;&#x51FD;&#x6570;</h4>
<p>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x7684;&#x635F;&#x5931;&#xFF0C;&#x79F0;&#x4E4B;&#x4E3A;<strong>&#x5BF9;&#x6570;&#x4F3C;&#x7136;&#x635F;&#x5931;</strong></p>
<p>$$
cost(h<em>\theta(x),y)=\sum\limits</em>{i=1}^m-y<em>ilog(h</em>\theta(x))-(1-y<em>i)log(1-h</em>\theta(x))</p>
<p>$$
<img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/&#x635F;&#x5931;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;.png" alt="&#x635F;&#x5931;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;" style="zoom: 67%;"></p>
<h4 id="4&#xFF09;&#x4F18;&#x5316;">4&#xFF09;&#x4F18;&#x5316;</h4>
<p>&#x540C;&#x6837;&#x4F7F;&#x7528;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#xFF0C;&#x53BB;&#x51CF;&#x5C11;&#x635F;&#x5931;&#x51FD;&#x6570;&#x7684;&#x503C;&#x3002;&#x8FD9;&#x6837;&#x53BB;&#x66F4;&#x65B0;&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x524D;&#x9762;&#x5BF9;&#x5E94;&#x7B97;&#x6CD5;&#x7684;&#x6743;&#x91CD;&#x53C2;&#x6570;&#xFF0C;&#x63D0;&#x5347;&#x539F;&#x672C;&#x5C5E;&#x4E8E; 1 &#x7C7B;&#x522B;&#x7684;&#x6982;&#x7387;&#xFF0C;&#x964D;&#x4F4E;&#x539F;&#x672C;&#x662F; 0 &#x7C7B;&#x522B;&#x7684;&#x6982;&#x7387;&#x3002;</p>
<h3 id="452-api">4.5.2 API</h3>
<p><strong><em>LogisticRegression(solver=&apos;liblinear&apos;, penalty=&#x2018;l2&#x2019;, C = 1.0)</em></strong></p>
<ul>
<li><em>solver</em>&#xFF1A;&#x4F18;&#x5316;&#x6C42;&#x89E3;&#x65B9;&#x5F0F;&#xFF08;&#x9ED8;&#x8BA4;&#x5F00;&#x6E90;&#x7684; liblinear &#x5E93;&#x5B9E;&#x73B0;&#xFF0C;&#x5185;&#x90E8;&#x4F7F;&#x7528;&#x4E86;&#x5750;&#x6807;&#x8F74;&#x4E0B;&#x964D;&#x6CD5;&#x6765;&#x8FED;&#x4EE3;&#x4F18;&#x5316;&#x635F;&#x5931;&#x51FD;&#x6570;&#xFF09;<ul>
<li><em>sag</em>&#xFF1A;&#x6839;&#x636E;&#x6570;&#x636E;&#x96C6;&#x81EA;&#x52A8;&#x9009;&#x62E9;&#xFF0C;&#x968F;&#x673A;&#x5E73;&#x5747;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;</li>
</ul>
</li>
<li><em>penalty</em>&#xFF1A;&#x6B63;&#x5219;&#x5316;&#x7684;&#x79CD;&#x7C7B;</li>
<li><em>C</em>&#xFF1A;&#x6B63;&#x5219;&#x5316;&#x529B;&#x5EA6;</li>
</ul>
<p>LogisticRegression &#x65B9;&#x6CD5;&#x76F8;&#x5F53;&#x4E8E; <code>SGDClassifier(loss=&quot;log&quot;, penalty=&quot; &quot;)</code>, SGDClassifier &#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x5B66;&#x4E60;&#xFF0C;&#x4E5F;&#x652F;&#x6301;&#x5E73;&#x5747;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x6CD5;&#xFF08;ASGD&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E; average=True&#x3002;&#x800C;&#x4F7F;&#x7528; LogisticRegression (&#x5B9E;&#x73B0;&#x4E86; SAG)</p>
<h3 id="453-&#x4F8B;">4.5.3 &#x4F8B;</h3>
<p>&#x6848;&#x4F8B;&#xFF1A;&#x764C;&#x75C7;&#x5206;&#x7C7B;&#x9884;&#x6D4B;-&#x826F;&#xFF0F;&#x6076;&#x6027;&#x4E73;&#x817A;&#x764C;&#x80BF;&#x7624;&#x9884;&#x6D4B;</p>
<blockquote>
<p>&#x6570;&#x636E;&#x63CF;&#x8FF0;</p>
<p>&#xFF08;1&#xFF09;699&#x6761;&#x6837;&#x672C;&#xFF0C;&#x5171;11&#x5217;&#x6570;&#x636E;&#xFF0C;&#x7B2C;&#x4E00;&#x5217;&#x7528;&#x8BED;&#x68C0;&#x7D22;&#x7684;id&#xFF0C;&#x540E;9&#x5217;&#x5206;&#x522B;&#x662F;&#x4E0E;&#x80BF;&#x7624;</p>
<p>&#x76F8;&#x5173;&#x7684;&#x533B;&#x5B66;&#x7279;&#x5F81;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x5217;&#x8868;&#x793A;&#x80BF;&#x7624;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x503C;&#x3002;</p>
<p>&#xFF08;2&#xFF09;&#x5305;&#x542B;16&#x4E2A;&#x7F3A;&#x5931;&#x503C;&#xFF0C;&#x7528; &#x201D;?&#x201D; &#x6807;&#x51FA;&#x3002;</p>
</blockquote>
<p>&#x5206;&#x6790;</p>
<ul>
<li>&#x7F3A;&#x5931;&#x503C;&#x5904;&#x7406;</li>
<li>&#x6807;&#x51C6;&#x5316;&#x5904;&#x7406;</li>
<li>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x9884;&#x6D4B;</li>
</ul>
<h4 id="1&#xFF09;&#x521D;&#x59CB;&#x5316;">1&#xFF09;&#x521D;&#x59CB;&#x5316;</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression, SGDClassifier
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report, roc_auc_score, roc_curve
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># &#x6587;&#x4EF6;&#x8BFB;&#x53D6;</span>
column_name = [<span class="hljs-string">&apos;Sample code number&apos;</span>, <span class="hljs-string">&apos;Clump Thickness&apos;</span>,
               <span class="hljs-string">&apos;Uniformity of Cell Size&apos;</span>, <span class="hljs-string">&apos;Uniformity of Cell Shape&apos;</span>, <span class="hljs-string">&apos;Marginal Adhesion&apos;</span>,
               <span class="hljs-string">&apos;Single Epithelial Cell Size&apos;</span>,
               <span class="hljs-string">&apos;Bare Nuclei&apos;</span>, <span class="hljs-string">&apos;Bland Chromatin&apos;</span>,
               <span class="hljs-string">&apos;Normal Nucleoli&apos;</span>, <span class="hljs-string">&apos;Mitoses&apos;</span>, <span class="hljs-string">&apos;Class&apos;</span>]
original_data = pd.read_csv(<span class="hljs-string">&apos;../Data/breast-cancer-wisconsin.data&apos;</span>,names=column_name)
original_data.head()
<span class="hljs-comment"># &#x7F3A;&#x5931;&#x503C;&#x5904;&#x7406;</span>
<span class="hljs-comment"># &#x7B2C;&#x4E00;&#x6B65;&#x5148;&#x66FF;&#x6362; ? &#x4E3A; nan</span>
data = original_data.replace(to_replace=<span class="hljs-string">&quot;?&quot;</span>, value=np.nan)
data.dropna(inplace=<span class="hljs-keyword">True</span>)
print(<span class="hljs-string">&quot;&#x68C0;&#x6D4B;&#x662F;&#x5426;&#x8FD8;&#x6709;&#x7F3A;&#x5931;&#x503C;(&#x5168;&#x4E3A;false&#x8868;&#x793A;&#x6CA1;&#x6709;&#x7F3A;&#x5931;&#x503C;)&quot;</span>)  <span class="hljs-comment"># &#x68C0;&#x6D4B;&#x662F;&#x5426;&#x8FD8;&#x6709;&#x7F3A;&#x5931;&#x503C;</span>
print(data.isnull().any())
<span class="hljs-comment"># &#x7B2C;&#x4E09;&#x6B65; &#x7B5B;&#x9009;&#x7279;&#x5F81;&#x503C;&#x548C;&#x76EE;&#x6807;&#x503C;</span>
x = data.iloc[:, <span class="hljs-number">1</span>:<span class="hljs-number">-1</span>]  <span class="hljs-comment"># &#x8868;&#x793A;&#x6BCF;&#x4E00;&#x884C;&#x6570;&#x636E;&#x90FD;&#x8981;, &#x4ECE;&#x7B2C;&#x4E00;&#x5217;&#x5230;&#x5012;&#x6570;&#x7B2C;&#x4E8C;&#x5217;&#x7684;column&#x5B57;&#x6BB5;&#x4E5F;&#x8981;</span>
y = data[<span class="hljs-string">&quot;Class&quot;</span>]
x_train, x_test, y_train, y_test = train_test_split(x, y)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x68C0;&#x6D4B;&#x662F;&#x5426;&#x8FD8;&#x6709;&#x7F3A;&#x5931;&#x503C;(&#x5168;&#x4E3A;false&#x8868;&#x793A;&#x6CA1;&#x6709;&#x7F3A;&#x5931;&#x503C;)
Sample code number             <span class="hljs-keyword">False</span>
Clump Thickness                <span class="hljs-keyword">False</span>
Uniformity of Cell Size        <span class="hljs-keyword">False</span>
Uniformity of Cell Shape       <span class="hljs-keyword">False</span>
Marginal Adhesion              <span class="hljs-keyword">False</span>
Single Epithelial Cell Size    <span class="hljs-keyword">False</span>
Bare Nuclei                    <span class="hljs-keyword">False</span>
Bland Chromatin                <span class="hljs-keyword">False</span>
Normal Nucleoli                <span class="hljs-keyword">False</span>
Mitoses                        <span class="hljs-keyword">False</span>
Class                          <span class="hljs-keyword">False</span>
</code></pre>
<h4 id="2&#xFF09;&#x8BAD;&#x7EC3;">2&#xFF09;&#x8BAD;&#x7EC3;</h4>
<pre><code class="lang-python"><span class="hljs-comment"># &#x7B2C;&#x56DB;&#x6B65;: &#x5F00;&#x59CB;&#x7279;&#x5F81;&#x5DE5;&#x7A0B;</span>
transfer = StandardScaler()
x_train = transfer.fit_transform(x_train)
x_test = transfer.transform(x_test)

<span class="hljs-comment"># &#x7B2C;&#x4E94;&#x6B65;, &#x9884;&#x4F30;&#x5668;&#x6D41;&#x7A0B;</span>
estimator = LogisticRegression()  <span class="hljs-comment"># &#x9ED8;&#x8BA4;&#x53C2;&#x6570;</span>
estimator.fit(x_train, y_train)
print(<span class="hljs-string">&quot;&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;: &quot;</span>, estimator.coef_)
print(<span class="hljs-string">&quot;&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x504F;&#x7F6E;&#x4E3A;:&quot;</span>, estimator.intercept_)
<span class="hljs-comment"># &#x7B2C;&#x516D;&#x6B65;, &#x6A21;&#x578B;&#x8BC4;&#x4F30;</span>
y_predict = estimator.predict(x_test)
print(<span class="hljs-string">&quot;&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x9884;&#x6D4B;&#x7ED3;&#x679C;&quot;</span>, y_predict)
print(<span class="hljs-string">&quot;&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x5BF9;&#x6BD4;:&quot;</span>, y_test == y_predict)
score = estimator.score(x_test, y_test)
print(<span class="hljs-string">&quot;&#x51C6;&#x786E;&#x7387;&#x4E3A;:&quot;</span>, score)
<span class="hljs-comment"># 2&#x662F;&#x826F;&#x6027;&#x7684; 4&#x662F;&#x6076;&#x6027;&#x7684;</span>
<span class="hljs-string">&quot;&quot;&quot;
&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x4E2A;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;, &#x4EE5;&#x4E0A;&#x53EA;&#x80FD;&#x8BF4;&#x660E;&#x9884;&#x6D4B;&#x7684;&#x6B63;&#x786E;&#x4E0E;&#x5426;,
&#x800C;&#x4E8B;&#x5B9E;&#x4E0A;, &#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x79CD;&#x8BC4;&#x4F30;&#x65B9;&#x5F0F;&#x6765;&#x663E;&#x793A;&#x6211;&#x4EEC;&#x5BF9;&#x6076;&#x6027;breast&#x7684;&#x9884;&#x6D4B;&#x6210;&#x529F;&#x7387;, &#x4E5F;&#x5C31;&#x662F;&#x53EC;&#x56DE;&#x7387;
&#x540C;&#x65F6;&#x53EF;&#x4EE5;&#x67E5;&#x770B;F1-score&#x7684;&#x7A33;&#x5065;&#x6027;
(&#x53EC;&#x56DE;&#x7387;&#x548C;&#x7CBE;&#x786E;&#x7387;&#x770B;&#x7B14;&#x8BB0;&#x548C;&#x622A;&#x56FE;)
&#x6240;&#x4EE5;&#x4E0B;&#x9762;&#x6362;&#x4E00;&#x79CD;&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;
&quot;&quot;&quot;</span>
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;:  [[<span class="hljs-number">1.20895973</span> <span class="hljs-number">0.34430535</span> <span class="hljs-number">0.93605533</span> <span class="hljs-number">0.50117234</span> <span class="hljs-number">0.22296947</span> <span class="hljs-number">1.22295345</span>
  <span class="hljs-number">0.81648447</span> <span class="hljs-number">0.64096012</span> <span class="hljs-number">0.71930684</span>]]
&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x504F;&#x7F6E;&#x4E3A;: [<span class="hljs-number">-0.9875554</span>]
&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x9884;&#x6D4B;&#x7ED3;&#x679C; [<span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span>
 <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span>
 <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span>
 <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span>
 <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span>]
&#x903B;&#x8F91;&#x56DE;&#x5F52;_&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x5BF9;&#x6BD4;: <span class="hljs-number">541</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">288</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">395</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">409</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">568</span>     <span class="hljs-keyword">True</span>
       ...  
<span class="hljs-number">442</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">51</span>     <span class="hljs-keyword">False</span>
<span class="hljs-number">370</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">304</span>     <span class="hljs-keyword">True</span>
<span class="hljs-number">363</span>     <span class="hljs-keyword">True</span>
Name: Class, Length: <span class="hljs-number">171</span>, dtype: bool
&#x51C6;&#x786E;&#x7387;&#x4E3A;: <span class="hljs-number">0.9766081871345029</span>
</code></pre>
<h4 id="3&#xFF09;&#x67E5;&#x770B;&#x7CBE;&#x786E;&#x7387;&#xFF0C;&#x53EC;&#x56DE;&#x7387;&#xFF0C;f1-score">3&#xFF09;&#x67E5;&#x770B;&#x7CBE;&#x786E;&#x7387;&#xFF0C;&#x53EC;&#x56DE;&#x7387;&#xFF0C;F1-score</h4>
<pre><code class="lang-python">Score = classification_report(y_test, y_predict, labels=[<span class="hljs-number">2</span>, <span class="hljs-number">4</span>],
                              target_names=[<span class="hljs-string">&quot;&#x826F;&#x6027;&quot;</span>, <span class="hljs-string">&quot;&#x6076;&#x6027;&quot;</span>])
print(<span class="hljs-string">&quot;&#x67E5;&#x770B;&#x7CBE;&#x786E;&#x7387;,&#x53EC;&#x56DE;&#x7387;,F1-score\n&quot;</span>, Score)
<span class="hljs-comment"># support&#x8868;&#x793A;&#x6837;&#x672C;&#x91CF;</span>
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x67E5;&#x770B;&#x7CBE;&#x786E;&#x7387;,&#x53EC;&#x56DE;&#x7387;,F1-score
               precision    recall  f1-score   support

          &#x826F;&#x6027;       <span class="hljs-number">0.98</span>      <span class="hljs-number">0.98</span>      <span class="hljs-number">0.98</span>       <span class="hljs-number">114</span>
          &#x6076;&#x6027;       <span class="hljs-number">0.96</span>      <span class="hljs-number">0.96</span>      <span class="hljs-number">0.96</span>        <span class="hljs-number">57</span>

    accuracy                           <span class="hljs-number">0.98</span>       <span class="hljs-number">171</span>
   macro avg       <span class="hljs-number">0.97</span>      <span class="hljs-number">0.97</span>      <span class="hljs-number">0.97</span>       <span class="hljs-number">171</span>
weighted avg       <span class="hljs-number">0.98</span>      <span class="hljs-number">0.98</span>      <span class="hljs-number">0.98</span>       <span class="hljs-number">171</span>
</code></pre>
<h4 id="4&#xFF09;&#x67E5;&#x770B;-roc-&#x66F2;&#x7EBF;&#x548C;-auc-&#x6307;&#x6807;">4&#xFF09;&#x67E5;&#x770B; ROC &#x66F2;&#x7EBF;&#x548C; AUC &#x6307;&#x6807;</h4>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
ROC&#x66F2;&#x7EBF;&#x548C;AUC&#x6307;&#x6807;(&#x6837;&#x672C;&#x5206;&#x7C7B;&#x4E0D;&#x5747;&#x8861;&#x7684;&#x60C5;&#x51B5;&#x4E0B;,&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;)
AUC = 0.5 &#x662F;&#x778E;&#x731C;&#x6A21;&#x578B;
AUC = 1 &#x662F;&#x6700;&#x597D;&#x7684;&#x6A21;&#x578B;
AUC &lt; 0.5 &#x5C5E;&#x4E8E;&#x53CD;&#x5411;&#x6BD2;&#x5976;
&#x66F4;&#x591A;&#x7684;&#x770B;&#x622A;&#x56FE;
&quot;&quot;&quot;</span>
<span class="hljs-comment"># &#x9700;&#x8981;&#x8F6C;&#x6362;&#x4E3A;0,1&#x8868;&#x793A;</span>
y_true = np.where(y_test &gt; <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># &#x8868;&#x793A;&#x5927;&#x4E8E;3&#x4E3A;1,&#x53CD;&#x4E4B;&#x4E3A;0(class&#x503C;&#x4E3A;2&#x548C;4)</span>
return_value = roc_auc_score(y_true, y_predict)
print(<span class="hljs-string">&quot;ROC&#x66F2;&#x7EBF;&#x548C;AUC&#x8FD4;&#x56DE;&#x503C;&#x4E3A;(&#x4E09;&#x89D2;&#x5F62;&#x9762;&#x79EF;)&quot;</span>, return_value)

fpr, tpr, thresholds = roc_curve(y_true, y_predict)
plt.plot(fpr, tpr)
plt.show()
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/image-20210127225009225.png" alt="image-20210127225009225" style="zoom:67%;"></p>
<h1 id="&#x4E94;&#x3001;&#x56DE;&#x5F52;">&#x4E94;&#x3001;&#x56DE;&#x5F52;</h1>
<p>&#xFF08;Regression&#xFF09;</p>
<ul>
<li>&#x5C0F;&#x89C4;&#x6A21;&#x6570;&#x636E;&#xFF1A;<ul>
<li><strong>LinearRegression(&#x4E0D;&#x80FD;&#x89E3;&#x51B3;&#x62DF;&#x5408;&#x95EE;&#x9898;)</strong></li>
<li>&#x5CAD;&#x56DE;&#x5F52;</li>
</ul>
</li>
<li>&#x5927;&#x89C4;&#x6A21;&#x6570;&#x636E;&#xFF1A;SGDRegressor</li>
</ul>
<h2 id="51-&#x7EBF;&#x6027;&#x56DE;&#x5F52;">5.1 &#x7EBF;&#x6027;&#x56DE;&#x5F52;</h2>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression, SGDRegressor
</code></pre>
<p>&#xFF08;Linear Regression&#xFF09;</p>
<p>&#x7EBF;&#x6027;&#x56DE;&#x5F52; (Linear regression) &#x662F;&#x5229;&#x7528;<strong>&#x56DE;&#x5F52;&#x65B9;&#x7A0B;(&#x51FD;&#x6570;)</strong>&#x5BF9;&#x4E00;&#x4E2A;&#x6216;<strong>&#x591A;&#x4E2A;&#x81EA;&#x53D8;&#x91CF;(&#x7279;&#x5F81;&#x503C;)&#x548C;&#x56E0;&#x53D8;&#x91CF;(&#x76EE;&#x6807;&#x503C;)&#x4E4B;&#x95F4;</strong>&#x5173;&#x7CFB;&#x8FDB;&#x884C;&#x5EFA;&#x6A21;&#x7684;&#x4E00;&#x79CD;&#x5206;&#x6790;&#x65B9;&#x5F0F;</p>
<h3 id="511-api">5.1.1 API</h3>
<h4 id="1&#xFF09;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;">1&#xFF09;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;</h4>
<p>  &#x6B63;&#x89C4;&#x65B9;&#x7A0B;&#x7684;&#x4F18;&#x5316;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x80FD;&#x89E3;&#x51B3;&#x62DF;&#x5408;&#x95EE;&#x9898;&#xFF0C;&#x4E00;&#x6B21;&#x6027;&#x6C42;&#x89E3;&#xFF0C;&#x9488;&#x5BF9;&#x5C0F;&#x6570;&#x636E;</p>
<ul>
<li><strong><em>LinearRegression(fit_intercept=True)</em></strong><ul>
<li><em>fit_intercept</em>&#xFF1A;&#x662F;&#x5426;&#x8BA1;&#x7B97;&#x504F;&#x7F6E;</li>
<li>&#x5C5E;&#x6027;<ul>
<li><em>LinearRegression.coef_</em>&#xFF1A;&#x6743;&#x91CD;&#x7CFB;&#x6570;&#xFF08;&#x56DE;&#x5F52;&#x7CFB;&#x6570;&#xFF09;</li>
<li><em>LinearRegression.intercept_</em>&#xFF1A;&#x504F;&#x7F6E;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2&#xFF09;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;">2&#xFF09;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;</h4>
<p>&#x5176;&#x5B9E;&#x662F;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;</p>
<ul>
<li><strong><em>SGDRegressor(loss=&quot;squared_loss&quot;, fit_intercept=True, learning_rate =&apos;invscaling&apos;, eta0=0.01)</em></strong><ul>
<li>SGDRegressor&#x7C7B;&#x5B9E;&#x73B0;&#x4E86;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x5B66;&#x4E60;&#xFF0C;&#x5B83;&#x652F;&#x6301;&#x4E0D;&#x540C;&#x7684;<strong>loss&#x51FD;&#x6570;&#x548C;&#x6B63;&#x5219;&#x5316;&#x60E9;&#x7F5A;&#x9879;</strong>&#x6765;&#x62DF;&#x5408;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#x6A21;&#x578B;&#x3002;</li>
<li><em>loss</em>&#xFF1A;&#x635F;&#x5931;&#x7C7B;&#x578B;<ul>
<li><strong>loss=&#x201D;squared_loss&#x201D;: &#x666E;&#x901A;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;</strong></li>
</ul>
</li>
<li><em>fit_intercept</em>&#xFF1A;&#x662F;&#x5426;&#x8BA1;&#x7B97;&#x504F;&#x7F6E;</li>
<li><em>learning_rate</em>&#xFF1A;string, optional<ul>
<li>&#x5B66;&#x4E60;&#x7387;&#x586B;&#x5145;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5E38;&#x6570;&#x503C;&#x7684;&#x5B66;&#x4E60;&#x7387;&#x6765;&#x8BF4;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;learning_rate=&#x2019;constant&#x2019; &#xFF0C;&#x5E76;&#x4F7F;&#x7528;eta0&#x6765;&#x6307;&#x5B9A;&#x5B66;&#x4E60;&#x7387;&#x3002;</li>
<li>&apos;constant&apos;&#xFF1A;eta = eta0</li>
<li>&apos;optimal&apos;&#xFF1A;eta = 1.0 / (alpha * (t + t0)) [default]</li>
<li>&apos;invscaling&apos;&#xFF1A;eta = eta0 / pow(t, power_t=0.25)</li>
</ul>
</li>
<li><em>max_iter</em>&#xFF1A;&#x8FED;&#x4EE3;&#x6B21;&#x6570;</li>
<li>&#x5C5E;&#x6027;<ul>
<li><em>SGDRegressor.coef_</em>&#xFF1A;&#x56DE;&#x5F52;&#x7CFB;&#x6570;</li>
<li><em>SGDRegressor.intercept_</em>&#xFF1A;&#x504F;&#x7F6E;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3&#xFF09;&#x5BF9;&#x6BD4;">3&#xFF09;&#x5BF9;&#x6BD4;</h4>
<table>
<thead>
<tr>
<th style="text-align:center">&#x68AF;&#x5EA6;&#x4E0B;&#x964D;</th>
<th style="text-align:center">&#x6B63;&#x89C4;&#x65B9;&#x7A0B;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x9700;&#x8981;&#x9009;&#x62E9;&#x5B66;&#x4E60;&#x7387;</td>
<td style="text-align:center">&#x4E0D;&#x9700;&#x8981;</td>
</tr>
<tr>
<td style="text-align:center">&#x9700;&#x8981;&#x8FED;&#x4EE3;&#x6C42;&#x89E3;</td>
<td style="text-align:center">&#x4E00;&#x6B21;&#x8FD0;&#x7B97;&#x5F97;&#x51FA;</td>
</tr>
<tr>
<td style="text-align:center">&#x7279;&#x5F81;&#x6570;&#x91CF;&#x8F83;&#x5927;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;</td>
<td style="text-align:center">&#x9700;&#x8981;&#x8BA1;&#x7B97;&#x65B9;&#x7A0B;&#xFF0C;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x9AD8;O(n3)</td>
</tr>
</tbody>
</table>
<h3 id="512-&#x56DE;&#x5F52;&#x6027;&#x80FD;&#x8BC4;&#x4F30;">5.1.2 &#x56DE;&#x5F52;&#x6027;&#x80FD;&#x8BC4;&#x4F30;</h3>
<h4 id="1&#xFF09;&#x5747;&#x65B9;&#x8BEF;&#x5DEE;-mse">1&#xFF09;&#x5747;&#x65B9;&#x8BEF;&#x5DEE; MSE</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error
</code></pre>
<p>&#x5747;&#x65B9;&#x8BEF;&#x5DEE;&#xFF08;Mean Squared Error&#xFF09;MSE &#x8BC4;&#x4EF7;&#x673A;&#x5236;</p>
<p><strong><em>mean_squared_error(y_test, y_pred)</em></strong></p>
<ul>
<li>&#x5747;&#x65B9;&#x8BEF;&#x5DEE;&#x56DE;&#x5F52;&#x635F;&#x5931;</li>
<li><em>y_test</em>&#xFF1A;&#x771F;&#x5B9E;&#x503C;</li>
<li><em>y_pred</em>&#xFF1A;&#x9884;&#x6D4B;&#x503C;</li>
<li><em>return</em>&#xFF1A;&#x6D6E;&#x70B9;&#x6570;&#x7ED3;&#x679C;</li>
</ul>
<h4 id="2&#xFF09;&#x5E73;&#x5747;&#x7EDD;&#x5BF9;&#x8BEF;&#x5DEE;-mae">2&#xFF09;&#x5E73;&#x5747;&#x7EDD;&#x5BF9;&#x8BEF;&#x5DEE; MAE</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_absolute_error
</code></pre>
<p><strong><em>mean_absolute_error(y_test, y_pred)</em></strong></p>
<ul>
<li>&#x5E73;&#x5747;&#x7EDD;&#x5BF9;&#x8BEF;&#x5DEE;&#x56DE;&#x5F52;&#x635F;&#x5931;</li>
<li><em>y_test</em>&#xFF1A;&#x771F;&#x5B9E;&#x503C;</li>
<li><em>y_pred</em>&#xFF1A;&#x9884;&#x6D4B;&#x503C;</li>
<li><em>return</em>&#xFF1A;&#x6D6E;&#x70B9;&#x6570;&#x7ED3;&#x679C;</li>
</ul>
<h3 id="513-&#x4F8B;">5.1.3 &#x4F8B;</h3>
<h4 id="1&#xFF09;&#x521D;&#x59CB;&#x5316;">1&#xFF09;&#x521D;&#x59CB;&#x5316;</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression, SGDRegressor
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error  <span class="hljs-comment"># &#x5747;&#x65B9;&#x8BEF;&#x5DEE;</span>

boston_data = load_boston()
print(<span class="hljs-string">&quot;&#x7279;&#x5F81;&#x6570;&#x91CF;&#x4E3A;:(&#x6837;&#x672C;&#x6570;,&#x7279;&#x5F81;&#x6570;)&quot;</span>, boston_data.data.shape)
x_train, x_test, y_train, y_test = train_test_split(boston_data.data,
                                                    boston_data.target, random_state=<span class="hljs-number">22</span>)
<span class="hljs-comment"># &#x6807;&#x51C6;&#x5316;</span>
transfer = StandardScaler()
x_train = transfer.fit_transform(x_train)
x_test = transfer.transform(x_test)
</code></pre>
<h4 id="2&#xFF09;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;">2&#xFF09;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;</h4>
<pre><code class="lang-python">estimator = LinearRegression()
estimator.fit(x_train, y_train)

print(<span class="hljs-string">&quot;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;: &quot;</span>, estimator.coef_)
print(<span class="hljs-string">&quot;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x504F;&#x7F6E;&#x4E3A;:&quot;</span>, estimator.intercept_)

y_predict = estimator.predict(x_test)
error = mean_squared_error(y_test, y_predict)
print(<span class="hljs-string">&quot;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x623F;&#x4EF7;&#x9884;&#x6D4B;:&quot;</span>, y_predict)
print(<span class="hljs-string">&quot;&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x5747;&#x5206;&#x8BEF;&#x5DEE;:&quot;</span>, error)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;:  [<span class="hljs-number">-0.64817766</span>  <span class="hljs-number">1.14673408</span> <span class="hljs-number">-0.05949444</span>  <span class="hljs-number">0.74216553</span> <span class="hljs-number">-1.95515269</span>  <span class="hljs-number">2.70902585</span>
 <span class="hljs-number">-0.07737374</span> <span class="hljs-number">-3.29889391</span>  <span class="hljs-number">2.50267196</span> <span class="hljs-number">-1.85679269</span> <span class="hljs-number">-1.75044624</span>  <span class="hljs-number">0.87341624</span>
 <span class="hljs-number">-3.91336869</span>]
&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x504F;&#x7F6E;&#x4E3A;: <span class="hljs-number">22.62137203166228</span>
&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x623F;&#x4EF7;&#x9884;&#x6D4B;: [<span class="hljs-number">28.22944896</span> <span class="hljs-number">31.5122308</span>  <span class="hljs-number">21.11612841</span> <span class="hljs-number">32.6663189</span>  <span class="hljs-number">20.0023467</span>  <span class="hljs-number">19.07315705</span>
 <span class="hljs-number">21.09772798</span> <span class="hljs-number">19.61400153</span> <span class="hljs-number">19.61907059</span> <span class="hljs-number">32.87611987</span> <span class="hljs-number">20.97911561</span> <span class="hljs-number">27.52898011</span>
 <span class="hljs-number">15.54701758</span> <span class="hljs-number">19.78630176</span> ......
 <span class="hljs-number">15.17700342</span>  <span class="hljs-number">3.81620663</span> <span class="hljs-number">29.18194848</span> <span class="hljs-number">20.68544417</span> <span class="hljs-number">22.32934783</span> <span class="hljs-number">28.01568563</span>
 <span class="hljs-number">28.58237108</span>]
&#x6B63;&#x89C4;&#x65B9;&#x7A0B;_&#x5747;&#x5206;&#x8BEF;&#x5DEE;: <span class="hljs-number">20.627513763095386</span>
</code></pre>
<h4 id="3&#xFF09;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;">3&#xFF09;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;</h4>
<pre><code class="lang-python">estimator = SGDRegressor(learning_rate=<span class="hljs-string">&quot;constant&quot;</span>, eta0=<span class="hljs-number">0.01</span>, max_iter=<span class="hljs-number">10000</span>)
<span class="hljs-comment"># estimator = SGDRegressor(penalty=&apos;l2&apos;, loss=&quot;squared_loss&quot;)  # &#x8FD9;&#x6837;&#x8BBE;&#x7F6E;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x5CAD;&#x56DE;&#x5F52;, &#x4F46;&#x662F;&#x5EFA;&#x8BAE;&#x7528;Ridge&#x65B9;&#x6CD5;</span>
estimator.fit(x_train, y_train)

print(<span class="hljs-string">&quot;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;: &quot;</span>, estimator.coef_)
print(<span class="hljs-string">&quot;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x504F;&#x7F6E;&#x4E3A;:&quot;</span>, estimator.intercept_)

y_predict = estimator.predict(x_test)
error = mean_squared_error(y_test, y_predict)
print(<span class="hljs-string">&quot;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x623F;&#x4EF7;&#x9884;&#x6D4B;:&quot;</span>, y_predict)
print(<span class="hljs-string">&quot;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x5747;&#x5206;&#x8BEF;&#x5DEE;:&quot;</span>, error)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;:  [<span class="hljs-number">-0.63057536</span>  <span class="hljs-number">1.10395195</span>  <span class="hljs-number">0.0426204</span>   <span class="hljs-number">1.11219718</span> <span class="hljs-number">-1.91486635</span>  <span class="hljs-number">2.72806163</span>
 <span class="hljs-number">-0.05021542</span> <span class="hljs-number">-3.52443232</span>  <span class="hljs-number">2.47863671</span> <span class="hljs-number">-1.62374879</span> <span class="hljs-number">-1.9093765</span>   <span class="hljs-number">1.08972091</span>
 <span class="hljs-number">-4.48569927</span>]
&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x504F;&#x7F6E;&#x4E3A;: [<span class="hljs-number">22.36660176</span>]
&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x623F;&#x4EF7;&#x9884;&#x6D4B;: [<span class="hljs-number">28.44139247</span> <span class="hljs-number">31.71808756</span> <span class="hljs-number">20.86031611</span> <span class="hljs-number">34.1638423</span>  <span class="hljs-number">19.35660167</span> <span class="hljs-number">19.18397968</span>
 <span class="hljs-number">20.97064914</span> <span class="hljs-number">18.87641833</span> <span class="hljs-number">18.87914517</span> ......
 <span class="hljs-number">14.57654182</span>  <span class="hljs-number">2.54082058</span> <span class="hljs-number">29.38973401</span> <span class="hljs-number">20.80732646</span> <span class="hljs-number">21.65598607</span> <span class="hljs-number">27.85659704</span>
 <span class="hljs-number">29.41864109</span>]
&#x68AF;&#x5EA6;&#x4E0B;&#x964D;_&#x5747;&#x5206;&#x8BEF;&#x5DEE;: <span class="hljs-number">20.997365545229272</span>
</code></pre>
<h2 id="52-&#x5CAD;&#x56DE;&#x5F52;">5.2 &#x5CAD;&#x56DE;&#x5F52;</h2>
<p>&#xFF08;Ridge Regression&#xFF09;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> Ridge, RidgeCV
</code></pre>
<p>&#x5CAD;&#x56DE;&#x5F52;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#x3002;&#x53EA;&#x4E0D;&#x8FC7;&#x5728;&#x7B97;&#x6CD5;&#x5EFA;&#x7ACB;&#x56DE;&#x5F52;&#x65B9;&#x7A0B;&#x65F6;&#x5019;&#xFF0C;&#x52A0;&#x4E0A;&#x6B63;&#x5219;&#x5316;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230;&#x89E3;&#x51B3;&#x8FC7;&#x62DF;&#x5408;&#x7684;&#x6548;&#x679C;</p>
<h3 id="521-&#x539F;&#x7406;">5.2.1 &#x539F;&#x7406;</h3>
<p>&#x6B63;&#x5219;&#x5316;&#x7C7B;&#x522B;</p>
<ul>
<li>L2 &#x6B63;&#x5219;&#x5316;<ul>
<li>&#x4F5C;&#x7528;&#xFF1A;&#x53EF;&#x4EE5;&#x4F7F;&#x5F97;&#x5176;&#x4E2D;&#x4E00;&#x4E9B; W &#x7684;&#x90FD;&#x5F88;&#x5C0F;&#xFF0C;&#x90FD;&#x63A5;&#x8FD1;&#x4E8E; 0&#xFF0C;&#x524A;&#x5F31;&#x67D0;&#x4E2A;&#x7279;&#x5F81;&#x7684;&#x5F71;&#x54CD;</li>
<li>&#x4F18;&#x70B9;&#xFF1A;&#x8D8A;&#x5C0F;&#x7684;&#x53C2;&#x6570;&#x8BF4;&#x660E;&#x6A21;&#x578B;&#x8D8A;&#x7B80;&#x5355;&#xFF0C;&#x8D8A;&#x7B80;&#x5355;&#x7684;&#x6A21;&#x578B;&#x5219;&#x8D8A;&#x4E0D;&#x5BB9;&#x6613;&#x4EA7;&#x751F;&#x8FC7;&#x62DF;&#x5408;&#x73B0;&#x8C61;</li>
<li>Ridge &#x56DE;&#x5F52;</li>
</ul>
</li>
<li>L1&#x6B63;&#x5219;&#x5316;<ul>
<li>&#x4F5C;&#x7528;&#xFF1A;&#x53EF;&#x4EE5;&#x4F7F;&#x5F97;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;W&#x7684;&#x503C;&#x76F4;&#x63A5;&#x4E3A;0&#xFF0C;&#x5220;&#x9664;&#x8FD9;&#x4E2A;&#x7279;&#x5F81;&#x7684;&#x5F71;&#x54CD;</li>
<li>LASSO &#x56DE;&#x5F52;</li>
</ul>
</li>
</ul>
<blockquote>
<p>&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#x7528;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;&#x5F53;&#x9884;&#x6D4B;&#x503C;&#x4E0E;&#x771F;&#x5B9E;&#x503C;&#x7684;&#x8BEF;&#x5DEE;&#x6EE1;&#x8DB3;&#x6B63;&#x6001;&#x5206;&#x5E03;&#x65F6;&#x7684;&#x6781;&#x5927;&#x4F3C;&#x7136;&#x4F30;&#x8BA1;&#xFF1B;&#x5CAD;&#x56DE;&#x5F52;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#xFF0C;&#x662F;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;+L2&#x8303;&#x6570;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;&#x5F53;&#x9884;&#x6D4B;&#x503C;&#x4E0E;&#x771F;&#x5B9E;&#x503C;&#x7684;&#x8BEF;&#x5DEE;&#x6EE1;&#x8DB3;&#x6B63;&#x6001;&#x5206;&#x5E03;&#xFF0C;&#x4E14;&#x6743;&#x91CD;&#x503C;&#x4E5F;&#x6EE1;&#x8DB3;&#x6B63;&#x6001;&#x5206;&#x5E03;&#xFF08;&#x5148;&#x9A8C;&#x5206;&#x5E03;&#xFF09;&#x65F6;&#x7684;&#x6700;&#x5927;&#x540E;&#x9A8C;&#x4F30;&#x8BA1;&#xFF1B;LASSO&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#xFF0C;&#x662F;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;+L1&#x8303;&#x6570;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;&#x7B49;&#x4EF7;&#x4E8E;&#x5F53;&#x9884;&#x6D4B;&#x503C;&#x4E0E;&#x771F;&#x5B9E;&#x503C;&#x7684;&#x8BEF;&#x5DEE;&#x6EE1;&#x8DB3;&#x6B63;&#x6001;&#x5206;&#x5E03;&#xFF0C;&#x4E14;&#x4E14;&#x6743;&#x91CD;&#x503C;&#x6EE1;&#x8DB3;&#x62C9;&#x666E;&#x62C9;&#x65AF;&#x5206;&#x5E03;&#xFF08;&#x5148;&#x9A8C;&#x5206;&#x5E03;&#xFF09;&#x65F6;&#x7684;&#x6700;&#x5927;&#x540E;&#x9A8C;&#x4F30;&#x8BA1;</p>
</blockquote>
<h3 id="522-api">5.2.2 API</h3>
<h4 id="1&#xFF09;&#x5E38;&#x89C4;&#x5CAD;&#x56DE;&#x5F52;">1&#xFF09;&#x5E38;&#x89C4;&#x5CAD;&#x56DE;&#x5F52;</h4>
<p><strong><em>Ridge(alpha=1.0, fit_intercept=True,solver=&quot;auto&quot;, normalize=False)</em></strong></p>
<ul>
<li><p>&#x5177;&#x6709; L2 &#x6B63;&#x5219;&#x5316;&#x7684;&#x7EBF;&#x6027;&#x56DE;&#x5F52;</p>
</li>
<li><p><em>alpha</em>&#xFF1A;&#x6B63;&#x5219;&#x5316;&#x529B;&#x5EA6;&#xFF0C;&#x4E5F;&#x53EB; &#x3BB;&#xFF0C;&#x5373;&#x60E9;&#x7F5A;&#x9879;&#x7CFB;&#x6570;</p>
<ul>
<li>&#x3BB;&#x53D6;&#x503C;&#xFF1A;0~1 1~10</li>
</ul>
</li>
<li><p><em>solver</em>&#xFF1A;&#x4F1A;&#x6839;&#x636E;&#x6570;&#x636E;&#x81EA;&#x52A8;&#x9009;&#x62E9;&#x4F18;&#x5316;&#x65B9;&#x6CD5;</p>
<ul>
<li><em>sag</em>&#xFF1A;&#x5982;&#x679C;&#x6570;&#x636E;&#x96C6;&#x3001;&#x7279;&#x5F81;&#x90FD;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x9009;&#x62E9;&#x8BE5;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x4F18;&#x5316;</li>
</ul>
</li>
<li><p><em>normalize</em>&#xFF1A;&#x6570;&#x636E;&#x662F;&#x5426;&#x8FDB;&#x884C;&#x6807;&#x51C6;&#x5316;</p>
<ul>
<li><code>normalize=False</code>&#xFF1A;&#x53EF;&#x4EE5;&#x5728; fit &#x4E4B;&#x524D;&#x8C03;&#x7528; preprocessing.StandardScaler &#x6807;&#x51C6;&#x5316;&#x6570;&#x636E;</li>
</ul>
</li>
<li><p>&#x5C5E;&#x6027;</p>
<ul>
<li><p><em>Ridge.coef_</em>&#xFF1A;&#x56DE;&#x5F52;&#x6743;&#x91CD;</p>
</li>
<li><p><em>Ridge.intercept_</em>&#xFF1A;&#x56DE;&#x5F52;&#x504F;&#x7F6E;</p>
</li>
</ul>
</li>
</ul>
<p>Ridge &#x65B9;&#x6CD5;&#x76F8;&#x5F53;&#x4E8E; <code>SGDRegressor(penalty=&apos;l2&apos;, loss=&quot;squared_loss&quot;)</code>, &#x53EA;&#x4E0D;&#x8FC7; SGDRegressor &#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x5B66;&#x4E60;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;Ridge(&#x5B9E;&#x73B0;&#x4E86;SAG)</p>
<h4 id="2&#xFF09;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x5CAD;&#x56DE;&#x5F52;">2&#xFF09;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x5CAD;&#x56DE;&#x5F52;</h4>
<p><strong><em>RidgeCV(_BaseRidgeCV, RegressorMixin)</em></strong></p>
<ul>
<li>&#x5177;&#x6709; L2 &#x6B63;&#x5219;&#x5316;&#x7684;&#x7EBF;&#x6027;&#x56DE;&#x5F52;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;</li>
<li><em>alphas</em>&#xFF1A;alpha &#x5217;&#x8868;</li>
<li><em>cv</em>&#xFF1A;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x6B21;&#x6570;</li>
<li><em>coef_</em>&#xFF1A;&#x56DE;&#x5F52;&#x7CFB;&#x6570;</li>
</ul>
<h3 id="523-&#x4F8B;">5.2.3 &#x4F8B;</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> Ridge, RidgeCV
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error  <span class="hljs-comment"># &#x5747;&#x65B9;&#x8BEF;&#x5DEE;</span>

boston_data = load_boston()
x_train, x_test, y_train, y_test = train_test_split(boston_data.data,
                                                    boston_data.target, random_state=<span class="hljs-number">22</span>)

<span class="hljs-comment"># &#x6807;&#x51C6;&#x5316;</span>
transfer = StandardScaler()
x_train = transfer.fit_transform(x_train)
x_test = transfer.transform(x_test)

<span class="hljs-comment"># &#x5CAD;&#x56DE;&#x5F52;</span>
estimator = Ridge(max_iter=<span class="hljs-number">10000</span>, alpha=<span class="hljs-number">0.5</span>)  <span class="hljs-comment"># &#x5CAD;&#x56DE;&#x5F52;</span>
<span class="hljs-comment"># estimator = RidgeCV(alphas=[0.1, 0.2, 0.3, 0.5])  # &#x52A0;&#x4E86;&#x4EA4;&#x53C9;&#x9A8C;&#x8BC1;&#x7684;&#x5CAD;&#x56DE;&#x5F52;</span>
estimator.fit(x_train, y_train)

print(<span class="hljs-string">&quot;&#x5CAD;&#x56DE;&#x5F52;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;: &quot;</span>, estimator.coef_)
print(<span class="hljs-string">&quot;&#x5CAD;&#x56DE;&#x5F52;_&#x504F;&#x7F6E;&#x4E3A;:&quot;</span>, estimator.intercept_)

y_predict = estimator.predict(x_test)
error = mean_squared_error(y_test, y_predict)
print(<span class="hljs-string">&quot;&#x5CAD;&#x56DE;&#x5F52;_&#x623F;&#x4EF7;&#x9884;&#x6D4B;:&quot;</span>, y_predict)
print(<span class="hljs-string">&quot;&#x5CAD;&#x56DE;&#x5F52;_&#x5747;&#x5206;&#x8BEF;&#x5DEE;:&quot;</span>, error)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x5CAD;&#x56DE;&#x5F52;_&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x4E3A;:  [<span class="hljs-number">-0.64193209</span>  <span class="hljs-number">1.13369189</span> <span class="hljs-number">-0.07675643</span>  <span class="hljs-number">0.74427624</span> <span class="hljs-number">-1.93681163</span>  <span class="hljs-number">2.71424838</span>
 <span class="hljs-number">-0.08171268</span> <span class="hljs-number">-3.27871121</span>  <span class="hljs-number">2.45697934</span> <span class="hljs-number">-1.81200596</span> <span class="hljs-number">-1.74659067</span>  <span class="hljs-number">0.87272606</span>
 <span class="hljs-number">-3.90544403</span>]
&#x5CAD;&#x56DE;&#x5F52;_&#x504F;&#x7F6E;&#x4E3A;: <span class="hljs-number">22.62137203166228</span>
&#x5CAD;&#x56DE;&#x5F52;_&#x623F;&#x4EF7;&#x9884;&#x6D4B;: [<span class="hljs-number">28.22536271</span> <span class="hljs-number">31.50554479</span> <span class="hljs-number">21.13191715</span> <span class="hljs-number">32.65799504</span> <span class="hljs-number">20.02127243</span> <span class="hljs-number">19.07245621</span>
 <span class="hljs-number">21.10832868</span> <span class="hljs-number">19.61646071</span> .....<span class="hljs-number">.15</span><span class="hljs-number">.19441045</span>  <span class="hljs-number">3.81755887</span> <span class="hljs-number">29.1743764</span>  <span class="hljs-number">20.68219692</span> <span class="hljs-number">22.33163756</span> <span class="hljs-number">28.01411044</span>
 <span class="hljs-number">28.55668351</span>]
&#x5CAD;&#x56DE;&#x5F52;_&#x5747;&#x5206;&#x8BEF;&#x5DEE;: <span class="hljs-number">20.641771606180914</span>
</code></pre>
<h1 id="&#x516D;&#x3001;&#x805A;&#x7C7B;">&#x516D;&#x3001;&#x805A;&#x7C7B;</h1>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> KMeans
</code></pre>
<p>K-means&#xFF08;K&#x5747;&#x503C;&#x805A;&#x7C7B;&#xFF09;</p>
<ul>
<li>&#x7279;&#x70B9;&#xFF1A;&#x91C7;&#x7528;&#x8FED;&#x4EE3;&#x5F0F;&#x7B97;&#x6CD5;&#xFF0C;&#x76F4;&#x89C2;&#x6613;&#x61C2;&#x5E76;&#x4E14;&#x975E;&#x5E38;&#x5B9E;&#x7528;</li>
<li>&#x7F3A;&#x70B9;&#xFF1A;&#x5BB9;&#x6613;&#x6536;&#x655B;&#x5230;&#x5C40;&#x90E8;&#x6700;&#x4F18;&#x89E3;(&#x591A;&#x6B21;&#x805A;&#x7C7B;)</li>
</ul>
<h2 id="61-&#x805A;&#x7C7B;&#x6B65;&#x9AA4;">6.1 &#x805A;&#x7C7B;&#x6B65;&#x9AA4;</h2>
<ol>
<li><p>&#x968F;&#x673A;&#x8BBE;&#x7F6E; K &#x4E2A;&#x7279;&#x5F81;&#x7A7A;&#x95F4;&#x5185;&#x7684;&#x70B9;&#x4F5C;&#x4E3A;&#x521D;&#x59CB;&#x7684;&#x805A;&#x7C7B;&#x4E2D;&#x5FC3;</p>
</li>
<li><p>&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x6BCF;&#x4E2A;&#x70B9;&#x8BA1;&#x7B97;&#x5230; K &#x4E2A;&#x4E2D;&#x5FC3;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x672A;&#x77E5;&#x7684;&#x70B9;&#x9009;&#x62E9;&#x6700;&#x8FD1;&#x7684;&#x4E00;&#x4E2A;&#x805A;&#x7C7B;&#x4E2D;&#x5FC3;&#x70B9;&#x4F5C;&#x4E3A;&#x6807;&#x8BB0;&#x7C7B;&#x522B;</p>
</li>
<li><p>&#x63A5;&#x7740;&#x5BF9;&#x7740;&#x6807;&#x8BB0;&#x7684;&#x805A;&#x7C7B;&#x4E2D;&#x5FC3;&#x4E4B;&#x540E;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x51FA;&#x6BCF;&#x4E2A;&#x805A;&#x7C7B;&#x7684;&#x65B0;&#x4E2D;&#x5FC3;&#x70B9;&#xFF08;&#x5E73;&#x5747;&#x503C;&#xFF09;</p>
</li>
<li><p>&#x5982;&#x679C;&#x8BA1;&#x7B97;&#x5F97;&#x51FA;&#x7684;&#x65B0;&#x4E2D;&#x5FC3;&#x70B9;&#x4E0E;&#x539F;&#x4E2D;&#x5FC3;&#x70B9;&#x4E00;&#x6837;&#xFF0C;&#x90A3;&#x4E48;&#x7ED3;&#x675F;&#xFF0C;&#x5426;&#x5219;&#x91CD;&#x65B0;&#x8FDB;&#x884C;&#x7B2C;&#x4E8C;&#x6B65;&#x8FC7;&#x7A0B;</p>
</li>
</ol>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/K-means&#x8FC7;&#x7A0B;&#x5206;&#x6790;.png" alt="K-means&#x8FC7;&#x7A0B;&#x5206;&#x6790;" style="zoom:67%;"></p>
<h2 id="62-api">6.2 API</h2>
<p><strong><em>KMeans(n_clusters=8, init=&#x2018;k-means++&#x2019;&#x2026;)</em></strong></p>
<ul>
<li>n_clusters&#xFF1A;&#x5F00;&#x59CB;&#x7684;&#x805A;&#x7C7B;&#x4E2D;&#x5FC3;&#x6570;&#x91CF;</li>
<li>init&#xFF1A;&#x521D;&#x59CB;&#x5316;&#x65B9;&#x6CD5;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;&apos;k-means ++&#x2019;</li>
</ul>
<p><em>KMeans.labels_</em>&#xFF1A;&#x9ED8;&#x8BA4;&#x6807;&#x8BB0;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x53EF;&#x4EE5;&#x548C;&#x771F;&#x5B9E;&#x503C;&#x6BD4;&#x8F83;&#xFF08;&#x4E0D;&#x662F;&#x503C;&#x6BD4;&#x8F83;&#xFF09;</p>
<h2 id="63--&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;">6.3  &#x8F6E;&#x5ED3;&#x7CFB;&#x6570;</h2>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> silhouette_score
</code></pre>
<p>&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x4F5C;&#x4E3A; Kmeans &#x7684;&#x6027;&#x80FD;&#x8BC4;&#x4F30;&#x6307;&#x6807;</p>
<h3 id="631-&#x516C;&#x5F0F;">6.3.1 &#x516C;&#x5F0F;</h3>
<p>$$
sc_i=\cfrac{b_i-a_i}{max(b_i,a_i)}</p>
<p>$$</p>
<blockquote>
<p>&#x6CE8;&#xFF1A;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x70B9; $i$ &#x4E3A;&#x5DF2;&#x805A;&#x7C7B;&#x6570;&#x636E;&#x4E2D;&#x7684;&#x6837;&#x672C; &#xFF0C;$b_i$ &#x4E3A; $i$ &#x5230;&#x5176;&#x5B83;&#x65CF;&#x7FA4;&#x7684;&#x6240;&#x6709;&#x6837;&#x672C;&#x7684;&#x8DDD;&#x79BB;&#x6700;&#x5C0F;&#x503C;&#xFF0C;$a_i$ &#x4E3A; $i$ &#x5230;&#x672C;&#x8EAB;&#x7C07;&#x7684;&#x8DDD;&#x79BB;&#x5E73;&#x5747;&#x503C;&#x3002;&#x6700;&#x7EC8;&#x8BA1;&#x7B97;&#x51FA;&#x6240;&#x6709;&#x7684;&#x6837;&#x672C;&#x70B9;&#x7684;&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x5E73;&#x5747;&#x503C;</p>
</blockquote>
<h3 id="632-&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x503C;&#x5206;&#x6790;">6.3.2 &#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x503C;&#x5206;&#x6790;</h3>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/image-20210118223723565.png" alt="image-20210118223723565" style="zoom: 60%;"></p>
<p><strong>&#x5206;&#x6790;&#x8FC7;&#x7A0B;</strong>&#xFF08;&#x4EE5;&#x4E00;&#x4E2A;&#x84DD;1&#x70B9;&#x4E3A;&#x4F8B;&#xFF09;</p>
<ol>
<li><p>&#x8BA1;&#x7B97;&#x51FA;&#x84DD;1&#x79BB;&#x672C;&#x8EAB;&#x65CF;&#x7FA4;&#x6240;&#x6709;&#x70B9;&#x7684;&#x8DDD;&#x79BB;&#x7684;&#x5E73;&#x5747;&#x503C;$a_i$</p>
</li>
<li><p>&#x84DD;1&#x5230;&#x5176;&#x5B83;&#x4E24;&#x4E2A;&#x65CF;&#x7FA4;&#x7684;&#x8DDD;&#x79BB;&#x8BA1;&#x7B97;&#x51FA;&#x5E73;&#x5747;&#x503C;&#x7EA2;&#x5E73;&#x5747;&#xFF0C;&#x7EFF;&#x5E73;&#x5747;&#xFF0C;&#x53D6;&#x6700;&#x5C0F;&#x7684;&#x90A3;&#x4E2A;&#x8DDD;&#x79BB;&#x4F5C;&#x4E3A;$b_i$</p>
</li>
<li><p>&#x6839;&#x636E;&#x516C;&#x5F0F;&#xFF1A;&#x6781;&#x7AEF;&#x503C;&#x8003;&#x8651;&#xFF1A;&#x5982;&#x679C;$b_i &gt;&gt;a_i$&#xFF0C;&#x90A3;&#x4E48;&#x516C;&#x5F0F;&#x7ED3;&#x679C;&#x8D8B;&#x8FD1;&#x4E8E;1&#xFF1B;&#x5982;&#x679C;$a_i&gt;&gt;&gt;b_i$&#xFF0C;&#x90A3;&#x4E48;&#x516C;&#x5F0F;&#x7ED3;&#x679C;&#x8D8B;&#x8FD1;&#x4E8E;-1</p>
</li>
</ol>
<p><strong>&#x7ED3;&#x8BBA;</strong>&#xFF1A;&#x5982;&#x679C;$b_i&gt;&gt;a_i$&#xFF0C;&#x8D8B;&#x8FD1;&#x4E8E;1&#xFF0C;&#x6548;&#x679C;&#x597D;&#xFF0C; $b_i&lt;&lt;a_i$&#xFF0C;&#x8D8B;&#x8FD1;&#x4E8E;-1&#xFF0C;&#x6548;&#x679C;&#x4E0D;&#x597D;&#x3002;&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x7684;&#x503C;&#x662F;&#x4ECB;&#x4E8E; [-1,1] &#xFF0C;&#x8D8A;&#x8D8B;&#x8FD1;&#x4E8E;1&#x4EE3;&#x8868;&#x5185;&#x805A;&#x5EA6;&#x548C;&#x5206;&#x79BB;&#x5EA6;&#x90FD;&#x76F8;&#x5BF9;&#x8F83;&#x4F18;</p>
<h3 id="633-api">6.3.3 API</h3>
<ul>
<li><strong><em>silhouette_score(X, labels)</em></strong>&#xFF1A;&#x8BA1;&#x7B97;&#x6240;&#x6709;&#x6837;&#x672C;&#x7684;&#x5E73;&#x5747;&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;<ul>
<li>X&#xFF1A;&#x7279;&#x5F81;&#x503C;</li>
<li>labels&#xFF1A;&#x88AB;&#x805A;&#x7C7B;&#x6807;&#x8BB0;&#x7684;&#x76EE;&#x6807;&#x503C;&#xFF08;&#x805A;&#x7C7B;&#x7ED3;&#x679C;&#xFF09;</li>
</ul>
</li>
</ul>
<h2 id="64-&#x4F8B;">6.4 &#x4F8B;</h2>
<p>&#x5206;&#x6790;</p>
<ol>
<li><p>&#x964D;&#x7EF4;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x636E;</p>
</li>
<li><p>k-means&#x805A;&#x7C7B;</p>
</li>
<li><p>&#x805A;&#x7C7B;&#x7ED3;&#x679C;&#x663E;&#x793A;</p>
</li>
<li>&#x7528;&#x6237;&#x805A;&#x7C7B;&#x7ED3;&#x679C;&#x8BC4;&#x4F30;</li>
</ol>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
%matplotlib inline
<span class="hljs-keyword">from</span> sklearn.datasets.samples_generator <span class="hljs-keyword">import</span> make_blobs
<span class="hljs-comment"># X&#x4E3A;&#x6837;&#x672C;&#x7279;&#x5F81;&#xFF0C;Y&#x4E3A;&#x6837;&#x672C;&#x7C07;&#x7C7B;&#x522B;&#xFF0C; &#x5171;1000&#x4E2A;&#x6837;&#x672C;&#xFF0C;&#x6BCF;&#x4E2A;&#x6837;&#x672C;2&#x4E2A;&#x7279;&#x5F81;&#xFF0C;&#x5171;4&#x4E2A;&#x7C07;&#xFF0C;&#x7C07;&#x4E2D;&#x5FC3;&#x5728;[-1,-1], [0,0],[1,1], [2,2]&#xFF0C; &#x7C07;&#x65B9;&#x5DEE;&#x5206;&#x522B;&#x4E3A;[0.4, 0.2, 0.2]</span>
X, y = make_blobs(n_samples=<span class="hljs-number">1000</span>, n_features=<span class="hljs-number">2</span>, centers=[[<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>], [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]], cluster_std=[<span class="hljs-number">0.4</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>])
plt.scatter(X[:, <span class="hljs-number">0</span>], X[:, <span class="hljs-number">1</span>], marker=<span class="hljs-string">&apos;o&apos;</span>)
plt.show()
</code></pre>
<p>&#x6848;&#x4F8B;&#x6837;&#x672C;</p>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/image-20210119103734104.png" alt="image-20210119103734104" style="zoom:67%;"></p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> KMeans

<span class="hljs-comment">#y_pred = KMeans(n_clusters=4).fit_predict(X)</span>
estimator = KMeans(n_clusters=<span class="hljs-number">4</span>, init=<span class="hljs-string">&apos;k-means++&apos;</span>)
estimator.fit(X)
y_pred = estimator.predict(X)

plt.scatter(X[:, <span class="hljs-number">0</span>], X[:, <span class="hljs-number">1</span>], c=y_pred)
plt.show()
</code></pre>
<p><img src="https://trou.oss-cn-shanghai.aliyuncs.com/img/image-20210119104047678.png" alt="image-20210119104047678" style="zoom:67%;"></p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> silhouette_score 

score = silhouette_score(X, y_pred)
print(<span class="hljs-string">&quot;&#x6A21;&#x578B;&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x4E3A;(1 &#x6700;&#x597D;, -1 &#x6700;&#x5DEE;):&quot;</span>, score)
</code></pre>
<p>&#x8F93;&#x51FA;</p>
<pre><code class="lang-python">&#x6A21;&#x578B;&#x8F6E;&#x5ED3;&#x7CFB;&#x6570;&#x4E3A;(<span class="hljs-number">1</span> &#x6700;&#x597D;, <span class="hljs-number">-1</span> &#x6700;&#x5DEE;): <span class="hljs-number">0.6634549555891298</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"sklearn","level":"1.4.4.1","depth":3,"next":{"title":"后端","level":"1.4.5","depth":2,"ref":"","articles":[{"title":"Django","level":"1.4.5.1","depth":3,"path":"Python/WEB backend/Django.md","ref":"Python/WEB backend/Django.md","articles":[]},{"title":"FastAPI","level":"1.4.5.2","depth":3,"path":"Python/WEB backend/FastAPI.md","ref":"Python/WEB backend/FastAPI.md","articles":[]},{"title":"Flask","level":"1.4.5.3","depth":3,"path":"Python/WEB backend/Flask.md","ref":"Python/WEB backend/Flask.md","articles":[]},{"title":"sqlalchemy","level":"1.4.5.4","depth":3,"path":"Python/WEB backend/sqlalchemy.md","ref":"Python/WEB backend/sqlalchemy.md","articles":[]}]},"previous":{"title":"[机器学习()","level":"1.4.4","depth":2,"ref":"","articles":[{"title":"sklearn","level":"1.4.4.1","depth":3,"path":"Python/MachineLearning/sklearn.md","ref":"Python/MachineLearning/sklearn.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Python/MachineLearning/sklearn.md","mtime":"2021-06-18T07:00:12.428Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-06-18T08:32:50.643Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

