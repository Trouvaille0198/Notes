# 概述

互联网：专有名词

互连网：通用网络

## 互联网的组成

### 边缘部分

由所有连接在互联网上的主机组成。这部分是用户直接使用的，用来进行通信（传送数据、音频或视频）和资源共享。

#### 端系统之间的两种通信方式

- **客户-服务器方式**（C/S）

    客户是服务的请求方，服务器是服务的提供方

    <img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/914894c2-0bc4-46b5-bef9-0316a69ef521.jpg" alt="img" style="zoom:67%;" />

    - 客户软件的特点
        1. 被用户调用后运行，在打算通信时主动向远地服务器发起通信（请求服务）。因此，**客户程序必须知道服务器程序的地址**
        2. 不需要特殊的硬件和很复杂的操作系统
    - 服务器软件的特点
        1. 一种专门用来提供某种服务的程序，可同时处理多个远地或本地客户的请求
        2. 系统启动后即自动调用并一直不断地运行着，被动地等待并接受来自各地的客户的通信请求。因此，**服务器程序不需要知道客户程序的地址**
        3. 一般需要强大的硬件和高级的操作系统支持

- **对等方式**（P2P）

    不区分客户和服务器。

    <img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/42430e94-3137-48c0-bdb6-3cebaf9102e3.jpg" alt="img" style="zoom:67%;" />



### 核心部分

由大量网络和连接这些网络的路由器组成。这部分是为边缘部分提供服务的（提供连通性和交换）

- 在网络核心部分起特殊作用的是**路由器** (router)。

- 路由器是实现**分组交换** (packet switching) 的关键构件，其任务是转发收到的分组，这是网络核心部分最重要的功能。
- 分组交换是网络核心部分最重要的功能

#### 电路交换

$$N$$ 部电话机两两直接相连，需 $$N(N – 1)/2$$ 对电线。这种直接连接方法所需要的电线对的数量与电话机数量的平方（ $$N^2$$ ）成正比。

当电话机的数量增多时，就要使用**交换机**来完成全网的分组任务，这就是电路交换

- 特点
    1. 电路交换必定是面向连接的
    2. 电路交换分为三个阶段：
        1. 建立连接：建立一条专用的物理通路，以保证双方通话时所需的通信资源在通信时不会被其他用户占用；
        2. 通话：主叫和被叫双方一直占用通信资源；
        3. 释放连接：释放刚才使用的这条专用的物理通路（释放刚才占用的所有通信资源）
- 总结

电路交换用于电话通信系统，两个用户要通信之前需要建立一条专用的物理链路，并且在整个通信过程中始终占用该链路。由于通信的过程中不可能一直在使用传输线路，因此电路交换对线路的利用率很低，往往不到 10%

#### 分组交换

分组交换采用**存储转发**技术

- **步骤**
    1. 在发送端，先把较长的报文划分成较短的、固定长度的数据段
    2. 每一个数据段前面添加上**首部**构成分组 (packet)
    3. 分组交换网以“分组”（也称为“包”，首部也可称为“包头”）作为数据传输单元，依次把各分组发送到接收端（假定接收端在左边）
    4. 接收端收到分组后剥去首部还原成报文
    5. 最后，在接收端把收到的数据恢复成为原来的报文。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210330090825113.png" alt="image-20210330090825113" style="zoom: 33%;" />

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210330090845396.png" alt="image-20210330090845396" style="zoom:33%;" />

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210330090900606.png" alt="image-20210330090900606" style="zoom:33%;" />

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210330090922592.png" alt="image-20210330090922592" style="zoom:33%;" />

- **首部的重要性**
    - 每一个分组的首部都含有地址（诸如目的地址和源地址）等控制信息。
    - 分组交换网中的结点交换机根据收到的分组首部中的地址信息，把分组转发到下一个结点交换机。
    - 每个分组在互联网中独立地选择传输路径。（通过路由器）
    - 用这样的存储转发方式，最后分组就能到达最终目的地。
- **路由器的作用**
    - 在路由器中的输入和输出端口之间没有直接连线。
    - 路由器处理分组的过程是：
        1. 把收到的分组先放入缓存（暂时存储）；
        2. 查找转发表，找出到某个目的地址应从哪个端口转发；
        3. 把分组送到适当的端口转发出去。
- **优点**
    - 高效：在分组传输的过程中动态分配传输带宽，对通信链路是逐段占用
    - 灵活：为每一个分组独立地选择最合适的转发路由
    - 迅速：以分组作为传送单位，可以不先建立连接就能向其他主机发送分组。
    - 可靠：保证可靠性的网络协议；分布式多路由的分组交换网，使网络有很好的生存性
- 缺点
    - 分组在各结点存储转发时需要排队，这就会造成一定的**时延**。
    - 分组必须携带的首部（里面有必不可少的控制信息）也造成了一定的开销
- **总结**

每个分组都有首部和尾部，包含了源地址和目的地址等控制信息，在同一个传输线路上同时传输多个分组互相不会影响，因此在同一条传输线路上允许同时传输多个分组，也就是说分组交换不需要占用传输线路。

在一个邮局通信系统中，邮局收到一份邮件之后，先存储下来，然后把相同目的地的邮件一起转发到下一个目的地，这个过程就是存储转发过程，分组交换也使用了存储转发过程。

#### 报文交换

在 20 世纪 40 年代，电报通信也采用了基于存储转发原理的报文交换 (message switching)。

报文交换的时延较长，从几分钟到几小时不等。现在报文交换已经很少有人使用了。

#### 三种交换的比较

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210330092542877.png" alt="image-20210330092542877" style="zoom: 50%;" />

### 核心与边缘

- 互联网的核心部分是由许多网络和把它们互连起来的路由器组成，而主机处在互联网的边缘部分。
- 互联网核心部分中的路由器之间一般都用高速链路相连接，而在网络边缘的主机接入到核心部分则通常以相对较低速率的链路相连接。
- 主机的用途是为用户进行信息处理的，并且可以和其他主机通过网络交换信息。路由器的用途则是用来转发分组的，即进行分组交换的。

## 计算机网络的分类

### 按照网络的作用范围进行分类

- **广域网 WAN** (Wide Area Network)：作用范围通常为几十到几千公里（跨越国家），是互联网的核心部分。
- **城域网 MAN** (Metropolitan Area Network)：作用距离约为 5 ~ 50 公里（几个街区甚至整个城市）。
- **局域网 LAN** (Local Area Network) ：局限在较小的范围（如 1 公里左右），校园网或企业网。
- **个人区域网 PAN** (Personal Area Network) ：范围很小，大约在 10 米左右，通过无线技术连接。

### 按照网络的使用者进行分类

- **公用网** (public network)

    电信公司建造的大型网络。按 规定交纳费用的人都
    可以 使用的 网络。因此也可称为公众网。

- **专用网** (private network)

    某个单位 为特殊业务工作的需要而建造的网络 ，例
    如军队、铁路、银行、电力等系统。

### 用来把用户接入到互联网的网络

- **接入网 AN** (Access Network)

    又称为本地接入网或居民接入网。

    接入网是一类比较特殊的计算机网络 ，用于将用户接入互联网。 只是起到让用户能够与互联网连接的“桥梁”作用。

    使用不同接入网技术，如电话线拨号、宽带

    接入网本身既不属于互联网的核心部分，也不属于互联网的边缘部分。

    接入网是从某个用户端系统到互联网中的第一个路由器（也称为边缘路由器）之间的一种网络。

    从覆盖的范围看，很多接入网还是属于局域网。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402101159250.png" alt="image-20210402101159250" style="zoom: 50%;" />

## 计算机网络的性能

### 性能指标

#### 速率

连接在计算机网络上的主机在数字信道上传送数据位数的速率，也称为数据率 (data rate) 或比特率 (bit)

速率的单位是 bit/s ，或 kbit /s 、 Mbit/s 、 Gbit /s 等。例如 $$4 \times 10^{10} bit/s$$ 的数据率就记为 40 Gbit /s 。


#### 带宽

带宽 (bandwidth) 用来表示网络中某通道传送数据的能力 。 表示在单位时间内网络中的某信道所能通过的“ **最高数据率** ”。

更常用的带宽单位是

- 千比特每秒 ，即 kb/s (10^3^ b/s )
- 兆比特每秒 ，即 Mb/s (10 ^6^ b/s )
- 吉比特每秒 ，即 Gb/s (10^9^ b/s )
- 太比特每秒 ，即 Tb/s (10^12^ b/s )

#### 吞吐量

吞吐量 (throughput) 表示在单位时间内通过某个网络（或信道、接口）的数据量，包括进和出

#### 时延

时延 (delay 或 latency) 是指数据（一个报文或分组，甚至比特）从网络（或链路）的一端传送到另一端所需的时间

有时也称为延迟或迟延

网络中的时延由以下几个不同的部分组成

1. 发送时延

    发送数据时，数据帧从结点进入到传输媒体所需要的时间。

    也就是从发送数据帧的第一个比特算起，到该帧的最后一个比特发送完毕所需的时间。

    发送时延 = 数据帧长度 (bit) / 发送速率（bit/s)

2. 传播时延

    电磁波在信道中需要传播一定的距离而花费的时间。

    传播时延 = 信道长度（米) / 信号在信道上的传播速率 (米/秒)

3. 处理时延

    主机或路由器在收到分组时，为处理分组（例如分析首部、提取数据、差错检验或查找路由 ）所花费的时间

4. 排队时延

    分组在路由器输入、输出队列中排队等待处理所经历的时延。

    排队时延的长短往往取决于网络中当时的通信量。

    队列溢出时，相当于排队时延无限大。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402102835716.png" alt="image-20210402102835716" style="zoom: 40%;" />

#### 时延带宽积

链路的时延带宽积又称为以比特为单位的链路长度。

时延带宽积 = 传播时延 × 带宽

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402103609371.png" alt="image-20210402103609371" style="zoom:40%;" />

#### 往返时间 RTT

(Round Trip Time)

往返时间 表示从发送方发送数据开始，到发送方收到来自接收方的确认，总共经历的时间。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402103729831.png" alt="image-20210402103729831" style="zoom: 35%;" />



#### 利用率

- **信道利用率**

    指出某信道有百分之几的时间是被利用的（有数据通过）。完全空闲的信道的利用率是零。

- **网络利用率** 

    全网络的信道利用率的加权平均值。

信道利用率并非越高越好。 当某信道的利用率增大时，该信道引起的时延也就迅速增加 。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402103941538.png" alt="image-20210402103941538" style="zoom:33%;" />

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402104133315.png" alt="image-20210402104133315" style="zoom:33%;" />

### 非性能特征

（nonperformance characteristics）

费用 (cost)

质量 (quality of service) (QoS)

标准化

可靠性 (reliability)

可扩展性 (scalability)和可升级性 (upgradability)

易于管理和维护

## 计算机网络的体系结构

（协议分层）TCP/IP、OSI、五层

### 计算机网络体系结构的形成

开放系统互连基本参考模型 OSI/RM (Open Systems Interconnection Reference Model) Model)，简称为 OSI 。

法律上的 (de jure) 国际标准 OSI 并没有得到市场的认可，非国际标准 TCP/IP 却获得了最广泛的应用。TCP/IP 常被称为 事实上的 (de facto) 国际标准

### 协议与划分层次

网络协议 (network protocol)，简称为协议，是为进行网络中的数据交换而建立的规则、标准或约定。

#### 网络协议的三个组成要素

- **语法**： 数据与控制信息的结构或格式 。
- **语义**： 需要发出何种控制信息，完成何种动作以及做出何种响应。
- **同步**： 事件实现顺序的详细说明。

#### 层次式协议结构

划分层次的概念举例：主机 1 向主机 2 通过网络发送文件。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402110300736.png" alt="image-20210402110300736" style="zoom: 33%;" />

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402110317587.png" alt="image-20210402110317587" style="zoom:33%;" />

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402110340122.png" alt="image-20210402110340122" style="zoom:33%;" />

**分层的优劣**

- 优点
    - 各层之间是独立的。
    - 灵活性好。
    - 结构上可分割开。
    - 易于实现和维护。
    - 能促进标准化工作。

- 缺点
    - 降低效率
    - 有些功能会在不同的层次中重复出现，因而产生了额外开销 。

**层数控制**

层数太少，就会使每一层的协议太复杂。

层数太多，又会在描述和综合各层功能的系统工程任务时遇到较多的困难。

**各层完成的主要功能**

1. 差错控制：使相应层次对等方的通信更加可靠。
2. 流量控制：发送端的发送速率必须使接收端来得及接收，不要太快。
3. 分段和重装：发送端将要发送的数据块划分为更小的单位，在接收端将其还原。
4. 复用和分用：发送端几个高层会话复用一条低层的连接，在接收端再进行分用。
5. 连接建立和释放：交换数据前先建立一条逻辑连接，数据传送结束后释放连接。

#### 计算机网络的体系结构

**计算机网络的体系结构** (architecture) 是计算机网络的各层及其协议的集合。

体系结构就是这个计算机网络及其部件 所应完成的功能的精确定义。

**实现** (implementation) 是遵循这种体系结构的前提下用何种硬件或软件完成这些功能的问题。

体系结构是抽象的，而实现则是具体的，是真正在运行的计算机硬件和软件。

### 具有五层协议的体系结构

采取折中的办法，即综合 OSI 和 TCP/IP 的优点，采用一种只有五层协议的体系结构

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/0fa6c237-a909-4e2a-a771-2c5485cd8ce0.png" alt="img" style="zoom:67%;" />

#### 应用层 (application layer)

通过应用进程间的交互来完成特定网络应用

域名系统 DNS ，万维网 HTTP 协议，电子邮件 SMTP 协议

#### 运输层 (transport layer)

向两台主机中进程之间的通信提供通用的数据传输服务

传输控制协议 TCP 、用户数据报协议 UDP

#### 网络层 (network layer)

为分组交换网上的不同主机提供通信服务；选择合适的路由

网际协议 IP 和路由选择协议

#### 数据链路层 (data link layer)

两个相邻节点之间传送数据

#### 物理层 (physical layer)

传输数据单位为比特，要考虑多大的电压代表 1 或 0

不包含物理媒介

### 实体、协议、服务和服务访问点

**实体** (entity) 表示任何可发送或接收信息的硬件或软件进程。

**协议**是控制两个对等实体进行通信的规则的集合。

语法规则定义了信息的格式，语义规则定义了发送者或接收者所要完成的操作

在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务。

要实现本层协议，还需要使用下层所提供的服务

#### 协议和服务的关系

协议的实现保证了能够向上一层提供服务 。

本层的服务用户只能看见服务而无法看见下面的协议。即下面的协议对上面的服务用户是透明的。

- 协议 是 “水平的 ”，即协议是控制对等实体之间通信的规则。

- 服务 是 “垂直的 ”，即服务是由下层向上层通过层间接口提供的。

上层使用下层提供的服务必须通过**服务原语**。

#### 服务访问点

同一系统相邻两层的实体进行交互的地方，称为**服务访问点 SAP** (Service Access Point) 。

服务访问点 SAP 是一个抽象的概念，它实际上就是一个逻辑接口 。

OSI 把层与层之间交换的数据的单位称为服务数据单元 SDU (Service Data)。

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402112931105.png" alt="image-20210402112931105" style="zoom:40%;" />

### TCP/IP 的体系结构

它只有四层，相当于五层协议中数据链路层和物理层合并为网络接口层。

TCP/IP 体系结构不严格遵循 OSI 分层概念，应用层可能会直接使用 IP 层或者网络接口层

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/48d79be8-085b-4862-8a9d-18402eb93b31.png" alt="img" style="zoom: 80%;" />

#### 沙漏型协议族

IP over everything

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210402113442576.png" alt="image-20210402113442576" style="zoom:33%;" />

