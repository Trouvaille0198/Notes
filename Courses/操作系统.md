# 操作系统

## 操作系统引论

### 操作系统概念

#### 定义

计算机系统中的一个系统软件，是程序模块的集合

（有效、合理、方便）

#### 目标

- 方便性
- 有效性：提高系统资源利用率、提高系统吞吐量
- 可扩充性
- 开放性：软硬件兼容

#### 作用

##### 作为用户与硬件之间的接口

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210909110517642.png" alt="image-20210909110517642" style="zoom:50%;" />

##### 计算机系统资源的管理者

硬件资源

软件资源

##### 实现了对计算机资源的抽象

覆盖了一系列软件（I/O 操作命令、文件管理等）后成为虚机器

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210909111006452.png" alt="image-20210909111006452" style="zoom: 50%;" />

#### 推动 OS 发展的动力

- 不断提高计算机资源利用率
- 方便用户
- 器件的不断更新与迭代
- 计算机体系结构的不断发展
- 不断提出新的应用需求

### 操作系统的发展过程

- 人工操作
- 脱机 / 假脱机（SPOOLing）方式
- 单道批处理

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210909114014453.png" alt="image-20210909114014453" style="zoom: 33%;" />

#### **多道批处理**

利用 A 程序的 I/O 操作而暂停执行 CPU 空挡时间，调度 B 程序运行

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210909114004983.png" alt="image-20210909114004983" style="zoom: 33%;" />

##### **特点**

- 资源利用率高
- 系统吞吐量大
- 平均周转时间长（需要排队依次进行处理）
- 无交互能力（修改和调试程序不方便）

##### **需要解决的问题**

- 处理机争用问题
- 内存分配和保护问题
- I/O 设备分配问题
- 文件的组织和管理问题
- 作业管理问题
- 用户与系统的接口问题

#### **分时系统**

- 人机交互、共享主机

    ![image-20210910102358257](https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210910102358257.png)

- 时间片（time slice）：一段很短的时间，用来切割 CPU

#### 实时系统

（Real time system）

计算机对所接收到的信号做出及时或实时的反应

#### 微机操作系统

##### 单用户单任务操作系统

MS-DOS

##### 单用户多任务操作系统

Windows XP

##### 多用户多任务操作系统

UNIX，Linux

### 操作系统的基本特性

#### 并发

（Concurrence）多时间在同一时间段内发生

##### 引入进程（Process）

未引入进程系统：计算和 I/O 顺序执行

引入进程系统：为计算程序和 I/O 程序分别建立一个进程，两个进程可并发进行

##### 线程（Threads）

比进程更小的单位 

#### 共享

（Sharing）系统中的资源可供内存中多个并发执行的进程（线程）**共同使用**

- 互斥共享（音频设备、打印机）
- 同时访问（磁盘文件、可重入代码）

#### 虚拟

（Virtual）把一个物理实体变为若干个逻辑上的对应物

如

- CPU：每个进程的虚处理机
- 存储器：每个进程占有的地址空间（指令+数据+堆栈）
- 方法
    - 时分复用
    - 空分复用:对存储空间的管理

#### 异步

（Asynchronism）

也称不确定性 / 随机，指进程的执行顺序和执行时间的不确定性

### 操作系统的主要功能

- 资源管理
    - 处理机管理（硬件）
    - 存储器管理（硬件）
    - 设备管理（硬件）
    - 文件管理（软件）
- 用户接口
    - 命令接口
    - 程序接口
    - 图形接口

#### 处理机管理功能

- 进程控制：创建、撤销、状态迁移

- 进程同步：互斥访问临界资源

- 进程通信：进程合作

    ![image-20210910110604428](https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210910110604428.png)

- 调度
    - 作业调度：按照算法为作业分配资源
    - 进程调度：按照算法先后执行进程

#### 存储器管理功能

- 内存分配
    - 为每道程序分配内存空间
    - 提高存储器利用率，减少内存碎片
    - 满足正在运行的程序数据动态增长的需要
    - 分类
        - 静态分配
        - 动态分配
- 内存保护
    - 确保程序互不干扰
    - 不允许用户访问操作系统的程序与数据
    - 不允许用户转到非共享的其他用户程序

- 地址映射

- 内存扩充
    - 虚存技术
    - 功能
        - 请求调入
        - 置换

#### 设备管理功能

完成用户提出的 I/O 请求，并分配设备

提高 I/O 利用率

- 缓冲管理
    - 在 I/O 设备和 CPU 中之间引入缓冲
- 设备分配
- 设备处理
- 虚拟设备

#### 文件管理功能

- 文件存储空间的管理

- 目录管理

- 文件的读/写管理和保护

#### 用户接口

命令接口

#### 程序接口

由一组==系统调用==构成

系统调用是操作系统提供给编程人员的唯一接口，它使 CPU 状态**从用户态陷入内核态**

