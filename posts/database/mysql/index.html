<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>关于 MySQL 的一些笔记 - 伤心肠粉的酱油碟子</title><meta name=author content><meta name=author-link content><meta name=description content="MySQL 学习笔记 登录和退出 MySQL 服务器 1 2 3 4 5 6 7 8 # 登录MySQL mysql -u [username] -p[password] # 远程连接 mysql"><meta name=keywords content="数据库,快速入门,MySQL"><meta itemprop=name content="关于 MySQL 的一些笔记"><meta itemprop=description content="MySQL 学习笔记 登录和退出 MySQL 服务器 1 2 3 4 5 6 7 8 # 登录MySQL mysql -u [username] -p[password] # 远程连接 mysql"><meta itemprop=datePublished content="2021-12-23T00:00:00+00:00"><meta itemprop=dateModified content="2022-08-15T10:22:35+00:00"><meta itemprop=wordCount content="16305"><meta itemprop=image content="https://trouvaille0198.github.io/logo.png"><meta itemprop=keywords content="数据库,快速入门,MySQL,"><meta property="og:title" content="关于 MySQL 的一些笔记"><meta property="og:description" content="MySQL 学习笔记 登录和退出 MySQL 服务器 1 2 3 4 5 6 7 8 # 登录MySQL mysql -u [username] -p[password] # 远程连接 mysql"><meta property="og:type" content="article"><meta property="og:url" content="https://trouvaille0198.github.io/Notes/posts/database/mysql/"><meta property="og:image" content="https://trouvaille0198.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-15T10:22:35+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://trouvaille0198.github.io/logo.png"><meta name=twitter:title content="关于 MySQL 的一些笔记"><meta name=twitter:description content="MySQL 学习笔记 登录和退出 MySQL 服务器 1 2 3 4 5 6 7 8 # 登录MySQL mysql -u [username] -p[password] # 远程连接 mysql"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#252627"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://trouvaille0198.github.io/Notes/posts/database/mysql/><link rel=prev href=https://trouvaille0198.github.io/Notes/posts/%E5%88%B7%E9%A2%98/greedy/55.-%E8%B7%B3%E8%B7%83%E6%B8%B8%E6%88%8F/><link rel=next href=https://trouvaille0198.github.io/Notes/posts/python/dataanalysis/numpy/><link rel=stylesheet href=/Notes/lib/normalize/normalize.min.css><link rel=stylesheet href=/Notes/css/style.min.css><link rel=stylesheet href=/Notes/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/Notes/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"关于 MySQL 的一些笔记","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/database\/mysql\/"},"genre":"posts","keywords":"数据库, 快速入门, MySQL","wordcount":16305,"url":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/database\/mysql\/","datePublished":"2021-12-23T00:00:00+00:00","dateModified":"2022-08-15T10:22:35+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"MelonCholi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>关于 MySQL 的一些笔记</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle"></i>
MelonCholi</span></span>
<span class=post-category>收录于 <a href=/Notes/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;数据库</a></span></div><div class=post-meta-line><span title="2021-12-23 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-12-23>2021-12-23</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 16305 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 33 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#登录和退出-mysql-服务器>登录和退出 MySQL 服务器</a></li><li><a href=#基本语法>基本语法</a></li><li><a href=#建表约束>建表约束</a><ul><li><a href=#主键约束>主键约束</a></li><li><a href=#唯一约束>唯一约束</a></li><li><a href=#非空约束>非空约束</a></li><li><a href=#默认约束>默认约束</a></li><li><a href=#外键约束>外键约束</a></li></ul></li><li><a href=#数据库的三大设计范式>数据库的三大设计范式</a><ul><li><a href=#1nf>1NF</a></li><li><a href=#2nf>2NF</a></li><li><a href=#3nf>3NF</a></li></ul></li><li><a href=#查询练习>查询练习</a><ul><li><a href=#准备数据>准备数据</a></li><li><a href=#1-到-10>1 到 10</a></li><li><a href=#分组计算平均成绩>分组计算平均成绩</a></li><li><a href=#分组条件与模糊查询>分组条件与模糊查询</a></li><li><a href=#多表查询---1>多表查询 - 1</a></li><li><a href=#多表查询---2>多表查询 - 2</a></li><li><a href=#三表关联查询>三表关联查询</a></li><li><a href=#子查询加分组求平均分>子查询加分组求平均分</a></li><li><a href=#子查询---1>子查询 - 1</a></li><li><a href=#子查询---2>子查询 - 2</a></li><li><a href=#year-函数与带-in-关键字查询>YEAR 函数与带 IN 关键字查询</a></li><li><a href=#多层嵌套子查询>多层嵌套子查询</a></li><li><a href=#多表查询>多表查询</a></li><li><a href=#子查询---3>子查询 - 3</a></li><li><a href=#union-和-notin-的使用>UNION 和 NOTIN 的使用</a></li><li><a href=#any-表示至少一个---desc--降序->ANY 表示至少一个 - DESC ( 降序 )</a></li><li><a href=#表示所有的-all>表示所有的 ALL</a></li><li><a href=#复制表的数据作为条件查询>复制表的数据作为条件查询</a></li><li><a href=#子查询---4>子查询 - 4</a></li><li><a href=#条件加组筛选>条件加组筛选</a></li><li><a href=#notlike-模糊查询取反>NOTLIKE 模糊查询取反</a></li><li><a href=#year-与-now-函数>YEAR 与 NOW 函数</a></li><li><a href=#max-与-min-函数>MAX 与 MIN 函数</a></li><li><a href=#多段排序>多段排序</a></li><li><a href=#子查询---5>子查询 - 5</a></li><li><a href=#max-函数与子查询>MAX 函数与子查询</a></li><li><a href=#子查询---6>子查询 - 6</a></li><li><a href=#子查询---7>子查询 - 7</a></li><li><a href=#子查询---8>子查询 - 8</a></li><li><a href=#按等级查询>按等级查询</a></li><li><a href=#连接查询>连接查询</a><ul><li><a href=#内连接>内连接</a></li><li><a href=#左外连接>左外连接</a></li><li><a href=#右外链接>右外链接</a></li><li><a href=#全外链接>全外链接</a></li></ul></li></ul></li><li><a href=#事务>事务</a><ul><li><a href=#如何控制事务---commit--rollback>如何控制事务 - COMMIT / ROLLBACK</a></li><li><a href=#手动开启事务---begin--start-transaction>手动开启事务 - BEGIN / START TRANSACTION</a></li><li><a href=#事务的-acid-特征与使用>事务的 ACID 特征与使用</a></li><li><a href=#事务的隔离性>事务的隔离性</a><ul><li><a href=#脏读>脏读</a></li><li><a href=#读取已提交>读取已提交</a></li><li><a href=#幻读>幻读</a></li><li><a href=#串行化>串行化</a></li></ul></li></ul></li><li><a href=#索引优化>索引优化</a><ul><li><a href=#索引的类型>索引的类型</a></li><li><a href=#索引的相关操作>索引的相关操作</a><ul><li><a href=#索引的创建><strong>索引的创建</strong></a><ul><li><a href=#alter-table><code>ALTER TABLE</code></a></li><li><a href=#create-index><code>CREATE INDEX</code></a></li></ul></li><li><a href=#索引的删除>索引的删除</a></li><li><a href=#索引的查看>索引的查看</a></li><li><a href=#索引的更改>索引的更改</a></li></ul></li><li><a href=#创建索引的技巧>创建索引的技巧</a></li><li><a href=#组合索引>组合索引</a></li><li><a href=#前缀索引><strong>前缀索引</strong></a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=mysql-学习笔记>MySQL 学习笔记</h1><h2 id=登录和退出-mysql-服务器>登录和退出 MySQL 服务器</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 登录MySQL</span>
</span></span><span class=line><span class=cl>mysql -u <span class=o>[</span>username<span class=o>]</span> -p<span class=o>[</span>password<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 远程连接</span>
</span></span><span class=line><span class=cl>mysql -h <span class=o>[</span>host<span class=o>]</span> -P <span class=o>[</span>port<span class=o>]</span> -u <span class=o>[</span>username<span class=o>]</span> -p<span class=o>[</span>password<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 退出MySQL数据库服务器</span>
</span></span><span class=line><span class=cl>exit<span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=基本语法>基本语法</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 显示所有数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=k>databases</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 创建数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>test</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 切换数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>use</span><span class=w> </span><span class=n>test</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 显示数据库中的所有表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=kp>tables</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 创建数据表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>pet</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>owner</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>species</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sex</span><span class=w> </span><span class=kt>CHAR</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>birth</span><span class=w> </span><span class=kt>DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>death</span><span class=w> </span><span class=kt>DATE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看数据表结构
</span></span></span><span class=line><span class=cl><span class=c1>-- describe pet;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>desc</span><span class=w> </span><span class=n>pet</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>pet</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 插入数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>pet</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;puffball&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Diane&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;hamster&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;f&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1990-03-30&#39;</span><span class=p>,</span><span class=w> </span><span class=no>NULL</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 修改数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>UPDATE</span><span class=w> </span><span class=n>pet</span><span class=w> </span><span class=kt>SET</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;squirrel&#39;</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>owner</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Diane&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pet</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;squirrel&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>myorder</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=建表约束>建表约束</h2><h3 id=主键约束>主键约束</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 主键约束
</span></span></span><span class=line><span class=cl><span class=c1>-- 使某个字段不重复且不得为空，确保表内所有数据的唯一性。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 联合主键
</span></span></span><span class=line><span class=cl><span class=c1>-- 联合主键中的每个字段都不能为空，并且加起来不能和已设置的联合主键重复。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>password</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 自增约束
</span></span></span><span class=line><span class=cl><span class=c1>-- 自增约束的主键由系统自动递增分配。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=kp>AUTO_INCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加主键约束
</span></span></span><span class=line><span class=cl><span class=c1>-- 如果忘记设置主键，还可以通过SQL语句设置（两种方式）：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=n>MODIFY</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除主键
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>drop</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=唯一约束>唯一约束</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 建表时创建唯一约束
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>UNIQUE</span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加唯一约束
</span></span></span><span class=line><span class=cl><span class=c1>-- 如果建表时没有设置唯一约束，还可以通过SQL语句设置（两种方式）：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>UNIQUE</span><span class=p>(</span><span class=n>name</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=n>MODIFY</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>UNIQUE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除唯一约束
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=非空约束>非空约束</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 建表时添加非空约束
</span></span></span><span class=line><span class=cl><span class=c1>-- 约束某个字段不能为空
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 移除非空约束
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=n>MODIFY</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=默认约束>默认约束</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 建表时添加默认约束
</span></span></span><span class=line><span class=cl><span class=c1>-- 约束某个字段的默认值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>user2</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 移除非空约束
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=n>MODIFY</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=kt>INT</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=外键约束>外键约束</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 班级
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>classes</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 学生表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>students</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>-- 这里的 class_id 要和 classes 中的 id 字段相关联
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>class_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>-- 表示 class_id 的值必须来自于 classes 中的 id 字段值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>class_id</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=nf>classes</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 1. 主表（父表）classes 中没有的数据值，在副表（子表）students 中，是不可以使用的；
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 主表中的记录被副表引用时，主表不可以被删除。
</span></span></span></code></pre></td></tr></table></div></div><h2 id=数据库的三大设计范式>数据库的三大设计范式</h2><h3 id=1nf>1NF</h3><p>所有字段值都是不可再分的原子值</p><p>只要字段值还可以继续拆分，就不满足第一范式。</p><p>范式设计得越详细，对某些实际操作可能会更好，但并非都有好处，需要对项目的实际情况进行设定。</p><h3 id=2nf>2NF</h3><p>在满足第一范式的前提下，<strong>其他列都必须完全依赖于主键列</strong>。如果出现不完全依赖，只可能发生在联合主键的情况下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 订单表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>myorder</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>product_id</span><span class=p>,</span><span class=w> </span><span class=n>customer_id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>实际上，在这张订单表中，<code>product_name</code> 只依赖于 <code>product_id</code> ，<code>customer_name</code> 只依赖于 <code>customer_id</code> 。也就是说，<code>product_name</code> 和 <code>customer_id</code> 是没用关系的，<code>customer_name</code> 和 <code>product_id</code> 也是没有关系的。</p><p>这就不满足第二范式：其他列都必须完全依赖于主键列！</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>myorder</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>order_id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=kt>INT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>product</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>customer</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>拆分之后，<code>myorder</code> 表中的 <code>product_id</code> 和 <code>customer_id</code> 完全依赖于 <code>order_id</code> 主键，而 <code>product</code> 和 <code>customer</code> 表中的其他字段又完全依赖于主键。满足了第二范式的设计！</p><h3 id=3nf>3NF</h3><p>在满足第二范式的前提下，<strong>除了主键列之外，其他列之间不能有传递依赖关系</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>myorder</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>order_id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_phone</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>表中的 <code>customer_phone</code> 有可能依赖于 <code>order_id</code> 、 <code>customer_id</code> 两列，也就不满足了第三范式的设计：其他列之间不能有传递依赖关系。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>myorder</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>order_id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=kt>INT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>customer</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>phone</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>修改后就不存在其他列之间的传递依赖关系，其他列都只依赖于主键列，满足了第三范式的设计！</p><h2 id=查询练习>查询练习</h2><h3 id=准备数据>准备数据</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 创建数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>select_test</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 切换数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>USE</span><span class=w> </span><span class=n>select_test</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 创建学生表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>student</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>no</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sex</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>birthday</span><span class=w> </span><span class=kt>DATE</span><span class=p>,</span><span class=w> </span><span class=c1>-- 生日
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>class</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=c1>-- 所在班级
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 创建教师表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>teacher</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>no</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sex</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>birthday</span><span class=w> </span><span class=kt>DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>profession</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w> </span><span class=c1>-- 职称
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>department</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=c1>-- 部门
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 创建课程表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>course</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>no</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>t_no</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w> </span><span class=c1>-- 教师编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=c1>-- 表示该 tno 来自于 teacher 表中的 no 字段值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>t_no</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=nf>teacher</span><span class=p>(</span><span class=n>no</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 成绩表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>score</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>s_no</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w> </span><span class=c1>-- 学生编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>c_no</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=no>NULL</span><span class=p>,</span><span class=w> </span><span class=c1>-- 课程号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>degree</span><span class=w> </span><span class=kt>DECIMAL</span><span class=p>,</span><span class=w>	</span><span class=c1>-- 成绩
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=c1>-- 表示该 s_no, c_no 分别来自于 student, course 表中的 no 字段值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>s_no</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=nf>student</span><span class=p>(</span><span class=n>no</span><span class=p>),</span><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>c_no</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=nf>course</span><span class=p>(</span><span class=n>no</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>-- 设置 s_no, c_no 为联合主键
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看所有表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=kp>TABLES</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加学生表数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;101&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;曾华&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1977-09-01&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95033&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;102&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;匡明&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1975-10-02&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;103&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;王丽&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;女&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1976-01-23&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95033&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;104&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;李军&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1976-02-20&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95033&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;王芳&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;女&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1975-02-10&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;106&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;陆军&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1974-06-03&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;107&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;王尼玛&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1976-02-20&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95033&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;108&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;张全蛋&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1975-02-10&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;109&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;赵铁柱&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1974-06-03&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加教师表数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;804&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;李诚&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1958-12-02&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;副教授&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;856&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;张旭&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1969-03-12&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;讲师&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;电子工程系&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;825&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;王萍&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;女&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1972-05-05&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;助教&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;831&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;刘冰&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;女&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1977-08-14&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;助教&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;电子工程系&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加课程表数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;计算机导论&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;825&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;3-245&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;操作系统&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;804&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;6-166&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;数字电路&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;856&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;9-888&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;高等数学&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;831&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加添加成绩表数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;103&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;92&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;103&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;86&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;103&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;6-166&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;85&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;88&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;75&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;6-166&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;79&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;109&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;76&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;109&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;68&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;109&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;6-166&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;81&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看表结构
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=1-到-10>1 到 10</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 查询 student 表的所有行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 student 表中的 name、sex 和 class 字段的所有行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>sex</span><span class=p>,</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 teacher 表中不重复的 department 列
</span></span></span><span class=line><span class=cl><span class=c1>-- department: 去重查询
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 score 表中成绩在60-80之间的所有行（区间查询和运算符查询）
</span></span></span><span class=line><span class=cl><span class=c1>-- BETWEEN xx AND xx: 查询区间, AND 表示 &#34;并且&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>60</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>80</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>60</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>80</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 score 表中成绩为 85, 86 或 88 的行
</span></span></span><span class=line><span class=cl><span class=c1>-- IN: 查询规定中的多个值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=mi>85</span><span class=p>,</span><span class=w> </span><span class=mi>86</span><span class=p>,</span><span class=w> </span><span class=mi>88</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 student 表中 &#39;95031&#39; 班或性别为 &#39;女&#39; 的所有行
</span></span></span><span class=line><span class=cl><span class=c1>-- or: 表示或者关系
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;女&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 以 class 降序的方式查询 student 表的所有行
</span></span></span><span class=line><span class=cl><span class=c1>-- DESC: 降序，从高到低
</span></span></span><span class=line><span class=cl><span class=c1>-- ASC（默认）: 升序，从低到高
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>ASC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 以 c_no 升序、degree 降序查询 score 表的所有行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>ASC</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 &#34;95031&#34; 班的学生人数
</span></span></span><span class=line><span class=cl><span class=c1>-- COUNT: 统计
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 score 表中的最高分的学生学号和课程编号（子查询或排序查询）。
</span></span></span><span class=line><span class=cl><span class=c1>-- (SELECT MAX(degree) FROM score): 子查询，算出最高分
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=nf>MAX</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--  排序查询
</span></span></span><span class=line><span class=cl><span class=c1>-- LIMIT r, n: 表示从第r行开始，查询n条数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>DESC</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=分组计算平均成绩>分组计算平均成绩</h3><p><strong>查询每门课的平均成绩。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- AVG: 平均值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;6-166&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- GROUP BY: 分组查询
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=分组条件与模糊查询>分组条件与模糊查询</h3><p><strong>查询 <code>score</code> 表中至少有 2 名学生选修，并以 3 开头的课程的平均分数。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- c_no 课程编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>分析表发现，至少有 2 名学生选修的课程是 <code>3-105</code> 、<code>3-245</code> 、<code>6-166</code> ，以 3 开头的课程是 <code>3-105</code> 、<code>3-245</code> 。也就是说，我们要查询所有 <code>3-105</code> 和 <code>3-245</code> 的 <code>degree</code> 平均分。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 首先把 c_no, AVG(degree) 通过分组查询出来
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=p>.</span><span class=mi>3333</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=p>.</span><span class=mi>3333</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=p>.</span><span class=mi>6667</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 再查询出至少有 2 名学生选修的课程
</span></span></span><span class=line><span class=cl><span class=c1>-- HAVING: 表示持有
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>HAVING</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=n>c_no</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 并且是以 3 开头的课程
</span></span></span><span class=line><span class=cl><span class=c1>-- LIKE 表示模糊查询，&#34;%&#34; 是一个通配符，匹配 &#34;3&#34; 后面的任意字符。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>AND</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;3%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 把前面的SQL语句拼接起来，
</span></span></span><span class=line><span class=cl><span class=c1>-- 后面加上一个 COUNT(*)，表示将每个分组的个数也查询出来。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>),</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>HAVING</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=n>c_no</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;3%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=p>.</span><span class=mi>3333</span><span class=w> </span><span class=o>|</span><span class=w>        </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=p>.</span><span class=mi>3333</span><span class=w> </span><span class=o>|</span><span class=w>        </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+----------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=多表查询---1>多表查询 - 1</h3><p><strong>查询所有学生的 <code>name</code>，以及该学生在 <code>score</code> 表中对应的 <code>c_no</code> 和 <code>degree</code> 。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>匡明</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>106</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>陆军</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>107</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王尼玛</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>108</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张全蛋</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>通过分析可以发现，只要把 <code>score</code> 表中的 <code>s_no</code> 字段值替换成 <code>student</code> 表中对应的 <code>name</code> 字段值就可以了，如何做呢？</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- FROM...: 表示从 student, score 表中查询
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE 的条件表示为，只有在 student.no 和 score.s_no 相等时才显示出来。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>,</span><span class=w> </span><span class=n>score</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>student</span><span class=p>.</span><span class=n>no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>score</span><span class=p>.</span><span class=n>s_no</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=多表查询---2>多表查询 - 2</h3><p><strong>查询所有学生的 <code>no</code> 、课程名称 ( <code>course</code> 表中的 <code>name</code> ) 和成绩 ( <code>score</code> 表中的 <code>degree</code> ) 列。</strong></p><p>只有 <code>score</code> 关联学生的 <code>no</code> ，因此只要查询 <code>score</code> 表，就能找出所有和学生相关的 <code>no</code> 和 <code>degree</code> ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>然后查询 <code>course</code> 表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=o>+-------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>            </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>计算机导论</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>9</span><span class=o>-</span><span class=mi>888</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>高等数学</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>只要把 <code>score</code> 表中的 <code>c_no</code> 替换成 <code>course</code> 表中对应的 <code>name</code> 字段值就可以了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 增加一个查询字段 name，分别从 score、course 这两个表中查询。
</span></span></span><span class=line><span class=cl><span class=c1>-- as 表示取一个该字段的别名。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>c_name</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>,</span><span class=w> </span><span class=n>course</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>score</span><span class=p>.</span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>course</span><span class=p>.</span><span class=n>no</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-----------------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_name</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-----------------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>计算机导论</span><span class=w>      </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>计算机导论</span><span class=w>      </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>计算机导论</span><span class=w>      </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>        </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>        </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>        </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>        </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>        </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>        </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-----------------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=三表关联查询>三表关联查询</h3><p><strong>查询所有学生的 <code>name</code> 、课程名 ( <code>course</code> 表中的 <code>name</code> ) 和 <code>degree</code> 。</strong></p><p>只有 <code>score</code> 表中关联学生的学号和课堂号，我们只要围绕着 <code>score</code> 这张表查询就好了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>只要把 <code>s_no</code> 和 <code>c_no</code> 替换成 <code>student</code> 和 <code>srouse</code> 表中对应的 <code>name</code> 字段值就好了。</p><p>首先把 <code>s_no</code> 替换成 <code>student</code> 表中的 <code>name</code> 字段：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>,</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>student</span><span class=p>.</span><span class=n>no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>score</span><span class=p>.</span><span class=n>s_no</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>再把 <code>c_no</code> 替换成 <code>course</code> 表中的 <code>name</code> 字段：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 课程表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>            </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>计算机导论</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>9</span><span class=o>-</span><span class=mi>888</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>高等数学</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 由于字段名存在重复，使用 &#34;表名.字段名 as 别名&#34; 代替。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>student</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>s_name</span><span class=p>,</span><span class=w> </span><span class=n>course</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>c_name</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>,</span><span class=w> </span><span class=n>score</span><span class=p>,</span><span class=w> </span><span class=n>course</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>student</span><span class=p>.</span><span class=n>NO</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>score</span><span class=p>.</span><span class=n>s_no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w> </span><span class=n>score</span><span class=p>.</span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>course</span><span class=p>.</span><span class=n>no</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询加分组求平均分>子查询加分组求平均分</h3><p><strong>查询 <code>95031</code> 班学生每门课程的平均成绩。</strong></p><p>在 <code>score</code> 表中根据 <code>student</code> 表的学生编号筛选出学生的课堂号和成绩：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- IN (..): 将筛选出的学生号当做 s_no 的条件查询
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这时只要将 <code>c_no</code> 分组一下就能得出 <code>95031</code> 班学生每门课的平均成绩：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;95031&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>82</span><span class=p>.</span><span class=mi>0000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>71</span><span class=p>.</span><span class=mi>5000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>80</span><span class=p>.</span><span class=mi>0000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---1>子查询 - 1</h3><p><strong>查询在 <code>3-105</code> 课程中，所有成绩高于 <code>109</code> 号同学的记录。</strong></p><p>首先筛选出课堂号为 <code>3-105</code> ，在找出所有成绩高于 <code>109</code> 号同学的的行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;109&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---2>子查询 - 2</h3><p><strong>查询所有成绩高于 <code>109</code> 号同学的 <code>3-105</code> 课程成绩记录。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 不限制课程号，只要成绩大于109号同学的3-105课程成绩就可以。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;109&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=year-函数与带-in-关键字查询>YEAR 函数与带 IN 关键字查询</h3><p><strong>查询所有和 <code>101</code> 、<code>108</code> 号学生同年出生的 <code>no</code> 、<code>name</code> 、<code>birthday</code> 列。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- YEAR(..): 取出日期中的年份
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>birthday</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=kt>YEAR</span><span class=p>(</span><span class=n>birthday</span><span class=p>)</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=kt>YEAR</span><span class=p>(</span><span class=n>birthday</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=mi>101</span><span class=p>,</span><span class=w> </span><span class=mi>108</span><span class=p>));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=多层嵌套子查询>多层嵌套子查询</h3><p><strong>查询 <code>'张旭'</code> 教师任课的学生成绩表。</strong></p><p>首先找到教师编号：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>NO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;张旭&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>通过 <code>sourse</code> 表找到该教师课程号：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>NO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>NO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;张旭&#39;</span><span class=w> </span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>通过筛选出的课程号查询成绩表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;张旭&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=多表查询>多表查询</h3><p><strong>查询某选修课程多于5个同学的教师姓名。</strong></p><p>首先在 <code>teacher</code> 表中，根据 <code>no</code> 字段来判断该教师的同一门课程是否有至少5名学员选修：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 查询 teacher 表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>804</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李诚</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>825</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王萍</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>831</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>刘冰</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>856</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张旭</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>-- 在这里找到对应的条件
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>查看和教师编号有有关的表的信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- t_no: 教师编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>+-------+-----------------+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>            </span><span class=o>|</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>计算机导论</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>825</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=mi>804</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=mi>856</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>9</span><span class=o>-</span><span class=mi>888</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>高等数学</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=mi>831</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-----------------+------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>我们已经找到和教师编号有关的字段就在 <code>course</code> 表中，但是还无法知道哪门课程至少有5名学生选修，所以还需要根据 <code>score</code> 表来查询：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 在此之前向 score 插入一些数据，以便丰富查询条件。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;101&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;90&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;102&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;91&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;104&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;89&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 score 表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 在 score 表中将 c_no 作为分组，并且限制 c_no 持有至少 5 条数据。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>根据筛选出来的课程号，找出在某课程中，拥有至少5名学员的教师编号：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>825</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>在 <code>teacher</code> 表中，根据筛选出来的教师编号找到教师姓名：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>-- 最终条件
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---3>子查询 - 3</h3><p><strong>查询 “计算机系” 课程的成绩表。</strong></p><p>思路是，先找出 <code>course</code> 表中所有 <code>计算机系</code> 课程的编号，然后根据这个编号查询 <code>score</code> 表。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 通过 teacher 表查询所有 `计算机系` 的教师编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+--------+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>department</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+--------+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>804</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李诚</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=err>计算机系</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>825</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王萍</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=err>计算机系</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+--------+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 通过 course 表查询该教师的课程编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 根据筛选出来的课程号查询成绩表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=union-和-notin-的使用>UNION 和 NOTIN 的使用</h3><p><strong>查询 <code>计算机系</code> 与 <code>电子工程系</code> 中的不同职称的教师。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- NOT: 代表逻辑非
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>profession</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>profession</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;电子工程系&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 合并两个集
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;电子工程系&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>profession</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>profession</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;计算机系&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=any-表示至少一个---desc--降序->ANY 表示至少一个 - DESC ( 降序 )</h3><p><strong>查询课程 <code>3-105</code> 且成绩 <u>至少</u> 高于 <code>3-245</code> 的 <code>score</code> 表。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ANY: 符合SQL语句中的任意条件。
</span></span></span><span class=line><span class=cl><span class=c1>-- 也就是说，在 3-105 成绩中，只要有一个大于从 3-245 筛选出来的任意行就符合条件，
</span></span></span><span class=line><span class=cl><span class=c1>-- 最后根据降序查询结果。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=nf>ANY</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=表示所有的-all>表示所有的 ALL</h3><p><strong>查询课程 <code>3-105</code> 且成绩高于 <code>3-245</code> 的 <code>score</code> 表。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 只需对上一道题稍作修改。
</span></span></span><span class=line><span class=cl><span class=c1>-- ALL: 符合SQL语句中的所有条件。
</span></span></span><span class=line><span class=cl><span class=c1>-- 也就是说，在 3-105 每一行成绩中，都要大于从 3-245 筛选出来全部行才算符合条件。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-105&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=k>ALL</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;3-245&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=复制表的数据作为条件查询>复制表的数据作为条件查询</h3><p><strong>查询某课程成绩比该课程平均成绩低的 <code>score</code> 表。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 查询平均分
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>c_no</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>87</span><span class=p>.</span><span class=mi>6667</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=p>.</span><span class=mi>3333</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=p>.</span><span class=mi>6667</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+-------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询 score 表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>86</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>85</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>88</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 将表 b 作用于表 a 中查询数据
</span></span></span><span class=line><span class=cl><span class=c1>-- score a (b): 将表声明为 a (b)，
</span></span></span><span class=line><span class=cl><span class=c1>-- 如此就能用 a.c_no = b.c_no 作为条件执行查询了。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>c_no</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>75</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>68</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>81</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---4>子查询 - 4</h3><p><strong>查询所有任课 ( 在 <code>course</code> 表里有课程 ) 教师的 <code>name</code> 和 <code>department</code></strong> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>department</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------+-----------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>李诚</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=err>计算机系</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王萍</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=err>计算机系</span><span class=w>        </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>刘冰</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=err>电子工程系</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>张旭</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=err>电子工程系</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------+-----------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=条件加组筛选>条件加组筛选</h3><p><strong>查询 <code>student</code> 表中至少有 2 名男生的 <code>class</code> 。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 查看学生表信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>birthday</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1977</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>匡明</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=mi>02</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>23</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>20</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>106</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>陆军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>107</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王尼玛</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>20</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>108</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张全蛋</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>110</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张飞</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95038</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 只查询性别为男，然后按 class 分组，并限制 class 行大于 1。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=nf>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=notlike-模糊查询取反>NOTLIKE 模糊查询取反</h3><p><strong>查询 <code>student</code> 表中不姓 &ldquo;王&rdquo; 的同学记录。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- NOT: 取反
</span></span></span><span class=line><span class=cl><span class=c1>-- LIKE: 模糊查询
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;王%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>birthday</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1977</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>匡明</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=mi>02</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>20</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>106</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>陆军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>108</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张全蛋</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>110</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张飞</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95038</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=year-与-now-函数>YEAR 与 NOW 函数</h3><p><strong>查询 <code>student</code> 表中每个学生的姓名和年龄。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 使用函数 YEAR(NOW()) 计算出当前年份，减去出生年份后得出年龄。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=kt>YEAR</span><span class=p>(</span><span class=nf>NOW</span><span class=p>())</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=kt>YEAR</span><span class=p>(</span><span class=n>birthday</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>age</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>42</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>匡明</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>44</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>43</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>43</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>44</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>陆军</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>45</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王尼玛</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=mi>43</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>张全蛋</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=mi>44</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=mi>45</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>张飞</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>45</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=max-与-min-函数>MAX 与 MIN 函数</h3><p><strong>查询 <code>student</code> 表中最大和最小的 <code>birthday</code> 值。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=nf>MAX</span><span class=p>(</span><span class=n>birthday</span><span class=p>),</span><span class=w> </span><span class=nf>MIN</span><span class=p>(</span><span class=n>birthday</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+---------------+---------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=nf>MAX</span><span class=p>(</span><span class=n>birthday</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=nf>MIN</span><span class=p>(</span><span class=n>birthday</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+---------------+---------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1977</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>01</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+---------------+---------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=多段排序>多段排序</h3><p><strong>以 <code>class</code> 和 <code>birthday</code> 从大到小的顺序查询 <code>student</code> 表。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>birthday</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>birthday</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>110</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张飞</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95038</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王丽</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>23</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>20</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>107</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王尼玛</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1976</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>20</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1977</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>106</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>陆军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1974</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王芳</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>108</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张全蛋</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>匡明</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>1975</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=mi>02</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>95031</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+-----------+-----+------------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---5>子查询 - 5</h3><p><strong>查询 &ldquo;男&rdquo; 教师及其所上的课程。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>teacher</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+--------------+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>no</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>t_no</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+--------------+------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>操作系统</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=mi>804</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>数字电路</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=mi>856</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-------+--------------+------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=max-函数与子查询>MAX 函数与子查询</h3><p><strong>查询最高分同学的 <code>score</code> 表。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 找出最高成绩（该查询只能有一个结果）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=nf>MAX</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 根据上面的条件筛选出所有最高成绩表，
</span></span></span><span class=line><span class=cl><span class=c1>-- 该查询可能有多个结果，假设 degree 值多次符合条件。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=nf>MAX</span><span class=p>(</span><span class=n>degree</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>92</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---6>子查询 - 6</h3><p><strong>查询和 &ldquo;李军&rdquo; 同性别的所有同学 <code>name</code> 。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 首先将李军的性别作为条件取出来
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;李军&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 根据性别查询 name 和 sex
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;李军&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-----+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-----+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>匡明</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>陆军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王尼玛</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>张全蛋</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>赵铁柱</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>张飞</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-----+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---7>子查询 - 7</h3><p><strong>查询和 &ldquo;李军&rdquo; 同性别且同班的同学 <code>name</code> 。</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>sex</span><span class=p>,</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;李军&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;李军&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-----+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-----+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>曾华</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>李军</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=err>王尼玛</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>95033</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+-----------+-----+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=子查询---8>子查询 - 8</h3><p><strong>查询所有选修 &ldquo;计算机导论&rdquo; 课程的 &ldquo;男&rdquo; 同学成绩表。</strong></p><p>需要的 &ldquo;计算机导论&rdquo; 和性别为 &ldquo;男&rdquo; 的编号可以在 <code>course</code> 和 <code>student</code> 表中找到。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c_no</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>course</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;计算机导论&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>91</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=按等级查询>按等级查询</h3><p>建立一个 <code>grade</code> 表代表学生的成绩等级，并插入数据：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>grade</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>low</span><span class=w> </span><span class=kt>INT</span><span class=p>(</span><span class=mi>3</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>upp</span><span class=w> </span><span class=kt>INT</span><span class=p>(</span><span class=mi>3</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>grade</span><span class=w> </span><span class=kt>char</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>90</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;A&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>80</span><span class=p>,</span><span class=w> </span><span class=mi>89</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;B&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>70</span><span class=p>,</span><span class=w> </span><span class=mi>79</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;C&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>60</span><span class=p>,</span><span class=w> </span><span class=mi>69</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;D&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>59</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;E&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>grade</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>low</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>upp</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=mi>100</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>80</span><span class=w> </span><span class=o>|</span><span class=w>   </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>70</span><span class=w> </span><span class=o>|</span><span class=w>   </span><span class=mi>79</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>C</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>60</span><span class=w> </span><span class=o>|</span><span class=w>   </span><span class=mi>69</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>   </span><span class=mi>59</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>E</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>查询所有学生的 <code>s_no</code> 、<code>c_no</code> 和 <code>grade</code> 列。</strong></p><p>思路是，使用区间 ( <code>BETWEEN</code> ) 查询，判断学生的成绩 ( <code>degree</code> ) 在 <code>grade</code> 表的 <code>low</code> 和 <code>upp</code> 之间。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>s_no</span><span class=p>,</span><span class=w> </span><span class=n>c_no</span><span class=p>,</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>score</span><span class=p>,</span><span class=w> </span><span class=n>grade</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>degree</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=n>low</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>upp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>s_no</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c_no</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>102</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>103</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>104</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>C</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>105</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>C</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>C</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=o>-</span><span class=mi>245</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>109</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=o>-</span><span class=mi>166</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=连接查询>连接查询</h3><p>准备用于测试连接查询的数据：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>testJoin</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>person</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>cardId</span><span class=w> </span><span class=kt>INT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=nf>card</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>card</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;饭卡&#39;</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;建行卡&#39;</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;农行卡&#39;</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;工商卡&#39;</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;邮政卡&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>card</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>饭卡</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>建行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>农行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>工商卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>邮政卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;张三&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;李四&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;王五&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>cardId</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张三</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李四</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王五</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>分析两张表发现，<code>person</code> 表并没有为 <code>cardId</code> 字段设置一个在 <code>card</code> 表中对应的 <code>id</code> 外键。如果设置了的话，<code>person</code> 中 <code>cardId</code> 字段值为 <code>6</code> 的行就插不进去，因为该 <code>cardId</code> 值在 <code>card</code> 表中并没有。</p><h4 id=内连接>内连接</h4><p>要查询这两张表中有关系的数据，可以使用 <code>INNER JOIN</code> ( 内连接 ) 将它们连接在一起。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- INNER JOIN: 表示为内连接，将两张表拼接在一起。
</span></span></span><span class=line><span class=cl><span class=c1>-- on: 表示要执行某个条件。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>card</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>person</span><span class=p>.</span><span class=n>cardId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>card</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>cardId</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张三</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>饭卡</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李四</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>农行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 将 INNER 关键字省略掉，结果也是一样的。
</span></span></span><span class=line><span class=cl><span class=c1>-- SELECT * FROM person JOIN card on person.cardId = card.id;
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>注意：<code>card</code> 的整张表被连接到了右边。</p></blockquote><h4 id=左外连接>左外连接</h4><p>完整显示左边的表 ( <code>person</code> ) ，右边的表如果符合条件就显示，不符合则补 <code>NULL</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- LEFT JOIN 也叫做 LEFT OUTER JOIN，用这两种方式的查询结果是一样的。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>card</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>person</span><span class=p>.</span><span class=n>cardId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>card</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>cardId</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张三</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>饭卡</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李四</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>农行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王五</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=右外链接>右外链接</h4><p>完整显示右边的表 ( <code>card</code> ) ，左边的表如果符合条件就显示，不符合则补 <code>NULL</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>RIGHT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>card</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>person</span><span class=p>.</span><span class=n>cardId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>card</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>cardId</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张三</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>饭卡</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李四</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>农行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>建行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>工商卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>邮政卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=全外链接>全外链接</h4><p>完整显示两张表的全部数据。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- MySQL 不支持这种语法的全外连接
</span></span></span><span class=line><span class=cl><span class=c1>-- SELECT * FROM person FULL JOIN card on person.cardId = card.id;
</span></span></span><span class=line><span class=cl><span class=c1>-- 出现错误：
</span></span></span><span class=line><span class=cl><span class=c1>-- ERROR 1054 (42S22): Unknown column &#39;person.cardId&#39; in &#39;on clause&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- MySQL全连接语法，使用 UNION 将两张表合并在一起。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>card</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>person</span><span class=p>.</span><span class=n>cardId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>card</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>RIGHT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>card</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>person</span><span class=p>.</span><span class=n>cardId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>card</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>cardId</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张三</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>饭卡</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李四</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>农行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>王五</span><span class=w>   </span><span class=o>|</span><span class=w>      </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>建行卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>工商卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>   </span><span class=o>|</span><span class=w>   </span><span class=no>NULL</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>邮政卡</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------+--------+--------+------+-----------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=事务>事务</h2><p>在 MySQL 中，事务其实是一个最小的不可分割的工作单元。事务能够<strong>保证一个业务的完整性</strong>。</p><p>比如我们的银行转账：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- a -&gt; -100
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- b -&gt; +100
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;b&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>在实际项目中，假设只有一条 SQL 语句执行成功，而另外一条执行失败了，就会出现数据前后不一致。</p><p>因此，在执行多条有关联 SQL 语句时，<strong>事务</strong>可能会要求这些 SQL 语句要么同时执行成功，要么就都执行失败。</p><h3 id=如何控制事务---commit--rollback>如何控制事务 - COMMIT / ROLLBACK</h3><p>在 MySQL 中，事务的<strong>自动提交</strong>状态默认是开启的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 查询事务的自动提交状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>AUTOCOMMIT</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>AUTOCOMMIT</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>            </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>自动提交的作用</strong>：当我们执行一条 SQL 语句的时候，其产生的效果就会立即体现出来，且不能<strong>回滚</strong>。</p><p>什么是回滚？举个例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>bank</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>USE</span><span class=w> </span><span class=n>bank</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=kt>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>money</span><span class=w> </span><span class=kt>INT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>可以看到，在执行插入语句后数据立刻生效，原因是 MySQL 中的事务自动将它<strong>提交</strong>到了数据库中。那么所谓<strong>回滚</strong>的意思就是，撤销执行过的所有 SQL 语句，使其回滚到<strong>最后一次提交</strong>数据时的状态。</p><p>在 MySQL 中使用 <code>ROLLBACK</code> 执行回滚：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 回滚到最后一次提交
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>由于所有执行过的 SQL 语句都已经被提交过了，所以数据并没有发生回滚。那如何让数据可以发生回滚？</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 关闭自动提交
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>SET</span><span class=w> </span><span class=n>AUTOCOMMIT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询自动提交状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>AUTOCOMMIT</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>AUTOCOMMIT</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>            </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>将自动提交关闭后，测试数据回滚：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 关闭 AUTOCOMMIT 后，数据的变化是在一张虚拟的临时数据表中展示，
</span></span></span><span class=line><span class=cl><span class=c1>-- 发生变化的数据并没有真正插入到数据表中。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 数据表中的真实数据其实还是：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 由于数据还没有真正提交，可以使用回滚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 再次查询
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>那如何将虚拟的数据真正提交到数据库中？使用 <code>COMMIT</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 手动提交数据（持久性），
</span></span></span><span class=line><span class=cl><span class=c1>-- 将数据真正提交到数据库中，执行后不能再回滚提交过的数据。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>COMMIT</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 提交后测试回滚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 再次查询（回滚无效了）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>总结</strong></p><ol><li><p><strong>自动提交</strong></p><ul><li><p>查看自动提交状态：<code>SELECT @@AUTOCOMMIT</code> ；</p></li><li><p>设置自动提交状态：<code>SET AUTOCOMMIT = 0</code> 。</p></li></ul></li><li><p><strong>手动提交</strong></p><p><code>@@AUTOCOMMIT = 0</code> 时，使用 <code>COMMIT</code> 命令提交事务。</p></li><li><p><strong>事务回滚</strong></p><p><code>@@AUTOCOMMIT = 0</code> 时，使用 <code>ROLLBACK</code> 命令回滚事务。</p></li></ol></blockquote><p><strong>事务的实际应用</strong>，让我们再回到银行转账项目：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 转账
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 到账
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;b&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这时假设在转账时发生了意外，就可以使用 <code>ROLLBACK</code> 回滚到最后一次提交的状态：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 假设转账发生了意外，需要回滚。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这时我们又回到了发生意外之前的状态，也就是说，事务给我们提供了一个可以反悔的机会。假设数据没有发生意外，这时可以手动将数据真正提交到数据表中：<code>COMMIT</code> 。</p><h3 id=手动开启事务---begin--start-transaction>手动开启事务 - BEGIN / START TRANSACTION</h3><p>事务的默认提交被开启 ( <code>@@AUTOCOMMIT = 1</code> ) 后，此时就不能使用事务回滚了。但是我们还可以手动开启一个事务处理事件，使其可以发生回滚：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 使用 BEGIN 或者 START TRANSACTION 手动开启一个事务
</span></span></span><span class=line><span class=cl><span class=c1>-- START TRANSACTION;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>BEGIN</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;b&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 由于手动开启的事务没有开启自动提交，
</span></span></span><span class=line><span class=cl><span class=c1>-- 此时发生变化的数据仍然是被保存在一张临时表中。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 测试回滚
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>仍然使用 <code>COMMIT</code> 提交数据，提交后无法再发生本次事务的回滚。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=n>BEGIN</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;b&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 提交数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>COMMIT</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 测试回滚（无效，因为表的数据已经被提交）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=事务的-acid-特征与使用>事务的 ACID 特征与使用</h3><p><strong>事务的四大特征：</strong></p><ul><li><strong>A 原子性</strong>：事务是最小的单位，不可以再分割；</li><li><strong>C 一致性</strong>：要求同一事务中的 SQL 语句，必须保证同时成功或者失败；</li><li><strong>I 隔离性</strong>：事务1 和 事务2 之间是具有隔离性的；</li><li><strong>D 持久性</strong>：事务一旦结束 ( <code>COMMIT</code> ) ，就不可以再返回了 ( <code>ROLLBACK</code> ) 。</li></ul><h3 id=事务的隔离性>事务的隔离性</h3><p><strong>事务的隔离性可分为四种 ( 性能从低到高 )</strong> ：</p><ol><li><p><strong>READ UNCOMMITTED ( 读取未提交 )</strong></p><p>如果有多个事务，那么任意事务都可以看见其他事务的<strong>未提交数据</strong>。</p></li><li><p><strong>READ COMMITTED ( 读取已提交 )</strong></p><p>只能读取到其他事务<strong>已经提交的数据</strong>。</p></li><li><p><strong>REPEATABLE READ ( 可被重复读 )</strong></p><p>如果有多个连接都开启了事务，那么事务之间不能共享数据记录，否则只能共享已提交的记录。</p></li><li><p><strong>SERIALIZABLE ( 串行化 )</strong></p><p>所有的事务都会按照<strong>固定顺序执行</strong>，执行完一个事务后再继续执行下一个事务的<strong>写入操作</strong>。</p></li></ol><p>查看当前数据库的默认隔离级别：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- MySQL 8.x, GLOBAL 表示系统级别，不加表示会话级别。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>TRANSACTION_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>REPEATABLE</span><span class=o>-</span><span class=k>READ</span><span class=w>                </span><span class=o>|</span><span class=w> </span><span class=c1>-- MySQL的默认隔离级别，可以重复读。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- MySQL 5.x
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TX_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>TX_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>修改隔离级别：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 设置系统隔离级别，LEVEL 后面表示要设置的隔离级别 (READ UNCOMMITTED)。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>SET</span><span class=w> </span><span class=n>GLOBAL</span><span class=w> </span><span class=n>TRANSACTION</span><span class=w> </span><span class=n>ISOLATION</span><span class=w> </span><span class=n>LEVEL</span><span class=w> </span><span class=k>READ</span><span class=w> </span><span class=n>UNCOMMITTED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询系统隔离级别，发现已经被修改。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>READ</span><span class=o>-</span><span class=n>UNCOMMITTED</span><span class=w>               </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=脏读>脏读</h4><p>测试 <strong>READ UNCOMMITTED ( 读取未提交 )</strong> 的隔离性：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;小明&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;淘宝店&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 开启一个事务操作数据
</span></span></span><span class=line><span class=cl><span class=c1>-- 假设小明在淘宝店买了一双800块钱的鞋子：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>START</span><span class=w> </span><span class=n>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>SET</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>800</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;小明&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>SET</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>800</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;淘宝店&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 然后淘宝店在另一方查询结果，发现钱已到账。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>200</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1800</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>由于小明的转账是在新开启的事务上进行操作的，而该操作的结果是可以被其他事务（另一方的淘宝店）看见的，因此淘宝店的查询结果是正确的，淘宝店确认到账。但就在这时，如果小明在它所处的事务上又执行了 <code>ROLLBACK</code> 命令，会发生什么？</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 小明所处的事务
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ROLLBACK</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 此时无论对方是谁，如果再去查询结果就会发现：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这就是所谓的<strong>脏读</strong>，一个事务读取到另外一个事务还未提交的数据。这在实际开发中是不允许出现的。</p><h4 id=读取已提交>读取已提交</h4><p>把隔离级别设置为 <strong>READ COMMITTED</strong> ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=kt>SET</span><span class=w> </span><span class=n>GLOBAL</span><span class=w> </span><span class=n>TRANSACTION</span><span class=w> </span><span class=n>ISOLATION</span><span class=w> </span><span class=n>LEVEL</span><span class=w> </span><span class=k>READ</span><span class=w> </span><span class=n>COMMITTED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>READ</span><span class=o>-</span><span class=n>COMMITTED</span><span class=w>                 </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这样，再有新的事务连接进来时，它们就只能查询到已经提交过的事务数据了。但是对于当前事务来说，它们看到的还是未提交的数据，例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 正在操作数据事务（当前事务）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>START</span><span class=w> </span><span class=n>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>SET</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>800</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;小明&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=kt>SET</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>800</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;淘宝店&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 虽然隔离级别被设置为了 READ COMMITTED，但在当前事务中，
</span></span></span><span class=line><span class=cl><span class=c1>-- 它看到的仍然是数据表中临时改变数据，而不是真正提交过的数据。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>200</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1800</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 假设此时在远程开启了一个新事务，连接到数据库。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>$</span><span class=w> </span><span class=n>mysql</span><span class=w> </span><span class=o>-</span><span class=n>u</span><span class=w> </span><span class=n>root</span><span class=w> </span><span class=o>-</span><span class=n>p12345612</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 此时远程连接查询到的数据只能是已经提交过的
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>但是这样还有问题，那就是假设一个事务在操作数据时，其他事务干扰了这个事务的数据。例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 小张在查询数据的时候发现：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>   </span><span class=mi>200</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1800</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 在小张求表的 money 平均值之前，小王做了一个操作：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>START</span><span class=w> </span><span class=n>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>COMMIT</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 此时表的真实数据是：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 这时小张再求平均值的时候，就会出现计算不相符合的情况：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>money</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=nf>AVG</span><span class=p>(</span><span class=n>money</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>820</span><span class=p>.</span><span class=mi>0000</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>虽然 <strong>READ COMMITTED</strong> 让我们只能读取到其他事务已经提交的数据，但还是会出现问题，就是<strong>在读取同一个表的数据时，可能会发生前后不一致的情况。<strong>这被称为</strong>不可重复读现象 ( READ COMMITTED )</strong> 。</p><h4 id=幻读>幻读</h4><p>将隔离级别设置为 <strong>REPEATABLE READ ( 可被重复读取 )</strong> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=kt>SET</span><span class=w> </span><span class=n>GLOBAL</span><span class=w> </span><span class=n>TRANSACTION</span><span class=w> </span><span class=n>ISOLATION</span><span class=w> </span><span class=n>LEVEL</span><span class=w> </span><span class=n>REPEATABLE</span><span class=w> </span><span class=k>READ</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>REPEATABLE</span><span class=o>-</span><span class=k>READ</span><span class=w>                </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>测试 <strong>REPEATABLE READ</strong> ，假设在两个不同的连接上分别执行 <code>START TRANSACTION</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 小张 - 成都
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>START</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;d&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 小王 - 北京
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>START</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 小张 - 成都
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>COMMIT</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>当前事务开启后，没提交之前，查询不到，提交后可以被查询到。但是，在提交之前其他事务被开启了，那么在这条事务线上，就不会查询到当前有操作事务的连接。相当于开辟出一条单独的线程。</p><p>无论小张是否执行过 <code>COMMIT</code> ，在小王这边，都不会查询到小张的事务记录，而是只会查询到自己所处事务的记录：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>----+-----------+-------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>----+-----------+-------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>c</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>----+-----------+-------+
</span></span></span></code></pre></td></tr></table></div></div><p>这是<strong>因为小王在此之前开启了一个新的事务 ( <code>START TRANSACTION</code> ) <strong>，那么</strong>在他的这条新事务的线上，跟其他事务是没有联系的</strong>，也就是说，此时如果其他事务正在操作数据，它是不知道的。</p><p>然而事实是，在真实的数据表中，小张已经插入了一条数据。但是小王此时并不知道，也插入了同一条数据，会发生什么呢？</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;d&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ERROR 1062 (23000): Duplicate entry &#39;6&#39; for key &#39;PRIMARY&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>报错了，操作被告知已存在主键为 <code>6</code> 的字段。这种现象也被称为<strong>幻读，一个事务提交的数据，不能被其他事务读取到</strong>。</p><h4 id=串行化>串行化</h4><p>顾名思义，就是所有事务的<strong>写入操作</strong>全都是串行化的。什么意思？把隔离级别修改成 <strong>SERIALIZABLE</strong> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=kt>SET</span><span class=w> </span><span class=n>GLOBAL</span><span class=w> </span><span class=n>TRANSACTION</span><span class=w> </span><span class=n>ISOLATION</span><span class=w> </span><span class=n>LEVEL</span><span class=w> </span><span class=n>SERIALIZABLE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>GLOBAL</span><span class=p>.</span><span class=n>TRANSACTION_ISOLATION</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>SERIALIZABLE</span><span class=w>                   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+--------------------------------+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>还是拿小张和小王来举例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1>-- 小张 - 成都
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>START</span><span class=w> </span><span class=n>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 小王 - 北京
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>START</span><span class=w> </span><span class=n>TRANSACTION</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 开启事务之前先查询表，准备操作数据。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>a</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>900</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>b</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>小明</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>淘宝店</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>c</span><span class=w>         </span><span class=o>|</span><span class=w>   </span><span class=mi>100</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>  </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>d</span><span class=w>         </span><span class=o>|</span><span class=w>  </span><span class=mi>1000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+----+-----------+-------+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 发现没有 7 号王小花，于是插入一条数据：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;王小花&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>此时会发生什么呢？由于现在的隔离级别是 <strong>SERIALIZABLE ( 串行化 )</strong> ，串行化的意思就是：假设把所有的事务都放在一个串行的队列中，那么所有的事务都会按照<strong>固定顺序执行</strong>，执行完一个事务后再继续执行下一个事务的<strong>写入操作</strong> ( <strong>这意味着队列中同时只能执行一个事务的写入操作</strong> ) 。</p><p>根据这个解释，小王在插入数据时，会出现等待状态，直到小张执行 <code>COMMIT</code> 结束它所处的事务，或者出现等待超时。</p><h2 id=索引优化>索引优化</h2><p>所谓索引就是为特定的 mysql 字段进行一些<strong>特定的算法排序</strong>，比如二叉树的算法和哈希算法</p><ul><li>哈希算法是通过建立特征值，然后根据特征值来快速查找。</li><li>而用的最多，并且是 mysql 默认的就是二叉树算法 BTREE，通过 BTREE 算法建立索引的字段，比如扫描 20 行就能得到未使用 BTREE 前扫描了 2^20^ 行的结果。</li></ul><h3 id=索引的类型>索引的类型</h3><p><strong>UNIQUE 唯一索引</strong></p><p>不可以出现相同的值，可以有 NULL 值。</p><p><strong>INDEX 普通索引</strong></p><p>允许出现相同的索引内容。</p><p><strong>PRIMARY KEY 主键索引</strong></p><p>不允许出现相同的值，且不能为 NULL 值，一个表只能有一个 primary_key 索引。</p><p><strong>fulltext index 全文索引</strong></p><p>上述三种索引都是针对列的值发挥作用，但全文索引，可以针对值中的某个单词，比如一篇文章中的某个词，然而并没有什么卵用，因为只有 myisam 以及英文支持，并且效率让人不敢恭维</p><h3 id=索引的相关操作>索引的相关操作</h3><h4 id=索引的创建><strong>索引的创建</strong></h4><h5 id=alter-table><code>ALTER TABLE</code></h5><p>适用于表创建完毕之后再添加。</p><p><code>ALTER TABLE 表名 ADD 索引类型 (unique,primary key,fulltext,index)[索引名](字段名)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>table_name</span><span class=o>`</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=o>`</span><span class=n>index_name</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>column_list</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=c1>-- 索引名，可要可不要；如果不要，当前的索引名就是该字段名。 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>table_name</span><span class=o>`</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>column_list</span><span class=o>`</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>table_name</span><span class=o>`</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>column_list</span><span class=o>`</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>table_name</span><span class=o>`</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>column_list</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=create-index><code>CREATE INDEX</code></h5><p>CREATE INDEX 可对表增加<strong>普通</strong>索引或 <strong>UNIQUE</strong> 索引。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--例：只能添加这两种索引 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=p>(</span><span class=n>column_list</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=p>(</span><span class=n>column_list</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>另外，还可以在建表时添加：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>test1</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>smallint</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=w> </span><span class=n>UNSIGNED</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w> </span><span class=c1>-- 注意，下面创建了主键索引，这里就不用创建了 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=o>`</span><span class=n>username</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;用户名&#39;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>nickname</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;昵称/姓名&#39;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>intro</span><span class=o>`</span><span class=w> </span><span class=nb>text</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>unique1</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>username</span><span class=o>`</span><span class=p>),</span><span class=w> </span><span class=c1>-- 索引名称，可要可不要，不要就是和列名一样 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>index1</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>nickname</span><span class=o>`</span><span class=p>),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>intro</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>intro</span><span class=o>`</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>MyISAM</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>4</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;后台用户表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=索引的删除>索引的删除</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=o>`</span><span class=n>index_name</span><span class=o>`</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=o>`</span><span class=n>talbe_name</span><span class=o>`</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>table_name</span><span class=o>`</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=o>`</span><span class=n>index_name</span><span class=o>`</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 这两句都是等价的,都是删除掉table_name中的索引index_name; 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>table_name</span><span class=o>`</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=c1>-- 删除主键索引，注意主键索引只能用这种方式删除
</span></span></span></code></pre></td></tr></table></div></div><h4 id=索引的查看>索引的查看</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>show</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>tablename</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=索引的更改>索引的更改</h4><p>更改个毛线，删掉重建一个既可</p><h3 id=创建索引的技巧>创建索引的技巧</h3><ol><li><p>维度高的列创建索引。</p></li><li><ul><li>数据列中<strong>不重复值</strong>出现的个数，这个数量越高，维度就越高。</li><li>如数据表中存在 8 行数据 a, b ,c, d, a, b ,c ,d 这个表的维度为 4。</li><li>要为维度高的列创建索引，如性别和年龄，那年龄的维度就高于性别。</li><li>性别这样的列不适合创建索引，因为维度过低。</li></ul></li><li><p>对 where, on, group by, order by 中出现的列使用索引。</p></li><li><p>对较小的数据列使用索引，这样会使索引文件更小，同时内存中也可以装载更多的索引键。</p></li><li><p>为较长的字符串使用前缀索引。</p></li><li><p>不要过多创建索引，除了增加额外的磁盘空间外，对于DML操作的速度影响很大，因为其每增删改一次就得从新建立索引。</p></li><li><p>使用组合索引，可以减少文件索引大小，在使用时速度要优于多个单列索引。</p></li></ol><h3 id=组合索引>组合索引</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>myIndex</span><span class=o>`</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=o>`</span><span class=n>name_city_age</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=n>vc_Name</span><span class=p>(</span><span class=mi>10</span><span class=p>),</span><span class=n>vc_City</span><span class=p>,</span><span class=n>i_Age</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>上述的步骤就是将 vc_Name,vc_City,i_Age 建到一个索引里</p><p>这样一来，在执行这条 SQL 查询语句时：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>`</span><span class=n>i_testID</span><span class=o>`</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=o>`</span><span class=n>myIndex</span><span class=o>`</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=o>`</span><span class=n>vc_Name</span><span class=o>`=</span><span class=s1>&#39;erquan&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>`</span><span class=n>vc_City</span><span class=o>`=</span><span class=s1>&#39;郑州&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>`</span><span class=n>i_Age</span><span class=o>`=</span><span class=mi>25</span><span class=p>;</span><span class=w> </span><span class=c1>-- 关联搜索;
</span></span></span></code></pre></td></tr></table></div></div><p>查询速度会比只建立某一个字段的单独索引要快得多</p><blockquote><p>如果分别在 vc_Name, vc_City, i_Age 上建立单列索引，让该表有 3 个单列索引，查询的速度将远远低于组合索引。</p><p>虽然此时有了三个索引，但 MySQL 只能用到其中的那个它认为似乎是<strong>最有效率</strong>的单列索引，另外两个是用不到的，也就是说还是一个全表扫描的过程。</p></blockquote><p>建立这样的组合索引，其实是相当于分别建立了：</p><ul><li>vc_Name,vc_City,i_Age</li><li>vc_Name,vc_City</li><li>vc_Name</li></ul><p>为什么没有 vc_City,i_Age 等这样的组合索引呢？这是因为 mysql 组合索引 “最左前缀” 的结果。简单的理解就是只从最左面的开始组合。并不是只要包含这三列的查询都会用到该组合索引，下面的几个 T-SQL 会用到：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>myIndex</span><span class=w> </span><span class=n>WHREE</span><span class=w> </span><span class=n>vc_Name</span><span class=o>=</span><span class=err>”</span><span class=n>erquan</span><span class=err>”</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>vc_City</span><span class=o>=</span><span class=err>”郑州”</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>myIndex</span><span class=w> </span><span class=n>WHREE</span><span class=w> </span><span class=n>vc_Name</span><span class=o>=</span><span class=err>”</span><span class=n>erquan</span><span class=err>”</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>而下面几个则不会用到：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>myIndex</span><span class=w> </span><span class=n>WHREE</span><span class=w> </span><span class=n>i_Age</span><span class=o>=</span><span class=mi>20</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>vc_City</span><span class=o>=</span><span class=err>”郑州”</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>myIndex</span><span class=w> </span><span class=n>WHREE</span><span class=w> </span><span class=n>vc_City</span><span class=o>=</span><span class=err>”郑州”</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>也就是，<code>name_city_age(vc_Name(10),vc_City,i_Age)</code> 会<strong>从左到右</strong>进行索引，如果没有左前索引，Mysql 不执行索引查询。</p><h3 id=前缀索引><strong>前缀索引</strong></h3><p>如果索引列长度过长，这种列索引时将会产生很大的索引文件，不便于操作，可以使用前缀索引方式进行索引前缀索引应该控制在一个合适的点，控制在 0.31 黄金值即可（大于这个值就可以创建）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=p>(</span><span class=k>LEFT</span><span class=p>(</span><span class=o>`</span><span class=n>title</span><span class=o>`</span><span class=p>,</span><span class=mi>10</span><span class=p>)))</span><span class=o>/</span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Arctic</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这个值大于 0.31 就可以创建前缀索引，Distinct 去重复</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>user</span><span class=o>`</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=o>`</span><span class=n>uname</span><span class=o>`</span><span class=p>(</span><span class=n>title</span><span class=p>(</span><span class=mi>10</span><span class=p>));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>增加前缀索引 SQL，将人名的索引建立在 10，这样可以减少索引文件大小，加快索引查询速度。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2022-08-15 10:22:35">更新于 2022-08-15</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://trouvaille0198.github.io/Notes/posts/database/mysql/ data-title="关于 MySQL 的一些笔记" data-hashtags=数据库,快速入门,MySQL><i class="fa-brands fa-twitter fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://trouvaille0198.github.io/Notes/posts/database/mysql/ data-hashtag=数据库><i class="fa-brands fa-facebook-square fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://trouvaille0198.github.io/Notes/posts/database/mysql/ data-title="关于 MySQL 的一些笔记"><i class="fa-brands fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw"></i>&nbsp;<a href=/Notes/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/>数据库</a>,&nbsp;<a href=/Notes/tags/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/>快速入门</a>,&nbsp;<a href=/Notes/tags/mysql/>MySQL</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/Notes/>主页</a></span></section></div><div class=post-nav><a href=/Notes/posts/%E5%88%B7%E9%A2%98/greedy/55.-%E8%B7%B3%E8%B7%83%E6%B8%B8%E6%88%8F/ class=prev rel=prev title="10. 正则表达式匹配"><i class="fa-solid fa-angle-left fa-fw"></i>10. 正则表达式匹配</a>
<a href=/Notes/posts/python/dataanalysis/numpy/ class=next rel=next title=numpy>numpy<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">酒困路长惟欲睡，日高人渴漫思茶</div><div class="footer-line copyright"><i class="fa-regular fa-copyright fa-fw"></i>
<span itemprop=copyrightYear>2022</span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fa-solid fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fa-solid fa-comment fa-fw"></i></a></div><div id=mask></div></div><link rel=stylesheet href=/Notes/lib/katex/katex.min.css><link rel=stylesheet href=/Notes/lib/katex/copy-tex.min.css><link rel=stylesheet href=/Notes/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/Notes/lib/autocomplete/autocomplete.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.stemmer.support.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.zh.min.js defer></script><script type=text/javascript src=/Notes/lib/lazysizes/lazysizes.min.js async defer></script><script type=text/javascript src=/Notes/lib/sharer/sharer.min.js async defer></script><script type=text/javascript src=/Notes/lib/katex/katex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/Notes/lib/cookieconsent/cookieconsent.min.js defer></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:45},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/Notes/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/Notes/lib/lunr/lunr.segmentit.js",maxResultLength:30,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/Notes/js/theme.min.js defer></script><script type=text/javascript src=/Notes/js/_custom.min.js defer></script></body></html>