<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Selenium - 伤心肠粉的酱油碟子</title><meta name=author content><meta name=author-link content><meta name=description content="Selenium 基本操作 Selenium 是一个自动化测试工具，利用它可以驱动浏览器执行特定的动作，如点击、下"><meta name=keywords content="Python"><meta itemprop=name content="Selenium"><meta itemprop=description content="Selenium 基本操作 Selenium 是一个自动化测试工具，利用它可以驱动浏览器执行特定的动作，如点击、下"><meta itemprop=datePublished content="2021-04-17T00:00:00+00:00"><meta itemprop=dateModified content="2023-06-28T06:53:19+00:00"><meta itemprop=wordCount content="3465"><meta itemprop=image content="https://trouvaille0198.github.io/logo.png"><meta itemprop=keywords content="Python,"><meta property="og:title" content="Selenium"><meta property="og:description" content="Selenium 基本操作 Selenium 是一个自动化测试工具，利用它可以驱动浏览器执行特定的动作，如点击、下"><meta property="og:type" content="article"><meta property="og:url" content="https://trouvaille0198.github.io/Notes/posts/python/crawler/selenium/"><meta property="og:image" content="https://trouvaille0198.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-17T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-28T06:53:19+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://trouvaille0198.github.io/logo.png"><meta name=twitter:title content="Selenium"><meta name=twitter:description content="Selenium 基本操作 Selenium 是一个自动化测试工具，利用它可以驱动浏览器执行特定的动作，如点击、下"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#252627"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://trouvaille0198.github.io/Notes/posts/python/crawler/selenium/><link rel=prev href=https://trouvaille0198.github.io/Notes/posts/python/crawler/xpath/><link rel=next href=https://trouvaille0198.github.io/Notes/posts/python/crawler/pyquery/><link rel=stylesheet href=/Notes/lib/normalize/normalize.min.css><link rel=stylesheet href=/Notes/css/style.min.css><link rel=stylesheet href=/Notes/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/Notes/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Selenium","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/python\/crawler\/selenium\/"},"genre":"posts","keywords":"Python","wordcount":3465,"url":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/python\/crawler\/selenium\/","datePublished":"2021-04-17T00:00:00+00:00","dateModified":"2023-06-28T06:53:19+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"MelonCholi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Selenium</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle"></i>
MelonCholi</span></span>
<span class=post-category>收录于 <a href=/Notes/categories/python/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Python</a></span></div><div class=post-meta-line><span title="2021-04-17 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-04-17>2021-04-17</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 3465 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#基本操作>基本操作</a><ul><li><a href=#导入>导入</a></li><li><a href=#声明浏览器对象>声明浏览器对象</a></li><li><a href=#其他操作>其他操作</a></li><li><a href=#cookies-操作>Cookies 操作</a><ul><li><a href=#获取-cookies>获取 Cookies</a></li><li><a href=#删除-cookies>删除 Cookies</a></li><li><a href=#添加-cookies>添加 Cookies</a></li></ul></li></ul></li><li><a href=#页面操作>页面操作</a><ul><li><a href=#前进后退>前进后退</a></li><li><a href=#标签页操作>标签页操作</a><ul><li><a href=#打开新标签页>打开新标签页</a></li><li><a href=#查看标签页>查看标签页</a></li><li><a href=#切换标签页>切换标签页</a></li></ul></li><li><a href=#切换-frame>切换 Frame</a></li><li><a href=#延时等待>延时等待</a><ul><li><a href=#隐式等待>隐式等待</a></li><li><a href=#显式等待>显式等待</a><ul><li><a href=#生成器>生成器</a></li><li><a href=#直到函数>直到函数</a></li><li><a href=#等待条件>等待条件</a></li><li><a href=#异常>异常</a></li></ul></li></ul></li></ul></li><li><a href=#节点操作>节点操作</a><ul><li><a href=#查找结点>查找结点</a><ul><li><a href=#单个节点>单个节点</a><ul><li><a href=#分类方法>分类方法</a></li><li><a href=#通用方法>通用方法</a></li></ul></li><li><a href=#多个节点>多个节点</a></li></ul></li><li><a href=#获取节点信息>获取节点信息</a><ul><li><a href=#基本信息>基本信息</a></li><li><a href=#判断操作>判断操作</a></li></ul></li></ul></li><li><a href=#交互操作>交互操作</a><ul><li><a href=#节点操作-1>节点操作</a></li><li><a href=#动作链>动作链</a><ul><li><a href=#拖曳>拖曳</a></li><li><a href=#点击>点击</a></li><li><a href=#键盘操作>键盘操作</a></li><li><a href=#移动>移动</a></li><li><a href=#发送按键>发送按键</a></li></ul></li><li><a href=#执行-javascript>执行 JavaScript</a></li><li><a href=#keys-对象>Keys 对象</a></li></ul></li><li><a href=#常见操作>常见操作</a></li></ul></nav></div></div><div class=content id=content><h1 id=selenium>Selenium</h1><h2 id=基本操作>基本操作</h2><p>Selenium 是一个自动化测试工具，利用它可以驱动浏览器执行特定的动作，如点击、下拉等操作，同时还可以获取浏览器当前呈现的页面的源代码，做到可见即可爬。对于一些 JavaScript 动态渲染的页面来说，此种抓取方式非常有效。</p><h3 id=导入>导入</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span> <span class=c1># 浏览器对象</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.common.by</span> <span class=kn>import</span> <span class=n>By</span> <span class=c1># find_element()</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.common.keys</span> <span class=kn>import</span> <span class=n>Keys</span> <span class=c1># 导入 Keys 对象</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.support</span> <span class=kn>import</span> <span class=n>expected_conditions</span> <span class=k>as</span> <span class=n>EC</span> <span class=c1># 显示等待条件</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.support.wait</span> <span class=kn>import</span> <span class=n>WebDriverWait</span> <span class=c1># 显示等待</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=声明浏览器对象>声明浏览器对象</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Firefox</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Edge</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>PhantomJS</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Safari</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=其他操作>其他操作</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.taobao.com&#39;</span><span class=p>)</span> 	<span class=c1># 访问 url</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>browser</span><span class=o>.</span><span class=n>current_url</span><span class=p>)</span> 				<span class=c1># 返回当前 url</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>browser</span><span class=o>.</span><span class=n>get_cookies</span><span class=p>())</span> 			<span class=c1># 返回 cookies</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>browser</span><span class=o>.</span><span class=n>page_source</span><span class=p>)</span>  			<span class=c1># 返回当前页面源码</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>close</span><span class=p>()</span> 						<span class=c1># 关闭当前标签页</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>                          <span class=c1># 关闭浏览器</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=cookies-操作>Cookies 操作</h3><h4 id=获取-cookies>获取 Cookies</h4><p><em><strong>.get_cookies()</strong></em></p><ul><li>返回现有 Cookies</li></ul><h4 id=删除-cookies>删除 Cookies</h4><p><em><strong>.delete_all_cookies()</strong></em></p><ul><li>删除现有 Cookies</li></ul><h4 id=添加-cookies>添加 Cookies</h4><p><em><strong>.add_cookie(dic_cookies)</strong></em></p><ul><li><em>dic_cookies</em>：字典形式的 Cookies</li></ul><h2 id=页面操作>页面操作</h2><p>页面操作以浏览器为对象</p><h3 id=前进后退>前进后退</h3><p><em><strong>.forward() .back()</strong></em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.baidu.com/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.taobao.com/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.python.org/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>back</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>forward</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>连续访问 3 个页面，然后调用 <code>back()</code> 方法回到第二个页面，接下来再调用 <code>forward()</code> 方法又可以前进到第三个页面。</p><h3 id=标签页操作>标签页操作</h3><h4 id=打开新标签页>打开新标签页</h4><p><em><strong>.execute_script(&lsquo;window.open()&rsquo;)</strong></em></p><h4 id=查看标签页>查看标签页</h4><p><em><strong>.window_handles</strong></em></p><ul><li>返回标签页列表</li></ul><h4 id=切换标签页>切换标签页</h4><p><em><strong>.switch_to_window(window_value)</strong></em></p><ul><li><em>window_value</em>：标签页名</li></ul><h3 id=切换-frame>切换 Frame</h3><p><em><strong>.switch_to_frame(window_value)</strong></em></p><p>网页中有一种节点叫作 iframe，也就是子 Frame，相当于页面的子页面，它的结构和外部网页的结构完全一致。Selenium 打开页面后，它默认是在父级 Frame 里面操作，而此时如果页面中还有子 Frame，它是不能获取到子 Frame 里面的节点的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>frame</span><span class=p>(</span><span class=s1>&#39;iframeResult&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>parent_frame</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=延时等待>延时等待</h3><p>在 Selenium 中，<code>get()</code> 方法会在网页框架加载结束后结束执行，此时如果获取 <code>page_source</code>，可能并不是浏览器完全加载完成的页面，如果某些页面有额外的 Ajax 请求，我们在网页源代码中也不一定能成功获取到。所以，这里需要延时等待一定时间，确保节点已经加载出来</p><h4 id=隐式等待>隐式等待</h4><p><em><strong>.implicitly_wait(seconds)</strong></em></p><p>如果 Selenium 没有在 DOM 中找到节点，将继续等待，超出设定时间后，则抛出找不到节点的异常</p><p>隐式等待的效果其实并没有那么好，因为我们只规定了一个固定时间，而页面的加载时间会受到网络条件的影响</p><h4 id=显式等待>显式等待</h4><p>先指定要查找的节点，然后指定一个<strong>最长等待时间</strong>。如果在规定时间内加载出来了这个节点，就返回查找的节点；如果到了规定时间依然没有加载出该节点，则抛出超时异常</p><h5 id=生成器>生成器</h5><p><em><strong>WebDriverWait(driver,timeout,poll_frequency=0.5,ignored_exceptions=None)</strong></em></p><ul><li><em>driver</em>：浏览器驱动</li><li><em>timeout</em>：最长超时时间，默认以秒为单位</li><li><em>poll_frequency</em>：检测的间隔步长，默认为 0.5s</li><li><em>ignored_exceptions</em>：超时后的抛出的异常信息，默认抛出 NoSuchElementExeception 异常。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>wait</span> <span class=o>=</span> <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>browser</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span> <span class=c1># 传入浏览器生成器和最长等待时间</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=直到函数>直到函数</h5><p><strong><em>until(method)</em> 和 <em>until_not(method)</em></strong></p><ul><li><p>以显示等待为对象</p></li><li><p><em>method</em>：expected_conditions</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>wait</span> <span class=o>=</span> <span class=n>WebDriverWait</span><span class=p>(</span><span class=n>browser</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>presence_of_element_located</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>ID</span><span class=p>,</span> <span class=s1>&#39;q&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>button</span> <span class=o>=</span> <span class=n>wait</span><span class=o>.</span><span class=n>until</span><span class=p>(</span><span class=n>EC</span><span class=o>.</span><span class=n>element_to_be_clickable</span><span class=p>((</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s1>&#39;.btn-search&#39;</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=等待条件>等待条件</h5><p>（expected_conditions）</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>title_is</td><td>判断当前页面的 title 是否完全等于（==）预期字符串，返回布尔值</td></tr><tr><td>title_contains</td><td>判断当前页面的 title 是否包含预期字符串，返回布尔值</td></tr><tr><td><strong>presence_of_element_located</strong></td><td>判断某个元素是否被加到了 dom 树里，并不代表该元素一定可见</td></tr><tr><td>visibility_of_element_located</td><td>判断元素是否可见（可见代表元素非隐藏，并且元素宽和高都不等于 0）</td></tr><tr><td>visibility_of</td><td>同上一方法，只是上一方法参数为locator，这个方法参数是 定位后的元素</td></tr><tr><td>presence_of_all_elements_located</td><td>判断是否至少有 1 个元素存在于 dom 树中。举例：如果页面上有 n 个元素的 class 都是’wp’，那么只要有 1 个元素存在，这个方法就返回 True</td></tr><tr><td>text_to_be_present_in_element</td><td>判断某个元素中的 text 是否 包含 了预期的字符串</td></tr><tr><td>text_to_be_present_in_element_value</td><td>判断某个元素中的 value 属性是否包含 了预期的字符串</td></tr><tr><td>frame_to_be_available_and_switch_to_it</td><td>判断该 frame 是否可以 switch进去，如果可以的话，返回 True 并且 switch 进去，否则返回 False</td></tr><tr><td>invisibility_of_element_located</td><td>判断某个元素中是否不存在于dom树或不可见</td></tr><tr><td>element_to_be_clickable</td><td>判断某个元素中是否可见并且可点击</td></tr><tr><td>staleness_of</td><td>等某个元素从 dom 树中移除，注意，这个方法也是返回 True或 False</td></tr><tr><td>element_to_be_selected</td><td>判断某个元素是否被选中了,一般用在下拉列表</td></tr><tr><td>element_selection_state_to_be</td><td>判断某个元素的选中状态是否符合预期</td></tr><tr><td>element_located_selection_state_to_be</td><td>跟上面的方法作用一样，只是上面的方法传入定位到的 element，而这个方法传入 locator</td></tr><tr><td>alert_is_present</td><td>判断页面上是否存在 alert</td></tr></tbody></table><h5 id=异常>异常</h5><p>如果网络有问题，在设定时间内内没有成功加载，那就抛出 <code>TimeoutException</code> 异常</p><h2 id=节点操作>节点操作</h2><p>节点操作均以节点为对象</p><h3 id=查找结点>查找结点</h3><h4 id=单个节点>单个节点</h4><p>返回元素节点，为 <code>WebElement </code>类型</p><h5 id=分类方法>分类方法</h5><p><em><strong>.find_element_by_XXX()</strong></em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>find_element_by_id</span><span class=p>(</span><span class=s1>&#39;id_vaule&#39;</span><span class=p>)</span> 				<span class=c1># 通过 id 定位元素</span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_name</span><span class=p>(</span><span class=s1>&#39;name_vaule&#39;</span><span class=p>)</span> 			<span class=c1># 通过 name 定位元素</span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_tag_name</span><span class=p>(</span><span class=s1>&#39;tag_name_vaule&#39;</span><span class=p>)</span> 	<span class=c1># 通过 tag_name 定位元素</span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_class_name</span><span class=p>(</span><span class=s1>&#39;class_name&#39;</span><span class=p>)</span> 	<span class=c1># 通过 class_name 定位元素 </span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_link_text</span><span class=p>(</span><span class=s1>&#39;text_vaule&#39;</span><span class=p>)</span> 	<span class=c1># 通过link标签（也就是a）的文本内容定位元素</span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_partial_link_text</span><span class=p>(</span><span class=s1>&#39;partial_text_vaule&#39;</span><span class=p>)</span> 	<span class=c1># 通过link标签的部分文本内容定位元素</span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_css_selector</span><span class=p>(</span><span class=s1>&#39;css_selector&#39;</span><span class=p>)</span> 				<span class=c1># 通过 css 选择器定位元素</span>
</span></span><span class=line><span class=cl><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;xpath&#39;</span><span class=p>)</span> 								<span class=c1># 通过 xpath 定位元素</span>
</span></span></code></pre></td></tr></table></div></div><p>例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_element_by_id</span><span class=p>(</span><span class=s2>&#34;coolestWidgetEvah&#34;</span><span class=p>)</span>                          <span class=c1>#按ID查找</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_elements_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;q&#34;]&#39;</span><span class=p>)</span>                              <span class=c1>#通过Xpath</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_elements_by_class_name</span><span class=p>(</span><span class=s2>&#34;cheese&#34;</span><span class=p>)</span>                         <span class=c1>#按类名查找</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_elements_by_link_text</span><span class=p>(</span><span class=s2>&#34;cheese&#34;</span><span class=p>)</span>                              <span class=c1>#按文本查找</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_elements_by_partial_link_text</span><span class=p>(</span><span class=s2>&#34;cheese&#34;</span><span class=p>)</span>                  <span class=c1>#按文本查找(模糊)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_elements_by_tag_name</span><span class=p>(</span><span class=s2>&#34;iframe&#34;</span><span class=p>)</span>                            <span class=c1>#按标签查找</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>find_elements_by_name</span><span class=p>(</span><span class=s2>&#34;cheese&#34;</span><span class=p>)</span>                                <span class=c1>#按名称查找</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=通用方法>通用方法</h5><p><em><strong>.find_element(By.XXX, value)</strong></em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>ID</span> <span class=o>=</span> <span class=s2>&#34;id&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span> <span class=o>=</span> <span class=s2>&#34;xpath&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>LINK_TEXT</span> <span class=o>=</span> <span class=s2>&#34;link text&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>PARTIAL_LINK_TEXT</span> <span class=o>=</span> <span class=s2>&#34;partial link text&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>NAME</span> <span class=o>=</span> <span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>TAG_NAME</span> <span class=o>=</span> <span class=s2>&#34;tag name&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>CLASS_NAME</span> <span class=o>=</span> <span class=s2>&#34;class name&#34;</span>
</span></span><span class=line><span class=cl><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span> <span class=o>=</span> <span class=s2>&#34;css selector&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=多个节点>多个节点</h4><p>如果要查找所有满足条件的节点，需要用 <code>find_elements()</code> 这样的方法。</p><p>返回节点列表，每个节点都是 <code>WebElement </code>类型。</p><h3 id=获取节点信息>获取节点信息</h3><h4 id=基本信息>基本信息</h4><ul><li><p><em><strong>.get_attribute(value)</strong></em></p><ul><li>获取属性 Gets the given attribute or property of the element.</li><li><em>value</em>：属性名</li></ul></li><li><p><em><strong>.text</strong></em></p><ul><li>获取文本</li></ul></li><li><p><em><strong>.id</strong></em></p><ul><li>获取 id，Internal ID used by selenium.</li></ul></li><li><p><em><strong>.location</strong></em></p><ul><li>节点在页面中的相对位置，The location of the element in the renderable canvas.</li></ul></li><li><p><em><strong>.size</strong></em></p><ul><li>获取节点大小（宽高），The size of the element.</li></ul></li><li><p><em><strong>.tag_name</strong></em></p><ul><li>获取标签名称，This element’s <code>tagName</code> property.</li></ul></li></ul><h4 id=判断操作>判断操作</h4><ul><li><p><em><strong>is_displayed()</strong></em></p><ul><li>是否可见，Whether the element is visible to a user.</li></ul></li><li><p><em><strong>is_enabled()</strong></em></p><ul><li>是否可使用，Returns whether the element is enabled.</li></ul></li><li><p><em><strong>is_selected()</strong></em></p><ul><li>是否被选中，Returns whether the element is selected.Can be used to check if a checkbox or radio button is selected.</li></ul></li></ul><h2 id=交互操作>交互操作</h2><p>Selenium 可以驱动浏览器来执行一些操作，也就是说可以让浏览器模拟执行一些动作</p><h3 id=节点操作-1>节点操作</h3><p>以节点为对象的操作</p><ul><li><p><em><strong>.send_keys(value)</strong></em></p><ul><li>选定元素进行输入，Simulates typing into the element.</li><li><em>value</em>：输入的值，可以是字符串也可以是 <code>Keys</code> 类型</li></ul></li><li><p><em><strong>.clear()</strong></em></p><ul><li>清空输入框 Clears the text if it’s a text entry element.</li></ul></li><li><p><em><strong>.click()</strong></em></p><ul><li>点击元素，Clicks the element</li></ul></li><li><p><em><strong>.submit()</strong></em></p><ul><li>提交，Submits a form.</li></ul></li><li><p><em><strong>.screenshot(path)</strong></em></p><ul><li>节点截图，Saves a screenshot of the current element to a PNG image file.</li><li>path：路径</li><li>usage： <code>element.screenshot(‘/Screenshots/foo.png’)</code></li></ul></li></ul><h3 id=动作链>动作链</h3><p>还有另外一些操作，它们没有特定的执行对象，比如鼠标拖曳、键盘按键等，这些动作用动作链来执行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>actions</span> <span class=o>=</span> <span class=n>ActionChains</span><span class=p>(</span><span class=n>browser</span><span class=p>)</span> <span class=c1># 声明动作链对象</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>actions</span><span class=o>.</span><span class=n>perform</span><span class=p>()</span> <span class=c1># 执行操作</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=拖曳>拖曳</h4><ul><li><p><em><strong>.drag_and_drop(source, target)</strong></em></p><ul><li>元素拖曳到另一个元素</li><li>source：起始节点</li><li>target：终止节点</li></ul></li><li><p><em><strong>.drag_and_drop_by_offset(source, xoffset, yoffset)</strong></em></p><ul><li><p>元素按偏移量拖曳</p></li><li><p>source：The element to mouse down.</p></li><li><p>xoffset：X offset to move to.</p></li><li><p>yoffset：Y offset to move to.</p></li></ul></li></ul><h4 id=点击>点击</h4><ul><li><p><em><strong>.click(on_element=None)</strong></em></p><ul><li>点击元素，Clicks an element</li><li><em>on_element</em>：The element to click. If None, clicks on current mouse position</li></ul></li><li><p><em><strong>.click_and_hold()</strong></em></p><ul><li>按住元素，Holds down the left mouse button on an element.</li></ul></li><li><p><em><strong>.release()</strong></em></p><ul><li>释放，Releasing a held mouse button on an element.</li></ul></li><li><p><em><strong>.context_click()</strong></em></p><ul><li>右键单击元素，Performs a context-click (right click) on an element.</li></ul></li><li><p><em><strong>.double_click()</strong></em></p><ul><li>双击元素，Double-clicks an element.</li></ul></li></ul><h4 id=键盘操作>键盘操作</h4><ul><li><p><em><strong>.key_down(value)</strong></em></p><ul><li><p>按下不放，Sends a key press only, without releasing it.</p><p>Should only be used with modifier keys (Control, Alt and Shift).</p></li><li><p><em>value</em>：<code>Keys</code>对象，The modifier key to send.</p></li><li><p>usage：<code>ActionChains(driver).key_down(Keys.CONTROL).send_keys('c').key_up(Keys.CONTROL).perform()</code>（pressing ctrl+c:）</p></li></ul></li><li><p><em><strong>.key_up(value)</strong></em></p><ul><li>松开，Releases a modifier key.</li><li><em>value</em>：<code>Keys</code> 对象，The modifier key to send.</li></ul></li></ul><h4 id=移动>移动</h4><ul><li><p><em><strong>.move_to_element(to_element)</strong></em></p><ul><li>将光标移至元素中央，Moving the mouse to the middle of an element.</li><li><em>to_element</em>：The WebElement to move to.</li></ul></li><li><p><em><strong>.move_to_element_with_offset(to_element, xoffset, yoffset)</strong></em></p><ul><li><p>将光标移动指定偏移量，Move the mouse by an offset of the specified element.</p><p>Offsets are relative to the top-left corner of the element.</p></li><li><p><em>to_element</em>：The WebElement to move to.</p></li><li><p><em>xoffset</em>：X offset to move to.</p></li><li><p><em>yoffset</em>：Y offset to move to.</p></li></ul></li></ul><h4 id=发送按键>发送按键</h4><ul><li><em><strong>.send_keys(keys_to_send)</strong></em><ul><li>发送，Sends keys to current focused element.</li><li><em>keys_to_send</em>：<code>Keys </code>对象，The keys to send. Modifier keys constants can be found in the ‘Keys’ class.</li></ul></li><li><em><strong>.send_keys_to_element(element, keys_to_send)</strong></em><ul><li>发送到指定节点，Sends keys to an element.</li><li><em>element</em>：The element to send keys.</li><li><em>keys_to_send</em>：<code>Keys</code> 对象</li></ul></li></ul><h3 id=执行-javascript>执行 JavaScript</h3><p><em><strong>browser.execute_script(JS_action)</strong></em></p><ul><li>JS_action：jS 指令</li></ul><p>例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.zhihu.com/explore&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s1>&#39;window.scrollTo(0, document.body.scrollHeight)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s1>&#39;alert(&#34;To Bottom&#34;)&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=keys-对象>Keys 对象</h3><p>我们经常需要模拟键盘的输入，当输入普通的值时，在 send_keys()方法中传入要输入的字符串就好了。</p><p>但是我们有时候会用到一些特殊的按键，这时候就需要用到我们的 Keys 类</p><p>例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>elem</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=n>Keys</span><span class=o>.</span><span class=n>CONTROL</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>按键</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ADD</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue025</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ALT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00a</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ARROW_DOWN</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue015</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ARROW_LEFT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue012</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ARROW_RIGHT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue014</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ARROW_UP</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue013</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>BACKSPACE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue003</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>BACK_SPACE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue003</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>CANCEL</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue001</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>CLEAR</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue005</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>COMMAND</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue03d</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>CONTROL</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue009</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>DECIMAL</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue028</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>DELETE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue017</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>DIVIDE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue029</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>DOWN</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue015</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>END</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue010</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ENTER</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue007</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>EQUALS</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue019</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>ESCAPE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00c</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F1</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue031</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F10</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue03a</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F11</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue03b</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F12</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue03c</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F2</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue032</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F3</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue033</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F4</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue034</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F5</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue035</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F6</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue036</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F7</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue037</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F8</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue038</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>F9</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue039</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>HELP</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue002</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>HOME</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue011</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>INSERT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue016</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>LEFT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue012</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>LEFT_ALT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00a</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>LEFT_CONTROL</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue009</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>LEFT_SHIFT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue008</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>META</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue03d</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>MULTIPLY</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue024</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NULL</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue000</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD0</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue01a</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD1</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue01b</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD2</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue01c</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD3</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue01d</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD4</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue01e</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD5</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue01f</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD6</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue020</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD7</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue021</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD8</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue022</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>NUMPAD9</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue023</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>PAGE_DOWN</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00f</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>PAGE_UP</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00e</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>PAUSE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00b</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>RETURN</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue006</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>RIGHT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue014</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>SEMICOLON</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue018</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>SEPARATOR</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue026</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>SHIFT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue008</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>SPACE</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue00d</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>SUBTRACT</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue027</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>TAB</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue004</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>UP</span> <span class=o>=</span> <span class=sa>u</span><span class=s1>&#39;</span><span class=se>\ue013</span><span class=s1>&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=常见操作>常见操作</h2><ol><li>设置浏览器类的 options 选项</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>options</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>ChromeOptions</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># 不加载图片,加快访问速度</span>
</span></span><span class=line><span class=cl><span class=n>options</span><span class=o>.</span><span class=n>add_experimental_option</span><span class=p>(</span><span class=s2>&#34;prefs&#34;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&#34;profile.managed_default_content_settings.images&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>})</span> 
</span></span><span class=line><span class=cl><span class=c1># 此步骤很重要，设置为开发者模式，防止被各大网站识别出来使用了Seleniu</span>
</span></span><span class=line><span class=cl><span class=n>options</span><span class=o>.</span><span class=n>add_experimental_option</span><span class=p>(</span><span class=s1>&#39;excludeSwitches&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;enable-automation&#39;</span><span class=p>])</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>browser</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>options</span><span class=o>=</span><span class=n>options</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>弹出框的处理 <em>switch_to.alert</em></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>alert</span><span class=o>.</span><span class=n>accept</span><span class=p>()</span> <span class=c1># 确认</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>alert</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s1>&#39;abc&#39;</span><span class=p>)</span><span class=c1># 输入文本</span>
</span></span><span class=line><span class=cl><span class=n>browser</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>alert</span><span class=o>.</span><span class=n>dismiss</span><span class=p>()</span> <span class=c1># 取消</span>
</span></span><span class=line><span class=cl><span class=n>brower</span><span class=o>.</span><span class=n>switch_to_alert</span><span class=p>()</span><span class=o>.</span><span class=n>text</span> <span class=c1># 获取文本</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-06-28 06:53:19">更新于 2023-06-28</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://trouvaille0198.github.io/Notes/posts/python/crawler/selenium/ data-title=Selenium data-hashtags=Python><i class="fa-brands fa-twitter fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://trouvaille0198.github.io/Notes/posts/python/crawler/selenium/ data-hashtag=Python><i class="fa-brands fa-facebook-square fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://trouvaille0198.github.io/Notes/posts/python/crawler/selenium/ data-title=Selenium><i class="fa-brands fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw"></i>&nbsp;<a href=/Notes/tags/python/>Python</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/Notes/>主页</a></span></section></div><div class=post-nav><a href=/Notes/posts/python/crawler/xpath/ class=prev rel=prev title=Xpath><i class="fa-solid fa-angle-left fa-fw"></i>Xpath</a>
<a href=/Notes/posts/python/crawler/pyquery/ class=next rel=next title=PyQuery>PyQuery<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">酒困路长惟欲睡，日高人渴漫思茶</div><div class="footer-line copyright"><i class="fa-regular fa-copyright fa-fw"></i>
<span itemprop=copyrightYear>2022 - 2023</span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fa-solid fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fa-solid fa-comment fa-fw"></i></a></div><div id=mask></div></div><link rel=stylesheet href=/Notes/lib/katex/katex.min.css><link rel=stylesheet href=/Notes/lib/katex/copy-tex.min.css><link rel=stylesheet href=/Notes/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/Notes/lib/autocomplete/autocomplete.min.js defer></script><script type=text/javascript src=/Notes/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script type=text/javascript src=/Notes/lib/lazysizes/lazysizes.min.js async defer></script><script type=text/javascript src=/Notes/lib/sharer/sharer.min.js async defer></script><script type=text/javascript src=/Notes/lib/katex/katex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/Notes/lib/cookieconsent/cookieconsent.min.js defer></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:45},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"7I9AMOLA4S",algoliaIndex:"Notes",algoliaSearchKey:"3c1638dfe9f4d49a59d81ff6943416b8",highlightTag:"em",maxResultLength:30,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"}}</script><script type=text/javascript src=/Notes/js/theme.min.js defer></script><script type=text/javascript src=/Notes/js/_custom.min.js defer></script></body></html>