<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>CV2 - 伤心肠粉的酱油碟子</title><meta name=Description content><meta property="og:title" content="CV2"><meta property="og:description" content="CV2 认识 安装 1 2 pip install opencv-python pip install opencv-contrib-python 图片的基本操作 图片的加载、显示与保存 1 2 3 4 5 6 7 8 9"><meta property="og:type" content="article"><meta property="og:url" content="https://trouvaille0198.github.io/Notes/posts/python/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/cv2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-14T14:33:49+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="CV2"><meta name=twitter:description content="CV2 认识 安装 1 2 pip install opencv-python pip install opencv-contrib-python 图片的基本操作 图片的加载、显示与保存 1 2 3 4 5 6 7 8 9"><meta name=application-name content="伤心肠粉的酱油碟子"><meta name=apple-mobile-web-app-title content="伤心肠粉的酱油碟子"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://trouvaille0198.github.io/Notes/posts/python/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/cv2/><link rel=prev href=https://trouvaille0198.github.io/Notes/posts/%E5%88%B7%E9%A2%98/array/%E5%89%91%E6%8C%87-offer-03.-%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97/><link rel=next href=https://trouvaille0198.github.io/Notes/posts/%E5%88%B7%E9%A2%98/array/4.-%E5%AF%BB%E6%89%BE%E4%B8%A4%E4%B8%AA%E6%AD%A3%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/><link rel=stylesheet href=/Notes/lib/normalize/normalize.min.css><link rel=stylesheet href=/Notes/css/style.min.css><link rel=stylesheet href=/Notes/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/Notes/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"CV2","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/python\/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86\/cv2\/"},"genre":"posts","keywords":"快速开始, Python, cv2","wordcount":4930,"url":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/python\/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86\/cv2\/","datePublished":"2022-02-20T00:00:00+00:00","dateModified":"2022-03-14T14:33:49+00:00","publisher":{"@type":"Organization","name":"MelonCholi"},"author":{"@type":"Person","name":"MelonCholi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":''==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:''==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子>伤心肠粉</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/Notes/categories/>分类 </a><a class=menu-item href=/Notes/tags/>标签 </a><a class=menu-item href=/Notes/posts/>文章 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子>伤心肠粉</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/Notes/categories/ title>分类</a><a class=menu-item href=/Notes/tags/ title>标签</a><a class=menu-item href=/Notes/posts/ title>文章</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">CV2</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/Notes/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>MelonCholi</a></span>&nbsp;<span class=post-category>收录于 <a href=/Notes/categories/python/><i class="far fa-folder fa-fw"></i>Python</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-02-20>2022-02-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 4930 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 10 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#认识>认识</a><ul><li><a href=#安装>安装</a></li></ul></li><li><a href=#图片的基本操作>图片的基本操作</a><ul><li><a href=#图片的加载显示与保存>图片的加载、显示与保存</a></li><li><a href=#图像显示窗口创建与销毁>图像显示窗口创建与销毁</a></li><li><a href=#图像对象的属性>图像对象的属性</a></li><li><a href=#图像颜色空间>图像颜色空间</a></li><li><a href=#图像的几何变换>图像的几何变换</a></li><li><a href=#图像三通道分离和合并>图像三通道分离和合并</a></li><li><a href=#正确的退出方法>正确的退出方法</a></li><li><a href=#实现正常退出>实现正常退出</a></li></ul></li><li><a href=#滤波>滤波</a><ul><li><a href=#均值滤波>均值滤波</a></li><li><a href=#中值滤波>中值滤波</a></li><li><a href=#高斯滤波>高斯滤波</a></li></ul></li><li><a href=#图像提取>图像提取</a></li><li><a href=#阈值分割>阈值分割</a><ul><li><a href=#二值阈值分割>二值阈值分割</a></li><li><a href=#自适应阈值分割>自适应阈值分割</a></li></ul></li><li><a href=#标记>标记</a></li><li><a href=#其他图片操作>其他图片操作</a><ul><li><a href=#添加文字>添加文字</a></li></ul></li><li><a href=#视频的基本操作>视频的基本操作</a><ul><li><a href=#获取视频>获取视频</a><ul><li><a href=#获取本地视频>获取本地视频</a></li><li><a href=#获取摄像头>获取摄像头</a></li></ul></li><li><a href=#读入视频>读入视频</a></li><li><a href=#播放视频>播放视频</a></li><li><a href=#保存视频>保存视频</a></li><li><a href=#保存帧图像>保存帧图像</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=cv2>CV2</h1><h2 id=认识>认识</h2><h3 id=安装>安装</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pip install opencv-python 
</span></span><span class=line><span class=cl>pip install opencv-contrib-python
</span></span></code></pre></td></tr></table></div></div><h2 id=图片的基本操作>图片的基本操作</h2><h3 id=图片的加载显示与保存>图片的加载、显示与保存</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=c1># 生成图片</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;1.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 生成灰色图片</span>
</span></span><span class=line><span class=cl><span class=n>imgGrey</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;1.jpg&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 展示原图</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span> <span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 展示灰色图片</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;imgGrey&#34;</span><span class=p>,</span> <span class=n>imgGrey</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 等待图片的关闭</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># 保存灰色图片</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s2>&#34;Copy.jpg&#34;</span><span class=p>,</span> <span class=n>imgGrey</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.imread(filepath, flags)</strong></em></p><ul><li>读入一张图像</li><li><em>filepath</em>：图片路径</li><li><em>flags</em>：读入图片的标志<ul><li><code>cv2.IMREAD_COLOR</code>：<strong>默认参数</strong>，读入一副彩色图片，忽略 alpha 通道</li><li><code>cv2.IMREAD_GRAYSCALE</code>：读入灰度图片</li><li><code>cv2.IMREAD_UNCHANGED</code>：顾名思义，读入完整图片，包括 alpha 通道</li></ul></li></ul><p><em><strong>cv2.imshow(wname, img)</strong></em></p><ul><li><p>显示图像</p></li><li><p><em>wname</em>：显示图像的窗口的名字</p></li><li><p><em>img</em>：要显示的图像（imread 读入的图像），窗口大小自动调整为图片大小</p></li></ul><p><em><strong>cv2.imwrite(file, img, num)</strong></em></p><ul><li>保存一张图像</li><li><em>file</em>：是要保存的文件名</li><li><em>img</em>：要保存的图像。</li><li><em>num</em>：压缩级别。默认为 3</li></ul><p><em><strong>cv2.waitKey(time)</strong></em></p><ul><li>等待指定时间内是否有键盘输入<ul><li>若在等待时间内按下任意键则返回按键的ASCII码，程序继续运行</li><li>若没有按下任何键，超时后返回 -1。参数为 0 表示无限等待（只显示第一帧）</li><li>不调用此函数的话，窗口会一闪而逝，看不到显示的图片</li></ul></li><li><em>time</em>：时间，单位为毫秒</li></ul><p><em><strong>img.copy()</strong></em></p><ul><li>图像复制</li></ul><p><em><strong>np.zeros(img.shape, np.uint8)</strong></em></p><ul><li>返回指定大小的空图像</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;1.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imgZero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>img</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>imgFix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>300</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># imgFix = np.zeros((300,500),np.uint8)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span> <span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;imgZero&#34;</span><span class=p>,</span> <span class=n>imgZero</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;imgFix&#34;</span><span class=p>,</span> <span class=n>imgFix</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=图像显示窗口创建与销毁>图像显示窗口创建与销毁</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;1.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>namedWindow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>WINDOW_NORMAL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span> <span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.namedWindow(wname, flag)</strong></em></p><ul><li><p>创建一个窗口</p></li><li><p><em>wname</em>：窗口名</p></li><li><p>flag：指定窗口大小模式</p><ul><li>cv2.WINDOW_AUTOSIZE：默认值，根据图像大小自动创建大小</li><li>cv2.WINDOW_NORMAL：窗口大小可调整</li><li>cv2.destoryAllWindows（窗口名）：删除任何建立的窗口</li></ul></li></ul><p><em><strong>cv2.destroyAllWindow()</strong></em></p><ul><li>销毁所有窗口</li></ul><p><em><strong>cv2.destroyWindow(wname)</strong></em></p><ul><li>销毁指定窗口</li><li><em>wname</em>：窗口名</li></ul><h3 id=图像对象的属性>图像对象的属性</h3><p><em><strong>img.shape</strong></em></p><ul><li>返回图像高（图像矩阵的行数）、宽（图像矩阵的列数）和通道数 3 个属性组成的元组</li><li>若图像是非彩色图，则只返回高和宽组成的元组。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;1.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imgGrey</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;1.jpg&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sp1</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl><span class=n>sp2</span> <span class=o>=</span> <span class=n>imgGrey</span><span class=o>.</span><span class=n>shape</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sp1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sp2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># ======输出=======</span>
</span></span><span class=line><span class=cl><span class=c1>#(1200, 1920, 3)</span>
</span></span><span class=line><span class=cl><span class=c1>#(1200, 1920)</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>img.size</strong></em></p><ul><li>图像像素总数目</li></ul><p><em><strong>img.dtype</strong></em></p><ul><li>图像数据类型，一般情况下都是 uint8</li></ul><p><em><strong>img[B, G, R]</strong></em></p><ul><li>访问图像对应位置的像素</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#获取图像的三通道</span>
</span></span><span class=line><span class=cl><span class=n>blue</span><span class=p>,</span><span class=n>green</span><span class=p>,</span><span class=n>red</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>    
</span></span><span class=line><span class=cl><span class=c1>#或者</span>
</span></span><span class=line><span class=cl><span class=n>blue</span> <span class=o>=</span> <span class=n>f</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>green</span> <span class=o>=</span> <span class=n>f</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>red</span> <span class=o>=</span> <span class=n>f</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>OpenCV 中图像矩阵的顺序是B、G、R。可以直接通过坐标位置访问和操作图像像素。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;01.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>numb</span> <span class=o>=</span> <span class=n>img</span><span class=p>[</span><span class=mi>50</span><span class=p>,</span><span class=mi>100</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>numb</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span><span class=p>[</span><span class=mi>50</span><span class=p>,</span><span class=mi>100</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span><span class=c1>#将50，100处的像素点改为红色</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>分开访问图像某一通道像素值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;01.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>100</span><span class=p>,</span><span class=mi>100</span><span class=p>:</span><span class=mi>200</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl><span class=n>img</span><span class=p>[</span><span class=mi>100</span><span class=p>:</span><span class=mi>200</span><span class=p>,</span><span class=mi>200</span><span class=p>:</span><span class=mi>300</span><span class=p>,</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl><span class=n>img</span><span class=p>[</span><span class=mi>200</span><span class=p>:</span><span class=mi>300</span><span class=p>,</span><span class=mi>300</span><span class=p>:</span><span class=mi>400</span><span class=p>,</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>更改某一矩阵中的像素值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;01.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>50</span><span class=p>,</span><span class=mi>1</span><span class=p>:</span><span class=mi>100</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;img&#34;</span><span class=p>,</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=图像颜色空间>图像颜色空间</h3><p><em><strong>cv2.cvtColor(img, cv2.COLOR_X2Y)</strong></em></p><ul><li>图像颜色空间转换</li><li><em>img</em>：图像对象</li><li><em>cv2.COLOR_X2Y</em>：从 X 图像转为 Y 图像<ul><li>其中 X, Y = RGB, BGR, GRAY, HSV, YCrCb, XYZ, Lab, Luv, HLS</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img2</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>img</span><span class=p>,</span><span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_RGB2GRAY</span><span class=p>)</span>   <span class=c1>#灰度化：彩色图像转为灰度图像</span>
</span></span><span class=line><span class=cl><span class=n>img3</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>img</span><span class=p>,</span><span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_GRAY2RGB</span><span class=p>)</span>   <span class=c1>#彩色化：灰度图像转为彩色图像</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=图像的几何变换>图像的几何变换</h3><p><em><strong>cv2.resize(image, dsize, fx, fy, interpolation)</strong></em></p><ul><li><p>图像缩放，返回缩放后的图像</p></li><li><p><em>img</em>：原始图像</p></li><li><p><em>dsize</em>：图像大小，宽度在前，高度在后，如 <code>(200, 100)</code></p></li><li><p><em>fx</em>：代表水平方向上（图像宽度）的缩放系数</p></li><li><p><em>fy</em>：代表竖直方向上（图像高度）的缩放系数</p></li><li><table><thead><tr><th>interpolation 选项</th><th>所用的插值方法</th></tr></thead><tbody><tr><td>INTER_NEAREST</td><td>最近邻插值</td></tr><tr><td>INTER_LINEAR</td><td>双线性插值（默认设置）</td></tr><tr><td>INTER_AREA</td><td>使用像素区域关系进行重采样。 它可能是图像抽取的首选方法，因为它会产生无云纹理的结果。 但是当图像缩放时，它类似于INTER_NEAREST方法。</td></tr><tr><td>INTER_CUBIC</td><td>4x4像素邻域的双三次插值</td></tr><tr><td>INTER_LANCZOS4</td><td>8x8像素邻域的Lanczos插值</td></tr></tbody></table><p>在缩小时推荐使用 cv2.INTER_AREA，扩大时推荐使用 cv2.INTER_CUBIC 和 cv2.INTER_LINEAR。</p></li></ul><p>将图片放大一倍</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>dsize</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>fx</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>fy</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>interpolation</span><span class=o>=</span><span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># or</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>width</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>height</span><span class=p>)),</span> <span class=n>interpolation</span><span class=o>=</span><span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.flip(img, flipcode)</strong></em></p><ul><li>图像翻转</li><li><em>img</em>：原始图像</li><li><em>flipcode</em>：控制翻转效果<ul><li>flipcode = 0：沿 x 轴翻转；</li><li>flipcode > 0：沿 y 轴翻转；</li><li>flipcode &lt; 0：x, y 轴同时翻转</li></ul></li></ul><p><em><strong>cv2.getRotationMarix2D(center, angle, scale)</strong></em></p><ul><li>获得仿射变化矩阵</li><li><em>center</em>：旋转中心</li><li><em>angle</em>：旋转角度</li><li><em>scale</em>：缩放倍数</li></ul><p><em><strong>cv2.warpAffine(img,M,dsize,flags,borderMode,borderValue)</strong></em></p><ul><li>进行仿射变化</li><li><em>img</em>：图像</li><li><em>M</em>：变换矩阵</li><li><em>dsize</em>：输出图像的大小，格式为 <code>(rows,cols)</code></li><li><em>flags</em>：插值方法的组合，默认为 <code>cv2.INTER_LINEAR</code></li><li><em>borderMode</em>：边界像素模式，默认为 <code>cv2.BORDER_REFLECT</code></li><li><em>borderValue</em>：边界填充值; 默认为 0，可设成 <code>(255,255,255)</code></li><li>日常进行仿射变换时，在只设置前三个参数的情况下，如 <code>cv2.warpAffine(img,M,(rows,cols))</code> 可以实现基本的仿射变换效果，但可能出现“黑边”现象</li></ul><p>图像旋转</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;4.jpg&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># 第一个参数是旋转中心，第二个参数是旋转角度，第三个参数是缩放比例</span>
</span></span><span class=line><span class=cl><span class=n>M1</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getRotationMatrix2D</span><span class=p>((</span><span class=n>cols</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>rows</span><span class=o>/</span><span class=mi>2</span><span class=p>),</span> <span class=mi>45</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>M2</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getRotationMatrix2D</span><span class=p>((</span><span class=n>cols</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>rows</span><span class=o>/</span><span class=mi>2</span><span class=p>),</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>M3</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>getRotationMatrix2D</span><span class=p>((</span><span class=n>cols</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>rows</span><span class=o>/</span><span class=mi>2</span><span class=p>),</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res1</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>warpAffine</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>M1</span><span class=p>,</span> <span class=p>(</span><span class=n>cols</span><span class=p>,</span> <span class=n>rows</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>res2</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>warpAffine</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>M2</span><span class=p>,</span> <span class=p>(</span><span class=n>cols</span><span class=p>,</span> <span class=n>rows</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>res3</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>warpAffine</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>M3</span><span class=p>,</span> <span class=p>(</span><span class=n>cols</span><span class=p>,</span> <span class=n>rows</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;res1&#39;</span><span class=p>,</span> <span class=n>res1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;res2&#39;</span><span class=p>,</span> <span class=n>res2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;res3&#39;</span><span class=p>,</span> <span class=n>res3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=图像三通道分离和合并>图像三通道分离和合并</h3><p><em><strong>cv2.split(img)</strong></em></p><ul><li>分离图像三通道，返回包含被分离的三个图像的元组</li><li><em>img</em>：原始图像</li></ul><p><em><strong>cv2.merge(img_list)</strong></em></p><ul><li>合并图像三通道，返回合并后的图像</li><li><em>img_list</em>：包含三个图像的数组</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s2>&#34;01.jpg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=p>,</span> <span class=n>g</span> <span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># b = cv2.split(img)[0]</span>
</span></span><span class=line><span class=cl><span class=c1># g = cv2.split(img)[1]</span>
</span></span><span class=line><span class=cl><span class=c1># r = cv2.split(img)[2]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>merged</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>merge</span><span class=p>([</span><span class=n>b</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>r</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;Blue&#34;</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;Green&#34;</span><span class=p>,</span><span class=n>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;Red&#34;</span><span class=p>,</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s2>&#34;Merged&#34;</span><span class=p>,</span><span class=n>merged</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=正确的退出方法>正确的退出方法</h3><h3 id=实现正常退出>实现正常退出</h3><p><em><strong>cv2.waitkey(delaytime) ->returnvalue</strong></em></p><ul><li><p>在 <code>delaytime</code> 时间内，按键盘，返回所按键的ASCII值</p></li><li><p>若未在 <code>delaytime</code> 时间内按任何键，返回 -1</p></li><li><p>当 <code>delaytime</code> 为 0 时，表示永不退回</p></li><li><p>当按 ecs 键时，因为其 ASCII 值为 27，而所有returnvalue的值为27，故可用此机制实现在 <code>delaytime</code> 内正常退出</p></li><li><p>推荐使用</p><ul><li><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>  <span class=k>if</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1># ord(&#39;q&#39;)返回q对应的Unicode码对应的值</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li></ul><h2 id=滤波>滤波</h2><h3 id=均值滤波>均值滤波</h3><p>均值滤波只取内核区域下所有像素的平均值并替换中心元素。3x3 标准化的盒式过滤器如下所示：</p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=https://img-blog.csdnimg.cn/20191029161721268.png data-srcset="https://img-blog.csdnimg.cn/20191029161721268.png, https://img-blog.csdnimg.cn/20191029161721268.png 1.5x, https://img-blog.csdnimg.cn/20191029161721268.png 2x" data-sizes=auto alt=https://img-blog.csdnimg.cn/20191029161721268.png title=img></p><p><em><strong>cv2.blur(img,ksize)</strong></em></p><p>参数</p><ul><li><em>ksize</em>：核大小，如 <code>(5, 5)</code></li></ul><p>特征：核中区域贡献率相同。</p><p>作用：对于椒盐噪声的滤除效果比较好。</p><h3 id=中值滤波>中值滤波</h3><p>中值滤波是一种典型的非线性滤波，是基于排序统计理论的一种能够有效抑制噪声的非线性信号处理技术</p><p>中值滤波将图像的每个像素用邻域（以当前像素为中心的正方形区域）像素的<strong>中值</strong>代替 。与邻域平均法类似，但计算的是中值。</p><p>特征：中心点的像素被核中中位数的像素值代替</p><p>作用：对于椒盐噪声有效</p><p><em><strong>cv2.medianBlur(img, ksize)</strong></em></p><p>参数</p><ul><li>ksize：滤波模板的尺寸大小，必须是大于1的奇数，如3、5、7</li></ul><h3 id=高斯滤波>高斯滤波</h3><p>对整幅图像进行加权平均，每个像素的值尤其本身和邻域内的其他像素值经过加权平均后得到</p><p><em><strong>cv2.GuassianBlur(img, ksize,sigmaX,sigmaY)</strong></em></p><p>参数</p><ul><li><em>sigmaX</em>，<em>sigmaY</em>：分别表示 X，Y 方向的标准偏差<ul><li>如果仅指定了 sigmaX，则 sigmaY 与 sigmaX 相同</li><li>如果两者都为零，则根据内核大小计算它们</li></ul></li></ul><p>特征：核中区域贡献率与距离区域中心成正比，权重与高斯分布相关。</p><p>作用：高斯模糊在从图像中去除高斯噪声方面非常有效</p><h2 id=图像提取>图像提取</h2><p>SIFT 的全称是 Scale Invariant Feature Transform，尺度不变特征变换。是在不同的尺度空间上查找关键点（特征点），并计算出关键点的方向。</p><p>SIFT所查找到的关键点是一些十分突出、不会因光照、仿射变换和噪音等因素而变化的点，如角点、边缘点、暗区的亮点及亮区的暗点等。</p><p>SIFT 特征对旋转、尺度缩放、亮度变化等保持不变性，是一种非常稳定的局部特征。</p><p><strong>环境</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pip</span> <span class=n>install</span> <span class=n>opencv</span><span class=o>-</span><span class=n>contrib</span><span class=o>-</span><span class=n>python</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>例</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>r</span><span class=s1>&#39;D:\Repo\PythonLearning\cv2Learning\assets\selina.jpg&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>  <span class=c1># 输入灰度图</span>
</span></span><span class=line><span class=cl><span class=c1># 构造生成器</span>
</span></span><span class=line><span class=cl><span class=n>sift</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>xfeatures2d</span><span class=o>.</span><span class=n>SIFT_create</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># 检测图片</span>
</span></span><span class=line><span class=cl><span class=n>kp</span><span class=p>,</span> <span class=n>des</span> <span class=o>=</span> <span class=n>sift</span><span class=o>.</span><span class=n>detectAndCompute</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>  <span class=c1># 关键点（Keypoint）和描述子（Descriptor）</span>
</span></span><span class=line><span class=cl><span class=c1># 绘出关键点</span>
</span></span><span class=line><span class=cl><span class=n>img2</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>drawKeypoints</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>kp</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 显示</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>  <span class=c1># 画布放大10倍</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>  <span class=c1># 隐藏坐标轴</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img2</span><span class=p>)</span>  <span class=c1># 打印图像</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>  <span class=c1># 显示画布</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>()</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=阈值分割>阈值分割</h2><h3 id=二值阈值分割>二值阈值分割</h3><p><em><strong>cv2.threshold(src, thresh, maxval, type[, dst])</strong></em></p><p>参数</p><ul><li><p><em>thresh</em>：阈值</p></li><li><p><em>maxval</em>：最大阈值，一般为 255</p></li><li><p><em>type</em>：阈值方式，最主要有五种</p><ul><li><table><thead><tr><th>阈值</th><th>小于阈值的像素点</th><th>大于阈值的像素点</th></tr></thead><tbody><tr><td>0</td><td>置 0</td><td>置填充色</td></tr><tr><td>1</td><td>置填充色</td><td>置 0</td></tr><tr><td>2</td><td>保持原色</td><td>置灰色</td></tr><tr><td>3</td><td>置 0</td><td>保持原色</td></tr><tr><td>4</td><td>保持原色</td><td>置 0</td></tr></tbody></table></li></ul></li></ul><p>返回值</p><ul><li><em>ret</em></li><li><em>dst</em>：阈值分割后的图像</li></ul><p>例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 灰度图读入</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\Repo\PythonLearning\cv2Learning\assets\gradient.png&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5种不同的阈值方法</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>th1</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_BINARY</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>th2</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_BINARY_INV</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>th3</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_TRUNC</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>th4</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_TOZERO</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>th5</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_TOZERO_INV</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>titles</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Original&#39;</span><span class=p>,</span> <span class=s1>&#39;BINARY&#39;</span><span class=p>,</span> <span class=s1>&#39;BINARY_INV&#39;</span><span class=p>,</span> <span class=s1>&#39;TRUNC&#39;</span><span class=p>,</span> <span class=s1>&#39;TOZERO&#39;</span><span class=p>,</span> <span class=s1>&#39;TOZERO_INV&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>images</span> <span class=o>=</span> <span class=p>[</span><span class=n>img</span><span class=p>,</span> <span class=n>th1</span><span class=p>,</span> <span class=n>th2</span><span class=p>,</span> <span class=n>th3</span><span class=p>,</span> <span class=n>th4</span><span class=p>,</span> <span class=n>th5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用Matplotlib显示</span>
</span></span><span class=line><span class=cl><span class=c1># 两行三列图</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>images</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=s1>&#39;gray&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=n>titles</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([]),</span> <span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([])</span>  <span class=c1># 隐藏坐标轴</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>输出</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210929180610118.png alt=image-20210929180610118 style=zoom:50%><h3 id=自适应阈值分割>自适应阈值分割</h3><p>固定阈值将整幅图片分成两类值，它并不适用于明暗分布不均的图片。而自适应阈值会每次取图片的一小部分计算阈值。这样图片不同区域的阈值就不尽相同</p><p><em><strong>cv2.adaptiveThreshold(src, maxValue, adaptiveMethod, thresholdType, blockSize, C)</strong></em></p><p>参数</p><ul><li><em>maxValue</em>：当 thresholdType 采用 <code>cv2.THRESH_BINARY</code> 和 <code>cv2.THRESH_BINARY_INV</code> 时像素点被赋予的新值</li><li><em>adaptiveMethod</em>：自适应阈值的计算方法<ul><li><code>cv2.ADPTIVE_THRESH_MEAN_C</code>：阈值取<strong>自相邻区域</strong>（也就是小区域）的平均值</li><li><code>cv2.ADPTIVE_THRESH_GAUSSIAN_C</code>：阈值取值相邻区域的加权和，权重为一个高斯窗口</li></ul></li><li><em>thresholdType</em>：阈值分割类型，共 5 种，同 <code>cv2.threshold()</code> 的阈值分割类型参数</li><li><em>blockSize</em>：用来计算阈值的邻域大小（小区域的面积，如 11 就是 11 * 11 的小块）</li><li><em>C</em>：常数，最终阈值 = 小区域计算出的阈值 - C</li></ul><p>例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 灰度图读入</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\Repo\PythonLearning\cv2Learning\assets\selina.jpg&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 固定阈值</span>
</span></span><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>th1</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>threshold</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_BINARY</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 自适应阈值</span>
</span></span><span class=line><span class=cl><span class=n>th2</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>adaptiveThreshold</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>ADAPTIVE_THRESH_MEAN_C</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_BINARY</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>th3</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>adaptiveThreshold</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>ADAPTIVE_THRESH_GAUSSIAN_C</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>THRESH_BINARY</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>titles</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Original&#39;</span><span class=p>,</span> <span class=s1>&#39;Global(v = 127)&#39;</span><span class=p>,</span> <span class=s1>&#39;Adaptive Mean&#39;</span><span class=p>,</span> <span class=s1>&#39;Adaptve Gaussian&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>images</span> <span class=o>=</span> <span class=p>[</span><span class=n>img</span><span class=p>,</span> <span class=n>th1</span><span class=p>,</span> <span class=n>th2</span><span class=p>,</span> <span class=n>th3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>images</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=s1>&#39;gray&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=n>titles</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([]),</span> <span class=n>plt</span><span class=o>.</span><span class=n>yticks</span><span class=p>([])</span>  <span class=c1># 隐藏坐标轴</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>输出</p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210929182009030.png data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210929182009030.png, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210929182009030.png 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210929182009030.png 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210929182009030.png title=image-20210929182009030></p><h2 id=标记>标记</h2><p><em><strong>cv2.drawKeypoints(img, keypoints, outputimage, color, flags)</strong></em></p><p>参数</p><ul><li><em>keypoints</em>：从原图中获得的关键点，这也是画图时所用到的数据</li><li><em>outputimage</em>：输出（可以是原始图片）</li><li><em>color</em>：颜色设置，格式为 <code>(r, g, b)</code></li><li><em>flags</em>：绘图功能的标识设置<ul><li><code>cv2.DRAW_MATCHES_FLAGS_DEFAULT</code>：创建输出图像矩阵，使用现存的输出图像绘制匹配对和特征点，对每一个关键点只绘制中间点</li><li><code>cv2.DRAW_MATCHES_FLAGS_DRAW_OVER_OUTIMG</code>：不创建输出图像矩阵，而是在输出图像上绘制匹配对</li><li><code>cv2.DRAW_MATCHES_FLAGS_DRAW_RICH_KEYPOINTS</code>：对每一个特征点绘制带大小和方向的关键点图形</li><li><code>cv2.DRAW_MATCHES_FLAGS_NOT_DRAW_SINGLE_POINTS</code>：单点的特征点不被绘制</li></ul></li></ul><h2 id=其他图片操作>其他图片操作</h2><h3 id=添加文字>添加文字</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=s1>&#39;caijian.jpg&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>font</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>FONT_HERSHEY_SIMPLEX</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>imgzi</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>putText</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=s1>&#39;000&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>300</span><span class=p>),</span> <span class=n>font</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>,</span> <span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.putText(img, text, org, fontFace, fontScale, color, thickness=None, lineType=None, bottomLeftOrigin=None)</strong></em></p><ul><li><em>text</em>：str，文字</li><li><em>org</em>：tuple[2]，图像中文本字符串的左下角</li><li><em>fontFace</em>：字体类型，请参见 #HersheyFonts</li><li><em>fontScale</em>：字体比例因子乘以特定于字体的基本大小</li><li><em>color</em>：字体颜色</li><li><em>thickness</em>：线条粗细</li><li><em>lineType</em>：线型。 请参阅 #LineTypes</li><li><em>bottomLeftOrigin</em>：如果为 true，则图像数据原点位于左下角。 否则，它位于左上角</li></ul><p>进行 putText 操作之后，读取原图像也是具有文字显示的</p><p>但是原图的文件并没有被改变</p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143148996.png data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143148996.png, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143148996.png 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143148996.png 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143148996.png title=在这里插入图片描述></p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143220522.png data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143220522.png, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143220522.png 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143220522.png 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025143220522.png title=在这里插入图片描述></p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144020368.png data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144020368.png, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144020368.png 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144020368.png 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144020368.png title=在这里插入图片描述></p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144001417.png data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144001417.png, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144001417.png 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144001417.png 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/20191025144001417.png title=在这里插入图片描述></p><h2 id=视频的基本操作>视频的基本操作</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=s1>&#39;video1.mp4&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>isOpened</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;frame&#39;</span><span class=p>,</span><span class=n>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 按下 q 退出播放</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>):</span>	
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cap</span><span class=o>.</span><span class=n>release</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=获取视频>获取视频</h3><h4 id=获取本地视频>获取本地视频</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=s1>&#39;video1.mp4&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.VideoCapture(path)</strong></em></p><p>获取视频的逐帧进行</p><p>cap 返回值如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&lt;</span><span class=n>VideoCapture</span> <span class=mi>000001</span><span class=n>B6734E1310</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=获取摄像头>获取摄像头</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>cap</span><span class=o>.</span><span class=n>release</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>VideoCapture()</strong></em></p><p>由摄像头输入视频，默认摄像头为 0</p><p>在使用 <code>cv2.VideoCapture()</code> 时习惯性在最后使用 <code>cap.release()</code> 释放视频。</p><h3 id=读入视频>读入视频</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ret</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ret</span><span class=p>,</span><span class=n>frame</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cap.read()</strong></em></p><p>返回值为 <code>retval </code>和 <code>image</code>，分别是一个<strong>布尔值</strong>和<strong>读取的一帧图片</strong>。</p><p><code>frame.shape</code> 返回一个<strong>布尔值</strong>和<strong>数组每个维度的值</strong>。显示 True 表示这一帧被成功获取，1920 和 1080 是视频每一帧图片的高和宽，3 是图片的三原色。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>True (1920, 1080, 3)
</span></span></code></pre></td></tr></table></div></div><p>可使用 <code>cap.get(3)</code> 和 <code>cap.get(4)</code> 验证一下视频宽度和高度：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Out put: 1080.0</span>
</span></span></code></pre></td></tr></table></div></div><p>一般在使用 <code>cap.read()</code> 时，为避免获取未开始而出现错误，可以使用 <code>cap.isOpened()</code> 检查，实现只有在 <code>cap</code> 已经开始的情况下读取。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>while</span> <span class=n>cap</span><span class=o>.</span><span class=n>isOpened</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span><span class=p>,</span><span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=播放视频>播放视频</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;frame&#39;</span><span class=p>,</span><span class=n>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 按下 q 退出播放</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>):</span>	
</span></span><span class=line><span class=cl>    <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.imshow(text, video)</strong></em></p><p>这里播放时也可将视频转换为任意模式，如改变去除颜色或 RGB，再进行播放</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>gray</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span><span class=n>code</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_BGR2GRAY</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;gray_frame&#39;</span><span class=p>,</span><span class=n>gray</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>RGB_mode</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span><span class=n>code</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_BGR2RGB</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;RGB_frame&#39;</span><span class=p>,</span><span class=n>RGB_mode</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=保存视频>保存视频</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>VideoWriter_fourcc</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>,</span><span class=s1>&#39;J&#39;</span><span class=p>,</span><span class=s1>&#39;P&#39;</span><span class=p>,</span><span class=s1>&#39;G&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#设置输出文件的名称格式，指定FourCC编码，帧数，尺寸</span>
</span></span><span class=line><span class=cl><span class=n>out</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoWriter</span><span class=p>(</span><span class=s1>&#39;output.avi&#39;</span><span class=p>,</span><span class=n>fourcc</span><span class=p>,</span> <span class=mf>20.0</span><span class=p>,</span> <span class=p>(</span><span class=mi>640</span><span class=p>,</span><span class=mi>480</span><span class=p>))</span> <span class=c1># 视频MP4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>isOpened</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>ret</span><span class=o>==</span><span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    	<span class=c1>#参数为0时竖直方向翻转图片，-1时水平竖直均翻转，1时水平翻转</span>
</span></span><span class=line><span class=cl>        <span class=n>frame</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>flip</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>out</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>&#39;frame&#39;</span><span class=p>,</span><span class=n>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFF</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;q&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cap</span><span class=o>.</span><span class=n>release</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>out</span><span class=o>.</span><span class=n>release</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><em><strong>cv2.imwrite()</strong></em></p><h3 id=保存帧图像>保存帧图像</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>video2image</span><span class=p>(</span><span class=n>video_dir</span><span class=p>,</span><span class=n>save_dir</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=n>video_dir</span><span class=p>)</span> <span class=c1>#生成读取视频对象</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=mi>1</span>   <span class=c1>#计数</span>
</span></span><span class=line><span class=cl>    <span class=n>width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FRAME_WIDTH</span><span class=p>))</span>    <span class=c1>#获取视频的宽度</span>
</span></span><span class=line><span class=cl>    <span class=n>height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FRAME_HEIGHT</span><span class=p>))</span>   <span class=c1>#获取视频的高度</span>
</span></span><span class=line><span class=cl>    <span class=n>fps</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FPS</span><span class=p>)</span>    <span class=c1>#获取视频的帧率</span>
</span></span><span class=line><span class=cl>    <span class=n>fourcc</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FOURCC</span><span class=p>))</span>    <span class=c1>#视频的编码</span>
</span></span><span class=line><span class=cl>    <span class=c1># 定义视频输出</span>
</span></span><span class=line><span class=cl>    <span class=c1>#writer = cv2.VideoWriter(&#34;teswellvideo_02_result.mp4&#34;, fourcc, fps, (width, height))</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>timeF</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span>     <span class=c1>#视频帧计数间隔频率</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>cap</span><span class=o>.</span><span class=n>isOpened</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span><span class=p>,</span><span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span> <span class=c1>#按帧读取视频</span>
</span></span><span class=line><span class=cl>        <span class=c1>#到视频结尾时终止</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ret</span> <span class=ow>is</span> <span class=kc>False</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=c1>#每隔timeF帧进行存储操作</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>%</span> <span class=n>timeF</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;保存第 </span><span class=si>%s</span><span class=s1> 张图像&#39;</span> <span class=o>%</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>save_image_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>save_dir</span><span class=p>,</span><span class=s1>&#39;</span><span class=si>%s</span><span class=s1>.jpg&#39;</span> <span class=o>%</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;save_image_dir: &#39;</span><span class=p>,</span> <span class=n>save_image_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=n>save_image_dir</span><span class=p>,</span><span class=n>frame</span><span class=p>)</span> <span class=c1>#保存视频帧图像</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>#延时1ms</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-03-14</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/Notes/tags/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/>快速开始</a>,&nbsp;<a href=/Notes/tags/python/>Python</a>,&nbsp;<a href=/Notes/tags/cv2/>cv2</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/Notes/>主页</a></span></section></div><div class=post-nav><a href=/Notes/posts/%E5%88%B7%E9%A2%98/array/%E5%89%91%E6%8C%87-offer-03.-%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97/ class=prev rel=prev title="剑指 Offer 03. 数组中重复的数字"><i class="fas fa-angle-left fa-fw"></i>剑指 Offer 03. 数组中重复的数字</a>
<a href=/Notes/posts/%E5%88%B7%E9%A2%98/array/4.-%E5%AF%BB%E6%89%BE%E4%B8%A4%E4%B8%AA%E6%AD%A3%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/ class=next rel=next title="4. 寻找两个正序数组的中位数">4. 寻找两个正序数组的中位数<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>酒困路长惟欲睡，日高人渴漫思茶</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/Notes/lib/katex/katex.min.css><link rel=stylesheet href=/Notes/lib/katex/copy-tex.min.css><script type=text/javascript src=/Notes/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/Notes/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/Notes/lib/lunr/lunr.min.js></script><script type=text/javascript src=/Notes/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/Notes/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/Notes/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/Notes/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/Notes/lib/katex/katex.min.js></script><script type=text/javascript src=/Notes/lib/katex/auto-render.min.js></script><script type=text/javascript src=/Notes/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/Notes/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:45},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/Notes/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/Notes/lib/lunr/lunr.segmentit.js",maxResultLength:30,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/Notes/js/theme.min.js></script></body></html>