<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title> - 我的全新 Hugo 网站</title><meta name=Description content><meta property="og:title" content>
<meta property="og:description" content="strings 由于 string 类型可以看成是一种特殊的 slice 类型，因此获取长度可以用内置的函数 len；同时支持 切片 操作，因此，子串获取很容易。 这里说的字符，指得是 rune 类">
<meta property="og:type" content="article">
<meta property="og:url" content="http://example.org/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%96%87%E6%9C%AC/strings/"><meta property="article:section" content="posts">
<meta name=twitter:card content="summary">
<meta name=twitter:title content>
<meta name=twitter:description content="strings 由于 string 类型可以看成是一种特殊的 slice 类型，因此获取长度可以用内置的函数 len；同时支持 切片 操作，因此，子串获取很容易。 这里说的字符，指得是 rune 类">
<meta name=application-name content="我的全新 Hugo 网站">
<meta name=apple-mobile-web-app-title content="我的全新 Hugo 网站"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%96%87%E6%9C%AC/strings/><link rel=prev href=http://example.org/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%96%87%E6%9C%AC/unicode/><link rel=next href=http://example.org/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%96%87%E6%9C%AC/strconv/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/golang\/%E6%A0%87%E5%87%86%E5%BA%93\/%E6%96%87%E6%9C%AC\/strings\/"},"genre":"posts","wordcount":5709,"url":"http:\/\/example.org\/posts\/golang\/%E6%A0%87%E5%87%86%E5%BA%93\/%E6%96%87%E6%9C%AC\/strings\/","publisher":{"@type":"Organization","name":"作者"},"author":{"@type":"Person","name":"作者"},"description":""}</script></head>
<body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="我的全新 Hugo 网站">伤心肠粉</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> 文章 </a><a class=menu-item href=/tags/> 标签 </a><a class=menu-item href=/categories/> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="我的全新 Hugo 网站">伤心肠粉</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
取消
</a>
</div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>目录</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX"></h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>作者</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=0001-01-01>0001-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 5709 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 12 分钟&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#字符串比较>字符串比较</a></li>
<li><a href=#是否存在某个字符或子串>是否存在某个字符或子串</a></li>
<li><a href=#子串出现次数--字符串匹配->子串出现次数 ( 字符串匹配 )</a></li>
<li><a href=#字符串分割为-string>字符串分割为 []string</a>
<ul>
<li><a href=#fields>Fields</a></li>
<li><a href=#fieldsfunc>FieldsFunc</a></li>
<li><a href=#split-和-splitafter-splitn-和-splitaftern>Split 和 SplitAfter、 SplitN 和 SplitAfterN</a></li>
</ul>
</li>
<li><a href=#字符串是否有某个前缀或后缀>字符串是否有某个前缀或后缀</a></li>
<li><a href=#字符或子串在字符串中出现的位置>字符或子串在字符串中出现的位置</a></li>
<li><a href=#字符串-join-操作>字符串 JOIN 操作</a></li>
<li><a href=#字符串重复几次>字符串重复几次</a></li>
<li><a href=#字符替换>字符替换</a></li>
<li><a href=#字符串子串替换>字符串子串替换</a></li>
<li><a href=#大小写转换>大小写转换</a></li>
<li><a href=#标题处理>标题处理</a></li>
<li><a href=#修剪>修剪</a></li>
<li><a href=#replacer-类型>Replacer 类型</a></li>
<li><a href=#reader-类型>Reader 类型</a></li>
<li><a href=#builder-类型>Builder 类型</a></li>
</ul>
</nav></div>
</div><div class=content id=content><h1 id=strings>strings</h1>
<p>由于 string 类型可以看成是一种特殊的 slice 类型，因此获取长度可以用内置的函数 len；同时支持 切片 操作，因此，子串获取很容易。</p>
<blockquote>
<p>这里说的字符，指得是 rune 类型，即一个 UTF-8 字符（Unicode 代码点）</p>
</blockquote>
<h2 id=字符串比较>字符串比较</h2>
<p>不推荐 <code>Compare()</code>，用<strong>运算符</strong>更直观</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// Compare 函数，用于比较两个字符串的大小，如果两个字符串相等，返回为 0。如果 a 小于 b ，返回 -1 ，反之返回 1 。不推荐使用这个函数，直接使用 == != &gt; &lt; &gt;= &lt;= 等一系列运算符更加直观。
</span><span class=c1></span><span class=kd>func</span> <span class=nf>Compare</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span> 
<span class=c1>// EqualFold 函数，计算 s 与 t 忽略字母大小写后是否相等。
</span><span class=c1></span><span class=kd>func</span> <span class=nf>EqualFold</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>t</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span>
</code></pre></td></tr></table>
</div>
</div><p>示例：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>a</span> <span class=o>:=</span> <span class=s>&#34;gopher&#34;</span>
<span class=nx>b</span> <span class=o>:=</span> <span class=s>&#34;hello world&#34;</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Compare</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Compare</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>a</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Compare</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>a</span><span class=p>))</span>

<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>EqualFold</span><span class=p>(</span><span class=s>&#34;GO&#34;</span><span class=p>,</span> <span class=s>&#34;go&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>EqualFold</span><span class=p>(</span><span class=s>&#34;壹&#34;</span><span class=p>,</span> <span class=s>&#34;一&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>-1
<span class=m>0</span>
<span class=m>1</span>
<span class=nb>true</span>
<span class=nb>false</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=是否存在某个字符或子串>是否存在某个字符或子串</h2>
<p>有三个函数做这件事：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// 子串 substr 在 s 中，返回 true
</span><span class=c1></span><span class=kd>func</span> <span class=nf>Contains</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>substr</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span>
<span class=c1>// chars 中任何一个 Unicode 代码点在 s 中，返回 true
</span><span class=c1></span><span class=kd>func</span> <span class=nf>ContainsAny</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>chars</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span>
<span class=c1>// Unicode 代码点 r 在 s 中，返回 true
</span><span class=c1></span><span class=kd>func</span> <span class=nf>ContainsRune</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>r</span> <span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span>
</code></pre></td></tr></table>
</div>
</div><p>这里对 ContainsAny 函数进行一下说明，看如下例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ContainsAny</span><span class=p>(</span><span class=s>&#34;team&#34;</span><span class=p>,</span> <span class=s>&#34;i&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ContainsAny</span><span class=p>(</span><span class=s>&#34;failure&#34;</span><span class=p>,</span> <span class=s>&#34;u &amp; i&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ContainsAny</span><span class=p>(</span><span class=s>&#34;in failure&#34;</span><span class=p>,</span> <span class=s>&#34;s g&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ContainsAny</span><span class=p>(</span><span class=s>&#34;foo&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ContainsAny</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nb>false</span>
<span class=nb>true</span>
<span class=nb>true</span>
<span class=nb>false</span>
<span class=nb>false</span>
</code></pre></td></tr></table>
</div>
</div><p>也就是说，第二个参数 chars 中任意一个字符（Unicode Code Point）如果在第一个参数 s 中存在，则返回 true。</p>
<p>查看这三个函数的源码，发现它们只是调用了相应的 Index 函数（子串出现的位置），然后和 0 作比较返回 true 或 fale。如，Contains：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Contains</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>substr</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nf>Index</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>substr</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=子串出现次数--字符串匹配->子串出现次数 ( 字符串匹配 )</h2>
<p>在 Go 中，查找子串出现次数即字符串模式匹配，实现的是 Rabin-Karp 算法。Count 函数的签名如下：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Count</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span>
</code></pre></td></tr></table>
</div>
</div><p>在 Count 的实现中，处理了几种特殊情况，属于字符匹配预处理的一部分。这里要特别说明一下的是当 sep 为空时，Count 的返回值是：<code>utf8.RuneCountInString(s) + 1</code></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Count</span><span class=p>(</span><span class=s>&#34;cheese&#34;</span><span class=p>,</span> <span class=s>&#34;e&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=s>&#34;谷歌中国&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Count</span><span class=p>(</span><span class=s>&#34;谷歌中国&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=m>3</span>
<span class=m>12</span>  
<span class=m>5</span>
</code></pre></td></tr></table>
</div>
</div><p>另外，Count 是计算子串在字符串中出现的无重叠的次数，比如：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Count</span><span class=p>(</span><span class=s>&#34;fivevev&#34;</span><span class=p>,</span> <span class=s>&#34;vev&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=m>1</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=字符串分割为-string>字符串分割为 []string</h2>
<p>这个需求很常见，倒不一定是为了得到 []string。</p>
<p>该包提供了六个三组分割函数：Fields 和 FieldsFunc、Split 和 SplitAfter、SplitN 和 SplitAfterN。</p>
<h3 id=fields>Fields</h3>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Fields</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>Fields 用一个或多个连续的<strong>空格分隔字符串 s</strong>，返回子字符串的数组（slice）。</p>
<p>如果字符串 s 只包含空格，则返回空列表 ([]string 的长度为 0）。其中，空格的定义是 <code>unicode.IsSpace</code></p>
<p>常见间隔符包括：'\t', &lsquo;\n&rsquo;, &lsquo;\v&rsquo;, &lsquo;\f&rsquo;, &lsquo;\r&rsquo;, ' &lsquo;, U+0085 (NEL), U+00A0 (NBSP)</p>
<p>由于是用空格分隔，因此结果中不会含有空格或空子字符串，例如：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Fields are: %q&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Fields</span><span class=p>(</span><span class=s>&#34;  foo bar  baz   &#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>Fields are: <span class=o>[</span><span class=s2>&#34;foo&#34;</span> <span class=s2>&#34;bar&#34;</span> <span class=s2>&#34;baz&#34;</span><span class=o>]</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=fieldsfunc>FieldsFunc</h3>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>FieldsFunc</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>FieldsFunc 用这样的 Unicode 代码点 c 进行分隔：满足 f(c) 返回 true。该函数返回 []string。</p>
<p>如果字符串 s 中所有的代码点 (unicode code points) 都满足 f(c) 或者 s 是空，则 FieldsFunc 返回空 slice。</p>
<p>也就是说，我们可以通过实现一个回调函数来指定分隔字符串 s 的字符。比如上面的例子，我们通过 FieldsFunc 来实现：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>FieldsFunc</span><span class=p>(</span><span class=s>&#34;  foo bar  baz   &#34;</span><span class=p>,</span> <span class=nx>unicode</span><span class=p>.</span><span class=nx>IsSpace</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>实际上，Fields 函数就是调用 FieldsFunc 实现的：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Fields</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nf>FieldsFunc</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>unicode</span><span class=p>.</span><span class=nx>IsSpace</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=split-和-splitafter-splitn-和-splitaftern>Split 和 SplitAfter、 SplitN 和 SplitAfterN</h3>
<p>之所以将这四个函数放在一起讲，是因为它们都是通过一个同一个内部函数来实现的。它们的函数签名及其实现：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// 结果不包含分隔符本身
</span><span class=c1></span><span class=kd>func</span> <span class=nf>Split</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>genSplit</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>}</span>
<span class=c1>// 结果包含分隔符本身
</span><span class=c1></span><span class=kd>func</span> <span class=nf>SplitAfter</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>genSplit</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>sep</span><span class=p>),</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>}</span>

<span class=kd>func</span> <span class=nf>SplitN</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>n</span> <span class=kt>int</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>genSplit</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span> <span class=p>}</span>

<span class=kd>func</span> <span class=nf>SplitAfterN</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>n</span> <span class=kt>int</span><span class=p>)</span> <span class=p>[]</span><span class=kt>string</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>genSplit</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>sep</span><span class=p>),</span> <span class=nx>n</span><span class=p>)</span> <span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>它们都调用了 genSplit 函数。</p>
<p>这四个函数都是通过 sep 进行分割，返回 []string。如果 sep 为空，相当于分成一个个的 UTF-8 字符，如 <code>Split("abc","")</code>，得到的是 [a b c]。</p>
<p><code>Split(s, sep)</code> 和 <code>SplitN(s, sep, -1)</code> 等价；<code>SplitAfter(s, sep)</code> 和 <code>SplitAfterN(s, sep, -1)</code> 等价。</p>
<p>那么，Split 和 SplitAfter 有啥区别呢？通过这两句代码的结果就知道它们的区别了：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34;foo,bar,baz&#34;</span><span class=p>,</span> <span class=s>&#34;,&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>SplitAfter</span><span class=p>(</span><span class=s>&#34;foo,bar,baz&#34;</span><span class=p>,</span> <span class=s>&#34;,&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>[</span><span class=s2>&#34;foo&#34;</span> <span class=s2>&#34;bar&#34;</span> <span class=s2>&#34;baz&#34;</span><span class=o>]</span>
<span class=o>[</span><span class=s2>&#34;foo,&#34;</span> <span class=s2>&#34;bar,&#34;</span> <span class=s2>&#34;baz&#34;</span><span class=o>]</span>
</code></pre></td></tr></table>
</div>
</div><p>也就是说，Split 会将 s 中的 sep 去掉，而 SplitAfter 会保留 sep。</p>
<p>带 N 的方法可以通过最后一个参数 n 控制返回的结果中的 slice 中的元素个数，当 n &lt; 0 时，返回所有的子字符串；当 n == 0 时，返回的结果是 nil；当 n > 0 时，表示返回的 slice 中最多只有 n 个元素，其中，最后一个元素不会分割，比如：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>SplitN</span><span class=p>(</span><span class=s>&#34;foo,bar,baz&#34;</span><span class=p>,</span> <span class=s>&#34;,&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>[</span><span class=s2>&#34;foo&#34;</span> <span class=s2>&#34;bar,baz&#34;</span><span class=o>]</span>
</code></pre></td></tr></table>
</div>
</div><p>另外看一下官方文档提供的例子，注意一下输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34;a,b,c&#34;</span><span class=p>,</span> <span class=s>&#34;,&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34;a man a plan a canal panama&#34;</span><span class=p>,</span> <span class=s>&#34;a &#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34; xyz &#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%q\n&#34;</span><span class=p>,</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;Bernardo O&#39;Higgins&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>[</span><span class=s>&#34;a&#34;</span> <span class=s>&#34;b&#34;</span> <span class=s>&#34;c&#34;</span><span class=p>]</span>
<span class=p>[</span><span class=s>&#34;&#34;</span> <span class=s>&#34;man &#34;</span> <span class=s>&#34;plan &#34;</span> <span class=s>&#34;canal panama&#34;</span><span class=p>]</span>
<span class=p>[</span><span class=s>&#34; &#34;</span> <span class=s>&#34;x&#34;</span> <span class=s>&#34;y&#34;</span> <span class=s>&#34;z&#34;</span> <span class=s>&#34; &#34;</span><span class=p>]</span>
<span class=p>[</span><span class=s>&#34;&#34;</span><span class=p>]</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=字符串是否有某个前缀或后缀>字符串是否有某个前缀或后缀</h2>
<p>这两个函数比较简单，源码如下：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// s 中是否以 prefix 开始
</span><span class=c1></span><span class=kd>func</span> <span class=nf>HasPrefix</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=nx>prefix</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=nb>len</span><span class=p>(</span><span class=nx>prefix</span><span class=p>)]</span> <span class=o>==</span> <span class=nx>prefix</span>
<span class=p>}</span>

<span class=c1>// s 中是否以 suffix 结尾
</span><span class=c1></span><span class=kd>func</span> <span class=nf>HasSuffix</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>suffix</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=nx>suffix</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>s</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span><span class=o>-</span><span class=nb>len</span><span class=p>(</span><span class=nx>suffix</span><span class=p>):]</span> <span class=o>==</span> <span class=nx>suffix</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>如果 prefix 或 suffix 为 "" , 返回值总是 true。</p>
<p>示例：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=s>&#34;Go&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=s>&#34;C&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasPrefix</span><span class=p>(</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasSuffix</span><span class=p>(</span><span class=s>&#34;Amigo&#34;</span><span class=p>,</span> <span class=s>&#34;go&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasSuffix</span><span class=p>(</span><span class=s>&#34;Amigo&#34;</span><span class=p>,</span> <span class=s>&#34;Ami&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>HasSuffix</span><span class=p>(</span><span class=s>&#34;Amigo&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nb>true</span>
<span class=nb>false</span>
<span class=nb>true</span>
<span class=nb>true</span>
<span class=nb>false</span>
<span class=nb>true</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=字符或子串在字符串中出现的位置>字符或子串在字符串中出现的位置</h2>
<p>有一序列函数与该功能有关：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// 在 s 中查找 sep 的第一次出现，返回第一次出现的索引
</span><span class=c1></span><span class=kd>func</span> <span class=nf>Index</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span>

<span class=c1>// 在 s 中查找字节 c 的第一次出现，返回第一次出现的索引
</span><span class=c1></span><span class=kd>func</span> <span class=nf>IndexByte</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>c</span> <span class=kt>byte</span><span class=p>)</span> <span class=kt>int</span>

<span class=c1>// chars 中任何一个 Unicode 代码点在 s 中首次出现的位置
</span><span class=c1></span><span class=kd>func</span> <span class=nf>IndexAny</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>chars</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span>

<span class=c1>// 查找字符 c 在 s 中第一次出现的位置，其中 c 满足 f(c) 返回 true
</span><span class=c1></span><span class=kd>func</span> <span class=nf>IndexFunc</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>int</span>

<span class=c1>// Unicode 代码点 r 在 s 中第一次出现的位置
</span><span class=c1></span><span class=kd>func</span> <span class=nf>IndexRune</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>r</span> <span class=kt>rune</span><span class=p>)</span> <span class=kt>int</span>

<span class=c1>// 有三个对应的查找最后一次出现的位置
</span><span class=c1></span><span class=kd>func</span> <span class=nf>LastIndex</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span>
<span class=kd>func</span> <span class=nf>LastIndexByte</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>c</span> <span class=kt>byte</span><span class=p>)</span> <span class=kt>int</span>
<span class=kd>func</span> <span class=nf>LastIndexAny</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>chars</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span>
<span class=kd>func</span> <span class=nf>LastIndexFunc</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>int</span>
</code></pre></td></tr></table>
</div>
</div><p>举 IndexFunc 的例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>han</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>c</span> <span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>unicode</span><span class=p>.</span><span class=nf>Is</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>Han</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=c1>// 汉字
</span><span class=c1></span><span class=p>}</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>IndexFunc</span><span class=p>(</span><span class=s>&#34;Hello, world&#34;</span><span class=p>,</span> <span class=nx>han</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>IndexFunc</span><span class=p>(</span><span class=s>&#34;Hello, 世界&#34;</span><span class=p>,</span> <span class=nx>han</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>-1
<span class=m>7</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=字符串-join-操作>字符串 JOIN 操作</h2>
<p>将字符串数组（或 slice）连接起来可以通过 Join 实现，函数签名如下：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Join</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>假如没有这个库函数，我们自己实现一个，我们会这么实现：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Join</span><span class=p>(</span><span class=nx>str</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
  <span class=c1>// 特殊情况应该做处理
</span><span class=c1></span>  <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>str</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
      <span class=k>return</span> <span class=s>&#34;&#34;</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>str</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>{</span>
      <span class=k>return</span> <span class=nx>str</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
  <span class=p>}</span>
  <span class=nx>buffer</span> <span class=o>:=</span> <span class=nx>bytes</span><span class=p>.</span><span class=nf>NewBufferString</span><span class=p>(</span><span class=nx>str</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
  <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>s</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>str</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=p>{</span>
      <span class=nx>buffer</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>sep</span><span class=p>)</span>
      <span class=nx>buffer</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=nx>buffer</span><span class=p>.</span><span class=nf>String</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>这里，我们使用了 bytes 包的 Buffer 类型，避免大量的字符串连接操作（因为 Go 中字符串是不可变的）。我们再看一下标准库的实现：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Join</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=nx>sep</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
  <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
      <span class=k>return</span> <span class=s>&#34;&#34;</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>{</span>
      <span class=k>return</span> <span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
  <span class=p>}</span>
  <span class=nx>n</span> <span class=o>:=</span> <span class=nb>len</span><span class=p>(</span><span class=nx>sep</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
  <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
      <span class=nx>n</span> <span class=o>+=</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>])</span>
  <span class=p>}</span>

  <span class=nx>b</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span>
  <span class=nx>bp</span> <span class=o>:=</span> <span class=nb>copy</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
  <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>s</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>a</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=p>{</span>
      <span class=nx>bp</span> <span class=o>+=</span> <span class=nb>copy</span><span class=p>(</span><span class=nx>b</span><span class=p>[</span><span class=nx>bp</span><span class=p>:],</span> <span class=nx>sep</span><span class=p>)</span>
      <span class=nx>bp</span> <span class=o>+=</span> <span class=nb>copy</span><span class=p>(</span><span class=nx>b</span><span class=p>[</span><span class=nx>bp</span><span class=p>:],</span> <span class=nx>s</span><span class=p>)</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=nb>string</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>标准库的实现没有用 bytes 包，当然也不会简单的通过 + 号连接字符串。Go 中是不允许循环依赖的，标准库中很多时候会出现代码拷贝，而不是引入某个包。这里 Join 的实现方式挺好，</p>
<p>不直接使用 bytes 包，可能也是不想依赖 bytes 包（其实 bytes 中的实现也是 copy 方式）。</p>
<p>简单使用示例：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nf>Join</span><span class=p>([]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;name=xxx&#34;</span><span class=p>,</span> <span class=s>&#34;age=xx&#34;</span><span class=p>},</span> <span class=s>&#34;&amp;&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nv>name</span><span class=o>=</span>xxx<span class=p>&amp;</span><span class=nv>age</span><span class=o>=</span>xx
</code></pre></td></tr></table>
</div>
</div><h2 id=字符串重复几次>字符串重复几次</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Repeat</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>count</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>将 s 重复 count 次，如果 count 为负数或返回值长度 len(s)*count 超出 string 上限会导致 panic，这个函数使用很简单：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;ba&#34;</span> <span class=o>+</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Repeat</span><span class=p>(</span><span class=s>&#34;na&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>banana
</code></pre></td></tr></table>
</div>
</div><h2 id=字符替换>字符替换</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Map</span><span class=p>(</span><span class=nx>mapping</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>rune</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>Map 函数，将 s 的每一个字符按照 mapping 的规则做映射替换，<strong>如果 mapping 返回值 &lt;0 ，则舍弃该字符</strong>。</p>
<p>该方法只能对每一个字符做处理，但处理方式很灵活，可以方便的过滤，筛选汉字等。</p>
<p>示例：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>mapping</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>r</span> <span class=kt>rune</span><span class=p>)</span> <span class=kt>rune</span> <span class=p>{</span>
    <span class=k>switch</span> <span class=p>{</span>
    <span class=k>case</span> <span class=nx>r</span> <span class=o>&gt;=</span> <span class=sc>&#39;A&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>r</span> <span class=o>&lt;=</span> <span class=sc>&#39;Z&#39;</span><span class=p>:</span> <span class=c1>// 大写字母转小写
</span><span class=c1></span>        <span class=k>return</span> <span class=nx>r</span> <span class=o>+</span> <span class=mi>32</span>
    <span class=k>case</span> <span class=nx>r</span> <span class=o>&gt;=</span> <span class=sc>&#39;a&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>r</span> <span class=o>&lt;=</span> <span class=sc>&#39;z&#39;</span><span class=p>:</span> <span class=c1>// 小写字母不处理
</span><span class=c1></span>        <span class=k>return</span> <span class=nx>r</span>
    <span class=k>case</span> <span class=nx>unicode</span><span class=p>.</span><span class=nf>Is</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>Han</span><span class=p>,</span> <span class=nx>r</span><span class=p>):</span> <span class=c1>// 汉字换行
</span><span class=c1></span>        <span class=k>return</span> <span class=sc>&#39;\n&#39;</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span> <span class=c1>// 过滤所有非字母、汉字的字符
</span><span class=c1></span><span class=p>}</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Map</span><span class=p>(</span><span class=nx>mapping</span><span class=p>,</span> <span class=s>&#34;Hello你#￥%……\n（&#39;World\n,好Hello^(&amp;(*界gopher...&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>hello
world
hello
gopher
</code></pre></td></tr></table>
</div>
</div><h2 id=字符串子串替换>字符串子串替换</h2>
<p>进行字符串替换时，考虑到性能问题，能不用正则尽量别用，应该用这里的函数。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// 用 new 替换 s 中的 old，一共替换 n 个。
</span><span class=c1>// 如果 n &lt; 0，则不限制替换次数，即全部替换
</span><span class=c1></span><span class=kd>func</span> <span class=nf>Replace</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>old</span><span class=p>,</span> <span class=nx>new</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>n</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>string</span>

<span class=c1>// 该函数内部直接调用了函数 Replace(s, old, new , -1)
</span><span class=c1></span><span class=kd>func</span> <span class=nf>ReplaceAll</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>old</span><span class=p>,</span> <span class=nx>new</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>使用示例：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Replace</span><span class=p>(</span><span class=s>&#34;oink oink oink&#34;</span><span class=p>,</span> <span class=s>&#34;k&#34;</span><span class=p>,</span> <span class=s>&#34;ky&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Replace</span><span class=p>(</span><span class=s>&#34;oink oink oink&#34;</span><span class=p>,</span> <span class=s>&#34;oink&#34;</span><span class=p>,</span> <span class=s>&#34;moo&#34;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ReplaceAll</span><span class=p>(</span><span class=s>&#34;oink oink oink&#34;</span><span class=p>,</span> <span class=s>&#34;oink&#34;</span><span class=p>,</span> <span class=s>&#34;moo&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>oinky</span> <span class=nx>oinky</span> <span class=nx>oink</span>
<span class=nx>moo</span> <span class=nx>moo</span> <span class=nx>moo</span>
<span class=nx>moo</span> <span class=nx>moo</span> <span class=nx>moo</span>
</code></pre></td></tr></table>
</div>
</div><p>如果我们希望一次替换多个，比如我们希望替换 <code>This is &lt;b>HTML&lt;/b></code> 中的 <code>&lt;</code> 和 <code>></code> 为 <code>&lt;</code> 和 <code>></code>，可以调用上面的函数两次。但标准库提供了另外的方法进行这种替换。</p>
<h2 id=大小写转换>大小写转换</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>ToLower</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=kd>func</span> <span class=nf>ToLowerSpecial</span><span class=p>(</span><span class=nx>c</span> <span class=nx>unicode</span><span class=p>.</span><span class=nx>SpecialCase</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>

<span class=kd>func</span> <span class=nf>ToUpper</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=kd>func</span> <span class=nf>ToUpperSpecial</span><span class=p>(</span><span class=nx>c</span> <span class=nx>unicode</span><span class=p>.</span><span class=nx>SpecialCase</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>大小写转换包含了 4 个相关函数，ToLower,ToUpper 用于大小写转换。ToLowerSpecial,ToUpperSpecial 可以转换特殊字符的大小写。 举个例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToLower</span><span class=p>(</span><span class=s>&#34;HELLO WORLD&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToLower</span><span class=p>(</span><span class=s>&#34;Ā Á Ǎ À&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToLowerSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;壹&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToLowerSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;HELLO WORLD&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToLower</span><span class=p>(</span><span class=s>&#34;Önnek İş&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToLowerSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;Önnek İş&#34;</span><span class=p>))</span>

<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToUpper</span><span class=p>(</span><span class=s>&#34;hello world&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToUpper</span><span class=p>(</span><span class=s>&#34;ā á ǎ à&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToUpperSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;一&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToUpperSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;hello world&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToUpper</span><span class=p>(</span><span class=s>&#34;örnek iş&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToUpperSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;örnek iş&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>hello world
ā á ǎ à
壹
hello world
önnek iş
önnek iş
HELLO WORLD
Ā Á Ǎ À       // 汉字拼音有效
一           //  汉字无效
HELLO WORLD
ÖRNEK IŞ
ÖRNEK İŞ    // 有细微差别
</code></pre></td></tr></table>
</div>
</div><h2 id=标题处理>标题处理</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>Title</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=kd>func</span> <span class=nf>ToTitle</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=kd>func</span> <span class=nf>ToTitleSpecial</span><span class=p>(</span><span class=nx>c</span> <span class=nx>unicode</span><span class=p>.</span><span class=nx>SpecialCase</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Title 会将 s 每个单词的首字母大写，不处理该单词的后续字符。</p>
</li>
<li>
<p>ToTitle 将 s 的每个字母大写。</p>
</li>
<li>
<p>ToTitleSpecial 将 s 的每个字母大写，并且会将一些特殊字母转换为其对应的特殊大写字母。</p>
</li>
</ul>
<p>举个例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Title</span><span class=p>(</span><span class=s>&#34;hElLo wOrLd&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToTitle</span><span class=p>(</span><span class=s>&#34;hElLo wOrLd&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToTitleSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;hElLo wOrLd&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Title</span><span class=p>(</span><span class=s>&#34;āáǎà ōóǒò êēéěè&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToTitle</span><span class=p>(</span><span class=s>&#34;āáǎà ōóǒò êēéěè&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToTitleSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;āáǎà ōóǒò êēéěè&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Title</span><span class=p>(</span><span class=s>&#34;dünyanın ilk borsa yapısı Aizonai kabul edilir&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToTitle</span><span class=p>(</span><span class=s>&#34;dünyanın ilk borsa yapısı Aizonai kabul edilir&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>ToTitleSpecial</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>TurkishCase</span><span class=p>,</span> <span class=s>&#34;dünyanın ilk borsa yapısı Aizonai kabul edilir&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>HElLo WOrLd
HELLO WORLD
HELLO WORLD
Āáǎà Ōóǒò Êēéěè
ĀÁǍÀ ŌÓǑÒ ÊĒÉĚÈ
ĀÁǍÀ ŌÓǑÒ ÊĒÉĚÈ
Dünyanın Ilk Borsa Yapısı Aizonai Kabul Edilir
DÜNYANIN ILK BORSA YAPISI AIZONAI KABUL EDILIR
DÜNYANIN İLK BORSA YAPISI AİZONAİ KABUL EDİLİR
</code></pre></td></tr></table>
</div>
</div><h2 id=修剪>修剪</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// 将 s 左侧和右侧中匹配 cutset 中的任一字符的字符去掉
</span><span class=c1></span><span class=kd>func</span> <span class=nf>Trim</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>cutset</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=c1>// 将 s 左侧的匹配 cutset 中的任一字符的字符去掉
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimLeft</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>cutset</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=c1>// 将 s 右侧的匹配 cutset 中的任一字符的字符去掉
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimRight</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>cutset</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>

<span class=c1>// 如果 s 的前缀为 prefix 则返回去掉前缀后的 string , 否则 s 没有变化。
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimPrefix</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>
<span class=c1>// 如果 s 的后缀为 suffix 则返回去掉后缀后的 string , 否则 s 没有变化。
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimSuffix</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>suffix</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>

<span class=c1>// 将 s 左侧和右侧的间隔符去掉。常见间隔符包括：&#39;\t&#39;, &#39;\n&#39;, &#39;\v&#39;, &#39;\f&#39;, &#39;\r&#39;, &#39; &#39;, U+0085 (NEL)
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimSpace</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span>

<span class=c1>// 将 s 左侧和右侧的匹配 f 的字符去掉
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimFunc</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>string</span>
<span class=c1>// 将 s 左侧的匹配 f 的字符去掉
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimLeftFunc</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>string</span>
<span class=c1>// 将 s 右侧的匹配 f 的字符去掉
</span><span class=c1></span><span class=kd>func</span> <span class=nf>TrimRightFunc</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>包含了 9 个相关函数用于修剪字符串。</p>
<p>举个例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>x</span> <span class=o>:=</span> <span class=s>&#34;!!!@@@你好,!@#$ Gophers###$$$&#34;</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>Trim</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s>&#34;@#$!%^&amp;*()_+=-&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimLeft</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s>&#34;@#$!%^&amp;*()_+=-&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimRight</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s>&#34;@#$!%^&amp;*()_+=-&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimSpace</span><span class=p>(</span><span class=s>&#34; \t\n Hello, Gophers \n\t\r\n&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimPrefix</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s>&#34;!&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimSuffix</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s>&#34;$&#34;</span><span class=p>))</span>

<span class=nx>f</span> <span class=o>:=</span> <span class=kd>func</span><span class=p>(</span><span class=nx>r</span> <span class=kt>rune</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>!</span><span class=nx>unicode</span><span class=p>.</span><span class=nf>Is</span><span class=p>(</span><span class=nx>unicode</span><span class=p>.</span><span class=nx>Han</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span> <span class=c1>// 非汉字返回 true
</span><span class=c1></span><span class=p>}</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimFunc</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>f</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimLeftFunc</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>f</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>strings</span><span class=p>.</span><span class=nf>TrimRightFunc</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>f</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>你好,!@#$ Gophers
你好,!@#$ Gophers###<span class=nv>$$</span>$
!!!@@@你好,!@#$ Gophers
Hello, Gophers
!!@@@你好,!@#$ Gophers###<span class=nv>$$</span>$
!!!@@@你好,!@#$ Gophers###<span class=nv>$$</span>
你好
你好,!@#$ Gophers###<span class=nv>$$</span>$
!!!@@@你好
</code></pre></td></tr></table>
</div>
</div><h2 id=replacer-类型>Replacer 类型</h2>
<p>这是一个结构，没有导出任何字段，实例化通过 <code>func NewReplacer(oldnew ...string) *Replacer</code> 函数进行，其中不定参数 oldnew 是 old-new 对，即进行多个替换。如果 oldnew 长度与奇数，会导致 panic.</p>
<p>示例：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>r</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>NewReplacer</span><span class=p>(</span><span class=s>&#34;&lt;&#34;</span><span class=p>,</span> <span class=s>&#34;&amp;lt;&#34;</span><span class=p>,</span> <span class=s>&#34;&gt;&#34;</span><span class=p>,</span> <span class=s>&#34;&amp;gt;&#34;</span><span class=p>)</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>r</span><span class=p>.</span><span class=nf>Replace</span><span class=p>(</span><span class=s>&#34;This is &lt;b&gt;HTML&lt;/b&gt;!&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>This</span> <span class=nx>is</span> <span class=o>&amp;</span><span class=nx>lt</span><span class=p>;</span><span class=nx>b</span><span class=o>&amp;</span><span class=nx>gt</span><span class=p>;</span><span class=nx>HTML</span><span class=o>&amp;</span><span class=nx>lt</span><span class=p>;</span><span class=o>/</span><span class=nx>b</span><span class=o>&amp;</span><span class=nx>gt</span><span class=p>;!</span>
</code></pre></td></tr></table>
</div>
</div><p>另外，Replacer 还提供了另外一个方法，它在替换之后将结果写入 io.Writer 中。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=p>(</span><span class=nx>r</span> <span class=o>*</span><span class=nx>Replacer</span><span class=p>)</span> <span class=nf>WriteString</span><span class=p>(</span><span class=nx>w</span> <span class=nx>io</span><span class=p>.</span><span class=nx>Writer</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>err</span> <span class=kt>error</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=reader-类型>Reader 类型</h2>
<p>看到名字就能猜到，这是实现了 <code>io</code> 包中的接口。</p>
<blockquote>
<p>它实现了 io.Reader（Read 方法），io.ReaderAt（ReadAt 方法），io.Seeker（Seek 方法），io.WriterTo（WriteTo 方法），io.ByteReader（ReadByte 方法），io.ByteScanner（ReadByte 和 UnreadByte 方法），io.RuneReader（ReadRune 方法） 和 io.RuneScanner（ReadRune 和 UnreadRune 方法）。</p>
</blockquote>
<p>Reader 结构如下：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>Reader</span> <span class=kd>struct</span> <span class=p>{</span>
  <span class=nx>s</span>        <span class=kt>string</span>    <span class=c1>// Reader 读取的数据来源
</span><span class=c1></span>  <span class=nx>i</span>        <span class=kt>int</span> <span class=c1>// current reading index（当前读的索引位置）
</span><span class=c1></span>  <span class=nx>prevRune</span> <span class=kt>int</span> <span class=c1>// index of previous rune; or &lt; 0（前一个读取的 rune 索引位置）
</span><span class=c1></span><span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>可见 Reader 结构没有导出任何字段，而是提供一个实例化方法：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>NewReader</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=o>*</span><span class=nx>Reader</span>
</code></pre></td></tr></table>
</div>
</div><p>该方法接收一个字符串，返回的 Reader 实例就是从该参数字符串读数据。在后面学习了 bytes 包之后，可以知道 bytes.NewBufferString 有类似的功能，不过，如果只是为了读取，NewReader 会更高效。</p>
<h2 id=builder-类型>Builder 类型</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>Builder</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>addr</span> <span class=o>*</span><span class=nx>Builder</span> <span class=c1>// of receiver, to detect copies by value
</span><span class=c1></span>    <span class=nx>buf</span>  <span class=p>[]</span><span class=kt>byte</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>该类型实现了 io 包下的 Writer, ByteWriter, StringWriter 等接口，可以向该对象内写入数据，Builder 没有实现 Reader 等接口，所以该类型不可读，但提供了 String 方法可以获取对象内的数据。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// 该方法向 b 写入一个字节
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>WriteByte</span><span class=p>(</span><span class=nx>c</span> <span class=kt>byte</span><span class=p>)</span> <span class=kt>error</span>
<span class=c1>// WriteRune 方法向 b 写入一个字符
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>WriteRune</span><span class=p>(</span><span class=nx>r</span> <span class=kt>rune</span><span class=p>)</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=c1>// WriteRune 方法向 b 写入字节数组 p
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>Write</span><span class=p>(</span><span class=nx>p</span> <span class=p>[]</span><span class=kt>byte</span><span class=p>)</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=c1>// WriteRune 方法向 b 写入字符串 s
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>WriteString</span><span class=p>(</span><span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=c1>// Len 方法返回 b 的数据长度。
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>
<span class=c1>// Cap 方法返回 b 的 cap。
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>Cap</span><span class=p>()</span> <span class=kt>int</span>
<span class=c1>// Grow 方法将 b 的 cap 至少增加 n (可能会更多)。如果 n 为负数，会导致 panic。
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>Grow</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>)</span>
<span class=c1>// Reset 方法将 b 清空 b 的所有内容。
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>Reset</span><span class=p>()</span>
<span class=c1>// String 方法将 b 的数据以 string 类型返回。
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Builder</span><span class=p>)</span> <span class=nf>String</span><span class=p>()</span> <span class=kt>string</span>
</code></pre></td></tr></table>
</div>
</div><p>Builder 有 4 个与写入相关的方法，这 4 个方法的 error 都总是为 nil.</p>
<p>Builder 的 cap 会自动增长，一般不需要手动调用 Grow 方法。</p>
<p>String 方法可以方便的获取 Builder 的内容。</p>
<p>举个例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>b</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nx>Builder</span><span class=p>{}</span>
<span class=nx>_</span> <span class=p>=</span> <span class=nx>b</span><span class=p>.</span><span class=nf>WriteByte</span><span class=p>(</span><span class=sc>&#39;7&#39;</span><span class=p>)</span>
<span class=nx>n</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>b</span><span class=p>.</span><span class=nf>WriteRune</span><span class=p>(</span><span class=sc>&#39;夕&#39;</span><span class=p>)</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
<span class=nx>n</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>b</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;Hello, World&#34;</span><span class=p>))</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
<span class=nx>n</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>b</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=s>&#34;你好，世界&#34;</span><span class=p>)</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nf>Len</span><span class=p>())</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nf>Cap</span><span class=p>())</span>
<span class=nx>b</span><span class=p>.</span><span class=nf>Grow</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nf>Len</span><span class=p>())</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nf>Cap</span><span class=p>())</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nf>String</span><span class=p>())</span>
<span class=nx>b</span><span class=p>.</span><span class=nf>Reset</span><span class=p>()</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nf>String</span><span class=p>())</span>
</code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=m>3</span>
<span class=m>12</span>
<span class=m>15</span>
<span class=m>31</span>
<span class=m>32</span>
<span class=m>31</span>
<span class=m>164</span>
7夕Hello, World你好，世界
</code></pre></td></tr></table>
</div>
</div></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>更新于 0001-01-01</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span>
</section>
</div>
<div class=post-nav><a href=/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%96%87%E6%9C%AC/unicode/ class=prev rel=prev title><i class="fas fa-angle-left fa-fw"></i></a>
<a href=/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%96%87%E6%9C%AC/strconv/ class=next rel=next title><i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>酒困路长惟欲睡，日高人渴漫思茶</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部>
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论>
<i class="fas fa-comment fa-fw"></i>
</a>
</div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:40},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>