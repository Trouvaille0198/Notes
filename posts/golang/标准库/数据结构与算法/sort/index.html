<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Go sort 标准库 - 伤心肠粉的酱油碟子</title><meta name=Description content><meta property="og:title" content="Go sort 标准库"><meta property="og:description" content="sort 该包实现了四种基本排序算法：插入排序、归并排序、堆排序和快速排序。 但是这四种排"><meta property="og:type" content="article"><meta property="og:url" content="https://trouvaille0198.github.io/Notes/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/sort/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-12T11:36:24+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Go sort 标准库"><meta name=twitter:description content="sort 该包实现了四种基本排序算法：插入排序、归并排序、堆排序和快速排序。 但是这四种排"><meta name=application-name content="伤心肠粉的酱油碟子"><meta name=apple-mobile-web-app-title content="伤心肠粉的酱油碟子"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://trouvaille0198.github.io/Notes/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/sort/><link rel=prev href=https://trouvaille0198.github.io/Notes/posts/golang/%E5%91%BD%E5%90%8D%E5%92%8C%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/><link rel=next href=https://trouvaille0198.github.io/Notes/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/rand/><link rel=stylesheet href=/Notes/lib/normalize/normalize.min.css><link rel=stylesheet href=/Notes/css/style.min.css><link rel=stylesheet href=/Notes/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/Notes/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Go sort 标准库","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/golang\/%E6%A0%87%E5%87%86%E5%BA%93\/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95\/sort\/"},"genre":"posts","keywords":"Go 库","wordcount":3558,"url":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/golang\/%E6%A0%87%E5%87%86%E5%BA%93\/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95\/sort\/","datePublished":"2021-12-23T00:00:00+00:00","dateModified":"2022-04-12T11:36:24+00:00","publisher":{"@type":"Organization","name":"MelonCholi"},"author":{"@type":"Person","name":"MelonCholi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":''==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:''==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子>伤心肠粉</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/Notes/categories/>分类 </a><a class=menu-item href=/Notes/tags/>标签 </a><a class=menu-item href=/Notes/posts/>文章 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子>伤心肠粉</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/Notes/categories/ title>分类</a><a class=menu-item href=/Notes/tags/ title>标签</a><a class=menu-item href=/Notes/posts/ title>文章</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Go sort 标准库</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/Notes/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>MelonCholi</a></span>&nbsp;<span class=post-category>收录于 <a href=/Notes/categories/golang/><i class="far fa-folder fa-fw"></i>Golang</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-12-23>2021-12-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3558 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#数据集合排序>数据集合排序</a><ul><li><a href=#三个需要实现的方法>三个需要实现的方法</a></li><li><a href=#reverse>Reverse()</a></li><li><a href=#search>Search()</a></li></ul></li><li><a href=#已支持的内部数据类型排序>已支持的内部数据类型排序</a><ul><li><a href=#intslice-类型及-int-排序>IntSlice 类型及 []int 排序</a></li><li><a href=#float64slice-类型及-float64-排序>Float64Slice 类型及 []float64 排序</a></li><li><a href=#stringslice-类型及-string-排序>StringSlice 类型及 []string 排序</a></li></ul></li><li><a href=#interface-排序与查找>[]interface 排序与查找</a><ul><li><a href=#sortslice>sort.Slice</a></li><li><a href=#sortslicestable>sort.SliceStable</a></li><li><a href=#sortsliceissorted>sort.SliceIsSorted</a></li><li><a href=#sortsearch>sort.Search</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=sort>sort</h1><p>该包实现了四种基本排序算法：插入排序、归并排序、堆排序和快速排序。</p><p>但是这四种排序方法是不公开的，它们只被用于 sort 包内部使用。</p><p>所以在对数据集合排序时不必考虑应当选择哪一种排序方法，只要实现了 sort.Interface 定义的三个方法，就可以顺利对数据集合进行排序：</p><ul><li>获取数据集合长度的 Len() 方法</li><li>比较两个元素大小的 Less() 方法</li><li>交换两个元素位置的 Swap() 方法</li></ul><p>sort 包会根据实际数据自动选择高效的排序算法。</p><p>除此之外，为了方便对常用数据类型的操作，sort 包提供了对 []int 切片、[]float64 切片和 []string 切片的完整支持，主要包括：</p><ul><li>对基本数据类型切片的排序支持</li><li>基本数据元素查找</li><li>判断基本数据类型切片是否已经排好序</li><li>对排好序的数据集合逆序</li></ul><h2 id=数据集合排序>数据集合排序</h2><h3 id=三个需要实现的方法>三个需要实现的方法</h3><p>前面已经提到过，对数据集合（包括自定义数据类型的集合）排序需要实现 sort.Interface 接口的三个方法，我们看以下该接口的定义：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Interface</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 获取数据集合元素个数
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 如果 i 索引的数据小于 j 索引的数据，返回 true，且不会调用下面的 Swap()，即数据升序排序。
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 交换 i 和 j 索引的两个元素的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>数据集合实现了这三个方法后，即可调用该包的 Sort() 方法进行排序。 Sort() 方法定义如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Sort</span><span class=p>(</span><span class=nx>data</span> <span class=nx>Interface</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>Sort()</code> 方法惟一的参数就是待排序的数据集合。</p><p>该包还提供了一个方法可以判断数据集合是否已经排好顺序，该方法的内部实现依赖于我们自己实现的 Len() 和 Less() 方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>IsSorted</span><span class=p>(</span><span class=nx>data</span> <span class=nx>Interface</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>n</span> <span class=o>:=</span> <span class=nx>data</span><span class=p>.</span><span class=nf>Len</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span><span class=o>--</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>data</span><span class=p>.</span><span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>i</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>下面是一个使用 sort 包对学生成绩排序的示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sort&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 学生成绩结构体
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>StuScore</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span>  <span class=kt>string</span>    <span class=c1>// 姓名
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>score</span> <span class=kt>int</span>   <span class=c1>// 成绩
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>StuScores</span> <span class=p>[]</span><span class=nx>StuScore</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Len()
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>StuScores</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Less(): 成绩将有低到高排序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>StuScores</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>score</span> <span class=p>&lt;</span> <span class=nx>s</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>score</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Swap()
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>StuScores</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>s</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>s</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>stus</span> <span class=o>:=</span> <span class=nx>StuScores</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s>&#34;alan&#34;</span><span class=p>,</span> <span class=mi>95</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s>&#34;hikerell&#34;</span><span class=p>,</span> <span class=mi>91</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s>&#34;acmfly&#34;</span><span class=p>,</span> <span class=mi>96</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s>&#34;leao&#34;</span><span class=p>,</span> <span class=mi>90</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 打印未排序的 stus 数据
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Default:\n\t&#34;</span><span class=p>,</span><span class=nx>stus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>//StuScores 已经实现了 sort.Interface 接口 , 所以可以调用 Sort 函数进行排序
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>sort</span><span class=p>.</span><span class=nf>Sort</span><span class=p>(</span><span class=nx>stus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 判断是否已经排好顺序，将会打印 true
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;IS Sorted?\n\t&#34;</span><span class=p>,</span> <span class=nx>sort</span><span class=p>.</span><span class=nf>IsSorted</span><span class=p>(</span><span class=nx>stus</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 打印排序后的 stus 数据
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Sorted:\n\t&#34;</span><span class=p>,</span><span class=nx>stus</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>该示例程序的自定义类型 StuScores 实现了 sort.Interface 接口，所以可以将其对象作为 sort.Sort() 和 sort.IsSorted() 的参数传入。运行结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Default:
</span></span><span class=line><span class=cl>     <span class=o>[{</span>alan 95<span class=o>}</span> <span class=o>{</span>hikerell 91<span class=o>}</span> <span class=o>{</span>acmfly 96<span class=o>}</span> <span class=o>{</span>leao 90<span class=o>}]</span>
</span></span><span class=line><span class=cl>IS Sorted?
</span></span><span class=line><span class=cl>     <span class=nb>true</span>
</span></span><span class=line><span class=cl>Sorted:
</span></span><span class=line><span class=cl>     <span class=o>[{</span>leao 90<span class=o>}</span> <span class=o>{</span>hikerell 91<span class=o>}</span> <span class=o>{</span>alan 95<span class=o>}</span> <span class=o>{</span>acmfly 96<span class=o>}]</span>
</span></span></code></pre></td></tr></table></div></div><p>该示例实现的是升序排序，如果要得到降序排序结果，其实只要修改 Less() 函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>//Less(): 成绩降序排序 , 只将小于号修改为大于号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>StuScores</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>score</span> <span class=p>&gt;</span> <span class=nx>s</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>score</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=reverse>Reverse()</h3><p>此外，<em>sort</em> 包提供了 <code>Reverse()</code> 方法，可以允许将数据按 <code>Less()</code> 定义的排序方式逆序排序，而不必修改 <code>Less()</code> 代码。方法定义如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Reverse</span><span class=p>(</span><span class=nx>data</span> <span class=nx>Interface</span><span class=p>)</span> <span class=nx>Interface</span>
</span></span></code></pre></td></tr></table></div></div><p>我们可以看到 <code>Reverse()</code> 返回的一个 <code>sort.Interface</code> 接口类型，整个 Reverse() 的内部实现比较有趣：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 定义了一个 reverse 结构类型，嵌入 Interface 接口
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>reverse</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Interface</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// reverse 结构类型的 Less() 方法拥有嵌入的 Less() 方法相反的行为
</span></span></span><span class=line><span class=cl><span class=c1>// Len() 和 Swap() 方法则会保持嵌入类型的方法行为
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>r</span> <span class=nx>reverse</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>r</span><span class=p>.</span><span class=nx>Interface</span><span class=p>.</span><span class=nf>Less</span><span class=p>(</span><span class=nx>j</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 返回新的实现 Interface 接口的数据类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Reverse</span><span class=p>(</span><span class=nx>data</span> <span class=nx>Interface</span><span class=p>)</span> <span class=nx>Interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>reverse</span><span class=p>{</span><span class=nx>data</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>了解内部原理后，可以在学生成绩排序示例中使用 <code>Reverse()</code> 来实现成绩升序排序：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>sort</span><span class=p>.</span><span class=nf>Sort</span><span class=p>(</span><span class=nx>sort</span><span class=p>.</span><span class=nf>Reverse</span><span class=p>(</span><span class=nx>stus</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>stus</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=search>Search()</h3><p>最后一个方法：<code>Search()</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Search</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><p>该方法会使用“二分查找”算法来找出能使 f(x)(0&lt;=x&lt;n) 返回 true 的最小值 i。</p><p>前提条件 : f(x)(0&lt;=x&lt;i) 均返回 false, f(x)(i&lt;=x&lt;n) 均返回 true。 如果不存在 i 可以使 f(i) 返回 true, 则返回 n。</p><p><code>Search()</code> 函数一个常用的使用方式是搜索元素 x 是否在已经升序排好的切片 s 中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>x</span> <span class=o>:=</span> <span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=nx>s</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>45</span><span class=p>}</span> <span class=c1>// 注意已经升序排序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>pos</span> <span class=o>:=</span> <span class=nx>sort</span><span class=p>.</span><span class=nf>Search</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>),</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=nx>x</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>pos</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>s</span><span class=p>[</span><span class=nx>pos</span><span class=p>]</span> <span class=o>==</span> <span class=nx>x</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s>&#34; 在 s 中的位置为：&#34;</span><span class=p>,</span> <span class=nx>pos</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;s 不包含元素 &#34;</span><span class=p>,</span> <span class=nx>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>官方文档还给出了一个猜数字的小程序：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>GuessingGame</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>s</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Pick an integer from 0 to 100.\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>answer</span> <span class=o>:=</span> <span class=nx>sort</span><span class=p>.</span><span class=nf>Search</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Is your number &lt;= %d? &#34;</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>s</span> <span class=o>!=</span> <span class=s>&#34;&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;y&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Your number is %d.\n&#34;</span><span class=p>,</span> <span class=nx>answer</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=已支持的内部数据类型排序>已支持的内部数据类型排序</h2><p>前面已经提到，sort 包原生支持 []int、[]float64 和 []string 三种内建数据类型切片的排序操作，即不必我们自己实现相关的 Len()、Less() 和 Swap() 方法。</p><h3 id=intslice-类型及-int-排序>IntSlice 类型及 []int 排序</h3><p>由于 []int 切片排序内部实现及使用方法与 []float64 和 []string 类似，所以只详细描述该部分。</p><p><em>sort</em> 包定义了一个 IntSlice 类型，并且实现了 sort.Interface 接口：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>IntSlice</span> <span class=p>[]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>           <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&lt;</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>      <span class=p>{</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// IntSlice 类型定义了 Sort() 方法，包装了 sort.Sort() 函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Sort</span><span class=p>()</span> <span class=p>{</span> <span class=nf>Sort</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// IntSlice 类型定义了 SearchInts() 方法，包装了 SearchInts() 函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Search</span><span class=p>(</span><span class=nx>x</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>SearchInts</span><span class=p>(</span><span class=nx>p</span><span class=p>,</span> <span class=nx>x</span><span class=p>)</span> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>并且提供的 sort.Ints() 方法使用了该 IntSlice 类型：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Ints</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span> <span class=nf>Sort</span><span class=p>(</span><span class=nf>IntSlice</span><span class=p>(</span><span class=nx>a</span><span class=p>))</span> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>所以，对 []int 切片排序更常使用 <code>sort.Ints()</code>，而不是直接使用 IntSlice 类型：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>s</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span> <span class=c1>// 未排序的切片数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>sort</span><span class=p>.</span><span class=nf>Ints</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=c1>// 将会输出[1 2 3 4 5 6]
</span></span></span></code></pre></td></tr></table></div></div><p>如果要使用降序排序，显然要用前面提到的 Reverse() 方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>s</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span> <span class=c1>// 未排序的切片数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>sort</span><span class=p>.</span><span class=nf>Sort</span><span class=p>(</span><span class=nx>sort</span><span class=p>.</span><span class=nf>Reverse</span><span class=p>(</span><span class=nx>sort</span><span class=p>.</span><span class=nf>IntSlice</span><span class=p>(</span><span class=nx>s</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=c1>// 将会输出[6 5 4 3 2 1]
</span></span></span></code></pre></td></tr></table></div></div><p>如果要查找整数 x 在切片 a 中的位置，相对于前面提到的 Search() 方法，<em>sort</em> 包提供了 SearchInts():</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>SearchInts</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>int</span><span class=p>,</span> <span class=nx>x</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><p>注意，SearchInts() 的使用条件为：<strong>切片 a 已经升序排序</strong> 以下是一个错误使用的例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>s</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span> <span class=c1>// 未排序的切片数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>sort</span><span class=p>.</span><span class=nf>SearchInts</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span> <span class=c1>// 将会输出 0 而不是 1
</span></span></span></code></pre></td></tr></table></div></div><h3 id=float64slice-类型及-float64-排序>Float64Slice 类型及 []float64 排序</h3><p>实现与 Ints 类似，只看一下其内部实现：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Float64Slice</span> <span class=p>[]</span><span class=kt>float64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Float64Slice</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>           <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Float64Slice</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&lt;</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=o>||</span> <span class=nf>isNaN</span><span class=p>(</span><span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=p>!</span><span class=nf>isNaN</span><span class=p>(</span><span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>])</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Float64Slice</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>      <span class=p>{</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Float64Slice</span><span class=p>)</span> <span class=nf>Sort</span><span class=p>()</span> <span class=p>{</span> <span class=nf>Sort</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Float64Slice</span><span class=p>)</span> <span class=nf>Search</span><span class=p>(</span><span class=nx>x</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>SearchFloat64s</span><span class=p>(</span><span class=nx>p</span><span class=p>,</span> <span class=nx>x</span><span class=p>)</span> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>与 Sort()、IsSorted()、Search() 相对应的三个方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Float64s</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Float64sAreSorted</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>)</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>SearchFloat64s</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>float64</span><span class=p>,</span> <span class=nx>x</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><p>要说明一下的是，在上面 Float64Slice 类型定义的 Less 方法中，有一个内部函数 isNaN()。 isNaN() 与 <em>math</em> 包中 IsNaN() 实现完全相同，<em>sort</em> 包之所以不使用 math.IsNaN()，完全是基于包依赖性的考虑，应当看到，<em>sort</em> 包的实现不依赖与其他任何包。</p><h3 id=stringslice-类型及-string-排序>StringSlice 类型及 []string 排序</h3><p>两个 string 对象之间的大小比较是基于“<strong>字典序</strong>”的。</p><p>实现与 Ints 类似，只看一下其内部实现：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>StringSlice</span> <span class=p>[]</span><span class=kt>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>StringSlice</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>           <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>StringSlice</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&lt;</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>StringSlice</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>      <span class=p>{</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>StringSlice</span><span class=p>)</span> <span class=nf>Sort</span><span class=p>()</span> <span class=p>{</span> <span class=nf>Sort</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>StringSlice</span><span class=p>)</span> <span class=nf>Search</span><span class=p>(</span><span class=nx>x</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span> <span class=k>return</span> <span class=nf>SearchStrings</span><span class=p>(</span><span class=nx>p</span><span class=p>,</span> <span class=nx>x</span><span class=p>)</span> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>与 Sort()、IsSorted()、Search() 相对应的三个方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Strings</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>StringsAreSorted</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>string</span><span class=p>)</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>SearchStrings</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=nx>x</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=interface-排序与查找>[]interface 排序与查找</h2><p>通过前面的内容我们可以知道，只要实现了 <code>sort.Interface</code> 接口，即可通过 sort 包内的函数完成排序，查找等操作。并且 sort 包已经帮我们把<code>[]int</code>, <code>[]float64</code>, <code>[]string</code> 三种类型都实现了该接口，我们可以方便的调用。但是这种用法对于其它数据类型的 slice 不友好，可能我们需要为大量的 struct 定义一个单独的 []struct 类型，再为其实现 <code>sort.Interface</code> 接口，类似这样：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Person</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Persons</span> <span class=p>[]</span><span class=nx>Person</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Persons</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;implement me&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Persons</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;implement me&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Persons</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>panic</span><span class=p>(</span><span class=s>&#34;implement me&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>因为排序涉及到比较两个变量的值，而 struct 可能包含多个属性，程序并不知道你想以哪一个属性或哪几个属性作为衡量大小的标准。</p><p>如果你能帮助程序完成比较，并将结果返回， sort 包内的方法就可以完成排序，判断，查找等。sort 包提供了以下函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Slice</span><span class=p>(</span><span class=nx>slice</span> <span class=kd>interface</span><span class=p>{},</span> <span class=nx>less</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>SliceStable</span><span class=p>(</span><span class=nx>slice</span> <span class=kd>interface</span><span class=p>{},</span> <span class=nx>less</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>SliceIsSorted</span><span class=p>(</span><span class=nx>slice</span> <span class=kd>interface</span><span class=p>{},</span> <span class=nx>less</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>bool</span> 
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Search</span><span class=p>(</span><span class=nx>n</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>f</span> <span class=kd>func</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span> <span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><p>通过函数签名可以看到，排序相关的三个函数都接收 <code>[]interface</code>，并且需要传入一个比较函数，用于为程序比较两个变量的大小，因为函数签名和作用域的原因，这个函数只能是 <code>匿名函数</code>。</p><h3 id=sortslice>sort.Slice</h3><p>该函数完成 []interface 的<strong>排序</strong>，举个栗子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>people</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=mi>7</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Alice&#34;</span><span class=p>,</span> <span class=mi>55</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Vera&#34;</span><span class=p>,</span> <span class=mi>24</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Bob&#34;</span><span class=p>,</span> <span class=mi>75</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>sort</span><span class=p>.</span><span class=nf>Slice</span><span class=p>(</span><span class=nx>people</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>people</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&lt;</span> <span class=nx>people</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>})</span> <span class=c1>// 按年龄升序排序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Sort by age:&#34;</span><span class=p>,</span> <span class=nx>people</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>输出结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>By age: <span class=o>[{</span>Gopher 7<span class=o>}</span> <span class=o>{</span>Vera 24<span class=o>}</span> <span class=o>{</span>Alice 55<span class=o>}</span> <span class=o>{</span>Bob 75<span class=o>}]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=sortslicestable>sort.SliceStable</h3><p>该函数完成 []interface 的<strong>稳定排序</strong>，举个栗子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>people</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=mi>7</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Alice&#34;</span><span class=p>,</span> <span class=mi>55</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Vera&#34;</span><span class=p>,</span> <span class=mi>24</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Bob&#34;</span><span class=p>,</span> <span class=mi>75</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>sort</span><span class=p>.</span><span class=nf>SliceStable</span><span class=p>(</span><span class=nx>people</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>people</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&gt;</span> <span class=nx>people</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>})</span> <span class=c1>// 按年龄降序排序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Sort by age:&#34;</span><span class=p>,</span> <span class=nx>people</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>输出结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>By age: <span class=o>[{</span>Bob 75<span class=o>}</span> <span class=o>{</span>Alice 55<span class=o>}</span> <span class=o>{</span>Vera 24<span class=o>}</span> <span class=o>{</span>Gopher 7<span class=o>}]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=sortsliceissorted>sort.SliceIsSorted</h3><p>该函数判断 []interface <strong>是否为有序</strong>，举个栗子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>people</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=mi>7</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Alice&#34;</span><span class=p>,</span> <span class=mi>55</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Vera&#34;</span><span class=p>,</span> <span class=mi>24</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s>&#34;Bob&#34;</span><span class=p>,</span> <span class=mi>75</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>sort</span><span class=p>.</span><span class=nf>Slice</span><span class=p>(</span><span class=nx>people</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>people</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&gt;</span> <span class=nx>people</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>})</span> <span class=c1>// 按年龄降序排序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Sort by age:&#34;</span><span class=p>,</span> <span class=nx>people</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Sorted:&#34;</span><span class=p>,</span><span class=nx>sort</span><span class=p>.</span><span class=nf>SliceIsSorted</span><span class=p>(</span><span class=nx>people</span><span class=p>,</span><span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>people</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&lt;</span> <span class=nx>people</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>}))</span>
</span></span></code></pre></td></tr></table></div></div><p>输出结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Sort by age: <span class=o>[{</span>Bob 75<span class=o>}</span> <span class=o>{</span>Alice 55<span class=o>}</span> <span class=o>{</span>Vera 24<span class=o>}</span> <span class=o>{</span>Gopher 7<span class=o>}]</span>
</span></span><span class=line><span class=cl>Sorted: <span class=nb>false</span>
</span></span></code></pre></td></tr></table></div></div><p>sort 包没有为 []interface 提供反序函数，但是从 1 和 2 可以看出，我们传入的比较函数已经决定了排序结果是升序还是降序。</p><p>判断 slice 是否为有序，同样取决于我们传入的比较函数，从 3 可以看出，虽然 slice 已经按年龄降序排序，但我们在判断 slice 是否为有序时给的比较函数是判断其是否为升序有序，所以最终得到的结果为 false。</p><h3 id=sortsearch>sort.Search</h3><p>该函数判断 []interface 是否存在指定元素，举个栗子：</p><ul><li>升序 slice</li></ul><p>sort 包为 <code>[]int</code>，<code>[]float64</code>，<code>[]string</code> 提供的 Search 函数其实也是调用的该函数，因为该函数是使用的二分查找法，所以要求 slice 为<strong>升序</strong>排序状态。并且判断条件必须为 <code>>=</code>，这也是官方库提供的三个查找相关函数的的写法。</p><p>举个栗子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>a</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>234</span><span class=p>,</span> <span class=mi>56</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>x</span> <span class=o>:=</span> <span class=mi>21</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>sort</span><span class=p>.</span><span class=nf>Slice</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&lt;</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>})</span>   <span class=c1>// 升序排序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>index</span> <span class=o>:=</span> <span class=nx>sort</span><span class=p>.</span><span class=nf>Search</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=nx>x</span> <span class=p>})</span> <span class=c1>// 查找元素
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>index</span> <span class=p>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>a</span><span class=p>[</span><span class=nx>index</span><span class=p>]</span> <span class=o>==</span> <span class=nx>x</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;found %d at index %d in %v\n&#34;</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>index</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%d not found in %v,index:%d\n&#34;</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>输出结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>found <span class=m>21</span> at index <span class=m>3</span> in <span class=o>[</span><span class=m>2</span> <span class=m>3</span> <span class=m>4</span> <span class=m>21</span> <span class=m>56</span> <span class=m>100</span> <span class=m>200</span> 234<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>降序 slice</li></ul><p>如果 slice 是降序状态，而我们又不想将其变为升序，只需将判断条件由 <code>>=</code> 变更为 <code>&lt;=</code> 即可。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-04-12</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/Notes/tags/go-%E5%BA%93/>Go 库</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/Notes/>主页</a></span></section></div><div class=post-nav><a href=/Notes/posts/golang/%E5%91%BD%E5%90%8D%E5%92%8C%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/ class=prev rel=prev title="Go 命名和开发规范"><i class="fas fa-angle-left fa-fw"></i>Go 命名和开发规范</a>
<a href=/Notes/posts/golang/%E6%A0%87%E5%87%86%E5%BA%93/rand/ class=next rel=next title="Go math/rand 标准库">Go math/rand 标准库<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>酒困路长惟欲睡，日高人渴漫思茶</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/Notes/lib/katex/katex.min.css><link rel=stylesheet href=/Notes/lib/katex/copy-tex.min.css><script type=text/javascript src=/Notes/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/Notes/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/Notes/lib/lunr/lunr.min.js></script><script type=text/javascript src=/Notes/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/Notes/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/Notes/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/Notes/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/Notes/lib/katex/katex.min.js></script><script type=text/javascript src=/Notes/lib/katex/auto-render.min.js></script><script type=text/javascript src=/Notes/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/Notes/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:45},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/Notes/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/Notes/lib/lunr/lunr.segmentit.js",maxResultLength:30,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/Notes/js/theme.min.js></script></body></html>