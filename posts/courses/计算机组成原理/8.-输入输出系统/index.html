<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>计组 第八章 - 伤心肠粉的酱油碟子</title><meta name=author content><meta name=author-link content><meta name=description content="输入输出系统 主机与外设的传输原理 输入：外设送到主机 输出：主机送到外设 外围设备的定"><meta name=keywords content="计算机组成原理"><meta itemprop=name content="计组 第八章"><meta itemprop=description content="输入输出系统 主机与外设的传输原理 输入：外设送到主机 输出：主机送到外设 外围设备的定"><meta itemprop=datePublished content="2021-10-23T00:00:00+00:00"><meta itemprop=dateModified content="2023-04-24T13:06:13+00:00"><meta itemprop=wordCount content="3816"><meta itemprop=image content="https://trouvaille0198.github.io/logo.png"><meta itemprop=keywords content="计算机组成原理,"><meta property="og:title" content="计组 第八章"><meta property="og:description" content="输入输出系统 主机与外设的传输原理 输入：外设送到主机 输出：主机送到外设 外围设备的定"><meta property="og:type" content="article"><meta property="og:url" content="https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/"><meta property="og:image" content="https://trouvaille0198.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-23T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-24T13:06:13+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://trouvaille0198.github.io/logo.png"><meta name=twitter:title content="计组 第八章"><meta name=twitter:description content="输入输出系统 主机与外设的传输原理 输入：外设送到主机 输出：主机送到外设 外围设备的定"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#252627"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/><link rel=prev href=https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/2.-%E8%BF%90%E7%AE%97%E6%96%B9%E6%B3%95%E5%92%8C%E8%BF%90%E7%AE%97%E5%99%A8/><link rel=next href=https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.-%E6%A6%82%E8%BF%B0/><link rel=stylesheet href=/Notes/lib/normalize/normalize.min.css><link rel=stylesheet href=/Notes/css/style.min.css><link rel=stylesheet href=/Notes/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/Notes/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"计组 第八章","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/courses\/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86\/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F\/"},"genre":"posts","keywords":"计算机组成原理","wordcount":3816,"url":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/courses\/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86\/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F\/","datePublished":"2021-10-23T00:00:00+00:00","dateModified":"2023-04-24T13:06:13+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"MelonCholi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>计组 第八章</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle"></i>
MelonCholi</span></span>
<span class=post-category>收录于 <a href=/Notes/categories/%E4%B8%93%E4%B8%9A%E8%AF%BE/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;专业课</a></span></div><div class=post-meta-line><span title="2021-10-23 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-10-23>2021-10-23</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 3816 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#外围设备的定时方式和信息交换方式>外围设备的定时方式和信息交换方式</a><ul><li><a href=#外围设备的速度分级>外围设备的速度分级</a></li><li><a href=#信息交换方式>信息交换方式</a></li></ul></li><li><a href=#程序查询方式>程序查询方式</a><ul><li><a href=#步骤>步骤</a></li><li><a href=#设备编址>设备编址</a><ul><li><a href=#统一编址>统一编址</a></li><li><a href=#单独编址>单独编址</a></li></ul></li><li><a href=#程序查询接口>程序查询接口</a></li></ul></li><li><a href=#程序中断方式>程序中断方式</a><ul><li><a href=#中断的基本概念>中断的基本概念</a></li><li><a href=#程序中断方式的基本io接口>程序中断方式的基本I/O接口</a></li><li><a href=#单级中断>单级中断</a></li><li><a href=#多级中断重要>多级中断（重要）</a><ul><li><a href=#概念>概念</a></li><li><a href=#多级中断源的识别>多级中断源的识别</a></li><li><a href=#例>例</a></li></ul></li><li><a href=#中断控制器了解>中断控制器（了解）</a><ul><li><a href=#定义>定义</a></li><li><a href=#优先级选择方式>优先级选择方式</a></li></ul></li></ul></li><li><a href=#dma-方式>DMA 方式</a><ul><li><a href=#基本概念>基本概念</a></li><li><a href=#dma-传送方式>DMA 传送方式</a><ul><li><a href=#停止-cpu-访问内存>停止 CPU 访问内存</a></li><li><a href=#周期挪用方式>周期挪用方式</a></li><li><a href=#dma-与-cpu-交替访内>DMA 与 CPU 交替访内</a></li></ul></li><li><a href=#基本的-dma-原理>基本的 DMA 原理</a><ul><li><a href=#dma-基本构成>DMA 基本构成</a></li><li><a href=#dma-数据传送过程>DMA 数据传送过程</a></li></ul></li><li><a href=#选择型和多路型-dma-控制器>选择型和多路型 DMA 控制器</a><ul><li><a href=#选择型>选择型</a></li><li><a href=#多路型>多路型</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=输入输出系统>输入输出系统</h1><p>主机与外设的传输原理</p><p>输入：外设送到主机</p><p>输出：主机送到外设</p><h2 id=外围设备的定时方式和信息交换方式>外围设备的定时方式和信息交换方式</h2><h3 id=外围设备的速度分级>外围设备的速度分级</h3><p>外设种类繁多，存在以下几种情况：</p><ul><li><p>不同种类的外设数据传输速率差别很大</p></li><li><p>同一种设备在不同时刻传输速率也可能不同</p></li></ul><p>高速的 CPU 与速度参差不齐的外设怎样在时间上同步呢？</p><ul><li>解决办法时在 CPU 和外设之间数据传送时加以定时。</li></ul><p>外设的分级</p><ul><li><p>速度极慢或简单的外设</p><ul><li>机械开关、显示二极管</li><li>CPU 只需要接受或者发送数据即可</li></ul></li><li><p>慢速或者中速的设备</p><ul><li>可以采用异步定时的方式</li></ul></li><li><p>高速外设</p><ul><li>采用同步定时方式，成组数据传输</li></ul></li></ul><h3 id=信息交换方式>信息交换方式</h3><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210603134735262.png alt=image-20210603134735262 style=zoom:50%><ul><li><p><strong>程序查询方式</strong></p><p>CPU 保持对外设的监听状态</p></li><li><p><strong>程序中断方式</strong></p><p>外设传送数据时向 CPU 汇报</p></li><li><p><strong>DMA 方式</strong>（直接内存访问）</p><p>外设传送成组的数据，不需要向 CPU 汇报；传输完成后再汇报，将总线控制权还给 CPU</p></li><li><p><strong>通道方式</strong></p><p>使用专门的 I/O 处理器来协助 CPU 工作</p></li></ul><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429122346870.png alt=image-20210429122346870 style=zoom:50%><h2 id=程序查询方式>程序查询方式</h2><p>又叫程序控制 I/O 方式</p><h3 id=步骤>步骤</h3><ol><li><p>先向 I/O 设备发出命令字，请求进行数据传送</p></li><li><p>从 I/O 接口读入状态字</p></li><li><p>检查状态字中的标志，看看数据交换是否可以进行</p></li><li><p>（等）假如这个设备没有准备就绪，则第 (2)、第 (3) 步重复进行，一直到这个设备准备好交换数据，发出准备就绪信号 “Ready” 为止</p></li><li><p>CPU 从 I/O 接口的数据缓冲寄存器输入数据，或者将数据从 CPU 输出至接口的数据缓冲寄存器。与此同时， CPU 将接口中的状态标志复位</p></li></ol><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429124731884.png alt=image-20210429124731884 style=zoom:80%><p>轮询</p><h3 id=设备编址>设备编址</h3><h4 id=统一编址>统一编址</h4><p>I/O 设备与内存单元联合在一起编排地址</p><p>不需要专门的 I/O 指令组</p><h4 id=单独编址>单独编址</h4><p>I/O 设备地址与内存地址单独分开</p><p>I/O 设备要有专门的指令组</p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429124203454.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429124203454.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429124203454.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429124203454.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429124203454.png title=image-20210429124203454></p><h3 id=程序查询接口>程序查询接口</h3><ul><li><p><strong>设备选择电路</strong></p><p>根据设备地址码选择外设</p></li><li><p><strong>数据缓冲寄存器</strong></p><p>缓冲数据</p></li><li><p><strong>设备状态标志</strong></p><p>标志设备的工作状态</p></li></ul><h2 id=程序中断方式>程序中断方式</h2><h3 id=中断的基本概念>中断的基本概念</h3><p>中断（Interrupt）是指 CPU 暂时中止现行程序，转去处理<strong>随机</strong>发生的紧急事件，处理完后自动返回原程序的功能和技术。</p><p>中断系统是计机实现中断功能的软硬件总称。</p><p>一般在 CPU 中设置中断机构，在外设接口中设置中断控制器，在软件上设置相应的中断服务程序</p><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125052957.png alt=image-20210429125052957 style=zoom:80%><p>中断处理过程注意几个问题：</p><ul><li><p><strong>响应中断时机：<strong>外界中断请求是</strong>随机</strong>的，但 CPU 只有在当前指令执行完毕后，才转至公操作</p></li><li><p><strong>断点保护问题</strong>（PC，寄存器内容和状态的保存）</p></li><li><p><strong>原子操作</strong>：开中断和关中断问题。</p><ul><li>将中断屏蔽触发器置为 1，即关闭中断，不接收中断请求</li></ul></li><li><p>中断是由<strong>软硬件结合</strong>起来实现的</p></li><li><p>中断分为<strong>内中断</strong>（<strong>异常</strong>）和<strong>外中断</strong></p></li></ul><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125147275.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125147275.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125147275.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125147275.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125147275.png title=image-20210429125147275></p><h3 id=程序中断方式的基本io接口>程序中断方式的基本I/O接口</h3><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429125243845.png alt=image-20210429125243845 style=zoom:80%><p>① 表示由程序启动外设，将该外设接口的**“忙”标志 BS** 置 “1”，<strong>“准备就绪”标志 RD</strong> 清 “0”；</p><p>② 表示接口向外设发出启动信号；</p><p>③ 表示数据由外设传送到接口的缓冲寄存器；</p><p>④ 表示当设备动作结束或缓冲寄存器数据填满时，设备向接口送出一控制信号，将数据“准备就绪”标志 RD 置 “1”；</p><p>⑤ 表示<strong>允许中断标志 EI</strong> 为 “1” 时，接口向 CPU 发出中断请求信号；</p><p>⑥ 表示在一条指令执行末尾 CPU 检查中断请求线，将中断请求线的请求信号接收到**“中断请求”标志 IR**；</p><p>⑦ 表示如果**“中断屏蔽”标志 IM** 为 “0” 时，CPU 在一条指令执行结束后受理外设的中断请求，向外设发出响应中断信号并关闭中断；</p><p>⑧ 表示转向该设备的中断服务程序入口；</p><p>⑨ 表示在中断服务程序通过输入指令把接口中数据缓冲寄存器的数据读至 CPU 中的寄存器；</p><p>⑩ 表示 CPU 发出控制信号 C 将接口中的 BS 和 RD 标志复位</p><h3 id=单级中断>单级中断</h3><p>有优先级，但不能嵌套</p><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429134300322.png alt=image-20210429134300322 style=zoom:67%><ul><li><p>概念</p><ul><li>所有中断源属于同一级，离 CPU 越近，优先级越高。</li></ul></li><li><p>中断源的识别：<strong>串行排队链法</strong></p><ul><li>IR1，IR2，IR3 为中断请求信号</li><li>IS1，IS2，IS3 为中断选中信号</li><li>INTI 为中断排队输入</li><li>INTO 为中断排队输出</li><li>INTA？</li></ul></li><li><p>中断向量的产生</p><ul><li>当 CPU 响应中断时，由硬件直接产生一个固定的地址 (即向量地址)</li><li>由向量地址指出每个中断源设备的中断服务程序入口，便于跳转，这种方法通常称为向量中断。</li></ul></li></ul><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429134351160.png alt=image-20210429134351160 style=zoom:80%><p>（好图，看 👆）</p><h3 id=多级中断重要>多级中断（重要）</h3><h4 id=概念>概念</h4><ul><li><p>每级有一个中断优先权</p></li><li><p>一维多级中断和二维多级中断</p></li><li><p>说明：</p><ul><li>一个系统有 n 级中断，则 CPU 中有 n 个 IR，n 个 IM<ul><li>某级中断被响应后，则关闭本级和低于本级的 IM，开放更高级的 IM。</li></ul></li><li>多级中断可以嵌套，但同一级的中断不允许嵌套</li><li>中断响应时，确定哪一级中断和中断源采用硬件实现。采用了独立请求方式和链式查询方式相结合的方式。</li><li>使用多级堆栈保存现场（包括 IM）</li><li>中断屏蔽触发器合在一起，组成了中断屏蔽寄存器</li></ul></li></ul><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135903783.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135903783.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135903783.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135903783.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135903783.png title=image-20210429135903783></p><h4 id=多级中断源的识别>多级中断源的识别</h4><ul><li><p>中断优先排队电路</p></li><li><p>中断向量产生电路</p></li></ul><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135954200.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135954200.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135954200.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135954200.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429135954200.png title=image-20210429135954200></p><h4 id=例>例</h4><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429141825471.png alt=image-20210429141825471 style=zoom:50%>
<img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210429141806985.png alt=image-20210429141806985 style=zoom:50%>
<img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506125301122.png alt=image-20210506125301122 style=zoom:150%><p>==分析==</p><ul><li>中断<strong>处理</strong>次序 / 优先级：在软件（中段处理程序）中设置</li><li>中断<strong>响应</strong>优先级：在硬件中设置</li></ul><h3 id=中断控制器了解>中断控制器（了解）</h3><h4 id=定义>定义</h4><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506130856935.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506130856935.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506130856935.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506130856935.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506130856935.png title=image-20210506130856935></p><p><strong>8259 中断控制器</strong>是一个集成电路芯片，它将中断接口与优先级判断等功能汇集于一身，常用于微型机系统</p><ul><li><p>8 位中断请求寄存器 (IR) 接受 8 个外部设备送来的中断请求，每一位对应一个设备。</p></li><li><p>中断请求寄存器的各位送入优先权判断器，根据中断屏蔽寄存器 (IM) 各位的状态来决定最高优先级的中断请求，并将各位的状态送入中断状态寄存器 IS。IS 保存着判优结果。由控制逻辑向 CPU 发出中断请求信号 INT，并接受 CPU 的中断响应信号 INTA。</p></li><li><p>数据缓冲器用于保存 CPU 内部总线与系统数据总线之间进行传送的数据。</p></li><li><p>读/写逻辑决定数据传送的方向，其中 IOR 为读控制，IOW 为写控制，CS 为设备选择，A0 为 I/O 端口识别。</p></li></ul><h4 id=优先级选择方式>优先级选择方式</h4><ol><li><p>完全嵌套方式</p><p>是一种固定优先级方式，连至 IR0 的设备优先级最高，IR7 的优先级最低。这种固定优先级方式对级别低的中断不利，在有些情况下最低级别的中断请求可能一直不能被处理。</p></li><li><p>轮换优先级方式 A</p><p>每个级别的中断保证有机会被处理，将给定的中断级别处理完后，立即把它放到最低级别的位置上去。</p></li><li><p>轮换优先级方式 B</p><p>要求 CPU 可在任何时间规定最优优先级，然后顺序地规定其他 IR 线上的优先级。</p></li><li><p>查询方式</p><p>由 CPU 访问 8259 的中断状态寄存器，一个状态字能表示出正在请求中断的最高优先级 IR 线，并能表示出中断请求是否有效。</p></li></ol><h2 id=dma-方式>DMA 方式</h2><p>高速外设，同步定时，以数据块为单位进行批量传输</p><h3 id=基本概念>基本概念</h3><p>**直接存储器访问（Direct Memory Address）**是为了在主存储器与 I/O 设备间高速交换批量数据而设置的。</p><ul><li><p>基本思想</p><p>通过硬件控制实现主存与 I/O 设备间的直接数据传送，在<strong>传送过程中</strong>无需 CPU 的干预。数据传送是在 <strong>DMA 控制器</strong>控制下进行的</p></li><li><p>优点</p><p>速度快，有利于发挥 CPU 的效率。</p></li></ul><h3 id=dma-传送方式>DMA 传送方式</h3><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506131519994.png alt=image-20210506131519994 style=zoom:67%><h4 id=停止-cpu-访问内存>停止 CPU 访问内存</h4><p>（在 DMA 访内过程中，CPU 不能同时访内）</p><p>主机响应 DMA 请求后，让出存储总线，直到一组数据传送完毕后，DMA 控制器才把总线控制权交还给 CPU</p><p>采用这种工作方式的 I/O 设备，在其接口中一般设置有小容量存储器</p><p>I/O 设备先与小容量存储器交换数据，然后由小容量存储器与主机交换数据</p><p>这样可减少 DMA 传送占用存储总线的时间，也即减少了 CPU 暂停工作的时间</p><ul><li><p>优点</p><p>控制简单，它适用于数据传输率很高的设备进行成组传送。</p></li><li><p>缺点</p><p>在 DMA 控制器访内阶段，内存的效能没有充分发挥，相当一部分内存工作周期是空闲的。这是因为，外围设备传送两个数据之间的间隔一般总是大于内存存储周期，即使高速 I/O 设备也是如此（故许多空闲的存储周期不能被 CPU 利用）</p></li></ul><h4 id=周期挪用方式>周期挪用方式</h4><p>也叫周期窃取方式，CPU 没有完全放弃对主存的访问</p><p>DMA 控制器与主存储器之间传送一个数据，占用（窃取）一个 CPU 周期，即 CPU 暂停工作一个周期，然后继续执行程序</p><p>一次 DMA 传输（挪用）没办法将整个数据块传输完</p><h4 id=dma-与-cpu-交替访内>DMA 与 CPU 交替访内</h4><p>又称透明的 DMA 传输方式</p><p>如果 CPU 的工作周期比内存存取周期长很多，可以采用该种方法</p><p>总线控制权的转移速度快，DMA 效率高。</p><h3 id=基本的-dma-原理>基本的 DMA 原理</h3><h4 id=dma-基本构成>DMA 基本构成</h4><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506132122468.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506132122468.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506132122468.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506132122468.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506132122468.png title=image-20210506132122468></p><ol><li><p><strong>内存地址计数器</strong></p><p>用于<strong>存放内存中要交换的数据的地址</strong></p><p>在 DMA 传送前，须通过程序将数据在内存中的起始位置(首地址)送到内存地址计数器。</p><p>而当 DMA 传送时，每交换一次数据，将地址计数器加“1”，从而以增量方式给出内存中要交换的一批数据的地址。</p></li><li><p><strong>字计数器</strong></p><p>用于<strong>记录传送数据块的长度</strong>(多少字数)。其内容也是在数据传送之前由程序预置，交换的字数通常以补码形式表示。</p><p>在 DMA 传送时，每传送一个字，字计数器就加“1” ，</p><p>当计数器溢出即最高位产生进位时，表示这批数据传送完毕，于是引起 DMA 控制器向 CPU 发中断信号</p></li><li><p><strong>数据缓冲寄存器</strong></p><p>用于<strong>暂存每次传送的数据</strong>(一个字)。</p><p>当输入时，由设备(如磁盘)送往数据缓冲寄存器，再由缓冲寄存器通过数据总线送到内存。</p><p>反之，输出时，由内存通过数据总线送到数据缓冲寄存器，然后再送到设备。</p></li><li><p><strong>“DMA 请求” 标志</strong></p><p>每当设备准备好一个数据字后给出一个控制信号，使 “DMA 请求” 标志置 “1”。</p><p>该标志置位后向“控制/状态”逻辑发出 DMA 请求，后者又向 CPU 发出总线使用权的请求(HOLD)，CPU 响应此请求后发回响应信号 HLDA，“控制/状态”逻辑接收此信号后发出 DMA 响应信号，使“DMA 请求”标志复位，为交换下一个字做好准备。</p></li><li><p><strong>“控制/状态” 逻辑</strong></p><p>由控制和时序电路以及状态标志等组成，用于修改内存地址计数器和字计数器，指定传送类型(输入或输出)，并对 “DMA 请求” 信号和 CPU 响应信号进行协调和同步。</p></li><li><p><strong>中断机构</strong></p><p>当字计数器溢出时 (全 0)，意味着一组数据交换完毕，由溢出信号触发中断机构，<strong>向 CPU 提出中断报告</strong></p><p>这里的中断与上一节介绍的 I/O 中断所采用的技术相同，但中断的目的不同，前面是为了数据的输入或输出，而这里是为了报告一组数据传送结束。因此它们是 I/O 系统中不同的中断事件</p></li></ol><h4 id=dma-数据传送过程>DMA 数据传送过程</h4><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/123.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/123.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/123.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/123.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/123.png title=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/123.png></p><p>当外设有 DMA 请求时，通常 CPU 在本机器周期结束后，响应 DMA 请求</p><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506134807469.png alt=image-20210506134807469 style=zoom:67%><h3 id=选择型和多路型-dma-控制器>选择型和多路型 DMA 控制器</h3><h4 id=选择型>选择型</h4><p>一段时间内只能为一个设备服务</p><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506134954053.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506134954053.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506134954053.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506134954053.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506134954053.png title=image-20210506134954053></p><h4 id=多路型>多路型</h4><p><img class=lazyload src=/Notes/svg/loading.min.svg data-src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506135017211.png data-srcset="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506135017211.png, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506135017211.png 1.5x, http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506135017211.png 2x" data-sizes=auto alt=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506135017211.png title=image-20210506135017211></p><p><strong>例</strong> 下图中假设有磁盘、磁带、打印机三个设备同时工作。磁盘以 30μs 的间隔向控制器发 DMA 请求，磁带以 45μs 的间隔发 DMA 请求，打印机以 150μs 间隔发 DMA 请求。根据传输速率，磁盘优先权最高，磁带次之，打印机最低，图中假设 DMA 控制器每完成一次 DMA 传送所需的时间是 5μs。若采用多路型 DMA 控制器，请画出 DMA 控制器服务三个设备的工作时间图。</p><img src=http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20210506140937308.png alt=image-20210506140937308 style=zoom:67%></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-04-24 13:06:13">更新于 2023-04-24</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/ data-title="计组 第八章" data-hashtags=计算机组成原理><i class="fa-brands fa-twitter fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/ data-hashtag=计算机组成原理><i class="fa-brands fa-facebook-square fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://trouvaille0198.github.io/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/8.-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/ data-title="计组 第八章"><i class="fa-brands fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw"></i>&nbsp;<a href=/Notes/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/>计算机组成原理</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/Notes/>主页</a></span></section></div><div class=post-nav><a href=/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/2.-%E8%BF%90%E7%AE%97%E6%96%B9%E6%B3%95%E5%92%8C%E8%BF%90%E7%AE%97%E5%99%A8/ class=prev rel=prev title="计组 第二章"><i class="fa-solid fa-angle-left fa-fw"></i>计组 第二章</a>
<a href=/Notes/posts/courses/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.-%E6%A6%82%E8%BF%B0/ class=next rel=next title="计算机网络 第一章">计算机网络 第一章<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">酒困路长惟欲睡，日高人渴漫思茶</div><div class="footer-line copyright"><i class="fa-regular fa-copyright fa-fw"></i>
<span itemprop=copyrightYear>2022 - 2023</span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fa-solid fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fa-solid fa-comment fa-fw"></i></a></div><div id=mask></div></div><link rel=stylesheet href=/Notes/lib/katex/katex.min.css><link rel=stylesheet href=/Notes/lib/katex/copy-tex.min.css><link rel=stylesheet href=/Notes/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/Notes/lib/autocomplete/autocomplete.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.stemmer.support.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.zh.min.js defer></script><script type=text/javascript src=/Notes/lib/lazysizes/lazysizes.min.js async defer></script><script type=text/javascript src=/Notes/lib/sharer/sharer.min.js async defer></script><script type=text/javascript src=/Notes/lib/katex/katex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/Notes/lib/cookieconsent/cookieconsent.min.js defer></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:45},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/Notes/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/Notes/lib/lunr/lunr.segmentit.js",maxResultLength:30,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/Notes/js/theme.min.js defer></script><script type=text/javascript src=/Notes/js/_custom.min.js defer></script></body></html>