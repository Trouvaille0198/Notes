<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>数据库原理（1） - 伤心肠粉的酱油碟子</title><meta name=author content><meta name=author-link content><meta name=description content="数据库原理一 第一章 数据库发展史 数据管理技术发展三个阶段 人工管理阶段 磁带、卡片、纸"><meta name=keywords content="数据库"><meta itemprop=name content="数据库原理（1）"><meta itemprop=description content="数据库原理一 第一章 数据库发展史 数据管理技术发展三个阶段 人工管理阶段 磁带、卡片、纸"><meta itemprop=datePublished content="2022-02-22T00:00:00+00:00"><meta itemprop=dateModified content="2022-11-23T14:00:55+00:00"><meta itemprop=wordCount content="10242"><meta itemprop=image content="https://trouvaille0198.github.io/logo.png"><meta itemprop=keywords content="数据库,"><meta property="og:title" content="数据库原理（1）"><meta property="og:description" content="数据库原理一 第一章 数据库发展史 数据管理技术发展三个阶段 人工管理阶段 磁带、卡片、纸"><meta property="og:type" content="article"><meta property="og:url" content="https://trouvaille0198.github.io/Notes/posts/courses/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80/"><meta property="og:image" content="https://trouvaille0198.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-22T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-23T14:00:55+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://trouvaille0198.github.io/logo.png"><meta name=twitter:title content="数据库原理（1）"><meta name=twitter:description content="数据库原理一 第一章 数据库发展史 数据管理技术发展三个阶段 人工管理阶段 磁带、卡片、纸"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#252627"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://trouvaille0198.github.io/Notes/posts/courses/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80/><link rel=prev href=https://trouvaille0198.github.io/Notes/posts/%E5%88%B7%E9%A2%98/back-tracking/%E5%89%91%E6%8C%87-offer-34.-%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%AD%E5%92%8C%E4%B8%BA%E6%9F%90%E4%B8%80%E5%80%BC%E7%9A%84%E8%B7%AF%E5%BE%84/><link rel=next href=https://trouvaille0198.github.io/Notes/posts/%E5%88%B7%E9%A2%98/array/%E5%89%91%E6%8C%87-offer-53-i.-%E5%9C%A8%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E6%9F%A5%E6%89%BE%E6%95%B0%E5%AD%97-i/><link rel=stylesheet href=/Notes/lib/normalize/normalize.min.css><link rel=stylesheet href=/Notes/css/style.min.css><link rel=stylesheet href=/Notes/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/Notes/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"数据库原理（1）","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/courses\/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86\/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80\/"},"genre":"posts","keywords":"数据库","wordcount":10242,"url":"https:\/\/trouvaille0198.github.io\/Notes\/posts\/courses\/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86\/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80\/","datePublished":"2022-02-22T00:00:00+00:00","dateModified":"2022-11-23T14:00:55+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"MelonCholi"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/Notes/ title=伤心肠粉的酱油碟子><span class=header-title-text>伤心肠粉</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/Notes/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/Notes/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/Notes/posts/>文章</a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>数据库原理（1）</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle"></i>
MelonCholi</span></span>
<span class=post-category>收录于 <a href=/Notes/categories/%E4%B8%93%E4%B8%9A%E8%AF%BE/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;专业课</a></span></div><div class=post-meta-line><span title="2022-02-22 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-02-22>2022-02-22</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 10242 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 21 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#第一章-数据库发展史>第一章 数据库发展史</a><ul><li><a href=#数据管理技术发展三个阶段>数据管理技术发展三个阶段</a><ul><li><a href=#人工管理阶段>人工管理阶段</a></li><li><a href=#文件系统阶段>文件系统阶段</a><ul><li><a href=#文件系统三个缺点><strong>文件系统三个缺点</strong></a></li></ul></li><li><a href=#倒排文件系统阶段>倒排文件系统阶段</a></li></ul></li><li><a href=#数据库技术的产生和发展>数据库技术的产生和发展</a><ul><li><a href=#数据库技术的三个阶段>数据库技术的<strong>三个阶段</strong></a></li><li><a href=#数据库阶段的特点-><strong>数据库阶段的特点</strong> ✔️</a></li><li><a href=#数据库术语><strong>数据库术语</strong></a></li><li><a href=#数据库技术的发展>数据库技术的发展</a></li></ul></li></ul></li><li><a href=#第二章-数据库系统结构>第二章 数据库系统结构</a><ul><li><a href=#数据描述>数据描述</a><ul><li><a href=#信息的三个领域><strong>信息的三个领域</strong></a></li><li><a href=#概念设计中的数据描述><strong>概念设计中的数据描述</strong></a></li><li><a href=#逻辑设计中的数据描述><strong>逻辑设计中的数据描述</strong></a></li><li><a href=#数据联系的描述>数据联系的描述</a></li><li><a href=#存储介质的层次>存储介质的层次</a></li></ul></li><li><a href=#数据模型>数据模型</a><ul><li><a href=#概念数据模型实体联系模型>概念数据模型——实体联系模型</a></li><li><a href=#逻辑数据模型面向数据库逻辑结构的模型><strong>逻辑数据模型</strong>——面向数据库逻辑结构的模型</a><ul><li><a href=#层次模型><strong>层次模型</strong></a></li><li><a href=#网状模型><strong>网状模型</strong></a></li><li><a href=#关系模型><strong>关系模型</strong></a></li><li><a href=#面向对象模型>面向对象模型</a></li></ul></li></ul></li><li><a href=#数据库的体系结构>数据库的体系结构</a><ul><li><a href=#三级模式结构><strong>三级模式结构</strong></a><ul><li><a href=#外模式><strong>外模式</strong></a></li><li><a href=#概念模式><strong>（概念）模式</strong></a></li><li><a href=#内模式><strong>内模式</strong></a></li></ul></li><li><a href=#两级映像>两级映像</a></li><li><a href=#两级数据的独立性>两级数据的独立性</a></li></ul></li><li><a href=#数据库管理系统-dbms>数据库管理系统 DBMS</a><ul><li><a href=#工作模式>工作模式</a></li><li><a href=#主要功能>主要功能</a></li><li><a href=#模块组成>模块组成</a></li></ul></li><li><a href=#数据库系统-dbs>数据库系统 DBS</a><ul><li><a href=#组成>组成</a></li><li><a href=#分类>分类</a></li></ul></li></ul></li><li><a href=#第三章-关系运算>第三章 关系运算</a><ul><li><a href=#关系数据模型>关系（数据）模型</a><ul><li><a href=#定义>定义</a><ul><li><a href=#定义-1>定义</a></li><li><a href=#形式定义>形式定义</a></li><li><a href=#关系模型特征>关系模型特征</a></li><li><a href=#关系的性质->关系的性质 ✔️</a></li></ul></li><li><a href=#关键码>关键码</a><ul><li><a href=#超键>超键</a></li><li><a href=#候选键>候选键</a></li><li><a href=#主键>主键</a></li><li><a href=#外键>外键</a></li></ul></li><li><a href=#关系模式的三级体系结构>关系模式的三级体系结构</a></li><li><a href=#关系模型的完整性规则->关系模型的完整性规则 ✔️</a></li><li><a href=#关系模型的形式定义>关系模型的形式定义</a></li></ul></li><li><a href=#关系代数->关系代数 ⭐</a><ul><li><a href=#关系代数的基本运算>关系代数的基本运算</a><ul><li><a href=#并-bigcup>并 $\bigcup$</a></li><li><a href=#差-->差 $-$</a></li><li><a href=#笛卡尔积-times>笛卡尔积 $\times$</a></li><li><a href=#投影-pi>投影 $\pi$</a></li><li><a href=#选择-sigma>选择 $\sigma$</a></li></ul></li><li><a href=#关系代数的组合运算>关系代数的组合运算</a><ul><li><a href=#交>交</a></li><li><a href=#联接-triangleright-triangleleft>联接 $\triangleright \triangleleft$</a><ul><li><a href=#theta-联接>$\theta$ 联接</a></li><li><a href=#f-联接>$F$ 联接</a></li><li><a href=#自然联接>自然联接</a></li></ul></li><li><a href=#除-div>除 $\div$</a></li></ul></li><li><a href=#扩充的关系代数操作>扩充的关系代数操作</a></li><li><a href=#常用技巧>常用技巧</a></li><li><a href=#例子>例子</a></li></ul></li><li><a href=#关系演算>关系演算</a><ul><li><a href=#元组关系演算><strong>元组</strong>关系演算</a></li><li><a href=#域关系演算><strong>域</strong>关系演算</a></li><li><a href=#关系运算的安全性>关系运算的安全性</a></li><li><a href=#关系运算的等价性>关系运算的等价性</a></li><li><a href=#例子-1>例子</a><ul><li><a href=#元组关系演算-1>元组关系演算</a></li><li><a href=#域关系演算-1>域关系演算</a></li></ul></li></ul></li><li><a href=#查询优化>查询优化</a><ul><li><a href=#等价变换规则>等价变换规则</a></li><li><a href=#优化的一般策略>优化的一般策略</a></li><li><a href=#优化算法->优化算法 ⭐</a><ul><li><a href=#例>例</a></li></ul></li></ul></li></ul></li><li><a href=#第四章-结构化查询语言>第四章 结构化查询语言</a><ul><li><a href=#sql-概述>SQL 概述</a><ul><li><a href=#sql-体系结构>SQL 体系结构</a><ul><li><a href=#三级体系结构对应关系>三级体系结构对应关系</a></li><li><a href=#sql-体系结构的特征>SQL 体系结构的特征</a></li></ul></li><li><a href=#sql-的组成>SQL 的组成</a></li></ul></li><li><a href=#sql-数据定义>SQL 数据定义</a><ul><li><a href=#sql-模式的操作>SQL 模式的操作</a><ul><li><a href=#创建-create-schema>创建 <code>CREATE SCHEMA</code></a></li><li><a href=#撤销-drop-schema>撤销 <code>DROP SCHEMA</code></a></li></ul></li><li><a href=#基本数据类型>基本数据类型</a></li><li><a href=#基本表的操作>基本表的操作</a><ul><li><a href=#基本表创建--create-table>基本表创建 ⭐ <code>CREATE TABLE</code></a></li><li><a href=#基本表修改-alter-table>基本表修改 <code>ALTER TABLE</code></a></li><li><a href=#基本表删除-drop-table>基本表删除 <code>DROP TABLE</code></a></li></ul></li><li><a href=#视图的操作>视图的操作</a><ul><li><a href=#视图创建-create-view>视图创建 <code>CREATE VIEW</code></a></li><li><a href=#视图撤销--drop-view>视图撤销 <code>DROP VIEW</code></a></li><li><a href=#视图查询>视图查询</a></li><li><a href=#视图更新>视图更新</a></li></ul></li><li><a href=#索引的操作>索引的操作</a><ul><li><a href=#索引创建-create-index>索引创建 <code>CREATE INDEX</code></a></li><li><a href=#索引撤销-drop-index>索引撤销 <code>DROP INDEX</code></a></li></ul></li></ul></li><li><a href=#sql-数据查询->SQL 数据查询 ⭐</a><ul><li><a href=#sql-查询语句>SQL 查询语句</a><ul><li><a href=#格式>格式</a></li><li><a href=#执行过程>执行过程</a></li><li><a href=#where-运算符><code>WHERE</code> 运算符</a></li><li><a href=#select-语句的语义>SELECT 语句的语义</a></li></ul></li><li><a href=#多表查询与联接操作>多表查询与联接操作</a><ul><li><a href=#联接查询>联接查询</a></li><li><a href=#多表查询>多表查询</a></li><li><a href=#嵌套操作><strong>嵌套操作</strong></a></li></ul></li><li><a href=#anyall-谓词>ANY、ALL 谓词</a></li><li><a href=#exists-存在谓词>EXISTS 存在谓词</a><ul><li><a href=#用-existsnot-exists-实现全称量词>用 EXISTS/NOT EXISTS 实现全称量词</a></li><li><a href=#用-existsnot-exists-实现逻辑蕴函>用 EXISTS/NOT EXISTS 实现逻辑蕴函</a></li></ul></li><li><a href=#聚合函数>聚合函数</a></li><li><a href=#数据分组>数据分组</a></li><li><a href=#集合操作>集合操作</a></li><li><a href=#例-1>例</a></li></ul></li><li><a href=#sql-数据更新->SQL 数据更新 ⭐</a><ul><li><a href=#数据插入-insert>数据插入 <code>INSERT</code></a></li><li><a href=#数据删除-delete>数据删除 <code>DELETE</code></a></li><li><a href=#数据修改-update>数据修改 <code>UPDATE</code></a></li></ul></li><li><a href=#嵌入式-sql>嵌入式 SQL</a><ul><li><a href=#使用规定>使用规定</a></li></ul></li></ul></li><li><a href=#第六章-实体联系模型>第六章 实体联系模型</a><ul><li><a href=#er-模型的基本元素>ER 模型的基本元素</a></li><li><a href=#属性的分类>属性的分类</a><ul><li><a href=#基本属性和复合属性>基本属性和复合属性</a></li><li><a href=#单值属性和多值属性>单值属性和多值属性</a><ul><li><a href=#多值属性的变换方法>多值属性的变换方法</a></li></ul></li><li><a href=#导出属性>导出属性</a></li><li><a href=#空值>空值</a></li></ul></li><li><a href=#联系的设计>联系的设计</a><ul><li><a href=#联系的元数>联系的元数</a></li><li><a href=#联系的联通词>联系的联通词</a></li><li><a href=#联系的基数>联系的基数</a></li></ul></li><li><a href=#er-模型的扩充>ER 模型的扩充</a><ul><li><a href=#依赖联系>依赖联系</a></li><li><a href=#弱实体>弱实体</a></li><li><a href=#子类超类>子类、超类</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=数据库原理一>数据库原理一</h1><h2 id=第一章-数据库发展史>第一章 数据库发展史</h2><h3 id=数据管理技术发展三个阶段>数据管理技术发展三个阶段</h3><h4 id=人工管理阶段>人工管理阶段</h4><p>磁带、卡片、纸带</p><ul><li>数据<strong>不保存在计算机</strong>内</li><li>没有专用软件管理数据（逻辑结构 = 物理结构，数据和程序不具有独立性）</li><li>只有程序的概念，没有文件的概念</li><li>数据<strong>面向程序</strong></li></ul><h4 id=文件系统阶段>文件系统阶段</h4><ul><li>数据以文件形式保存</li><li>操作系统接管读写细节</li><li>优点：<ul><li>数据以文件形式存在<strong>磁盘</strong>上</li><li>逻辑结构和物理结构有简单区别，程序和数据间有设备独立性（程序只和文件打交道）</li><li>文件组织多样化（索引、链接、直接存取文件）</li><li>数据<strong>面向应用</strong>（可以重复使用）</li><li>对数据操作<strong>以记录为单位</strong></li></ul></li></ul><h5 id=文件系统三个缺点><strong>文件系统三个缺点</strong></h5><ul><li><strong>数据冗余</strong>：同样数据在多个文件中重复</li><li><strong>不一致性</strong>：更新操作导致重复数据不统一（由数据冗余造成）</li><li><strong>数据联系弱</strong>：文件相互独立，缺乏联系</li></ul><h4 id=倒排文件系统阶段>倒排文件系统阶段</h4><ul><li>推广索引文件，为每个字段提供单独索引</li><li>优点：允许用户按字段的任何组合检索记录</li><li>缺点：占用很多存储空间，数据更新复杂</li></ul><h3 id=数据库技术的产生和发展>数据库技术的产生和发展</h3><h4 id=数据库技术的三个阶段>数据库技术的<strong>三个阶段</strong></h4><blockquote><p>三件大事</p></blockquote><ul><li><p><strong>IMS 系统</strong>：<strong>层次模型</strong></p><ul><li><strong>树形结构</strong></li><li>表示<strong>一对多</strong>关系</li><li><strong>表达多对多</strong>关系需要<strong>冗余节点</strong></li><li>通过<strong>指针导航</strong></li><li>查询速度快，但需要程序员掌握数据结构</li></ul></li><li><p><strong>DBTG 报告</strong>：<strong>网状模型</strong></p><ul><li><strong>图形</strong>结构</li><li>表示<strong>多对多</strong>关系</li><li>通过<strong>指针导航</strong></li><li>查询速度快，但需要程序员掌握数据结构</li></ul></li><li><p><strong>E.F.Codd 文章</strong>：</p></li><li><p><strong>关系模型</strong> -> 第三章</p></li></ul><h4 id=数据库阶段的特点-><strong>数据库阶段的特点</strong> ✔️</h4><ul><li><p>采用<strong>数据模型</strong>表示复杂的数据结构</p><ul><li>存储数据和数据间的关系</li><li>面向全组织的复杂的数据结构，实现了数据的结构化</li></ul></li><li><p>有较高的<strong>数据独立性</strong></p><ul><li>用户只操作逻辑结构，物理结构对用户透明</li></ul></li><li><p>提供方便的<strong>用户接口</strong></p><ul><li>终端 / 程序方式</li></ul></li><li><p>提供<strong>数据控制</strong>功能</p><ul><li>并发控制、恢复、完整性、安全性</li></ul></li><li><p>增加<strong>系统灵活性</strong></p><ul><li>可以以<strong>数据项</strong>而非记录为单位</li></ul></li></ul><h4 id=数据库术语><strong>数据库术语</strong></h4><ul><li><strong>数据库 DB</strong>：长期存储在计算机内，有组织的、统一管理的相关数据的组合。<ul><li>用户共享、冗余度小、数据联系紧密、独立性强</li></ul></li><li><strong>数据库管理系统 DBMS</strong>：介于 OS 和用户之间，为用户提供数据管理的软件。<ul><li>层次型、网状型、关系型、面向对象型</li><li><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423101846139.png alt=image-20220423101846139 style=zoom:50%></li></ul></li><li><strong>数据库技术</strong>：研究数据库结构、存储、设计、管理、使用的一门学科</li><li><strong>数据库系统 DBS</strong>：采用数据库技术的计算机系统</li></ul><h4 id=数据库技术的发展>数据库技术的发展</h4><ul><li><p>分布式数据库技术</p></li><li><p>面向对象数据库技术</p></li></ul><p><em>集中式 DB、C/S 架构、B/S 架构</em></p><h2 id=第二章-数据库系统结构>第二章 数据库系统结构</h2><h3 id=数据描述>数据描述</h3><p>从事物的特性到计算机中的具体表示，分别经历了三个阶段</p><ul><li>概念设计中的数据描述（实体、属性、实体集、实体标识符）</li><li>逻辑设计中的数据描述（记录、字段、文件、关键码）</li><li>物理设计中的数据描述（位、字节、字、块、桶、卷）</li></ul><h4 id=信息的三个领域><strong>信息的三个领域</strong></h4><p>从客观世界事物的特征到计算机中的表示经历了三个领域</p><ul><li><p><strong>现实世界</strong></p><ul><li>需求分析</li></ul></li><li><p><strong>信息世界</strong></p><ul><li>用概念设计描述数据库的概念结构</li></ul></li><li><p><strong>机器世界</strong></p><ul><li>在计算机中展示出来</li></ul></li></ul><h4 id=概念设计中的数据描述><strong>概念设计中的数据描述</strong></h4><blockquote><p>代表 E-R 模型</p></blockquote><ul><li>实体：客观存在，一个具体或抽象的对象</li><li>实体集：性质相同实体的集合</li><li>属性：实体的一个特性</li><li>实体标识符：唯一标识实体的属性或属性集</li></ul><h4 id=逻辑设计中的数据描述><strong>逻辑设计中的数据描述</strong></h4><blockquote><p>代表关系模型等</p></blockquote><ul><li>字段（数据项）：标记实体属性的命名单位 → 属性</li><li>记录：字段的有序集合 → 实体</li><li>文件：同一类记录的集合 → 实体集</li><li>关键码（键）：唯一确定文件中每个记录的字段或字段集 → 实体标识符</li></ul><h4 id=数据联系的描述>数据联系的描述</h4><ul><li><p><strong>联系</strong>：实体间的相互关系。</p></li><li><p><strong>联系的元数</strong>：与一个联系有关的实体集个数</p><ul><li>一元、二元、多元</li><li>二元联系：两个不同实体集实体之间的联系</li></ul></li><li><p><strong>联系的类型</strong>：一对一联系（1:1）、一对多联系（1:n）、多对多联系（m:n）</p></li></ul><h4 id=存储介质的层次>存储介质的层次</h4><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220425123814998.png alt=image-20220425123814998 style=zoom:67%><h3 id=数据模型>数据模型</h3><p><strong>定义</strong></p><ul><li>表示<strong>实体类型</strong>和<strong>实体间联系</strong>的模型</li></ul><p><strong>分类</strong></p><ul><li><strong>概念模型</strong>（实体联系模型）</li><li><strong>逻辑模型</strong>（结构数据模型）</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423130807734.png alt=image-20220423130807734 style=zoom:67%><h4 id=概念数据模型实体联系模型>概念数据模型——实体联系模型</h4><blockquote><p>ER 模型</p></blockquote><p><strong>独立于计算机系统</strong>的模型，用于建立信息世界的数据模型，语义表达能力丰富</p><ul><li><p>构成</p><ul><li><p>矩形表示实体类型</p></li><li><p>菱形表示实体间联系</p></li><li><p>椭圆形表示实体或联系的属性</p></li></ul></li><li><p>优点</p><ul><li>简单、容易理解，真实反映用户需求</li><li>与计算机无关，用户容易接受</li></ul></li><li><p>缺点</p><ul><li>只能说明实体间的语义联系，不能说明数据结构</li></ul></li></ul><h4 id=逻辑数据模型面向数据库逻辑结构的模型><strong>逻辑数据模型</strong>——面向数据库逻辑结构的模型</h4><p>从计算机的观点对数据建模，用于建立机器世界的数据模型</p><ul><li><p><strong>包含</strong></p><ul><li><p><strong>数据结构</strong>：对实体类型和实体间联系的表达和实现</p></li><li><p><strong>数据操作</strong>：对数据库的检索和更新（包括插入、删除、
修改）两类操作的实现</p></li><li><p><strong>完整性约束</strong>：数据及其联系应具有的制约和依赖规则</p></li></ul></li></ul><h5 id=层次模型><strong>层次模型</strong></h5><ul><li><p>用<strong>树型结构</strong>表示实体类型及实体之间联系的模型</p></li><li><p>使用有根树型结构、记录间联系通过<strong>指针</strong>、只能表示 1:n 联系</p></li><li><p><strong>优点</strong></p><ul><li>记录之间通过指针实现，查询效率高</li><li>逻辑和数据转换由 DBMS 完成</li></ul></li><li><p><strong>缺点</strong></p><ul><li>只能表示 1:n 联系，m:n 联系表示复杂<ul><li>层次顺序的严格和复杂引起查询更新很复杂，程序编写困难</li></ul></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20211130201305384.png alt=image-20211130201305384 style=zoom:33%></li></ul><h5 id=网状模型><strong>网状模型</strong></h5><ul><li><p>用<strong>有向图</strong>结构表示实体类型及实体间联系的模型</p></li><li><p>使用有向图结构、记录间联系通过<strong>指针</strong>、能表示 m:n 联系</p></li><li><p>特点</p><ul><li><p>允许有一个以上的结点无双亲</p></li><li><p>结点可以有多于一个的双亲</p></li><li><p>结点间可有两种或多种联系</p></li></ul></li><li><p><strong>优点</strong></p><ul><li>容易实现 m:n 联系，查询效率高。</li></ul></li><li><p><strong>缺点</strong></p><ul><li>程序员必须熟悉数据库的逻辑结构才能编写相应的应用程序</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20211130201536914.png alt=image-20211130201536914 style=zoom:33%></li></ul><h5 id=关系模型><strong>关系模型</strong></h5><ul><li><p>用<strong>二维表格</strong>结构来表示实体集，用<strong>外键</strong>表示实体间联系的模型</p><ul><li>关系模型是由若干个关系模式组成的集合，关系模式相当于记录类型，它的每一个实例称为关系。<strong>每个关系实际上就是一张二维表格。</strong></li><li>关系模型和层次、网络模型的最大差别是用关键码而不是用指针导航数据，表格简单，用户易懂，编写程序是并不涉及存储结构、访问技术等问题。</li></ul></li><li><p>特征</p><ul><li>每列不可分</li><li>没有两行完全相同</li><li>没有行序</li><li>没有列序</li></ul></li><li><p>关系模式三要素：数据结构、数据操作、完整性约束</p><ul><li>完整性约束：<strong>实体完整性</strong>、<strong>参照完整性</strong>、<strong>用户自定义完整性</strong></li></ul></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20211130202008707.png alt=image-20211130202008707 style=zoom:33%><h5 id=面向对象模型>面向对象模型</h5><ul><li><p>面向对象模型较完整地描述了现实世界的数据结构，能支持各类新的应用需求所满足的数据类型、能表达<strong>递归和嵌套</strong>的数据结构</p></li><li><p>基本概念：对象、类</p></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423131936207.png alt=image-20220423131936207 style=zoom:40%><h3 id=数据库的体系结构>数据库的体系结构</h3><blockquote><p>三级结构两级映像</p></blockquote><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20211130203738425.png alt=image-20211130203738425 style=zoom:33%><h4 id=三级模式结构><strong>三级模式结构</strong></h4><h5 id=外模式><strong>外模式</strong></h5><p>（可以有很多）用户与数据库系统的接口，外模式可以有很多</p><h5 id=概念模式><strong>（概念）模式</strong></h5><p>（只有一个）数据库中<strong>全部数据的整体逻辑结构描述</strong>，模式只有一个</p><h5 id=内模式><strong>内模式</strong></h5><p>数据库在<strong>物理存储</strong>方面的描述，最贴近物理结构</p><ul><li>记录的存储方式</li><li>索引的组织方式</li><li>文件的组织方式</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423132223561.png alt=image-20220423132223561 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423132337273.png alt=image-20220423132337273 style=zoom:67%><h4 id=两级映像>两级映像</h4><p>两级映像的作用：<strong>确保数据独立性</strong></p><ul><li>外模式 / 模式映像：体现<strong>逻辑</strong>数据独立性</li><li>模式 / 内模式映像：体现<strong>物理</strong>数据独立性</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20211130203620873.png alt=image-20211130203620873 style=zoom:33%><h4 id=两级数据的独立性>两级数据的独立性</h4><p>数据独立性（DataIndependence）是指应用程序和数据库的数据结构之间相互独立，不受影响。</p><ul><li>物理数据独立性：修改内模式不影响模式</li><li>逻辑数据独立性：修改模式不影响外模式</li></ul><blockquote><p><em>DML</em>：数据操纵语言（用户使用）</p><p><em>DDL</em>：<em>外模式、模式、内模式中数据定义语言</em></p></blockquote><h3 id=数据库管理系统-dbms>数据库管理系统 DBMS</h3><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423132933171.png alt=image-20220423132933171 style=zoom:50%><p>DMBS 是 DBS 的核心，一切对 DB 的操作都通过 DBMS 进行</p><p>事物是 DBMS 的基本工作单位，是由用户定义的一个操作序列，这些操作要么全做要么全不做，是不可分割的</p><h4 id=工作模式>工作模式</h4><ul><li>接受用户请求并处理</li><li>将用户的数据请求（高级指令）转换成机器代码（低层指令）</li><li>实现对数据库的操作</li><li>接受查询结果</li><li>对查询结果进行格式转换</li><li>返回用户</li></ul><h4 id=主要功能>主要功能</h4><ul><li><strong>数据库的定义功能</strong><ul><li>DBMS 提供 DDL 定义数据库的三级结构、两级映像，定义数据的完整性约束、保密限制等约束。</li><li>因此，在 DBMS 中应包括 DDL 的编译程序。</li></ul></li><li><strong>数据库的操纵功能</strong><ul><li>检索（查询）和更新（插入、删除、更新）</li></ul></li><li><strong>数据库的保护功能</strong><ul><li>数据库的恢复</li><li>数据库的并发控制</li><li>数据完整性控制</li><li>数据安全性控制</li><li>其他<ul><li>系统缓冲区的管理</li><li>数据存储的某些自适应调节机制</li></ul></li></ul></li><li><strong>数据库的维护功能</strong><ul><li>包括数据库的数据载入、转换、转储，数据库的改组以及性能监控等功能。</li></ul></li><li><strong>数据字典</strong><ul><li>数据库系统中存放三级结构定义的数据库称为数据字典 (DataDictionary, DD)。</li><li>对数据库的操作都要通过 DD 才能实现。</li><li>DD 中还存放数据库运行时的统计信息，例如记录个数、访问次数等。</li><li>管理 DD 的子系统称为 “DD 系统”。</li></ul></li></ul><h4 id=模块组成>模块组成</h4><ul><li><strong>查询处理器</strong>：DML 编译器、DDL 编译器、嵌入式 DML 预编译器、查询运行核心程序</li><li><strong>存储处理器</strong>：权限和完整性管理器、事务管理器、文件管理器、缓冲区管理器</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423134253173.png alt=image-20220423134253173 style=zoom:67%><h3 id=数据库系统-dbs>数据库系统 DBS</h3><h4 id=组成>组成</h4><ul><li><strong>数据库 DB</strong></li><li><strong>硬件</strong></li><li><strong>软件</strong></li><li><strong>数据库管理员 DBA</strong><ul><li>DBA 是控制数据整体结构的一组人员，负责 DBS 的正常运行，承担创建、监控和维护数据库结构的责任。</li><li>主要职责<ul><li>定义模式</li><li>定义内模式</li><li>与用户的联络。包括定义外模式、应用程序的设计、提供技术培训等专业服务。</li><li>定义安全性规则，对用户访问数据库的授权</li><li>定义完整性规则，监督数据库的运行</li><li>数据库的转储与恢复工作。</li></ul></li></ul></li></ul><h4 id=分类>分类</h4><ul><li>集中式 DBS、客户服务器式 DBS、并行式 DBS、分布式 DBS</li></ul><h2 id=第三章-关系运算>第三章 关系运算</h2><h3 id=关系数据模型>关系（数据）模型</h3><h4 id=定义>定义</h4><h5 id=定义-1>定义</h5><p>用<strong>二维表格</strong>表示实体集，用关键码（外键）表示实体间联系的数据模型</p><h5 id=形式定义>形式定义</h5><p>关系是域的笛卡尔积的子集，元组的集合</p><ul><li><p><strong>属性</strong>：表格中的列</p></li><li><p><strong>域</strong>：值的集合，即<strong>属性的取值范围</strong></p></li><li><p><strong>域的笛卡尔积</strong>：一组域的所有组合的集合</p></li><li><p><strong>元组</strong>：表格中的行，域的笛卡尔积的元素</p></li><li><p><strong>关系</strong>：二维表格</p><ul><li>集合论：关系是一个<strong>元数为 K 的元组的集合</strong>，表示一个实体集</li><li>值域：关系是属性值域<strong>笛卡儿积的一个子集</strong></li></ul></li></ul><h5 id=关系模型特征>关系模型特征</h5><ul><li>可以看做二维表格</li><li>表中的一行成为一个元组</li><li>列为属性</li><li>列的取值范围为域</li><li>任意两行不相同</li></ul><h5 id=关系的性质->关系的性质 ✔️</h5><ul><li>属性值是原子的，不可分解</li><li>没有重复的元组</li><li>没有行序</li><li>理论上没有列序（为方便设置列序）</li></ul><h4 id=关键码>关键码</h4><h5 id=超键>超键</h5><p>能唯一标识元组的属性组合（可能存在多余的属性）</p><h5 id=候选键>候选键</h5><p>能唯一标识元组的最小属性组合</p><h5 id=主键>主键</h5><p>人为选定的一个候选键</p><p>若一个关系中有多个侯选键，则选其中的一个为关系的主键。</p><h5 id=外键>外键</h5><p>若一个关系 R 中包含有另一个关系 S 的主键所对应的属性组 F， 则称 F 为 R 的外键。称关系 S 为参照关系，R 为依赖关系。</p><blockquote><p>主键使用下划线、外键使用下划波浪线</p></blockquote><h4 id=关系模式的三级体系结构>关系模式的三级体系结构</h4><ul><li><p><strong>关系子模式</strong> → 外模式</p><ul><li>从若干关系中抽出满足一定条件的数据</li></ul></li><li><p><strong>关系模式</strong> → 概念模式</p><ul><li>定义模式名、属性名、值域名、模式的主键</li></ul></li><li><p><strong>存储模式</strong> → 内模式</p><ul><li>描述了关系如何在物理设备上存储</li></ul></li></ul><h4 id=关系模型的完整性规则->关系模型的完整性规则 ✔️</h4><ul><li><strong>实体完整性</strong>：主键非空</li><li><strong>参照完整性</strong>：外键必须为空或为对应关系的某个主键值</li><li><strong>用户定义完整性</strong>：由应用环境决定数据需要符合的约束条件</li></ul><h4 id=关系模型的形式定义>关系模型的形式定义</h4><p>也就是关系模型的三个组成</p><p>关系模型由<strong>数据结构、数据操作、完整性规则</strong>组成</p><h3 id=关系代数->关系代数 ⭐</h3><blockquote><p>关系运算分为关系代数和关系演算</p></blockquote><p>数据操纵语言 DML</p><ul><li>查询语句</li><li>更新语句</li></ul><p>关系查询语言：<strong>非过程性</strong>语言</p><ul><li><strong>关系代数</strong>语言：查询操作以<strong>集合操作</strong>为基础</li><li><strong>关系演算</strong>语言：查询操作以<strong>谓词演算</strong>（一阶逻辑）为基础，非过程性更强一些</li></ul><h4 id=关系代数的基本运算>关系代数的基本运算</h4><blockquote><p>并 $\bigcup$ 、差 $-$ 、笛卡尔积 $\times$、投影 $\pi$ 、选择 $\sigma$</p></blockquote><h5 id=并-bigcup>并 $\bigcup$</h5><p>Union，列要一样，相当于 <code>or</code>
$$
R\bigcup S = { t|t \in R \vee t \in S }
$$</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423143604210.png alt=image-20220423143604210 style=zoom:67%><h5 id=差-->差 $-$</h5><p>Difference，列要一样，相当于 <code>not exists</code>
$$
R-S= { t|t \in R \wedge t \notin S }
$$
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423143619299.png alt=image-20220423143619299 style=zoom:67%></p><h5 id=笛卡尔积-times>笛卡尔积 $\times$</h5><p>Cartesian Product，相当于 <code>from A, B</code></p><p>设关系 R 和关系 S 的元数分别为 r 和 s。定义 R 和 S 的笛卡儿积 R×S 是一个 (r+s) 元的元组集合，每个元组的前 r 个分量（属性值）来自 R 的一个元组，后 s 个分量是 S 的一个元组，记为 R×S
$$
R \times S = { t|t=\langle t^r, t^s \rangle \wedge t^r \in R \wedge t^s\in S }
$$
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423144038793.png alt=image-20220423144038793 style=zoom:67%></p><h5 id=投影-pi>投影 $\pi$</h5><p>对一个关系进行<strong>垂直分割</strong>，消去某些列，并重新安排列的顺序，再删去重复元组。</p><p>Projection，筛选出指定属性并自动去重，相当于 <code>select distinct</code>
$$
{\pi_{i_1,\cdots ,i_m}} ( R )= { t|t= \langle t_{i_1},\cdots ,t_{i_m} \rangle \wedge \langle t_1,\cdots ,t_k \rangle \in R }
$$
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423144314538.png alt=image-20220423144314538 style=zoom:67%></p><h5 id=选择-sigma>选择 $\sigma$</h5><p>根据某些条件对关系做水平分割,选择符合条件的元组。</p><p>Select，根据条件筛选元组，形如 $\sigma _{\text{age=18}} ( S )$，相当于 <code>where</code>
$$
\sigma_f ( R )= { t|t\in R\wedge f ( t )=\text{true} }
$$
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423144448071.png alt=image-20220423144448071 style=zoom:67%></p><h4 id=关系代数的组合运算>关系代数的组合运算</h4><blockquote><p>交 $\bigcap$ 、联接 $\triangleright \triangleleft $ 、自然联接 $\triangleright \triangleleft $ 、除 $\div$</p></blockquote><h5 id=交>交</h5><p>Intersection，相当于 <code>and</code>
$$
R\bigcap S=R- ( R-S )=S- ( S-R )
$$
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423145051587.png alt=image-20220423145051587 style=zoom:67%></p><h5 id=联接-triangleright-triangleleft>联接 $\triangleright \triangleleft$</h5><p>Join，是笛卡儿积、选择和投影操作的组合</p><h6 id=theta-联接>$\theta$ 联接</h6><p>$$
R \ \underset{i\ \theta \ j}{\mathop \triangleright \triangleleft },S={\sigma }_{i\ \theta \ ( r+j )} ( R\times S )
$$</p><p>其中 i，j 为下标，i，j 列都保留（笛卡尔积后选择）</p><p>如果 $\theta$ 为 $=$，那么就是<strong>等值连接</strong></p><h6 id=f-联接>$F$ 联接</h6><p>$$
R \ \underset{F}{\mathop \triangleright \triangleleft },S
$$</p><p>这里 F 是形如 F1∧F2∧…∧Fn 公式，每个 $F_i$ 是形为 $i\theta j$ 的式子。</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423145732719.png alt=image-20220423145732719 style=zoom:67%><h6 id=自然联接>自然联接</h6><blockquote><p>特殊的等值连接</p></blockquote><p>将关系 R 和 S 中公共属性组满足对应分量相等的元组联接起来， 并且要在结果中将重复的属性去掉。</p><p>先笛卡尔积，再选择，再投影掉重复的列，相当于 <code>inner join</code>
$$
R\triangleright \triangleleft \ S=\pi ( \sigma ( R\times S ) )
$$</p><h5 id=除-div>除 $\div$</h5><p>R 中满足 S 中所有条件的元组的剩余信息 <code>not exists(not exists)</code>
$$
R\div S=\pi_{1,2,&mldr;,r-s} ( R )-\pi_{1,2,&mldr;,r-s} ( \pi_{1,2,&mldr;,r-s} ( R )\times S-R )
$$
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104183233065.png alt=image-20220104183233065 style=zoom:33%></p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104183607634.png alt=image-20220104183607634 style=zoom:25%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423151016080.png alt=image-20220423151016080 style=zoom:67%><h4 id=扩充的关系代数操作>扩充的关系代数操作</h4><ul><li><p><strong>外联接</strong>：（左、右、全）（级联左右带双横线 =）哪边有 = 哪边有表对面有空</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104190218847.png alt=image-20220104190218847 style=zoom:33%></li><li><p><strong>外部并</strong>：把两表并起来，并填上 null（普通并要求属性一致）</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104190327881.png alt=image-20220104190327881 style=zoom:33%></li><li><p><strong>半联接</strong>：⋉ 自然联接的投影左表属性 S⋉SC 为选了课的学生</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104190446215.png alt=image-20220104190446215 style=zoom:33%></li></ul><h4 id=常用技巧>常用技巧</h4><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220425130528237.png alt=image-20220425130528237 style=zoom:50%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220425130551430.png alt=image-20220425130551430 style=zoom:50%><h4 id=例子>例子</h4><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423153742354.png alt=image-20220423153742354 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423153732195.png alt=image-20220423153732195 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220423153753215.png alt=image-20220423153753215 style=zoom:67%><h3 id=关系演算>关系演算</h3><p><strong>关系代数和关系演算的区别</strong> ✔️ ：关系代数以<strong>集合操作</strong>为基础，关系演算以<strong>谓词演算</strong>为基础（谓词即离散数学中的一阶逻辑）</p><h4 id=元组关系演算><strong>元组</strong>关系演算</h4><p>${ t|P ( t ) }$ ，$t$ 代表一个元组（一行）</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104190757883.png alt=image-20220104190757883 style=zoom:40%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104190912939.png alt=image-20220104190912939 style=zoom:40%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104190938069.png alt=image-20220104190938069 style=zoom:40%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104191334025.png alt=image-20220104191334025 style=zoom:33%><h4 id=域关系演算><strong>域</strong>关系演算</h4><p>${ t_1\cdots t_k|P ( t_1\cdots t_k ) }$ ，$t_1\cdots t_k$ 代表一个元组</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111182258624.png alt=image-20220111182258624 style=zoom:40%><h4 id=关系运算的安全性>关系运算的安全性</h4><p>关系代数操作结果不应包括<strong>无限关系</strong>和<strong>无穷验证</strong></p><ul><li>无限关系：指元组个数为无穷多个的关系</li><li>无穷验证：验证公式真假时需要进行无限次验证</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111183244310.png alt=image-20220111183244310 style=zoom:37%><h4 id=关系运算的等价性>关系运算的等价性</h4><p><strong>关系代数</strong> = <strong>安全的元组关系演算</strong> = <strong>安全的域关系演算</strong></p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111183308649.png alt=image-20220111183308649 style=zoom:40%><h4 id=例子-1>例子</h4><h5 id=元组关系演算-1>元组关系演算</h5><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104191627976.png alt=image-20220104191627976 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220104191736773.png alt=image-20220104191736773 style=zoom:33%><h5 id=域关系演算-1>域关系演算</h5><h3 id=查询优化>查询优化</h3><p>关键：如何花费较少的时间和空间，有效地执行笛卡尔积操作</p><h4 id=等价变换规则>等价变换规则</h4><ul><li>投影串接： $\pi _{L_1} ( \pi _{L_2} ( E ) ) \equiv \pi _{L_1} ( E )$</li><li>选择串接：$\sigma _{F_1} ( \sigma _{F_2} ( E ) )\equiv\sigma _{F_1\wedge F_2} ( E )$</li><li>选择投影交换：$\pi _{L} ( \sigma _{F} ( E ) )\equiv\sigma _{F} ( \pi _{L} ( E ) )$；前提是后者依然可执行</li><li>选择对笛卡尔积分配： $\sigma _F ( E_1\times E_2 )\equiv\sigma _{F_1} ( E_1\times \sigma _{F_2} ( E_2 ) )$</li><li>选择对并分配： $\sigma _F ( E_1\bigcup E_2 )\equiv\sigma _F ( E_1 )\bigcup \sigma _F ( E_2 )$</li><li>选择对差分配： $\sigma _F ( E_1-E_2 )=\sigma _F ( E_1 )-\sigma _F ( E_2 )=\sigma _F ( E_1 )-E_2$</li><li>投影对笛卡尔积分配： $\pi _L ( E_1\times E_2 )=\pi _{L_1} ( E_1 )\times \pi _{L_2} ( E_2 )$</li><li>投影对并分配： $\pi _L ( E_1\bigcup E_2 )=\pi _L ( E_1 )\bigcup \pi _L ( E_2 )$</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111190543057.png alt=image-20220111190543057 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111190601671.png alt=image-20220111190601671 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424122349677.png alt=image-20220424122349677 style=zoom:50%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111190657139.png alt=image-20220111190657139 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111190711400.png alt=image-20220111190711400 style=zoom:33%><h4 id=优化的一般策略>优化的一般策略</h4><ul><li>尽早执行选择操作</li><li>笛卡尔积和其后的选择、投影<strong>合并运算</strong></li><li>同时计算一连串的选择和投影操作，以免分开运算造成多次扫描文件，节省操作时间。</li><li>预处理多次出现的<strong>子表达式</strong><ul><li>如在一个表达式中多次出现某个子表达式，可先对该子表达式进行计算并保存结果，以免重复计算</li></ul></li><li>适当对关系文件进行<strong>预处理</strong>，建立合理的索引方式</li><li>优化表达式的计算方法，如选择哪个作为外层循环</li></ul><h4 id=优化算法->优化算法 ⭐</h4><p>由 DBMS 中的 DML 编译器完成</p><ol><li>将自然联接转为笛卡尔积 + 选择 + 投影</li><li>逆用选择串接，将选择拆开</li><li>将每个选择和投影尽可能移向树叶</li><li>将相邻的投影和选择转化为 (0/1 个) 选择 + (0/1 个) 投影<ul><li>把选择和投影合并成单个选择、单个投影或一个选择后跟一个投影。</li></ul></li><li>按二元运算分组，保证每组只有一个二元运算<ul><li><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424123407911.png alt=image-20220424123407911 style=zoom:67%></li></ul></li></ol><h5 id=例>例</h5><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111191447894.png alt=image-20220111191447894 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111191458432.png alt=image-20220111191458432 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111191558503.png alt=image-20220111191558503 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111191617544.png alt=image-20220111191617544 style=zoom:33%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220111191631666.png alt=image-20220111191631666 style=zoom:33%><h2 id=第四章-结构化查询语言>第四章 结构化查询语言</h2><blockquote><p>Structured Query Language, SQL</p></blockquote><h3 id=sql-概述>SQL 概述</h3><p><strong>定义</strong>：结构化查询语言，一种介于关系代数和关系演算之间的语言。</p><h4 id=sql-体系结构>SQL 体系结构</h4><h5 id=三级体系结构对应关系>三级体系结构对应关系</h5><ul><li><strong>内模式</strong>：对应<strong>存储文件</strong></li><li><strong>模式</strong>：对应<strong>基本表</strong>（元组称为行、属性称为列）</li><li><strong>外模式</strong>：对应<strong>视图</strong></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220425142012667.png alt=image-20220425142012667 style=zoom:67%><h5 id=sql-体系结构的特征>SQL 体系结构的特征</h5><ul><li>一个 SQL 模式是表和约束的集合</li><li>表是行的集合</li><li>表可以是基本表，也可以是视图。视图只存放定义不存放数据</li><li>一张表可以存放在多个存储文件中，一份存储文件可以存放多张表</li><li>用户使用 SQL 语句对视图和表进行操作；表和视图对用户而言都是关系（即表格）</li><li>用户可以是程序也可以是终端</li></ul><h4 id=sql-的组成>SQL 的组成</h4><ul><li><strong>数据定义</strong>（SQL DDL）：定义 SQL 模式、基本表、视图和索引</li><li><strong>数据操纵</strong>（SQL DML）：数据查询（DQL）、数据更新（插入删除修改）</li><li><strong>数据控制</strong>（SQL DCL）：对基本表和视图的授权、完整性规则描述、事务控制语句</li><li><strong>嵌入式 SQL</strong>：嵌入 SQL 的规则</li></ul><h3 id=sql-数据定义>SQL 数据定义</h3><h4 id=sql-模式的操作>SQL 模式的操作</h4><p>SQL 模式的定义：基本表的集合</p><h5 id=创建-create-schema>创建 <code>CREATE SCHEMA</code></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=o>&lt;</span><span class=err>模式名</span><span class=o>&gt;</span><span class=w> </span><span class=n>AUTHORIZATION</span><span class=w> </span><span class=o>&lt;</span><span class=err>拥有者</span><span class=o>&gt;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=撤销-drop-schema>撤销 <code>DROP SCHEMA</code></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=o>&lt;</span><span class=err>模式名</span><span class=o>&gt;</span><span class=w> </span><span class=p>[</span><span class=n>CASECADE</span><span class=o>|</span><span class=k>RESTRICT</span><span class=p>];</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ul><li><code>CASECADE</code>（级联）连锁式</li><li><code>RESTRICT</code> 约束式：只有当模式中没有任何下属元素时允许撤销</li></ul><blockquote><p>一般不用模式 <code>SCHEMA</code>，而用数据库 <code>DATABASE</code></p></blockquote><h4 id=基本数据类型>基本数据类型</h4><ul><li><p>数值型</p><ul><li><code>INTEGER</code>：长整数</li><li><code>DOUBLE PRECISION</code>：双精度浮点数</li><li><code>FLOAT(n)</code>：浮点数，精度至少为 n 位数字;</li><li><code>NUMERIC(p,d)</code>：p.d 位定点小数，也可写成 <code>DECEMIAL(p,d)</code> 或 <code>DEC(p,d)</code></li></ul></li><li><p>字符串型</p><ul><li><code>CHAR(n)</code>：定长 n</li><li><code>VACHAR(n)</code>：最大长度 n</li></ul></li><li><p>位串型</p><ul><li><code>BIT(n)</code>：定长 n</li><li><code>BIT VARYING(n)</code>：最大长度 n</li></ul></li><li><p>时间型</p><ul><li><code>DATE(YYYY-MM-DD)</code></li><li><code>TIME(HH:MM:SS)</code></li><li>允许比较操作</li></ul></li></ul><h4 id=基本表的操作>基本表的操作</h4><h5 id=基本表创建--create-table>基本表创建 ⭐ <code>CREATE TABLE</code></h5><ul><li><p>列级约束 + 表级约束</p></li><li><p>三个子句：主键子句、外键子句、检查子句</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>SNO</span><span class=w> </span><span class=nb>CHAR</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>SNO</span><span class=p>,</span><span class=n>PNO</span><span class=p>),</span><span class=w>             </span><span class=c1>-- 主键子句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>JNO</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>J</span><span class=p>(</span><span class=n>JNO</span><span class=p>)</span><span class=w> </span><span class=c1>-- 外键子句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>QTY</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>10000</span><span class=p>)</span><span class=w>    </span><span class=c1>-- 检查子句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=基本表修改-alter-table>基本表修改 <code>ALTER TABLE</code></h5><blockquote><p>增删属性</p></blockquote><p>增加属性</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=err>属性名</span><span class=w> </span><span class=err>属性类型</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>例</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=n>TELE</span><span class=w> </span><span class=nb>CHAR</span><span class=p>(</span><span class=mi>12</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>删除属性</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=err>属性名</span><span class=w> </span><span class=p>[</span><span class=k>CASCADE</span><span class=p>(</span><span class=err>连锁</span><span class=p>)</span><span class=o>|</span><span class=k>RESTRICT</span><span class=p>(</span><span class=err>约束</span><span class=p>)]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=基本表删除-drop-table>基本表删除 <code>DROP TABLE</code></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=p>[</span><span class=k>CASCADE</span><span class=p>(</span><span class=err>连锁</span><span class=p>)</span><span class=o>|</span><span class=k>RESTRICT</span><span class=p>(</span><span class=err>约束</span><span class=p>)];</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=视图的操作>视图的操作</h4><h5 id=视图创建-create-view>视图创建 <code>CREATE VIEW</code></h5><p>在创建一个视图时，系统把视图的定义存放在数据字典中，而不存储视图对应的数据，在用户使用视图时才去求对应的数据。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=o>&lt;</span><span class=err>视图名</span><span class=o>&gt;</span><span class=p>(</span><span class=err>列名表</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AS</span><span class=w>  </span><span class=o>&lt;</span><span class=k>SELECT</span><span class=w>  </span><span class=err>查询语句</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>例</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>JSP_NAME</span><span class=p>(</span><span class=n>JNO</span><span class=p>,</span><span class=n>JNAME</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=p>(</span><span class=n>J</span><span class=p>.</span><span class=n>JNO</span><span class=p>,</span><span class=n>J</span><span class=p>.</span><span class=n>JNAME</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=p>,</span><span class=n>J</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=err>…</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=视图撤销--drop-view>视图撤销 <code>DROP VIEW</code></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>JSP_NAME</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=视图查询>视图查询</h5><p>系统会根据数据字典的定义将视图查询<strong>转换为对基本表的查询</strong></p><p>HAVING：组条件</p><p>WHERE：行条件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>S_GRADE</span><span class=p>(</span><span class=n>sno</span><span class=p>,</span><span class=w> </span><span class=n>c_num</span><span class=p>,</span><span class=w> </span><span class=n>avg_grade</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>sno</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cno</span><span class=p>),</span><span class=k>AVG</span><span class=p>(</span><span class=n>grade</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>sno</span><span class=p>,</span><span class=w> </span><span class=n>avg_grade</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>S_GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>c_num</span><span class=w> </span><span class=o>&gt;</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>c_num</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>S_GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>sno</span><span class=o>=</span><span class=err>’</span><span class=n>S4</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>会转变成：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>sno</span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>grade</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_grade</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cno</span><span class=p>)</span><span class=o>&gt;</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cno</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>sno</span><span class=o>=</span><span class=err>’</span><span class=n>S4</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=视图更新>视图更新</h5><p>只有<strong>行列子集视图</strong>可以进行更新</p><p><strong>行列子集视图</strong>：当视图是从单个基本表<strong>仅</strong>使用<strong>选择</strong>和<strong>投影</strong>导出，并包含了基本表的主键或某个<strong>候选键</strong>，则可以进行更新操作。</p><p>拒绝更新的视图：</p><ul><li>视图从多个基本表<strong>联接</strong>导出</li><li>视图有<strong>分组</strong>或<strong>聚合</strong>操作</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=cm>/* 以下更新会被拒绝：
</span></span></span><span class=line><span class=cl><span class=cm>** 因为视图包含分组聚合操作COUNT(cno), AVG(grade)
</span></span></span><span class=line><span class=cl><span class=cm>**/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UPDATE</span><span class=w> </span><span class=n>S_GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SET</span><span class=w> </span><span class=n>sno</span><span class=o>=</span><span class=err>’</span><span class=n>S3</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>sno</span><span class=o>=</span><span class=err>’</span><span class=n>S4</span><span class=err>’</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>在 SQL2 中,允许更新的视图在定义时，必须加上 <code>WITH CHECK OPTION</code> 短语。</p></blockquote><h4 id=索引的操作>索引的操作</h4><h5 id=索引创建-create-index>索引创建 <code>CREATE INDEX</code></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=p>[</span><span class=k>UNIQUE</span><span class=p>]</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=err>索引名</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=err>基本表名</span><span class=w> </span><span class=p>(</span><span class=o>&lt;</span><span class=err>列名</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;</span><span class=err>次序</span><span class=o>&gt;</span><span class=p>]...)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>例</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>SPJ_INDEX</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>SPJ</span><span class=p>(</span><span class=n>SNO</span><span class=w> </span><span class=k>ASC</span><span class=p>,</span><span class=w> </span><span class=n>PNO</span><span class=p>,</span><span class=w> </span><span class=k>ASC</span><span class=p>,</span><span class=w> </span><span class=n>JON</span><span class=w> </span><span class=k>DESC</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=索引撤销-drop-index>索引撤销 <code>DROP INDEX</code></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>JNO_INDEX</span><span class=p>,</span><span class=w> </span><span class=n>SPJ_INDEX</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=sql-数据查询->SQL 数据查询 ⭐</h3><h4 id=sql-查询语句>SQL 查询语句</h4><blockquote><p>select 投影、from 笛卡尔积、where 选择（条件）</p></blockquote><p>一些技巧</p><ul><li>在 SQL 中要表达涉及到 “<strong>全部</strong>“ 值的查询时，可以将问题转换为<strong>两次否定</strong>的语义表达形式（即：不存在……，……没有……＂），然后用两次 <code>NOT EXISTS</code> 的方式来实现。</li><li>先用 where 筛选，再 having，最后运行聚合函数</li></ul><h5 id=格式>格式</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=p>[</span><span class=k>DISTINCT</span><span class=p>]</span><span class=w> </span><span class=err>列名序列</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=err>表名</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>[</span><span class=k>WHERE</span><span class=w> </span><span class=err>行条件表达式</span><span class=p>]</span><span class=w>                       </span><span class=c1>-- 行条件子句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[</span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=err>列名序列</span><span class=w> </span><span class=p>[</span><span class=k>HAVING</span><span class=w> </span><span class=err>组条件表达式</span><span class=p>]]</span><span class=w>    </span><span class=c1>-- 分组子句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=err>列名</span><span class=w> </span><span class=p>[</span><span class=k>ASC</span><span class=o>|</span><span class=k>DESC</span><span class=p>]</span><span class=w> </span><span class=err>序列</span><span class=p>]</span><span class=w>            </span><span class=c1>-- 排序子句
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>WHERE 子句称为 “行条件子句”</p><p>GROUP 子句称为 “分组子句”</p><p>HAVING 子句称为 “组条件子句”</p><p>ORDER 子句称为 “排序子句”</p></blockquote><h5 id=执行过程>执行过程</h5><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424133029844.png alt=image-20220424133029844 style=zoom:67%><h5 id=where-运算符><code>WHERE</code> 运算符</h5><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424133407512.png alt=image-20220424133407512 style=zoom:67%><h5 id=select-语句的语义>SELECT 语句的语义</h5><ul><li>SELECT 语句中未使用分组子句，也未使用聚合操作<ul><li>那么 SELECT 子句的语义是对查询的结果执行投影操作</li></ul></li><li>SELECT 语句中未使用分组子句，但在 SELECT 子句中使用了聚合操作<ul><li>此时 SELECT 子句的语义是对查询结果执行聚合操作</li></ul></li><li>SELECT 语句使用了分组子句和聚合操作<ul><li>此时 SELECT 子句的语义是对查询结果的每一分组去做聚合操作</li></ul></li></ul><h4 id=多表查询与联接操作>多表查询与联接操作</h4><p><code>INNER JOIN</code>：内联接 → 匹配行</p><p><code>LEFT JOIN</code>：左外联接 → 匹配行 + 左表；保证左边所有行都存在</p><p><code>RIGHT JOIN</code>：右外联接 → 匹配行 + 右表</p><p><code>FULL JOIN</code>：完全外联接 → 匹配行+左表+右表；左右不匹配的行也保留</p><p><code>CROSS JOIN</code>：交叉联接 → 笛卡尔积</p><p>以下五者等价：查询选修 2 号课程的学生姓名</p><h5 id=联接查询>联接查询</h5><p>from 表 1 联接类型 表 2 on 联接条件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>SNAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>S</span><span class=p>.</span><span class=n>SNO</span><span class=o>=</span><span class=n>SC</span><span class=p>.</span><span class=n>SNO</span><span class=w>   </span><span class=c1>-- 注意 ON
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>WHERE</span><span class=w> </span><span class=n>CNO</span><span class=o>=</span><span class=err>’</span><span class=mi>2</span><span class=err>’</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=多表查询>多表查询</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>SNAME</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=p>,</span><span class=n>SC</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>S</span><span class=p>.</span><span class=n>SNO</span><span class=o>=</span><span class=n>SC</span><span class=p>.</span><span class=n>SNO</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>CNO</span><span class=o>=</span><span class=err>’</span><span class=mi>2</span><span class=err>’</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=嵌套操作><strong>嵌套操作</strong></h5><ul><li><p><strong>不相关子查询</strong>：子查询条件不依赖父查询，效率最高</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>SNAME</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SNO</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>SNO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>CNO</span><span class=o>=</span><span class=err>’</span><span class=mi>2</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>相关子查询</strong>：子查询条件依赖父查询</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>SNAME</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=err>‘</span><span class=mi>2</span><span class=err>’</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>CNO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SNO</span><span class=o>=</span><span class=n>S</span><span class=p>.</span><span class=n>SNO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>EXISTS</strong>：也是相关子查询</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>SNAME</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SNO</span><span class=o>=</span><span class=n>S</span><span class=p>.</span><span class=n>SNO</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>CNO</span><span class=o>=</span><span class=err>’</span><span class=mi>2</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=anyall-谓词>ANY、ALL 谓词</h4><p>ANY、ALL <strong>用于单属性表前</strong>以聚合，MAX、MIN 用于 SELECT 后以聚合。</p><p><em>查询非信息系中比信息系至少某一个学生年龄小的学生姓名年龄</em>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>Sname</span><span class=p>,</span><span class=w> </span><span class=n>Sage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>Sdept</span><span class=o>!=</span><span class=err>’</span><span class=k>IS</span><span class=err>’</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>Sage</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=k>ANY</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>Sage</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>Sdept</span><span class=o>=</span><span class=err>’</span><span class=k>IS</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>等价于</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>Sname</span><span class=p>,</span><span class=w> </span><span class=n>Sage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>Sdept</span><span class=o>!=</span><span class=err>’</span><span class=k>IS</span><span class=err>’</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>Sage</span><span class=o>&lt;</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>Sage</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>Sdept</span><span class=o>=</span><span class=err>’</span><span class=k>IS</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=exists-存在谓词>EXISTS 存在谓词</h4><h5 id=用-existsnot-exists-实现全称量词>用 EXISTS/NOT EXISTS 实现全称量词</h5><p><strong>存在表任意关系</strong>：$\forall x ( p ) \equiv \neg \exists x ( \neg p )$</p><p><em>查询选修全部课程的学生姓名</em>：（也就是不存在一门课它没选）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>#</span><span class=w> </span><span class=err>找到某学生并满足：不存在这样一种情况：有课程该学生没有选修</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>“有课程该学生没有选修”的写法：找到某课程并满足：不存在这样一种情况：该课程被这个学生选修</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>Sname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>Cno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>C</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=n>Sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>Cno</span><span class=o>=</span><span class=k>C</span><span class=p>.</span><span class=n>Cno</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>Sno</span><span class=o>=</span><span class=n>S</span><span class=p>.</span><span class=n>Sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>等价于</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>Sname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>(</span><span class=w> </span><span class=cm>/*查询S没选的课*/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>Cno</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>C</span><span class=p>.</span><span class=n>Cno</span><span class=o>=</span><span class=n>SC</span><span class=p>.</span><span class=n>Cno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>Sno</span><span class=o>=</span><span class=n>S</span><span class=p>.</span><span class=n>sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=用-existsnot-exists-实现逻辑蕴函>用 EXISTS/NOT EXISTS 实现逻辑蕴函</h5><p><strong>存在表蕴含关系</strong>： $ \forall y ( p arrow q ) \equiv \neg \exists y ( \neg ( \neg p \vee q ) ) \equiv \neg \exists y ( p \wedge \neg q ) $</p><p><em>查询选过学生 A（学号95002）选过的全部课程的学生B学号</em>：（不存在 A 选的课它没选）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>Sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>X</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>(</span><span class=w> </span><span class=cm>/*不存在这样一个课程号*/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>Cno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Y</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>Y</span><span class=p>.</span><span class=n>Sno</span><span class=o>=</span><span class=err>’</span><span class=mi>95002</span><span class=err>’</span><span class=w> </span><span class=cm>/*95002选了*/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>(</span><span class=w> </span><span class=cm>/*B没选*/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Z</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>Z</span><span class=p>.</span><span class=n>Cno</span><span class=o>=</span><span class=n>Y</span><span class=p>.</span><span class=n>Cno</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>Z</span><span class=p>.</span><span class=n>Sno</span><span class=o>=</span><span class=n>X</span><span class=p>.</span><span class=n>Sno</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=聚合函数>聚合函数</h4><p><strong>逻辑：先用 where 筛选，再 having，最后运行聚合函数</strong></p><ul><li><code>COUNT(*)</code> 元组个数</li><li><code>COUNT(列名)</code> 列中非空值个数</li><li><code>COUNT(DISTINCT 列名)</code> 列中元素种数</li><li><code>SUM(列)</code>、<code>AVG(列)</code></li><li><code>MAX(列)</code>、<code>MIN(列)</code></li><li><code>DISTINCT</code></li></ul><h4 id=数据分组>数据分组</h4><ul><li><p>Group By 属性必须在 SELECT 后出现；</p></li><li><p>在 SELECT 中指定的字段要么就要<strong>包含在 Group By 语句中</strong>，作为分组的依据；要么就要被<strong>包含在聚合函数</strong>中</p></li><li><p>通常 SELECT 语句中使用了分组子句就会有聚合操作；但执行聚合操作不一定要用分组子句。</p></li></ul><p><em>查询每门课的选课人数</em>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>Cno</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>Sno</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>Cno</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=集合操作>集合操作</h4><ul><li>UNION 并</li><li>INTERSACT 交</li><li>EXCEPT 差</li></ul><h4 id=例-1>例</h4><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424155140638.png alt=image-20220424155140638 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424155212776.png alt=image-20220424155212776 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424155222407.png alt=image-20220424155222407 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424155454448.png alt=image-20220424155454448 style=zoom:67%>
<img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424155505907.png alt=image-20220424155505907 style=zoom:67%><h3 id=sql-数据更新->SQL 数据更新 ⭐</h3><h4 id=数据插入-insert>数据插入 <code>INSERT</code></h4><p>插入单个元组</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=err>基本表名</span><span class=p>(</span><span class=err>列名表</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=err>元组值</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>例</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>SC</span><span class=p>(</span><span class=n>SNO</span><span class=p>,</span><span class=n>CNO</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=s1>&#39;S3&#39;</span><span class=p>,</span><span class=s1>&#39;C3&#39;</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>插入子查询结果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=err>基本表名</span><span class=p>(</span><span class=err>列名表</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>SELECT</span><span class=w>  </span><span class=err>查询语句；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>例</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>S_AVG_GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>SELECT</span><span class=w> </span><span class=n>SNO</span><span class=p>,</span><span class=k>AVG</span><span class=p>(</span><span class=n>GRADE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>FROM</span><span class=w> </span><span class=n>SC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>SNO</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=数据删除-delete>数据删除 <code>DELETE</code></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=o>&lt;</span><span class=err>表名</span><span class=o>&gt;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=o>&lt;</span><span class=err>条件表达式</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>例</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DELETE</span><span class=w>  </span><span class=k>FROM</span><span class=w>  </span><span class=n>SC</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>WHERE</span><span class=w> </span><span class=n>CNO</span><span class=w> </span><span class=k>IN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>CNO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>C</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=n>CNAME</span><span class=o>=</span><span class=s1>&#39;数据库原理&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=数据修改-update>数据修改 <code>UPDATE</code></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>UPDATE</span><span class=w> </span><span class=err>基本表名</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SET</span><span class=w> </span><span class=err>列名</span><span class=o>=</span><span class=err>值表达式</span><span class=p>[,</span><span class=w> </span><span class=err>列名</span><span class=o>=</span><span class=err>值表达式…</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>[</span><span class=k>WHERE</span><span class=w> </span><span class=err>条件表达式</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>把课程名为 “数据库原理” 的成绩提高 10%.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>UPDATE</span><span class=w>  </span><span class=n>SC</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>SET</span><span class=w> </span><span class=n>GRADE</span><span class=o>=</span><span class=mi>1</span><span class=p>.</span><span class=mi>1</span><span class=o>*</span><span class=n>GRADE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>WHERE</span><span class=w> </span><span class=n>CNO</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>CNO</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>C</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>WHERE</span><span class=w> </span><span class=n>CNAME</span><span class=o>=</span><span class=s1>&#39;数据库原理&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>把课程名为 “数据库原理” 的学分增加 1 分，老师改为王。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>UPDATE</span><span class=w>  </span><span class=k>C</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>SET</span><span class=w> </span><span class=n>CREDIT</span><span class=o>=</span><span class=n>CREDIT</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=n>TNAME</span><span class=o>=</span><span class=err>‘</span><span class=n>WANG</span><span class=err>’</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>CNAME</span><span class=o>=</span><span class=s1>&#39;数据库原理&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=嵌入式-sql>嵌入式 SQL</h3><p><strong>定义</strong>：嵌入在高级语言（宿主语言）的程序中使用的 SQL 语言</p><p><strong>实现方式</strong></p><ul><li>扩充宿主语言的编译程序</li><li>预处理方式（常用）</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424170801490.png alt=image-20220424170801490 style=zoom:80%><h4 id=使用规定>使用规定</h4><blockquote><p>必须解决的问题</p></blockquote><ul><li><p>为区分 SQL 语句与宿主语言语句，在所有的 SQL 语句前必须加上前缀标识 <code>EXEC SQL</code>，并以 <code>END EXEC</code> 作为语句结束标志</p></li><li><p>通过<strong>共享变量</strong>进行数据交互</p><ul><li><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424195033225.png alt=image-20220424195033225 style=zoom:67%></li><li><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424195022854.png alt=image-20220424195022854 style=zoom:80%></li></ul></li><li><p>通过<strong>游标</strong>统一 SQL 中一次一集合的和程序中一次一记录工作方式</p><ul><li>定义游标语句：DECLARE</li><li>打开游标语句：OPEN</li><li>游标推进语句：FETCH</li><li>关闭游标语句：CLOSE</li></ul></li></ul><blockquote><p>只有查询结果是多条记录、或需要对当前记录进行操作时才需要使用游标</p></blockquote><blockquote><p>使用嵌入式的目标：统一 SQL 中一次一集合的和程序中一次一记录工作方式</p></blockquote><p><strong>使用技术</strong>：blablabla</p><h2 id=第六章-实体联系模型>第六章 实体联系模型</h2><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201817219.png alt=image-20220424201817219 style=zoom:67%><h3 id=er-模型的基本元素>ER 模型的基本元素</h3><p><strong>基本元素</strong>：实体、联系、属性</p><ul><li><strong>实体</strong>：一个数据对象 → 方框</li><li><strong>联系</strong>：表示实体间的关系 → 菱形框，用线段和实体相连</li><li><strong>属性</strong>：表示实体的特性 → 椭圆形框<ul><li>实体标识符（主键）加<u>下划线</u>，用线段和实体相连</li></ul></li></ul><h3 id=属性的分类>属性的分类</h3><h4 id=基本属性和复合属性>基本属性和复合属性</h4><ul><li>基本属性：不可再分割的属性。</li><li>复合属性：可再分解为其他属性的属性（即属性嵌套属性）<ul><li>复合属性形成了一个属性的<strong>层次结构</strong>。</li></ul></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424195907068.png alt=image-20220424195907068 style=zoom:67%><h4 id=单值属性和多值属性>单值属性和多值属性</h4><ul><li><p>单值属性：同一实体的属性只能取一个值。</p></li><li><p>多值属性：同一实体的某些属性可能取多个值。</p><ul><li>用双椭圆表示</li><li>学位、住址</li></ul></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424200204191.png alt=image-20220424200204191 style=zoom:67%><h5 id=多值属性的变换方法>多值属性的变换方法</h5><ul><li><p>添加<strong>新的属性</strong>：将多值属性展开成多个单值属性</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424200314113.png alt=image-20220424200314113 style=zoom:67%></li><li><p>添加<strong>弱实体</strong>：通过<strong>双菱形连双方框</strong>，属性为销售性质和价格</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424200340896.png alt=image-20220424200340896 style=zoom:67%></li></ul><h4 id=导出属性>导出属性</h4><ul><li><p>可由其他信息推导的属性</p></li><li><p>如用出生日期推算年龄</p></li><li><p>用虚线和虚椭圆连接</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424200444179.png alt=image-20220424200444179 style=zoom:67%></li></ul><h4 id=空值>空值</h4><p>空值的三种意义</p><ul><li>占位空值：表示无意义（未婚则配偶名无意义）</li><li>未知空值：表示未知（已婚但配偶名未知）</li><li>员工是否已婚未知</li></ul><h3 id=联系的设计>联系的设计</h3><h4 id=联系的元数>联系的元数</h4><p>联系涉及到的实体集个数</p><ul><li><strong>一元联系</strong>：员工管理员工，零件使用零件<ul><li>在同一个实体内部存在的联系，又叫递归联系</li><li>一对一、一对多：做外键</li><li>多对多：单独建表</li></ul></li><li><strong>二元联系</strong>：零件构成产品<ul><li>一对一：双方表选一个建对方的外键</li><li>一对多：多的一方加入外键</li><li>多对多：单独建表（SC）</li></ul></li><li><strong>三元联系</strong>：学生选老师开设的课，单独建表（SPJ）</li></ul><h4 id=联系的联通词>联系的联通词</h4><p>1:1, 1:N, M:N, M:N:P 等</p><ul><li>一元联系</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201220239.png alt=image-20220424201220239 style=zoom:67%><ul><li>二元联系</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201233187.png alt=image-20220424201233187 style=zoom:67%><ul><li>三元联系</li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201246661.png alt=image-20220424201246661 style=zoom:67%><h4 id=联系的基数>联系的基数</h4><p>有两个实体集 E1 和 E2，E1 中的每个实体与 E2 中有联系实体数目的最小值 Min 和最大值 Max，称为 E1 的基数</p><p>写在联系两侧，格式为 $ ( \min ,\max )$ ，靠近一侧做主语</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201352993.png alt=image-20220424201352993 style=zoom:67%><h3 id=er-模型的扩充>ER 模型的扩充</h3><h4 id=依赖联系>依赖联系</h4><p>一个实体的存在以另一个实体的存在为前提</p><p>如，一个职工可能有多个社会关系，社会关系是多值属性；为了消除冗余，设计两个实体：职工与社会关系。在职工与社会关系中，社会关系的信息是以职工信息的存在为前提。因此社会关系的存在是以职工的存在为前提，所以职工与社会关系是一种依赖联系。</p><h4 id=弱实体>弱实体</h4><p>一个实体对于另一些实体具有很强的依赖联系，而且该实体的主码部分或全部从其父实体中获得。</p><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201554750.png alt=image-20220424201554750 style=zoom:67%><h4 id=子类超类>子类、超类</h4><p>当较低层上实体类型表达了与之联系的较高层上的实体类型的特殊情况时，就称较高层上实体类型为超类型（supertype），较低层上实体类型为子类型（subtype）。</p><p>有继承性，且实体标识符相同。超类用两端双线的矩形框表示，联系中间加圈</p><p><strong>性质</strong></p><ul><li><p>子类继承超类的所有属性，但可以包含更多属性</p></li><li><p>通过子类实体和超类实体有相同的实体标识符实现（即子类和超类主键相同）</p></li></ul><img src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220424201711084.png alt=image-20220424201711084 style=zoom:67%><hr><p>填空题 TLB：</p><ul><li>SQL 三个阶段：人工管理、文件系统、数据库系统</li><li>数据库技术三个阶段：层次模型、网状模型、关系模型</li><li>数据控制四功能：并发控制、恢复、完整性、安全性</li><li>三个世界：现实世界、信息世界、机器世界</li><li>数据模型分类：概念模型、逻辑模型</li><li>数据模型三要素：数据结构、数据操纵、完整性约束</li><li>完整性约束：实体完整性、参照完整性、用户自定义完整性</li><li>三级模式：外模式、模式、内模式</li><li>两级映像：外模式模式映像、模式内模式映像</li><li>完整性规则：实体完整性、参照完整性、用户自定义完整性</li><li>空值三个意义：占位空值、未知空值、未知</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2022-11-23 14:00:55">更新于 2022-11-23</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://trouvaille0198.github.io/Notes/posts/courses/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80/ data-title=数据库原理（1） data-hashtags=数据库><i class="fa-brands fa-twitter fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://trouvaille0198.github.io/Notes/posts/courses/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80/ data-hashtag=数据库><i class="fa-brands fa-facebook-square fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://trouvaille0198.github.io/Notes/posts/courses/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E4%B8%80/ data-title=数据库原理（1）><i class="fa-brands fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw"></i>&nbsp;<a href=/Notes/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/>数据库</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/Notes/>主页</a></span></section></div><div class=post-nav><a href=/Notes/posts/%E5%88%B7%E9%A2%98/back-tracking/%E5%89%91%E6%8C%87-offer-34.-%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%AD%E5%92%8C%E4%B8%BA%E6%9F%90%E4%B8%80%E5%80%BC%E7%9A%84%E8%B7%AF%E5%BE%84/ class=prev rel=prev title="剑指 Offer 34. 二叉树中和为某一值的路径"><i class="fa-solid fa-angle-left fa-fw"></i>剑指 Offer 34. 二叉树中和为某一值的路径</a>
<a href=/Notes/posts/%E5%88%B7%E9%A2%98/array/%E5%89%91%E6%8C%87-offer-53-i.-%E5%9C%A8%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E6%9F%A5%E6%89%BE%E6%95%B0%E5%AD%97-i/ class=next rel=next title="剑指 Offer 53 - I. 在排序数组中查找数字 I">剑指 Offer 53 - I. 在排序数组中查找数字 I<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">酒困路长惟欲睡，日高人渴漫思茶</div><div class="footer-line copyright"><i class="fa-regular fa-copyright fa-fw"></i>
<span itemprop=copyrightYear>2022</span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fa-solid fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fa-solid fa-comment fa-fw"></i></a></div><div id=mask></div></div><link rel=stylesheet href=/Notes/lib/katex/katex.min.css><link rel=stylesheet href=/Notes/lib/katex/copy-tex.min.css><link rel=stylesheet href=/Notes/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/Notes/lib/autocomplete/autocomplete.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.stemmer.support.min.js defer></script><script type=text/javascript src=/Notes/lib/lunr/lunr.zh.min.js defer></script><script type=text/javascript src=/Notes/lib/lazysizes/lazysizes.min.js async defer></script><script type=text/javascript src=/Notes/lib/sharer/sharer.min.js async defer></script><script type=text/javascript src=/Notes/lib/katex/katex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/Notes/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/Notes/lib/cookieconsent/cookieconsent.min.js defer></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:45},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/Notes/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/Notes/lib/lunr/lunr.segmentit.js",maxResultLength:30,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/Notes/js/theme.min.js defer></script><script type=text/javascript src=/Notes/js/_custom.min.js defer></script></body></html>