<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title> - 我的全新 Hugo 网站</title><meta name=Description content><meta property="og:title" content>
<meta property="og:description" content="Vue3 官方文档是最好的教程：https://v3.cn.vuejs.org/guide/ 认识 1 2 3 <div id=&#34;counter&#34;> Counter: {{ counter }} </div> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 const Counter">
<meta property="og:type" content="article">
<meta property="og:url" content="http://example.org/posts/frontend/%E6%A1%86%E6%9E%B6/vue3/"><meta property="article:section" content="posts">
<meta name=twitter:card content="summary">
<meta name=twitter:title content>
<meta name=twitter:description content="Vue3 官方文档是最好的教程：https://v3.cn.vuejs.org/guide/ 认识 1 2 3 <div id=&#34;counter&#34;> Counter: {{ counter }} </div> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 const Counter">
<meta name=application-name content="我的全新 Hugo 网站">
<meta name=apple-mobile-web-app-title content="我的全新 Hugo 网站"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/frontend/%E6%A1%86%E6%9E%B6/vue3/><link rel=prev href=http://example.org/posts/frontend/%E6%A1%86%E6%9E%B6/vuetify/><link rel=next href=http://example.org/posts/frontend/%E6%A1%86%E6%9E%B6/vue2/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/frontend\/%E6%A1%86%E6%9E%B6\/vue3\/"},"genre":"posts","wordcount":11132,"url":"http:\/\/example.org\/posts\/frontend\/%E6%A1%86%E6%9E%B6\/vue3\/","publisher":{"@type":"Organization","name":"作者"},"author":{"@type":"Person","name":"作者"},"description":""}</script></head>
<body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="我的全新 Hugo 网站">伤心肠粉</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> 文章 </a><a class=menu-item href=/tags/> 标签 </a><a class=menu-item href=/categories/> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="我的全新 Hugo 网站">伤心肠粉</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
取消
</a>
</div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>目录</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX"></h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>作者</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=0001-01-01>0001-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 11132 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 23 分钟&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#认识>认识</a>
<ul>
<li><a href=#不成熟的认知习惯>不成熟的认知习惯</a></li>
<li><a href=#新特性>新特性</a></li>
<li><a href=#安装>安装</a>
<ul>
<li><a href=#vite>Vite</a></li>
<li><a href=#vue-cli>Vue CLI</a></li>
</ul>
</li>
<li><a href=#一些思想>一些思想</a></li>
<li><a href=#ts-支持>TS 支持</a>
<ul>
<li><a href=#配置文件>配置文件</a></li>
<li><a href=#定义-vue-组件>定义 Vue 组件</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#基本知识>基本知识</a>
<ul>
<li><a href=#组件化>组件化</a>
<ul>
<li><a href=#单个文件组件>单个文件组件</a></li>
<li><a href=#在模块系统中局部注册>在模块系统中局部注册</a></li>
<li><a href=#字母不分大小写>字母不分大小写</a></li>
</ul>
</li>
<li><a href=#应用实例>应用实例</a>
<ul>
<li><a href=#根组件与挂载>根组件与挂载</a></li>
<li><a href=#组件实例-property>组件实例 property</a></li>
<li><a href=#生命周期钩子>生命周期钩子</a></li>
</ul>
</li>
<li><a href=#模板语法>模板语法</a>
<ul>
<li><a href=#动态参数>动态参数</a></li>
<li><a href=#对动态参数表达式约定>对动态参数表达式约定</a></li>
<li><a href=#修饰符>修饰符</a></li>
</ul>
</li>
<li><a href=#data-property>Data Property</a></li>
<li><a href=#防抖和节流>防抖和节流</a></li>
<li><a href=#计算属性的-setter>计算属性的 Setter</a></li>
<li><a href=#侦听器>侦听器</a></li>
<li><a href=#计算属性-vs-侦听器>计算属性 vs 侦听器</a></li>
<li><a href=#class-的对象语法>class 的对象语法</a>
<ul>
<li><a href=#在模板里定义对象>在模板里定义对象</a></li>
<li><a href=#在-data-中定义对象>在 data 中定义对象</a></li>
<li><a href=#在计算属性里定义对象>在计算属性里定义对象</a></li>
<li><a href=#数组语法>数组语法</a></li>
</ul>
</li>
<li><a href=#关于-v-on>关于 <code>v-on</code></a>
<ul>
<li><a href=#事件修饰符>事件修饰符</a></li>
<li><a href=#按键修饰符>按键修饰符</a>
<ul>
<li><a href=#按键别名>按键别名</a></li>
<li><a href=#系统修饰键>系统修饰键</a></li>
<li><a href=#exact-修饰符><code>.exact</code> 修饰符</a></li>
<li><a href=#鼠标按钮修饰符>鼠标按钮修饰符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#关于-v-model>关于 <code>v-model</code></a>
<ul>
<li><a href=#修饰符-1>修饰符</a>
<ul>
<li><a href=#lazy><code>.lazy</code></a></li>
<li><a href=#number><code>.number</code></a></li>
<li><a href=#trim><code>.trim</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href=#composition-api>Composition API</a>
<ul>
<li><a href=#结构示例>结构示例</a>
<ul>
<li><a href=#optionapi>optionAPI</a></li>
<li><a href=#compositionapi>CompositionAPI</a></li>
</ul>
</li>
<li><a href=#setup>setup</a>
<ul>
<li><a href=#参数>参数</a>
<ul>
<li><a href=#props>props</a></li>
<li><a href=#context>context</a></li>
</ul>
</li>
<li><a href=#返回值>返回值</a>
<ul>
<li><a href=#对象>对象</a></li>
<li><a href=#渲染函数>渲染函数</a></li>
</ul>
</li>
<li><a href=#不用-this>不用 this</a></li>
</ul>
</li>
<li><a href=#ref-与-reactive>ref 与 reactive</a>
<ul>
<li><a href=#reactive>reactive</a></li>
<li><a href=#ref>ref</a>
<ul>
<li><a href=#模板中访问><strong>模板中访问</strong></a></li>
<li><a href=#作为响应式对象的属性访问><strong>作为响应式对象的属性访问</strong></a></li>
<li><a href=#类型定义><strong>类型定义</strong></a></li>
</ul>
</li>
<li><a href=#例>例</a></li>
</ul>
</li>
<li><a href=#computed>computed</a></li>
<li><a href=#watch>watch</a></li>
<li><a href=#propsemit>props/$emit</a></li>
<li><a href=#跨组件传值>跨组件传值</a>
<ul>
<li><a href=#怎么设置为响应式更新呢>怎么设置为响应式更新呢？</a></li>
<li><a href=#父组件>父组件</a></li>
<li><a href=#子组件>子组件</a></li>
</ul>
</li>
<li><a href=#模块化>模块化</a></li>
<li><a href=#definecomponent>defineComponent</a></li>
<li><a href=#与-ts-的结合>与 TS 的结合</a>
<ul>
<li><a href=#接口约束约束属性>接口约束约束属性</a>
<ul>
<li><a href=#interface><code>interface</code></a></li>
<li><a href=#组件中使用>组件中使用</a></li>
</ul>
</li>
<li><a href=#组件使用-definecomponent-来定义>组件使用 <code>defineComponent</code> 来定义</a></li>
<li><a href=#类型声明-reactive>类型声明 <code>reactive</code></a></li>
</ul>
</li>
<li><a href=#setup-script>setup script</a>
<ul>
<li><a href=#自动注册子组件>自动注册子组件</a></li>
<li><a href=#属性和方法无需返回>属性和方法无需返回</a></li>
<li><a href=#支持-propsemit-和-context>支持 props、emit 和 context</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><h1 id=vue3>Vue3</h1>
<p>官方文档是最好的教程：https://v3.cn.vuejs.org/guide/</p>
<h2 id=认识>认识</h2>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;counter&#34;</span><span class=p>&gt;</span>
  Counter: {{ counter }}
<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>Counter</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>counter</span><span class=o>:</span> <span class=mi>0</span>
    <span class=p>}</span>
  <span class=p>},</span>
  <span class=nx>mounted</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>setInterval</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>counter</span><span class=o>++</span>
    <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>(</span><span class=nx>Counter</span><span class=p>).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#counter&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>另一个例子</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
  <span class=nx>data() {</span>
    <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span>: <span class=kt>4</span> <span class=p>}</span>
  <span class=p>},</span>
  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>increment() {</span>
      <span class=c1>// `this` 指向该组件实例
</span><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>count</span><span class=o>++</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>})</span>
<span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=不成熟的认知习惯>不成熟的认知习惯</h3>
<ul>
<li>
<p>在 OptionsAPI 中</p>
<ul>
<li>
<p>data 写成函数形式，里面 return 一个对象</p>
</li>
<li>
<p>methods 写成对象形式</p>
</li>
<li>
<p>computed 写成对象形式，里面的计算属性写成函数形式</p>
</li>
<li>
<p>mounted 写成函数形式</p>
</li>
</ul>
</li>
</ul>
<h3 id=新特性>新特性</h3>
<ul>
<li>树摇（Tree shacking）</li>
<li>组合式 API（Composition API）</li>
</ul>
<h3 id=安装>安装</h3>
<ul>
<li><code>vue-cli</code> 基于 <code>webpack</code> 封装，生态非常强大，可配置性也非常高，几乎能够满足前端工程化的所有要求。缺点就是配置复杂，甚至有公司有专门的 webpack 工程师专门做配置，另外就是 webpack 由于开发环境需要打包编译，开发体验实际上不如 <code>vite</code>。</li>
<li><code>vite</code> 开发模式基于 <code>esbuild</code>，打包使用的是 <code>rollup</code>。急速的 <code>冷启动</code> 和无缝的 <code>hmr</code> 在开发模式下获得极大的体验提升。缺点就是该脚手架刚起步，生态上还不及 <code>webpack</code></li>
</ul>
<h4 id=vite>Vite</h4>
<p>vite 是伴随这 Vue3.0 诞生的单文件组件的非打包开发服务器，用来进行 3.0 的编译</p>
<p>安装 vite 命令</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=c1># yarn 安装</span>
yarn global add create-vite-app
<span class=c1># npm 全局安装</span>
npm i -g create-vite-app
</code></pre></td></tr></table>
</div>
</div><p>创建项目</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=c1># 完整命令</span>
create-vite-app &lt;project-name&gt;
<span class=c1># 缩写命令</span>
cva &lt;project-name&gt;

<span class=c1># or 推荐</span>
npm init vite@latest &lt;project-name&gt; -- --template vue
</code></pre></td></tr></table>
</div>
</div><p>配置 <code>vite.config.ts</code></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=c1>// vite.config.ts
</span><span class=c1></span><span class=kr>module</span><span class=nx>.exports</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>port</span>: <span class=kt>8077</span><span class=p>,</span> <span class=c1>// 服务端口
</span><span class=c1></span>  <span class=nx>proxy</span><span class=o>:</span> <span class=p>{</span> <span class=c1>// 代理
</span><span class=c1></span>    <span class=c1>// string shorthand
</span><span class=c1></span>    <span class=s2>&#34;/foo&#34;</span><span class=o>:</span> <span class=s2>&#34;http://localhost:4567/foo&#34;</span><span class=p>,</span>
    <span class=c1>// with options
</span><span class=c1></span>    <span class=s2>&#34;/api&#34;</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>target</span><span class=o>:</span> <span class=s2>&#34;http://jsonplaceholder.typicode.com&#34;</span><span class=p>,</span>
      <span class=nx>changeOrigin</span>: <span class=kt>true</span><span class=p>,</span>
      <span class=nx>rewrite</span><span class=o>:</span> <span class=p>(</span><span class=nx>path</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>path</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/^\/api/</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>),</span>
    <span class=p>},</span>
  <span class=p>},</span>
<span class=p>};</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=vue-cli>Vue CLI</h4>
<p>安装</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>npm install -g @vue/cli
</code></pre></td></tr></table>
</div>
</div><p>创建项目</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>vue create my-vue3-demo
<span class=c1># 通过可视化工具创建</span>
vue ui
</code></pre></td></tr></table>
</div>
</div><p>启动</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-shell data-lang=shell>npm run serve
</code></pre></td></tr></table>
</div>
</div><p><code> vue.config.js</code> 配置</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// vue.config.js
</span><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>outputDir</span><span class=o>:</span> <span class=s1>&#39;dist&#39;</span><span class=p>,</span> <span class=c1>// 打包的目录
</span><span class=c1></span>  <span class=nx>lintOnSave</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=c1>// 在保存时校验格式
</span><span class=c1></span>  <span class=nx>productionSourceMap</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=c1>// 生产环境是否生成 SourceMap
</span><span class=c1></span>  <span class=nx>devServer</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>open</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=c1>// 启动服务后是否打开浏览器
</span><span class=c1></span>    <span class=nx>overlay</span><span class=o>:</span> <span class=p>{</span> <span class=c1>// 错误信息展示到页面
</span><span class=c1></span>      <span class=nx>warnings</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nx>errors</span><span class=o>:</span> <span class=kc>true</span>
    <span class=p>},</span>
    <span class=nx>host</span><span class=o>:</span> <span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span>
    <span class=nx>port</span><span class=o>:</span> <span class=mi>8066</span><span class=p>,</span> <span class=c1>// 服务端口
</span><span class=c1></span>    <span class=nx>https</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
    <span class=nx>hotOnly</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
    <span class=c1>// proxy: { // 设置代理
</span><span class=c1></span>    <span class=c1>//   &#39;/api&#39;: {
</span><span class=c1></span>    <span class=c1>//     target: host,
</span><span class=c1></span>    <span class=c1>//     changeOrigin: true,
</span><span class=c1></span>    <span class=c1>//     pathRewrite: {
</span><span class=c1></span>    <span class=c1>//       &#39;/api&#39;: &#39;/&#39;,
</span><span class=c1></span>    <span class=c1>//     }
</span><span class=c1></span>    <span class=c1>//   },
</span><span class=c1></span>    <span class=c1>// },
</span><span class=c1></span>  <span class=p>},</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=一些思想>一些思想</h3>
<ul>
<li>对于任何包含响应式数据的复杂逻辑，都应该使用<strong>计算属性</strong>
<ul>
<li>我们可以将同一函数定义为一个方法而不是一个计算属性。两种方式的最终结果确实是完全相同的。然而，不同的是<strong>计算属性是基于它们的响应依赖关系缓存的</strong>。计算属性只在相关响应式依赖发生改变时它们才会重新求值。这就意味着只要 <code>author.books</code> 还没有发生改变，多次访问 <code>publishedBookMessage</code> 计算属性会立即返回之前的计算结果，而不必再次执行函数</li>
<li>但是如果你不希望有缓存，请用 <code>method</code> 来替代</li>
<li>当需要在数据变化时执行异步或开销较大的操作时，使用侦听器更为合适。</li>
</ul>
</li>
<li>因为 <code>v-if</code> 是一个指令，所以必须将它添加到一个元素上。但是如果想切换多个元素呢？此时可以把一个 <code>&lt;template></code> 元素当做不可见的包裹元素，并在上面使用 <code>v-if</code>。最终的渲染结果将不包含 <code>&lt;template></code> 元素</li>
<li>一般来说，<code>v-if</code> 有更高的切换开销，而 <code>v-show</code> 有更高的初始渲染开销。因此，如果需要非常频繁地切换，则使用 <code>v-show</code> 较好；如果在运行时条件很少改变，则使用 <code>v-if</code> 较好。</li>
<li>建议尽可能在使用 <code>v-for</code> 时提供 <code>key</code> attribute，如 <code>v-for="item in items" :key="item.id"</code></li>
<li>有时，我们想要显示一个数组经过过滤或排序后的版本，而不实际变更或重置原始数据。在这种情况下，可以创建一个计算属性，来返回过滤或排序后的数组</li>
<li>类似于 <code>v-if</code>，你也可以利用带有 <code>v-for</code> 的 <code>&lt;template></code> 来循环渲染一段包含多个元素的内容</li>
</ul>
<h3 id=ts-支持>TS 支持</h3>
<h4 id=配置文件>配置文件</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// tsconfig.json
</span><span class=c1></span><span class=p>{</span>
  <span class=s2>&#34;compilerOptions&#34;</span><span class=o>:</span> <span class=p>{</span>
    <span class=s2>&#34;target&#34;</span><span class=o>:</span> <span class=s2>&#34;esnext&#34;</span><span class=p>,</span>
    <span class=s2>&#34;module&#34;</span><span class=o>:</span> <span class=s2>&#34;esnext&#34;</span><span class=p>,</span>
    <span class=c1>// 这样就可以对 `this` 上的数据属性进行更严格的推断
</span><span class=c1></span>    <span class=s2>&#34;strict&#34;</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=s2>&#34;jsx&#34;</span><span class=o>:</span> <span class=s2>&#34;preserve&#34;</span><span class=p>,</span>
    <span class=s2>&#34;moduleResolution&#34;</span><span class=o>:</span> <span class=s2>&#34;node&#34;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>请注意，必须包含 <code>strict: true</code> (或至少包含 <code>noImplicitThis: true</code>，它是 <code>strict</code> 标志的一部分) 才能在组件方法中利用 <code>this</code> 的类型检查，否则它总是被视为 <code>any</code> 类型。</p>
<p>如果你使用自定义 Webpack 配置，需要配置 ' ts-loader ' 来解析 vue 文件里的 <code>&lt;script lang="ts"></code> 代码块：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// webpack.config.js
</span><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
  <span class=p>...</span>
  <span class=nx>module</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>rules</span><span class=o>:</span> <span class=p>[</span>
      <span class=p>{</span>
        <span class=nx>test</span><span class=o>:</span> <span class=sr>/\.tsx?$/</span><span class=p>,</span>
        <span class=nx>loader</span><span class=o>:</span> <span class=s1>&#39;ts-loader&#39;</span><span class=p>,</span>
        <span class=nx>options</span><span class=o>:</span> <span class=p>{</span>
          <span class=nx>appendTsSuffixTo</span><span class=o>:</span> <span class=p>[</span><span class=sr>/\.vue$/</span><span class=p>],</span>
        <span class=p>},</span>
        <span class=nx>exclude</span><span class=o>:</span> <span class=sr>/node_modules/</span><span class=p>,</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nx>test</span><span class=o>:</span> <span class=sr>/\.vue$/</span><span class=p>,</span>
        <span class=nx>loader</span><span class=o>:</span> <span class=s1>&#39;vue-loader&#39;</span><span class=p>,</span>
      <span class=p>}</span>
      <span class=p>...</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=定义-vue-组件>定义 Vue 组件</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>script</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;ts&#34;</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
  <span class=c1>// 已启用类型推断
</span><span class=c1></span><span class=p>})</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=基本知识>基本知识</h2>
<h3 id=组件化>组件化</h3>
<p>组件系统是 Vue 的另一个重要概念，因为它是一种抽象，允许我们使用小型、独立和通常可复用的组件构建大型应用。仔细想想，几乎任意类型的应用界面都可以抽象为一个组件树：</p>
<p><img class=lazyload src=/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/components.png data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/components.png, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/components.png 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/components.png 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/components.png title="Component Tree"></p>
<p>在 Vue 中，组件本质上是一个具有预定义选项的实例。在 Vue 中注册组件很简单：如对 <code>App</code> 对象所做的那样创建一个组件对象，并将其定义在父级组件的 <code>components</code> 选项中：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// 创建 Vue 应用
</span><span class=c1></span><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>(...)</span>

<span class=c1>// 定义名为 todo-item 的新组件
</span><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;todo-item&#39;</span><span class=p>,</span> <span class=p>{</span>
  <span class=nx>template</span><span class=o>:</span> <span class=sb>`&lt;li&gt;This is a todo&lt;/li&gt;`</span>
<span class=p>})</span>

<span class=c1>// 挂载 Vue 应用
</span><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(...)</span>
</code></pre></td></tr></table>
</div>
</div><p>现在，你可以将其放到到另一个组件的模板中：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>ol</span><span class=p>&gt;</span>
  <span class=c>&lt;!-- 创建一个 todo-item 组件实例 --&gt;</span>
  <span class=p>&lt;</span><span class=nt>todo-item</span><span class=p>&gt;&lt;/</span><span class=nt>todo-item</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>ol</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>但是这样会为每个待办项渲染同样的文本。我们应该能将数据从父组件传入子组件才对。让我们来修改一下组件的定义，使之能够接受一个 prop；然后使用 <code>v-bind</code> 指令将待办项传到循环输出的每个组件中：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;todo-list-app&#34;</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>ol</span><span class=p>&gt;</span>
     <span class=c>&lt;!--
</span><span class=c>      现在我们为每个 todo-item 提供 todo 对象
</span><span class=c>      todo 对象是变量，即其内容可以是动态的。
</span><span class=c>      我们也需要为每个组件提供一个“key”，稍后再
</span><span class=c>      作详细解释。
</span><span class=c>    --&gt;</span>
    <span class=p>&lt;</span><span class=nt>todo-item</span>
      <span class=na>v-for</span><span class=o>=</span><span class=s>&#34;item in groceryList&#34;</span>
      <span class=na>v-bind:todo</span><span class=o>=</span><span class=s>&#34;item&#34;</span>
      <span class=na>v-bind:key</span><span class=o>=</span><span class=s>&#34;item.id&#34;</span>
    <span class=p>&gt;&lt;/</span><span class=nt>todo-item</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>ol</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>TodoList</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>groceryList</span><span class=o>:</span> <span class=p>[</span>
        <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>text</span><span class=o>:</span> <span class=s1>&#39;Vegetables&#39;</span> <span class=p>},</span>
        <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>text</span><span class=o>:</span> <span class=s1>&#39;Cheese&#39;</span> <span class=p>},</span>
        <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>text</span><span class=o>:</span> <span class=s1>&#39;Whatever else humans are supposed to eat&#39;</span> <span class=p>}</span>
      <span class=p>]</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>(</span><span class=nx>TodoList</span><span class=p>)</span>

<span class=nx>app</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;todo-item&#39;</span><span class=p>,</span> <span class=p>{</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;todo&#39;</span><span class=p>],</span>
  <span class=nx>template</span><span class=o>:</span> <span class=sb>`&lt;li&gt;{{ todo.text }}&lt;/li&gt;`</span>
<span class=p>})</span>

<span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#todo-list-app&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>在一个大型应用中，有必要将整个应用程序划分为多个组件，以使开发更易管理。不过这里有一个 (假想的) 例子，以展示使用了组件的应用模板是什么样的：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>app-nav</span><span class=p>&gt;&lt;/</span><span class=nt>app-nav</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>app-view</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>app-sidebar</span><span class=p>&gt;&lt;/</span><span class=nt>app-sidebar</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>app-content</span><span class=p>&gt;&lt;/</span><span class=nt>app-content</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>app-view</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=单个文件组件>单个文件组件</h4>
<p>在典型的 Vue 应用中，我们使用单个文件组件而不是字符串模板。</p>
<h4 id=在模块系统中局部注册>在模块系统中局部注册</h4>
<p>如果你使用了诸如 Babel 和 webpack 的模块系统。在这些情况下，我们推荐创建一个 <code>components</code> 目录，并将每个组件放置在其各自的文件中。</p>
<p>然后你需要在局部注册之前导入每个你想使用的组件。例如，在一个假设的 <code>ComponentB.js</code> 或 <code>ComponentB.vue</code> 文件中：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>import</span> <span class=nx>ComponentA</span> <span class=nx>from</span> <span class=s1>&#39;./ComponentA&#39;</span>
<span class=kr>import</span> <span class=nx>ComponentC</span> <span class=nx>from</span> <span class=s1>&#39;./ComponentC&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>components</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>ComponentA</span><span class=p>,</span>
    <span class=nx>ComponentC</span>
  <span class=p>}</span>
  <span class=c1>// ...
</span><span class=c1></span><span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>现在 <code>ComponentA</code> 和 <code>ComponentC</code> 都可以在 <code>ComponentB</code> 的模板中使用了。</p>
<h4 id=字母不分大小写>字母不分大小写</h4>
<p>另外，HTML attribute 名不区分大小写，因此浏览器将所有大写字符解释为小写。这意味着当你在 DOM 模板中使用时，驼峰 prop 名称和 event 处理器参数需要使用它们的 kebab-cased (横线字符分隔) 等效值：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>//  在JavaScript中的驼峰
</span><span class=c1></span>
<span class=nx>app</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;blog-post&#39;</span><span class=p>,</span> <span class=p>{</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;postTitle&#39;</span><span class=p>],</span>
  <span class=nx>template</span><span class=o>:</span> <span class=sb>`
</span><span class=sb>    &lt;h3&gt;{{ postTitle }}&lt;/h3&gt;
</span><span class=sb>  `</span>
<span class=p>})</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 在HTML则是横线字符分割 --&gt;</span>

<span class=p>&lt;</span><span class=nt>blog-post</span> <span class=na>post-title</span><span class=o>=</span><span class=s>&#34;hello!&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>blog-post</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=应用实例>应用实例</h3>
<p>每个 Vue 应用都是通过用 <code>createApp</code> 函数创建一个新的<strong>应用实例</strong>开始的：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
  <span class=cm>/* 选项 */</span>
<span class=p>})</span>
</code></pre></td></tr></table>
</div>
</div><p>该应用实例是用来在应用中注册“全局”组件的。简单的例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({})</span>
<span class=nx>app</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;SearchInput&#39;</span><span class=p>,</span> <span class=nx>SearchInputComponent</span><span class=p>)</span>
<span class=nx>app</span><span class=p>.</span><span class=nx>directive</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>FocusDirective</span><span class=p>)</span>
<span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>LocalePlugin</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>应用实例暴露的大多数方法都会返回该同一实例，允许链式：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({})</span>
  <span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;SearchInput&#39;</span><span class=p>,</span> <span class=nx>SearchInputComponent</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>directive</span><span class=p>(</span><span class=s1>&#39;focus&#39;</span><span class=p>,</span> <span class=nx>FocusDirective</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>LocalePlugin</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=根组件与挂载>根组件与挂载</h4>
<p>传递给 <code>createApp</code> 的选项用于配置<strong>根组件</strong>。当我们<strong>挂载</strong>应用时，该组件被用作渲染的起点。</p>
<p>一个应用需要被挂载到一个 DOM 元素中。例如，如果你想把一个 Vue 应用挂载到 <code>&lt;div id="app">&lt;/div></code>，应该传入 <code>#app</code>：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>RootComponent</span> <span class=o>=</span> <span class=p>{</span> 
  <span class=cm>/* 选项 */</span> 
<span class=p>}</span>
<span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>(</span><span class=nx>RootComponent</span><span class=p>)</span>
<span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>mount</code> 不返回应用本身，它返回的是根组件实例</p>
</blockquote>
<p>大多数的真实应用都是被组织成一个嵌套的、可重用的组件树。举个例子，一个 todo 应用组件树可能是这样的：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-text data-lang=text>Root Component
└─ TodoList
   ├─ TodoItem
   │  ├─ DeleteTodoButton
   │  └─ EditTodoButton
   └─ TodoListFooter
      ├─ ClearTodosButton
      └─ TodoListStatistics
</code></pre></td></tr></table>
</div>
</div><h4 id=组件实例-property>组件实例 property</h4>
<p>在 <code>data</code> 中定义的 property 是通过组件实例暴露的：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span><span class=o>:</span> <span class=mi>4</span> <span class=p>}</span>
  <span class=p>}</span>
<span class=p>})</span>

<span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>vm</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// =&gt; 4
</span></code></pre></td></tr></table>
</div>
</div><p>有各种其他的组件选项，可以将用户定义的 property 添加到组件实例中，例如 <code>methods</code>，<code>props</code>，<code>computed</code>，<code>inject</code> 和 <code>setup</code>。组件实例的所有 property，无论如何定义，都可以在组件的模板中访问。</p>
<p>Vue 还通过组件实例暴露了一些内置 property，如 <code>$attrs</code> 和 <code>$emit</code>。这些 property 都有一个 <code>$</code> 前缀，以避免与用户定义的 property 名冲突。</p>
<h4 id=生命周期钩子>生命周期钩子</h4>
<p>每个组件在被创建时都要经过一系列的初始化过程——例如，需要设置数据监听、编译模板、将实例挂载到 DOM 并在数据变化时更新 DOM 等。同时在这个过程中也会运行一些叫做<strong>生命周期钩子</strong>的函数，这给了用户在不同阶段添加自己的代码的机会。</p>
<p><img class=lazyload src=/svg/loading.min.svg data-src=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/lifecycle.svg data-srcset="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/lifecycle.svg, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/lifecycle.svg 1.5x, https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/lifecycle.svg 2x" data-sizes=auto alt=https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/lifecycle.svg title=实例的生命周期>生命周期钩子的 <code>this</code> 上下文指向调用它的当前活动实例。</p>
<blockquote>
<p>不要在选项 property 或回调上使用箭头函数，因为他们没有 <code>this</code></p>
</blockquote>
<h3 id=模板语法>模板语法</h3>
<p>部分内容详见 <a href=Frontend/%e6%a1%86%e6%9e%b6/Vue2.md rel>Vue2</a></p>
<h4 id=动态参数>动态参数</h4>
<p>也可以在指令参数中使用 JavaScript 表达式，方法是用方括号括起来：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!--
</span><span class=c>注意，参数表达式的写法存在一些约束，如之后的“对动态参数表达式的约束”章节所述。
</span><span class=c>--&gt;</span>
<span class=p>&lt;</span><span class=nt>a</span> <span class=na>v-bind:</span><span class=err>[</span><span class=na>attributeName</span><span class=err>]=&#34;</span><span class=na>url</span><span class=err>&#34;</span><span class=p>&gt;</span> ... <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>这里的 <code>attributeName</code> 会被作为一个 JavaScript 表达式进行动态求值，求得的值将会作为最终的参数来使用。</p>
<p>例如，如果你的组件实例有一个 data property 为 <code>attributeName</code>，其值为 <code>"href"</code>，那么这个绑定将等价于 <code>v-bind:href</code>。</p>
<p>同样地，你可以使用动态参数为一个动态的事件名绑定处理函数：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>a</span> <span class=na>v-on:</span><span class=err>[</span><span class=na>eventName</span><span class=err>]=&#34;</span><span class=na>doSomething</span><span class=err>&#34;</span><span class=p>&gt;</span> ... <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>在这个示例中，当 <code>eventName</code> 的值为 <code>"focus"</code> 时，<code>v-on:[eventName]</code> 将等价于 <code>v-on:focus</code></p>
<h4 id=对动态参数表达式约定>对动态参数表达式约定</h4>
<p>动态参数表达式有一些语法约束，因为某些字符，如空格和引号，放在 HTML attribute 名里是无效的。例如：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 这会触发一个编译警告 --&gt;</span>
<span class=p>&lt;</span><span class=nt>a</span> <span class=na>v-bind:</span><span class=err>[&#39;</span><span class=na>foo</span><span class=err>&#39;</span> <span class=err>+</span> <span class=na>bar</span><span class=err>]=&#34;</span><span class=na>value</span><span class=err>&#34;</span><span class=p>&gt;</span> ... <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>变通的办法是使用没有空格或引号的表达式，或用计算属性替代这种复杂表达式。</p>
<p>在 DOM 中使用模板时 (直接在一个 HTML 文件里撰写模板)，还需要避免使用大写字符来命名键名，因为浏览器会把 attribute 名全部强制转为小写：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!--
</span><span class=c>在 DOM 中使用模板时这段代码会被转换为 `v-bind:[someattr]`。
</span><span class=c>除非在实例中有一个名为“someattr”的 property，否则代码不会工作。
</span><span class=c>--&gt;</span>
<span class=p>&lt;</span><span class=nt>a</span> <span class=na>v-bind:</span><span class=err>[</span><span class=na>someAttr</span><span class=err>]=&#34;</span><span class=na>value</span><span class=err>&#34;</span><span class=p>&gt;</span> ... <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=修饰符>修饰符</h4>
<p>修饰符 (modifier) 是以半角句号 <code>.</code> 指明的特殊后缀，用于指出一个指令应该以特殊方式绑定。例如，<code>.prevent</code> 修饰符告诉 <code>v-on</code> 指令对于触发的事件调用 <code>event.preventDefault()</code>：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>form</span> <span class=na>v-on:submit</span><span class=err>.</span><span class=na>prevent</span><span class=o>=</span><span class=s>&#34;onSubmit&#34;</span><span class=p>&gt;</span>...<span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>在接下来对 <code>v-on</code> 和 <code>v-for</code>等功能的探索中，将会看到修饰符的其它例子</p>
<h3 id=data-property>Data Property</h3>
<p>组件的 <code>data</code> 选项是一个函数。Vue 会在创建新组件实例的过程中调用此函数。它应该返回一个对象，然后 Vue 会通过响应性系统将其包裹起来，并以 <code>$data</code> 的形式存储在组件实例中。为方便起见，该对象的任何顶级 property 也会直接通过组件实例暴露出来：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span><span class=o>:</span> <span class=mi>4</span> <span class=p>}</span>
  <span class=p>}</span>
<span class=p>})</span>

<span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>vm</span><span class=p>.</span><span class=nx>$data</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// =&gt; 4
</span><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>vm</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span>       <span class=c1>// =&gt; 4
</span><span class=c1></span>
<span class=c1>// 修改 vm.count 的值也会更新 $data.count
</span><span class=c1></span><span class=nx>vm</span><span class=p>.</span><span class=nx>count</span> <span class=o>=</span> <span class=mi>5</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>vm</span><span class=p>.</span><span class=nx>$data</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// =&gt; 5
</span><span class=c1></span>
<span class=c1>// 反之亦然
</span><span class=c1></span><span class=nx>vm</span><span class=p>.</span><span class=nx>$data</span><span class=p>.</span><span class=nx>count</span> <span class=o>=</span> <span class=mi>6</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>vm</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// =&gt; 6
</span></code></pre></td></tr></table>
</div>
</div><p>直接将不包含在 <code>data</code> 中的新 property 添加到组件实例是可行的。但由于该 property 不在背后的响应式 <code>$data</code> 对象内，所以 Vue 的响应性系统不会自动跟踪它。</p>
<p>Vue 使用 <code>$</code> 前缀通过组件实例暴露自己的内置 API。它还为内部 property 保留 <code>_</code> 前缀。你应该避免使用这两个字符开头的的顶级 <code>data</code> property 名称</p>
<h3 id=防抖和节流>防抖和节流</h3>
<p>Vue 没有内置支持防抖和节流，但可以使用 <a href=https://lodash.com/ target=_blank rel="noopener noreffer">Lodash</a> 等库来实现。</p>
<p>如果某个组件仅使用一次，可以在 <code>methods</code> 中直接应用防抖：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://unpkg.com/lodash@4.17.20/lodash.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
  <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
      <span class=c1>// 用 Lodash 的防抖函数
</span><span class=c1></span>      <span class=nx>click</span><span class=o>:</span> <span class=nx>_</span><span class=p>.</span><span class=nx>debounce</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// ... 响应点击 ...
</span><span class=c1></span>      <span class=p>},</span> <span class=mi>500</span><span class=p>)</span>
    <span class=p>}</span>
  <span class=p>}).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>但是，这种方法对于可复用组件有潜在的问题，因为它们都共享相同的防抖函数。为了使组件实例彼此独立，可以在生命周期钩子的 <code>created</code> 里添加该防抖函数:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>app</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;save-button&#39;</span><span class=p>,</span> <span class=p>{</span>
  <span class=nx>created</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>// 用 Lodash 的防抖函数
</span><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>debouncedClick</span> <span class=o>=</span> <span class=nx>_</span><span class=p>.</span><span class=nx>debounce</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>click</span><span class=p>,</span> <span class=mi>500</span><span class=p>)</span>
  <span class=p>},</span>
  <span class=nx>unmounted</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>// 移除组件时，取消定时器
</span><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>debouncedClick</span><span class=p>.</span><span class=nx>cancel</span><span class=p>()</span>
  <span class=p>},</span>
  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>click</span><span class=p>()</span> <span class=p>{</span>
      <span class=c1>// ... 响应点击 ...
</span><span class=c1></span>    <span class=p>}</span>
  <span class=p>},</span>
  <span class=nx>template</span><span class=o>:</span> <span class=sb>`
</span><span class=sb>    &lt;button @click=&#34;debouncedClick&#34;&gt;
</span><span class=sb>      Save
</span><span class=sb>    &lt;/button&gt;
</span><span class=sb>  `</span>
<span class=p>})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=计算属性的-setter>计算属性的 Setter</h3>
<p>计算属性默认只有 getter，不过在需要时你也可以提供一个 setter：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// ...
</span><span class=c1></span><span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>fullName</span><span class=o>:</span> <span class=p>{</span>
    <span class=c1>// getter
</span><span class=c1></span>    <span class=nx>get</span><span class=p>()</span> <span class=p>{</span>
      <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span>
    <span class=p>},</span>
    <span class=c1>// setter
</span><span class=c1></span>    <span class=nx>set</span><span class=p>(</span><span class=nx>newValue</span><span class=p>)</span> <span class=p>{</span>
      <span class=kr>const</span> <span class=nx>names</span> <span class=o>=</span> <span class=nx>newValue</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>=</span> <span class=nx>names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span> <span class=o>=</span> <span class=nx>names</span><span class=p>[</span><span class=nx>names</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
    <span class=p>}</span>
  <span class=p>}</span> 
<span class=p>}</span>
<span class=c1>// ...
</span></code></pre></td></tr></table>
</div>
</div><p>现在再运行 <code>vm.fullName = 'John Doe'</code> 时，setter 会被调用，<code>vm.firstName</code> 和 <code>vm.lastName</code> 也会相应地被更新。</p>
<h3 id=侦听器>侦听器</h3>
<p>虽然计算属性在大多数情况下更合适，但有时也需要一个自定义的侦听器。这就是为什么 Vue 通过 <code>watch</code> 选项提供了一个更通用的方法，来响应数据的变化。当需要在数据变化时执行异步或开销较大的操作时，这个方式是最有用的。</p>
<p>例如：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;watch-example&#34;</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
    Ask a yes/no question:
    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>v-model</span><span class=o>=</span><span class=s>&#34;question&#34;</span> <span class=p>/&gt;</span>
  <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>{{ answer }}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 因为 AJAX 库和通用工具的生态已经相当丰富，Vue 核心代码没有重复 --&gt;</span>
<span class=c>&lt;!-- 提供这些功能以保持精简。这也可以让你自由选择自己更熟悉的工具。 --&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
  <span class=kr>const</span> <span class=nx>watchExampleVM</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
      <span class=k>return</span> <span class=p>{</span>
        <span class=nx>question</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=nx>answer</span><span class=o>:</span> <span class=s1>&#39;Questions usually contain a question mark. ;-)&#39;</span>
      <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>watch</span><span class=o>:</span> <span class=p>{</span>
      <span class=c1>// whenever question changes, this function will run
</span><span class=c1></span>      <span class=nx>question</span><span class=p>(</span><span class=nx>newQuestion</span><span class=p>,</span> <span class=nx>oldQuestion</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=nx>newQuestion</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s1>&#39;?&#39;</span><span class=p>)</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
          <span class=k>this</span><span class=p>.</span><span class=nx>getAnswer</span><span class=p>()</span>
        <span class=p>}</span>
      <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>getAnswer</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>answer</span> <span class=o>=</span> <span class=s1>&#39;Thinking...&#39;</span>
        <span class=nx>axios</span>
          <span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://yesno.wtf/api&#39;</span><span class=p>)</span>
          <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=p>{</span>
            <span class=k>this</span><span class=p>.</span><span class=nx>answer</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>answer</span>
          <span class=p>})</span>
          <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=p>{</span>
            <span class=k>this</span><span class=p>.</span><span class=nx>answer</span> <span class=o>=</span> <span class=s1>&#39;Error! Could not reach the API. &#39;</span> <span class=o>+</span> <span class=nx>error</span>
          <span class=p>})</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>}).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#watch-example&#39;</span><span class=p>)</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>在这个示例中，使用 <code>watch</code> 选项允许我们执行异步操作 (访问一个 API)，限制我们执行该操作的频率，并在我们得到最终结果前，设置中间状态。这些都是计算属性无法做到的。</p>
<h3 id=计算属性-vs-侦听器>计算属性 vs 侦听器</h3>
<p>Vue 提供了一种更通用的方式来观察和响应当前活动的实例上的数据变动：<strong>侦听属性</strong>。当你有一些数据需要随着其它数据变动而变动时，<code>watch</code> 很容易被滥用——特别是如果你之前使用过 AngularJS。然而，通常更好的做法是使用计算属性而不是命令式的 <code>watch</code> 回调。细想一下这个例子：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;demo&#34;</span><span class=p>&gt;</span>{{ fullName }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>firstName</span><span class=o>:</span> <span class=s1>&#39;Foo&#39;</span><span class=p>,</span>
      <span class=nx>lastName</span><span class=o>:</span> <span class=s1>&#39;Bar&#39;</span><span class=p>,</span>
      <span class=nx>fullName</span><span class=o>:</span> <span class=s1>&#39;Foo Bar&#39;</span>
    <span class=p>}</span>
  <span class=p>},</span>
  <span class=nx>watch</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>firstName</span><span class=p>(</span><span class=nx>val</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>fullName</span> <span class=o>=</span> <span class=nx>val</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span>
    <span class=p>},</span>
    <span class=nx>lastName</span><span class=p>(</span><span class=nx>val</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>fullName</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=nx>val</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#demo&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>上面代码是命令式且重复的。将它与计算属性的版本进行比较：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>vm</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>firstName</span><span class=o>:</span> <span class=s1>&#39;Foo&#39;</span><span class=p>,</span>
      <span class=nx>lastName</span><span class=o>:</span> <span class=s1>&#39;Bar&#39;</span>
    <span class=p>}</span>
  <span class=p>},</span>
  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>fullName</span><span class=p>()</span> <span class=p>{</span>
      <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>firstName</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>lastName</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#demo&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>好很多了，不是吗？</p>
<h3 id=class-的对象语法>class 的对象语法</h3>
<h4 id=在模板里定义对象>在模板里定义对象</h4>
<p>我们可以传给 <code>:class</code> (<code>v-bind:class</code> 的简写) 一个对象，以动态地切换 class：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span>
  <span class=na>class</span><span class=o>=</span><span class=s>&#34;static&#34;</span>
  <span class=na>:class</span><span class=o>=</span><span class=s>&#34;{ active: isActive, &#39;text-danger&#39;: hasError }&#34;</span>
<span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>return</span> <span class=p>{</span>
    <span class=nx>isActive</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nx>hasError</span><span class=o>:</span> <span class=kc>false</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>渲染的结果为：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;static active&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=在-data-中定义对象>在 data 中定义对象</h4>
<p>绑定的数据对象不必内联定义在模板里</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>:class</span><span class=o>=</span><span class=s>&#34;classObject&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>return</span> <span class=p>{</span>
    <span class=nx>classObject</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>active</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=s1>&#39;text-danger&#39;</span><span class=o>:</span> <span class=kc>false</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=在计算属性里定义对象>在计算属性里定义对象</h4>
<p>我们也可以在这里绑定一个返回对象的计算属性。这是一个常用且强大的模式：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>:class</span><span class=o>=</span><span class=s>&#34;classObject&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>return</span> <span class=p>{</span>
    <span class=nx>isActive</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nx>error</span><span class=o>:</span> <span class=kc>null</span>
  <span class=p>}</span>
<span class=p>},</span>
<span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
  <span class=nx>classObject</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>active</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>isActive</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>error</span><span class=p>,</span>
      <span class=s1>&#39;text-danger&#39;</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>error</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=p>.</span><span class=nx>error</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=s1>&#39;fatal&#39;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>style</code> 也可以用：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>:style</span><span class=o>=</span><span class=s>&#34;styleObject&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>return</span> <span class=p>{</span>
    <span class=nx>styleObject</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>color</span><span class=o>:</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span>
      <span class=nx>fontSize</span><span class=o>:</span> <span class=s1>&#39;13px&#39;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=数组语法>数组语法</h4>
<p>我们也可以把一个数组传给 <code>:class</code>，以应用一个 class 列表：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>:class</span><span class=o>=</span><span class=s>&#34;[activeClass, errorClass]&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>return</span> <span class=p>{</span>
    <span class=nx>activeClass</span><span class=o>:</span> <span class=s1>&#39;active&#39;</span><span class=p>,</span>
    <span class=nx>errorClass</span><span class=o>:</span> <span class=s1>&#39;text-danger&#39;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>渲染的结果为：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;active text-danger&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>如果你想根据条件切换列表中的 class，可以使用三元表达式：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>:class</span><span class=o>=</span><span class=s>&#34;[isActive ? activeClass : &#39;&#39;, errorClass]&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>这样写将始终添加 <code>errorClass</code>，但是只有在 <code>isActive</code> 为 truthy 时才添加 <code>activeClass</code></p>
<p>不过，当有多个条件 class 时这样写有些繁琐。所以在数组语法中也可以使用对象语法：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>div</span> <span class=na>:class</span><span class=o>=</span><span class=s>&#34;[{ active: isActive }, errorClass]&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=关于-v-on>关于 <code>v-on</code></h3>
<h4 id=事件修饰符>事件修饰符</h4>
<p>Vue.js 为 <code>v-on</code> 提供了<strong>事件修饰符</strong>。之前提过，修饰符是由点开头的指令后缀来表示的。</p>
<ul>
<li><code>.stop</code></li>
<li><code>.prevent</code></li>
<li><code>.capture</code></li>
<li><code>.self</code></li>
<li><code>.once</code></li>
<li><code>.passive</code></li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 阻止单击事件继续传播 --&gt;</span>
<span class=p>&lt;</span><span class=nt>a</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>stop</span><span class=o>=</span><span class=s>&#34;doThis&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 提交事件不再重载页面 --&gt;</span>
<span class=p>&lt;</span><span class=nt>form</span> <span class=err>@</span><span class=na>submit</span><span class=err>.</span><span class=na>prevent</span><span class=o>=</span><span class=s>&#34;onSubmit&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 修饰符可以串联 --&gt;</span>
<span class=p>&lt;</span><span class=nt>a</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>stop</span><span class=err>.</span><span class=na>prevent</span><span class=o>=</span><span class=s>&#34;doThat&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 只有修饰符 --&gt;</span>
<span class=p>&lt;</span><span class=nt>form</span> <span class=err>@</span><span class=na>submit</span><span class=err>.</span><span class=na>prevent</span><span class=p>&gt;&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 添加事件监听器时使用事件捕获模式 --&gt;</span>
<span class=c>&lt;!-- 即内部元素触发的事件先在此处理，然后才交由内部元素进行处理 --&gt;</span>
<span class=p>&lt;</span><span class=nt>div</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>capture</span><span class=o>=</span><span class=s>&#34;doThis&#34;</span><span class=p>&gt;</span>...<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 只当在 event.target 是当前元素自身时触发处理函数 --&gt;</span>
<span class=c>&lt;!-- 即事件不是从内部元素触发的 --&gt;</span>
<span class=p>&lt;</span><span class=nt>div</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>self</span><span class=o>=</span><span class=s>&#34;doThat&#34;</span><span class=p>&gt;</span>...<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 点击事件将只会触发一次 --&gt;</span>
<span class=p>&lt;</span><span class=nt>a</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>once</span><span class=o>=</span><span class=s>&#34;doThis&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=按键修饰符>按键修饰符</h4>
<p>在监听键盘事件时，我们经常需要检查详细的按键。Vue 允许为 <code>v-on</code> 或者 <code>@</code> 在监听键盘事件时添加按键修饰符：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 只有在 `key` 是 `Enter` 时调用 `vm.submit()` --&gt;</span>
<span class=p>&lt;</span><span class=nt>input</span> <span class=err>@</span><span class=na>keyup</span><span class=err>.</span><span class=na>enter</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=p>/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>你可以直接将 <a href=https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values target=_blank rel="noopener noreffer"><code>KeyboardEvent.key</code></a> 暴露的任意有效按键名转换为 kebab-case 来作为修饰符。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>input</span> <span class=err>@</span><span class=na>keyup</span><span class=err>.</span><span class=na>page-down</span><span class=o>=</span><span class=s>&#34;onPageDown&#34;</span> <span class=p>/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>在上述示例中，处理函数只会在 <code>$event.key</code> 等于 <code>'PageDown'</code> 时被调用。</p>
<h5 id=按键别名>按键别名</h5>
<p>Vue 为最常用的键提供了别名：</p>
<ul>
<li><code>.enter</code></li>
<li><code>.tab</code></li>
<li><code>.delete</code> (捕获“删除”和“退格”键)</li>
<li><code>.esc</code></li>
<li><code>.space</code></li>
<li><code>.up</code></li>
<li><code>.down</code></li>
<li><code>.left</code></li>
<li><code>.right</code></li>
</ul>
<h5 id=系统修饰键>系统修饰键</h5>
<p>可以用如下修饰符来实现仅在按下相应按键时才触发鼠标或键盘事件的监听器。</p>
<ul>
<li><code>.ctrl</code></li>
<li><code>.alt</code></li>
<li><code>.shift</code></li>
<li><code>.meta</code></li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- Alt + Enter --&gt;</span>
<span class=p>&lt;</span><span class=nt>input</span> <span class=err>@</span><span class=na>keyup</span><span class=err>.</span><span class=na>alt</span><span class=err>.</span><span class=na>enter</span><span class=o>=</span><span class=s>&#34;clear&#34;</span> <span class=p>/&gt;</span>

<span class=c>&lt;!-- Ctrl + Click --&gt;</span>
<span class=p>&lt;</span><span class=nt>div</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>ctrl</span><span class=o>=</span><span class=s>&#34;doSomething&#34;</span><span class=p>&gt;</span>Do something<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=exact-修饰符><code>.exact</code> 修饰符</h5>
<p><code>.exact</code> 修饰符允许你控制由精确的系统修饰符组合触发的事件。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 即使 Alt 或 Shift 被一同按下时也会触发 --&gt;</span>
<span class=p>&lt;</span><span class=nt>button</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>ctrl</span><span class=o>=</span><span class=s>&#34;onClick&#34;</span><span class=p>&gt;</span>A<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 有且只有 Ctrl 被按下的时候才触发 --&gt;</span>
<span class=p>&lt;</span><span class=nt>button</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>ctrl</span><span class=err>.</span><span class=na>exact</span><span class=o>=</span><span class=s>&#34;onCtrlClick&#34;</span><span class=p>&gt;</span>A<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>

<span class=c>&lt;!-- 没有任何系统修饰符被按下的时候才触发 --&gt;</span>
<span class=p>&lt;</span><span class=nt>button</span> <span class=err>@</span><span class=na>click</span><span class=err>.</span><span class=na>exact</span><span class=o>=</span><span class=s>&#34;onClick&#34;</span><span class=p>&gt;</span>A<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=鼠标按钮修饰符>鼠标按钮修饰符</h5>
<ul>
<li><code>.left</code></li>
<li><code>.right</code></li>
<li><code>.middle</code></li>
</ul>
<p>这些修饰符会限制处理函数仅响应特定的鼠标按钮。</p>
<h3 id=关于-v-model>关于 <code>v-model</code></h3>
<h4 id=修饰符-1>修饰符</h4>
<h5 id=lazy><code>.lazy</code></h5>
<p>在默认情况下，<code>v-model</code> 在每次 <code>input</code> 事件触发后将输入框的值与数据进行同步 (除了输入法组织文字时)。你可以添加 <code>lazy</code> 修饰符，从而转为在 <code>change</code> 事件_之后_进行同步：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 在“change”时而非“input”时更新 --&gt;</span>
<span class=p>&lt;</span><span class=nt>input</span> <span class=na>v-model</span><span class=err>.</span><span class=na>lazy</span><span class=o>=</span><span class=s>&#34;msg&#34;</span> <span class=p>/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=number><code>.number</code></h5>
<p>如果想自动将用户的输入值转为数值类型，可以给 <code>v-model</code> 添加 <code>number</code> 修饰符：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>input</span> <span class=na>v-model</span><span class=err>.</span><span class=na>number</span><span class=o>=</span><span class=s>&#34;age&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=p>/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>这通常很有用，因为即使在 <code>type="number"</code> 时，HTML 输入元素的值也总会返回字符串。如果这个值无法被 <code>parseFloat()</code> 解析，则会返回原始的值。</p>
<h5 id=trim><code>.trim</code></h5>
<p>如果要自动过滤用户输入的首尾空白字符，可以给 <code>v-model</code> 添加 <code>trim</code> 修饰符：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>input</span> <span class=na>v-model</span><span class=err>.</span><span class=na>trim</span><span class=o>=</span><span class=s>&#34;msg&#34;</span> <span class=p>/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=composition-api>Composition API</h2>
<h3 id=结构示例>结构示例</h3>
<h4 id=optionapi>optionAPI</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
  <span class=nx>components</span><span class=o>:</span> <span class=p>{},</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>{},</span>
  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>{}</span>
  <span class=p>},</span>
  <span class=nx>watch</span><span class=o>:</span> <span class=p>{},</span>
  <span class=nx>created</span><span class=p>()</span> <span class=p>{},</span>
  <span class=nx>mounted</span><span class=p>()</span> <span class=p>{},</span>
  <span class=nx>methods</span><span class=o>:</span> <span class=p>{}</span>
<span class=p>}</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>style</span>  <span class=na>lang</span><span class=o>=</span><span class=s>&#34;scss&#34;</span> <span class=na>scoped</span><span class=p>&gt;&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=compositionapi>CompositionAPI</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;ts&#34;</span><span class=p>&gt;</span>
  <span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>onMounted</span><span class=p>,</span> <span class=nx>reactive</span><span class=p>,</span> <span class=nx>UnwrapRef</span><span class=p>,</span> <span class=nx>watch</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>

  <span class=kr>interface</span> <span class=nx>State</span> <span class=p>{}</span>
  <span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;components name&#39;</span><span class=p>,</span>
    <span class=nx>props</span><span class=o>:</span> <span class=p>{},</span>
    <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;props: &#39;</span><span class=p>,</span> <span class=nx>props</span><span class=p>);</span>
      <span class=c1>//data
</span><span class=c1></span>      <span class=kr>const</span> <span class=nx>state</span><span class=o>:</span> <span class=nx>UnwrapRef</span><span class=p>&lt;</span><span class=nt>State</span><span class=p>&gt;</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({});</span>

      <span class=c1>//Lifecycle Hooks
</span><span class=c1></span>      <span class=nx>onMounted</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{});</span>
      <span class=c1>//watch
</span><span class=c1></span>      <span class=nx>watch</span><span class=p>(</span>
        <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>props</span><span class=p>,</span>
        <span class=p>(</span><span class=nx>_count</span><span class=p>,</span> <span class=nx>_prevCount</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{},</span>
        <span class=p>{</span>
          <span class=nx>deep</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
          <span class=nx>immediate</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
        <span class=p>}</span>
      <span class=p>);</span>
      <span class=c1>//methods
</span><span class=c1></span>      <span class=kr>const</span> <span class=nx>getList</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{};</span>
      
      <span class=k>return</span> <span class=p>{</span>
        <span class=nx>state</span><span class=p>,</span>
        <span class=nx>getList</span>
      <span class=p>};</span>
    <span class=p>},</span>
  <span class=p>});</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>style</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;scss&#34;</span> <span class=na>scoped</span><span class=p>&gt;&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>（组合式 API）</p>
<p>一些基础性的总结：https://juejin.cn/post/7008063765585330207</p>
<p><a href=https://segmentfault.com/a/1190000040319089 target=_blank rel="noopener noreffer">https://segmentfault.com/a/1190000040319089</a></p>
<p><a href=https://www.jianshu.com/p/5996f611c990 target=_blank rel="noopener noreffer">https://www.jianshu.com/p/5996f611c990</a></p>
<p><img class=lazyload src=/svg/loading.min.svg data-src="https://pic1.zhimg.com/80/v2-b72736d77cfceecc80a2b1497c649e54_1440w.jpg?source=1940ef5c" data-srcset="https://pic1.zhimg.com/80/v2-b72736d77cfceecc80a2b1497c649e54_1440w.jpg?source=1940ef5c, https://pic1.zhimg.com/80/v2-b72736d77cfceecc80a2b1497c649e54_1440w.jpg?source=1940ef5c 1.5x, https://pic1.zhimg.com/80/v2-b72736d77cfceecc80a2b1497c649e54_1440w.jpg?source=1940ef5c 2x" data-sizes=auto alt="https://pic1.zhimg.com/80/v2-b72736d77cfceecc80a2b1497c649e54_1440w.jpg?source=1940ef5c" title=img></p>
<h3 id=setup>setup</h3>
<p><code>setup</code> 是一个组件选项，所以像别的组件选项一样，写在组件导出的对象里。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;script&gt;</span>
  export default {
    name: &#34;App&#34;,
    setup() {
      // ...

      return {
        // ...
      }
    },
  }
<span class=nt>&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ol>
<li><code>setup</code> 选项应该为一个函数</li>
<li><code>setup</code> 选项函数接受两个参数： <code>props</code> 和 <code>context</code></li>
<li><code>setup</code> 选项函数需要返回要暴露给组件的内容</li>
</ol>
<h4 id=参数>参数</h4>
<h5 id=props>props</h5>
<p>正如在一个标准组件中所期望的那样，<code>setup</code> 函数中的 <code>props</code> 是响应式的，当传入新的 prop 时，它将被更新。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=c1>// MyBook.vue
</span><span class=c1></span>
<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>title</span><span class=o>:</span> <span class=nb>String</span>
  <span class=p>},</span>
  <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>props</span><span class=p>.</span><span class=nx>title</span><span class=p>)</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>但是，因为 <code>props</code> 是响应式的，你<strong>不能使用 ES6 解构</strong>，因为它会消除 prop 的响应性。
如果需要解构 prop，可以通过使用 <code>setup</code> 函数中的 <code>toRefs</code> 来安全地完成此操作。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=kr>import</span> <span class=p>{</span> <span class=nx>toRefs</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>

<span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=p>{</span> <span class=nx>title</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>toRefs</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span>

    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>title</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=context>context</h5>
<p><code>context</code> 上下文是一个普通的 JavaScript 对象，它暴露三个组件的 property：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=c1>// MyBook.vue
</span><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>,</span> <span class=nx>context</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Attribute (非响应式对象)
</span><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>attrs</span><span class=p>)</span>

    <span class=c1>// 插槽 (非响应式对象)
</span><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>slots</span><span class=p>)</span>

    <span class=c1>// 触发事件 (方法)
</span><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>emit</span><span class=p>)</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>context</code> 是一个普通的 JavaScript 对象，也就是说，它不是响应式的，这意味着你可以安全地对 <code>context</code> 使用 ES6 解构。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=c1>// MyBook.vue
</span><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>,</span> <span class=p>{</span> <span class=nx>attrs</span><span class=p>,</span> <span class=nx>slots</span><span class=p>,</span> <span class=nx>emit</span> <span class=p>})</span> <span class=p>{</span>
    <span class=p>...</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>attrs</code> 和 <code>slots</code> 是有状态的对象，它们总是会随组件本身的更新而更新。这意味着你应该避免对它们进行解构，并始终以 <code>attrs.x</code> 或 <code>slots.x</code> 的方式引用 property。请注意，与 <code>props</code> 不同，<code>attrs</code> 和 <code>slots</code> 是非响应式的。如果你打算根据 <code>attrs</code> 或 <code>slots</code> 更改应用副作用，那么应该在 <code>onUpdated</code> 生命周期钩子中执行此操作。</p>
<h4 id=返回值>返回值</h4>
<h5 id=对象>对象</h5>
<p>如果 <code>setup</code> 返回一个对象，则可以在组件的模板中像传递给 <code>setup</code> 的 <code>props</code> property 一样访问该对象的 property：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- MyBook.vue --&gt;</span>
<span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=c>&lt;!-- 模板中使用会被自动解开，所以不需要 .value  --&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>{{ readersNumber }} {{ book.title }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
  <span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>reactive</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>

  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
    <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
      <span class=kr>const</span> <span class=nx>readersNumber</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
      <span class=kr>const</span> <span class=nx>book</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span> <span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;Vue 3 Guide&#39;</span> <span class=p>})</span>

      <span class=c1>// expose to template
</span><span class=c1></span>      <span class=k>return</span> <span class=p>{</span>
        <span class=nx>readersNumber</span><span class=p>,</span>
        <span class=nx>book</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意，从 <code>setup</code> 返回的 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fvue3js.cn%2Fdocs%2Fzh%2Fapi%2Frefs-api.html%23ref" target=_blank rel="noopener noreffer">refs</a> 在模板中访问时是<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fvue3js.cn%2Fdocs%2Fzh%2Fguide%2Freactivity-fundamentals.html%23ref-%E8%A7%A3%E5%BC%80" target=_blank rel="noopener noreffer">被自动解开</a>的，因此不应在模板中使用 <code>.value</code>。</p>
</blockquote>
<h5 id=渲染函数>渲染函数</h5>
<p><code>setup</code> 还可以返回一个渲染函数，该函数可以直接使用在同一作用域中声明的响应式状态：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=c1>// MyBook.vue
</span><span class=c1></span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>reactive</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>readersNumber</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
    <span class=kr>const</span> <span class=nx>book</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span> <span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;Vue 3 Guide&#39;</span> <span class=p>})</span>
    <span class=c1>// Please note that we need to explicitly expose ref value here
</span><span class=c1></span>    <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>h</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>readersNumber</span><span class=p>.</span><span class=nx>value</span><span class=p>,</span> <span class=nx>book</span><span class=p>.</span><span class=nx>title</span><span class=p>])</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>新的 <code>setup</code> 组件选项在<strong>创建组件之前</strong>执行，一旦 <code>props</code> 被解析，并充当合成 API 的入口点。</p>
<h4 id=不用-this>不用 this</h4>
<p>在 <code>setup()</code> 内部，<code>this</code> 不会是该活跃实例的引用，因为 <code>setup()</code> 是在解析其它组件选项之前被调用的，所以 <code>setup()</code> 内部的 <code>this</code> 的行为与其它选项中的 <code>this</code> 完全不同。这在和其它选项式 API 一起使用 <code>setup()</code> 时可能会导致混淆。</p>
<h3 id=ref-与-reactive>ref 与 reactive</h3>
<p>reactive 和 ref 都是用来定义响应式数据的</p>
<p>reactive 更推荐去定义复杂的数据类型，ref 更推荐定义基本类型</p>
<p>可以简单的理解为：ref 是对 reactive 的二次包装，ref 定义的数据访问的时候要多一个 <code>.value</code></p>
<blockquote>
<p>toRefs API 提供了一个方法可以把 reactive 的值处理为 ref</p>
</blockquote>
<h4 id=reactive>reactive</h4>
<p><code>reactive()</code> 接收一个普通对象然后返回该普通对象的响应式代理。等同于 2.x 的 <code>Vue.observable()</code></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>obj</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span> <span class=nx>count</span>: <span class=kt>0</span> <span class=p>})</span>
</code></pre></td></tr></table>
</div>
</div><p>响应式转换是“深层的”：会影响对象内部所有嵌套的属性。基于 ES2015 的 Proxy 实现，返回的代理对象<strong>不等于</strong>原始对象。建议仅使用代理对象而避免依赖原始对象。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>{ state.count }<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>reactive</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>// state 现在是一个响应式的状态
</span><span class=c1></span>    <span class=kr>const</span> <span class=nx>state</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span>
      <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
    <span class=p>})</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=ref>ref</h4>
<p>接受一个参数值并返回一个响应式且可改变的 ref 对象。ref 对象拥有一个指向内部值的单一属性 <code>.value</code></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=c1>// 0
</span><span class=c1></span>
<span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=o>++</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=c1>// 1
</span></code></pre></td></tr></table>
</div>
</div><p>如果传入 ref 的是一个对象，将调用 <code>reactive</code> 方法进行深层响应转换。</p>
<h5 id=模板中访问><strong>模板中访问</strong></h5>
<p>当 ref 作为渲染上下文的属性返回（即在<code>setup()</code> 返回的对象中）并在模板中使用时，它会自动解套，无需在模板内额外书写 <code>.value</code>：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>{{ count }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
    <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
      <span class=k>return</span> <span class=p>{</span>
        <span class=nx>count</span><span class=o>:</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span>
      <span class=p>}</span>
    <span class=p>},</span>
  <span class=p>}</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=作为响应式对象的属性访问><strong>作为响应式对象的属性访问</strong></h5>
<p>当 ref 作为 reactive 对象的 property 被访问或修改时，也将自动解套 value 值，其行为类似普通属性：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=kr>const</span> <span class=nx>state</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span>
  <span class=nx>count</span><span class=p>,</span>
<span class=p>})</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>state</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// 0
</span><span class=c1></span>
<span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>=</span> <span class=mi>1</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=c1>// 1
</span></code></pre></td></tr></table>
</div>
</div><p>注意如果将一个新的 ref 分配给现有的 ref， 将替换旧的 ref：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>otherCount</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>

<span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>=</span> <span class=nx>otherCount</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>state</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span> <span class=c1>// 2
</span><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=c1>// 1
</span></code></pre></td></tr></table>
</div>
</div><p>注意当嵌套在 reactive <code>Object</code> 中时，ref 才会解套。从 <code>Array</code> 或者 <code>Map</code> 等原生集合类中访问 ref 时，不会自动解套：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>arr</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>([</span><span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)])</span>
<span class=c1>// 这里需要 .value
</span><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>arr</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>value</span><span class=p>)</span>

<span class=kr>const</span> <span class=nx>map</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>(</span><span class=k>new</span> <span class=nx>Map</span><span class=p>([[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)]]))</span>
<span class=c1>// 这里需要 .value
</span><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>map</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>).</span><span class=nx>value</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=类型定义><strong>类型定义</strong></h5>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>interface</span> <span class=nx>Ref</span><span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> <span class=p>{</span>
  <span class=nx>value</span>: <span class=kt>T</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>ref</span><span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;(</span><span class=nx>value</span>: <span class=kt>T</span><span class=p>)</span><span class=o>:</span> <span class=nx>Ref</span><span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>有时我们可能需要为 ref 做一个较为复杂的类型标注。我们可以通过在调用 <code>ref</code> 时传递泛型参数来覆盖默认推导：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>const</span> <span class=nx>foo</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>&lt;</span><span class=nt>string</span> <span class=err>|</span> <span class=na>number</span><span class=p>&gt;(</span><span class=s1>&#39;foo&#39;</span><span class=p>)</span> <span class=c1>// foo 的类型: Ref&lt;string | number&gt;
</span><span class=c1></span>
<span class=nx>foo</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=mi>123</span> <span class=c1>// 能够通过！
</span></code></pre></td></tr></table>
</div>
</div><h4 id=例>例</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;{{</span><span class=nx>count</span><span class=p>}}</span>
    <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;changeCount&#34;</span><span class=p>&gt;</span><span class=na>添加</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>学生的姓名是</span><span class=o>:</span><span class=p>{{</span><span class=nx>student</span><span class=p>.</span><span class=nx>name</span><span class=p>}}&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>学生的年龄是</span><span class=o>:</span><span class=p>{{</span><span class=nx>student</span><span class=p>.</span><span class=nx>age</span><span class=p>}}</span>
    <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;changeStudentAge(20)&#34;</span><span class=p>&gt;</span><span class=na>添加</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;ts&#34;</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>reactive</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Home&#39;</span><span class=p>,</span>
  <span class=nx>setup</span> <span class=p>()</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
    <span class=kr>const</span> <span class=nx>changeCount</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>count</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>count</span><span class=p>.</span><span class=nx>value</span> <span class=o>+</span> <span class=mi>1</span>
    <span class=p>}</span>
    <span class=kr>const</span> <span class=nx>student</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span>
      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span>
      <span class=nx>age</span><span class=o>:</span> <span class=mi>12</span>
    <span class=p>})</span>
    <span class=kr>const</span> <span class=nx>changeStudentAge</span> <span class=o>=</span> <span class=p>(</span><span class=nx>age</span><span class=o>:</span> <span class=nx>number</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>student</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=nx>age</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>count</span><span class=p>,</span>
      <span class=nx>changeCount</span><span class=p>,</span>
      <span class=nx>student</span><span class=p>,</span>
      <span class=nx>changeStudentAge</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>});</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=computed>computed</h3>
<p>使用响应式 <code>computed</code> API 有两种方式：</p>
<ol>
<li>传入一个 getter 函数，返回一个默认不可手动修改的 ref 对象。</li>
</ol>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=k>const</span> <span class=n>count</span> <span class=p>=</span> <span class=k>ref</span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
<span class=k>const</span> <span class=n>plusOne</span> <span class=p>=</span> <span class=n>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=n>count</span><span class=p>.</span><span class=k>value</span> <span class=p>+</span> <span class=m>1</span><span class=p>)</span>

<span class=n>console</span><span class=p>.</span><span class=n>log</span><span class=p>(</span><span class=n>plusOne</span><span class=p>.</span><span class=k>value</span><span class=p>)</span> <span class=c1>// 2
</span><span class=c1></span>
<span class=n>plusOne</span><span class=p>.</span><span class=k>value</span><span class=p>++</span> <span class=c1>// 错误！
</span></code></pre></td></tr></table>
</div>
</div><ol start=2>
<li>传入一个拥有 <code>get</code> 和 <code>set</code> 函数的对象，创建一个可手动修改的计算状态。</li>
</ol>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=k>const</span> <span class=n>count</span> <span class=p>=</span> <span class=k>ref</span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
<span class=k>const</span> <span class=n>plusOne</span> <span class=p>=</span> <span class=n>computed</span><span class=p>({</span>
  <span class=k>get</span><span class=p>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=n>count</span><span class=p>.</span><span class=k>value</span> <span class=p>+</span> <span class=m>1</span><span class=p>,</span>
  <span class=k>set</span><span class=p>:</span> <span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=n>count</span><span class=p>.</span><span class=k>value</span> <span class=p>=</span> <span class=n>val</span> <span class=p>-</span> <span class=m>1</span>
  <span class=p>},</span>
<span class=p>})</span>

<span class=n>plusOne</span><span class=p>.</span><span class=k>value</span> <span class=p>=</span> <span class=m>1</span>
<span class=n>console</span><span class=p>.</span><span class=n>log</span><span class=p>(</span><span class=n>count</span><span class=p>.</span><span class=k>value</span><span class=p>)</span> <span class=c1>// 0
</span></code></pre></td></tr></table>
</div>
</div><h3 id=watch>watch</h3>
<ul>
<li>
<p>引入 watch， <code>import { watch } from 'vue'</code></p>
</li>
<li>
<p>直接使用watch，watch 接受 3 个参数</p>
<ol>
<li>
<p>要监听更新的响应式引用或者 getter 函数</p>
</li>
<li>
<p>一个回调用来做更新后的操作</p>
</li>
<li>
<p>可选配置项</p>
</li>
</ol>
</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts> <span class=nx>setup() {</span>
     <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
     <span class=c1>//监听count
</span><span class=c1></span>     <span class=nx>watch</span><span class=p>(</span>
         <span class=p>()</span> <span class=o>=</span> <span class=o>&gt;</span> <span class=nx>count</span><span class=p>,</span> <span class=p>(</span><span class=nx>_count</span><span class=p>,</span> <span class=nx>_prevCount</span><span class=p>)</span> <span class=o>=</span> <span class=o>&gt;</span> <span class=p>{},</span> <span class=p>{</span>
             <span class=nx>deep</span>: <span class=kt>true</span><span class=p>,</span>
             <span class=nx>immediate</span>: <span class=kt>true</span>
         <span class=p>}</span>
     <span class=p>);</span>
 <span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;{{</span><span class=nx>count</span><span class=p>}}&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;{{</span><span class=nx>doubleCount</span><span class=p>}}&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;addCount&#34;</span><span class=p>&gt;</span><span class=na>添加</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;ts&#34;</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>computed</span><span class=p>,</span> <span class=nx>watchEffect</span><span class=p>,</span> <span class=nx>watch</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;App&#39;</span><span class=p>,</span>
  <span class=nx>setup</span> <span class=p>()</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
    <span class=nx>watch</span><span class=p>(</span><span class=nx>count</span><span class=p>,</span> <span class=p>(</span><span class=nx>newValue</span><span class=p>,</span> <span class=nx>oldValue</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=c1>// 如多个则用数组的方式传入[count, count1]
</span><span class=c1></span>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`newValue为：</span><span class=si>${</span><span class=nx>newValue</span><span class=si>}</span><span class=sb>,--------oldValue为：</span><span class=si>${</span><span class=nx>oldValue</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
    <span class=p>})</span>
    <span class=nx>watchEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;watchEffect&#39;</span><span class=p>,</span> <span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span>
    <span class=p>})</span>
    <span class=kr>const</span> <span class=nx>addCount</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>count</span><span class=p>.</span><span class=nx>value</span><span class=o>++</span>
    <span class=p>}</span>
    <span class=kr>const</span> <span class=nx>doubleCount</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=k>return</span> <span class=nx>count</span><span class=p>.</span><span class=nx>value</span> <span class=o>*</span> <span class=mi>2</span>
    <span class=p>})</span>
    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>count</span><span class=p>,</span>
      <span class=nx>doubleCount</span><span class=p>,</span>
      <span class=nx>addCount</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>});</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=propsemit>props/$emit</h3>
<p>父子组件传值的写法</p>
<ul>
<li>父组件</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-elixir data-lang=elixir><span class=o>&lt;</span><span class=nc>Search</span> <span class=na>@searchData</span><span class=o>=</span><span class=s2>&#34;searchData&#34;</span> <span class=ss>:quaryParams</span><span class=o>=</span><span class=s2>&#34;quaryParams&#34;</span><span class=o>/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>父组件的写法和<code>vue</code>还是一样的，只是子组件需要作一些改变</p>
<ul>
<li>子组件</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=p>&lt;</span><span class=nt>script</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;ts&#34;</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>
<span class=kr>interface</span> <span class=nx>GetUserListParams</span> <span class=p>{</span>
    <span class=nx>pageNum</span>: <span class=kt>number</span><span class=p>;</span>
    <span class=nx>pageSize</span>: <span class=kt>number</span><span class=p>;</span>
    <span class=nx>roleName</span>: <span class=kt>string</span><span class=p>;</span>
<span class=p>}</span>
<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Search&#39;</span><span class=p>,</span>
    <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>quaryParams</span><span class=o>:</span> <span class=p>{</span>
            <span class=kr>type</span><span class=o>:</span> <span class=nb>Object</span> <span class=kr>as</span> <span class=nx>PropType</span><span class=p>&lt;</span><span class=nt>GetUserListParams</span><span class=p>&gt;</span> <span class=p>,</span>
            <span class=k>default</span><span class=o>:</span> <span class=p>()</span> <span class=o>=</span> <span class=o>&gt;</span> <span class=p>({</span>
                <span class=nx>pageNum</span>: <span class=kt>1</span><span class=p>,</span>
                <span class=nx>pageSize</span>: <span class=kt>10</span><span class=p>,</span>
                <span class=nx>roleName</span><span class=o>:</span> <span class=s1>&#39;&#39;</span>
            <span class=p>})</span>
        <span class=p>}</span>
    <span class=p>},</span>
    <span class=nx>emits</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;searchData&#39;</span><span class=p>],</span><span class=c1>//需要声明emits
</span><span class=c1></span>    <span class=nx>setup</span><span class=p>(</span><span class=nx>_props</span><span class=p>,</span> <span class=nx>context</span><span class=p>)</span> <span class=p>{</span>
    
      <span class=kr>const</span> <span class=nx>onSubmit</span> <span class=o>=</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
        <span class=nx>context</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s1>&#39;searchData&#39;</span><span class=p>,</span> <span class=s2>&#34;我是子节点传递给父节点的值&#34;</span><span class=p>);</span>
      <span class=p>}</span>
      
      <span class=k>return</span> <span class=p>{</span>
        <span class=nx>getData</span>
      <span class=p>}</span>
    <span class=p>}</span>
<span class=p>});</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=跨组件传值>跨组件传值</h3>
<p>在 <code>Vue 2</code> 中，我们可以使用 <code>Provide/Inject</code> 跨组件传值，在 Vue 3 中也可以。</p>
<p>在 <code>setup</code> 中 使用，必须从 <code>vue</code> 中导入使用。</p>
<p>使用 <code>Provide</code> 时，一般设置为 响应式更新的，这样的话，父组件变更，子组件，子孙组件也跟着更新。</p>
<h4 id=怎么设置为响应式更新呢>怎么设置为响应式更新呢？</h4>
<blockquote>
<ol>
<li>使用 <code>ref</code> / <code>reactive</code> 创建响应式变量</li>
<li>使用 <code>provide('name', '要传递的响应式变量')</code></li>
<li>最后添加一个更新 响应式变量的事件，这样响应式变量更新，<code> provide</code> 中的变量也跟着更新</li>
</ol>
</blockquote>
<h4 id=父组件>父组件</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  
  <span class=p>&lt;</span><span class=nt>Son</span><span class=p>/&gt;</span>
  
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>


<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=kr>import</span> <span class=p>{</span> <span class=nx>provide</span><span class=p>,</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>reactive</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;vue&#34;</span><span class=p>;</span>
    <span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
    <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
            <span class=kr>const</span> <span class=nx>father</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s2>&#34;我父组件&#34;</span><span class=p>);</span>
    <span class=kr>const</span> <span class=nx>info</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span>
      <span class=nx>id</span><span class=o>:</span> <span class=mi>23</span><span class=p>,</span>
      <span class=nx>message</span><span class=o>:</span> <span class=s2>&#34;前端自学社区&#34;</span><span class=p>,</span>
    <span class=p>});</span>
    <span class=kd>function</span> <span class=nx>changeProvide</span><span class=p>(){</span>
      <span class=nx>info</span><span class=p>.</span><span class=nx>message</span> <span class=o>=</span> <span class=s1>&#39;测试&#39;</span>
    <span class=p>}</span>
    <span class=nx>provide</span><span class=p>(</span><span class=s1>&#39;father&#39;</span><span class=p>,</span><span class=nx>father</span><span class=p>)</span>
    <span class=nx>provide</span><span class=p>(</span><span class=s1>&#39;info&#39;</span><span class=p>,</span><span class=nx>info</span><span class=p>)</span>
    <span class=k>return</span> <span class=p>{</span><span class=nx>changeProvide</span><span class=p>};</span>
    <span class=p>}</span>
    
<span class=p>})</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=子组件>子组件</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;{{</span><span class=nx>info</span><span class=p>.</span><span class=nx>message</span><span class=p>}}&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;{{</span><span class=nx>fatherData</span><span class=p>}}&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span><span class=nx>provide</span><span class=p>,</span> <span class=nx>defineComponent</span><span class=p>,</span><span class=nx>ref</span><span class=p>,</span><span class=nx>reactive</span><span class=p>,</span> <span class=nx>inject</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
    <span class=nx>setup</span> <span class=p>()</span> <span class=p>{</span>
        <span class=kr>const</span> <span class=nx>fatherData</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=s1>&#39;father&#39;</span><span class=p>)</span>
        <span class=kr>const</span> <span class=nx>info</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=s1>&#39;info&#39;</span><span class=p>)</span>
        
        <span class=k>return</span> <span class=p>{</span><span class=nx>fatherData</span><span class=p>,</span><span class=nx>info</span><span class=p>}</span>
    <span class=p>}</span>
<span class=p>})</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=模块化>模块化</h3>
<p>往往是把一个功能的所有状态、方法、都封装到一个函数里面，方便统一管理</p>
<p>将相关功能提取到一个独立的组合式函数中</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// src/composables/useUserRepositories.js
</span><span class=c1></span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>fetchUserRepositories</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@/api/repositories&#39;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>onMounted</span><span class=p>,</span> <span class=nx>watch</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>useUserRepositories</span><span class=p>(</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
  <span class=kr>const</span> <span class=nx>repositories</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>([])</span>
  <span class=kr>const</span> <span class=nx>getUserRepositories</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=nx>repositories</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchUserRepositories</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span>
  <span class=p>}</span>

  <span class=nx>onMounted</span><span class=p>(</span><span class=nx>getUserRepositories</span><span class=p>)</span>
  <span class=nx>watch</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=nx>getUserRepositories</span><span class=p>)</span>

  <span class=k>return</span> <span class=p>{</span>
    <span class=nx>repositories</span><span class=p>,</span>
    <span class=nx>getUserRepositories</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>当我们哪个功能需要再其他组件被复用的时候，直接把相关的方法提取出去，然后再引用进来就可以了</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=c1>// src/components/UserRepositories.vue
</span><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>toRefs</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>import</span> <span class=nx>useUserRepositories</span> <span class=nx>from</span> <span class=s1>&#39;@/composables/useUserRepositories&#39;</span>
<span class=kr>import</span> <span class=nx>useRepositoryNameSearch</span> <span class=nx>from</span> <span class=s1>&#39;@/composables/useRepositoryNameSearch&#39;</span>
<span class=kr>import</span> <span class=nx>useRepositoryFilters</span> <span class=nx>from</span> <span class=s1>&#39;@/composables/useRepositoryFilters&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>components</span><span class=o>:</span> <span class=p>{</span> <span class=nx>RepositoriesFilters</span><span class=p>,</span> <span class=nx>RepositoriesSortBy</span><span class=p>,</span> <span class=nx>RepositoriesList</span> <span class=p>},</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>user</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>type</span><span class=o>:</span> <span class=nb>String</span><span class=p>,</span>
      <span class=nx>required</span><span class=o>:</span> <span class=kc>true</span>
    <span class=p>}</span>
  <span class=p>},</span>
  <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=p>{</span> <span class=nx>user</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>toRefs</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span>

    <span class=kr>const</span> <span class=p>{</span> <span class=nx>repositories</span><span class=p>,</span> <span class=nx>getUserRepositories</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useUserRepositories</span><span class=p>(</span><span class=nx>user</span><span class=p>)</span>

    <span class=kr>const</span> <span class=p>{</span>
      <span class=nx>searchQuery</span><span class=p>,</span>
      <span class=nx>repositoriesMatchingSearchQuery</span>
    <span class=p>}</span> <span class=o>=</span> <span class=nx>useRepositoryNameSearch</span><span class=p>(</span><span class=nx>repositories</span><span class=p>)</span>

    <span class=kr>const</span> <span class=p>{</span>
      <span class=nx>filters</span><span class=p>,</span>
      <span class=nx>updateFilters</span><span class=p>,</span>
      <span class=nx>filteredRepositories</span>
    <span class=p>}</span> <span class=o>=</span> <span class=nx>useRepositoryFilters</span><span class=p>(</span><span class=nx>repositoriesMatchingSearchQuery</span><span class=p>)</span>

    <span class=k>return</span> <span class=p>{</span>
      <span class=c1>// 因为我们并不关心未经过滤的仓库
</span><span class=c1></span>      <span class=c1>// 我们可以在 `repositories` 名称下暴露过滤后的结果
</span><span class=c1></span>      <span class=nx>repositories</span><span class=o>:</span> <span class=nx>filteredRepositories</span><span class=p>,</span>
      <span class=nx>getUserRepositories</span><span class=p>,</span>
      <span class=nx>searchQuery</span><span class=p>,</span>
      <span class=nx>filters</span><span class=p>,</span>
      <span class=nx>updateFilters</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=definecomponent>defineComponent</h3>
<p>最主要的功能是为了 ts 下的类型推导</p>
<p>如果我们直接写</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>export</span> <span class=k>default</span> <span class=p>{}</span>
</code></pre></td></tr></table>
</div>
</div><p>这个时候，对于编辑器而言，{} 只是一个 Object 的类型，无法有针对性的提示我们对于 vue 组件来说 {} 里应该有哪些属性。但是增加一层 defineComponet 的话，</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({})</span>
</code></pre></td></tr></table>
</div>
</div><p>这时，{} 就变成了 defineComponent 的参数，那么对参数类型的提示，就可以实现对 {} 中属性的提示，外还可以进行对参数的一些类型推导等操作。</p>
<h3 id=与-ts-的结合>与 TS 的结合</h3>
<h4 id=接口约束约束属性>接口约束约束属性</h4>
<blockquote>
<p>采用 <code>TypeScirpt</code> 的特性， 类型断言 + 接口 完美的对 属性进行了 约束</p>
</blockquote>
<h5 id=interface><code>interface</code></h5>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=nx>分页查询</span> <span class=nx>字段属性类型验证</span>
<span class=kr>export</span> <span class=k>default</span>  <span class=kr>interface</span> <span class=nx>queryType</span><span class=p>{</span>
    <span class=nx>page</span><span class=o>:</span> <span class=nb>Number</span><span class=p>,</span>
    <span class=nx>size</span><span class=o>:</span> <span class=nb>Number</span><span class=p>,</span>
    <span class=nx>name</span><span class=o>:</span> <span class=nb>String</span><span class=p>,</span>
    <span class=nx>age</span><span class=o>:</span>  <span class=nb>Number</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=组件中使用>组件中使用</h5>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=kr>import</span> <span class=nx>queryType</span> <span class=kr>from</span> <span class=s1>&#39;../interface/Home&#39;</span>


    <span class=nx>data() {</span>
        <span class=k>return</span> <span class=p>{</span>
            <span class=nx>query</span><span class=o>:</span><span class=p>{</span>
                <span class=nx>page</span>:<span class=kt>0</span><span class=p>,</span>
                <span class=nx>size</span>:<span class=kt>10</span><span class=p>,</span>
                <span class=nx>name</span><span class=o>:</span><span class=s1>&#39;测试&#39;</span><span class=p>,</span>
                <span class=nx>age</span>: <span class=kt>2</span>
            <span class=p>}</span> <span class=kr>as</span> <span class=nx>queryType</span>
        <span class=p>}</span>
    <span class=p>},</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=组件使用-definecomponent-来定义>组件使用 <code>defineComponent</code> 来定义</h4>
<blockquote>
<p>这样 <code>TypeScript</code> 正确推断 <code>Vue</code> 组件选项中的类型</p>
</blockquote>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
    <span class=nx>setup</span><span class=p>(){</span>
        <span class=k>return</span><span class=p>{</span> <span class=p>}</span>
    <span class=p>}</span>
<span class=p>})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=类型声明-reactive>类型声明 <code>reactive</code></h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=kr>export</span> <span class=k>default</span>  <span class=kr>interface</span> <span class=nx>Product</span> <span class=p>{</span>
    <span class=nx>name</span><span class=o>:</span><span class=nb>String</span><span class=p>,</span>
    <span class=nx>price</span><span class=o>:</span><span class=nb>Number</span><span class=p>,</span>
    <span class=nx>address</span><span class=o>:</span><span class=nb>String</span>
<span class=p>}</span>



<span class=kr>import</span>  <span class=nx>Product</span> <span class=nx>from</span> <span class=s1>&#39;@/interface/Product&#39;</span> 
<span class=kr>import</span> <span class=p>{</span><span class=nx>reactive</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>const</span> <span class=nx>product</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=s1>&#39;xiaomi 11&#39;</span><span class=p>,</span><span class=nx>price</span><span class=o>:</span><span class=mi>5999</span><span class=p>,</span><span class=nx>address</span><span class=o>:</span><span class=s1>&#39;北京&#39;</span><span class=p>})</span> <span class=nx>as</span> <span class=nx>Product</span>
       
<span class=k>return</span> <span class=p>{</span><span class=nx>fatherData</span><span class=p>,</span><span class=nx>info</span><span class=p>,</span><span class=nx>product</span><span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=setup-script>setup script</h3>
<p>setup script 是 vue3 新出的一个语法糖，使用方法就是在书写 script 标签的时候在其后面加上一个 <code>setup</code> 修饰。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=自动注册子组件>自动注册子组件</h4>
<p>普通语法</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span><span class=nx>我是父组件</span><span class=o>!</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>Child</span> <span class=p>/&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>
<span class=kr>import</span> <span class=nx>Child</span> <span class=nx>from</span> <span class=s1>&#39;./Child.vue&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
  <span class=nx>components</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>Child</span>
  <span class=p>},</span>
  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>

    <span class=k>return</span> <span class=p>{</span>
      
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>});</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>vue3 语法在引入 Child 组件后，需要在 components 中注册对应的组件才可使用。</p>
<p>setup script 写法</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span><span class=nx>我是父组件</span><span class=o>!-</span><span class=nx>setup</span> <span class=nx>script</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>Child</span> <span class=p>/&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=nx>Child</span> <span class=nx>from</span> <span class=s1>&#39;./Child.vue&#39;</span>

<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=属性和方法无需返回>属性和方法无需返回</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>h2</span> <span class=nt>@click</span><span class=s>=&#34;ageInc&#34;</span><span class=p>&gt;{{</span> <span class=na>name</span> <span class=p>}}</span> <span class=na>is</span> <span class=p>{{</span> <span class=na>age</span> <span class=p>}}&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>

<span class=kr>const</span> <span class=nx>name</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;CoCoyY1&#39;</span><span class=p>)</span>
<span class=kr>const</span> <span class=nx>age</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>

<span class=kr>const</span> <span class=nx>ageInc</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>age</span><span class=p>.</span><span class=nx>value</span><span class=o>++</span>
<span class=p>}</span>

<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=支持-propsemit-和-context>支持 props、emit 和 context</h4>
<p>普通语法</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=c1>//Father.vue
</span><span class=c1></span><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span> <span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>h2</span> <span class=p>&gt;</span><span class=nx>我是父组件</span><span class=err>！</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>Child</span> <span class=na>msg</span><span class=o>=</span><span class=s>&#34;hello&#34;</span> <span class=nt>@child-click</span><span class=s>=&#34;childCtx&#34;</span> <span class=p>/&gt;</span>
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>
<span class=kr>import</span> <span class=nx>Child</span> <span class=nx>from</span> <span class=s1>&#39;./Child.vue&#39;</span><span class=p>;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
  <span class=nx>components</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>Child</span>
  <span class=p>},</span>
  <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>,</span> <span class=nx>context</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>childCtx</span> <span class=o>=</span> <span class=p>(</span><span class=nx>ctx</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>childCtx</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>})</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>


<span class=c1>//Child.vue
</span><span class=c1></span><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>span</span> <span class=nt>@click</span><span class=s>=&#34;handleClick&#34;</span><span class=p>&gt;</span><span class=na>我是子组件</span><span class=err>!</span> <span class=err>--</span> <span class=na>msg</span><span class=o>:</span> <span class=p>{{</span> <span class=na>props.msg</span> <span class=p>}}&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span><span class=p>,</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>defineComponent</span><span class=p>({</span>
  <span class=nx>emits</span><span class=o>:</span> <span class=p>[</span>
    <span class=s1>&#39;child-click&#39;</span>
  <span class=p>],</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>msg</span><span class=o>:</span> <span class=nb>String</span>
  <span class=p>},</span>
  <span class=nx>setup</span><span class=p>(</span><span class=nx>props</span><span class=p>,</span> <span class=nx>context</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>handleClick</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=nx>context</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s1>&#39;child-click&#39;</span><span class=p>,</span> <span class=nx>context</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=p>{</span>
      <span class=nx>props</span><span class=p>,</span>
      <span class=nx>handleClick</span>
    <span class=p>}</span>
  <span class=p>},</span>
<span class=p>})</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>setup script 语法</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
<span class=kr>const</span> <span class=nx>props</span> <span class=o>=</span> <span class=nx>defineProps</span><span class=p>({</span>
  <span class=nx>foo</span><span class=o>:</span> <span class=nb>String</span>
<span class=p>})</span>

<span class=kr>const</span> <span class=nx>emit</span> <span class=o>=</span> <span class=nx>defineEmits</span><span class=p>([</span><span class=s1>&#39;change&#39;</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>])</span>
<span class=c1>// setup code
</span><span class=c1></span><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>setup script 语法糖提供了三个新的 API 来供我们使用：<code>defineProps</code>、<code>defineEmits</code>和 <code>useContext</code>。</p>
<p>其中 <code>defineProps</code> 用来接收父组件传来的值 props。<code>defineEmits</code> 用来声明触发的事件表。<code>useContext</code> 用来获取组件上下文 context。</p>
<ul>
<li><code>defineProps</code> 和 <code>defineEmits</code> 都是只在 <code>&lt;script setup></code> 中才能使用的<strong>编译器宏</strong>。他们不需要导入且会随着 <code>&lt;script setup></code> 处理过程一同被编译掉。</li>
<li><code>defineProps</code> 接收与 <code>props</code> 选项相同的值，<code>defineEmits</code> 也接收 <code>emits</code> 选项相同的值。</li>
<li><code>defineProps</code> 和 <code>defineEmits</code> 在选项传入后，会提供恰当的类型推断。</li>
</ul>
<h1 id=技巧>技巧</h1>
</div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>更新于 0001-01-01</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span>
</section>
</div>
<div class=post-nav><a href=/posts/frontend/%E6%A1%86%E6%9E%B6/vuetify/ class=prev rel=prev title><i class="fas fa-angle-left fa-fw"></i></a>
<a href=/posts/frontend/%E6%A1%86%E6%9E%B6/vue2/ class=next rel=next title><i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>酒困路长惟欲睡，日高人渴漫思茶</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部>
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论>
<i class="fas fa-comment fa-fw"></i>
</a>
</div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:40},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>