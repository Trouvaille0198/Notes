---
title: "数据库原理（2）"
date: 2022-02-25
draft: true
author: "MelonCholi"
tags: [数据库]
categories: [专业课]
---

# 数据库原理二

## 第五章 规范化设计

### 关系模式的设计问题

#### 关系模式的外延和内涵

一个关系模型包括外延和内涵两个方面的内容。

- 外延：关系、表或当前值。

- 内涵：对数据的定义以及对数据完整性约束的定义。

#### 泛关系模式与数据库模式

关系模式 R(U)

- R：关系名字
- U：所有属性的全集
- 关系 r 是关系模式 R(U) 的当前值，是元组的集合
- 这样的关系模式和关系称为**泛关系模式**和泛关系。

实际使用时，用一个关系模式的集合 $\rho = \{ R_1,\dots,R_k\}$ 来代替 R(U)，其中每个 R~i~ 是 U 的子集，$\rho$ 称为**数据库模式**。

#### 关系模式的冗余和异常问题

冗余、修改异常、插入异常、删除异常

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308151401739.png" alt="image-20220308151401739" style="zoom:50%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308151410230.png" alt="image-20220308151410230" style="zoom: 67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308151420363.png" alt="image-20220308151420363" style="zoom: 60%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308151430051.png" alt="image-20220308151430051" style="zoom:60%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308151446399.png" alt="image-20220308151446399" style="zoom:50%;" />

### 函数依赖

#### 函数依赖 FD 的定义

通俗定义：当 X 有一个确定值时，Y 一定有一个唯一的值与其对应

严格定义：

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308151831420.png" alt="image-20220308151831420" style="zoom: 67%;" />

或者说，**属性 X 函数决定属性 Y，记作 X→Y**。 其中 X 叫决定因素，Y 叫被决定因素。

此定义可简单表述为：如果属性 X 的值决定属性 Y 的值,那么属性 Y 函数依赖于属性 X。 

换一种说法是，如果知道  X 的值，就可以获得 Y 的值。 

- 不依赖：$X \nrightarrow Y$

- 互相依赖：$X \leftrightarrow Y$

##### 例

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308153147662.png" alt="image-20220308153147662" style="zoom: 67%;" />

#### FD 的逻辑蕴涵、函数依赖集 F 的闭包

函数依赖集 F 的闭包：F 能推出的所有依赖组成的集合

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308153351885.png" alt="image-20220308153351885" style="zoom:60%;" />

#### 函数依赖的推理规则

##### Armstrong 公理系统

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308153406619.png" alt="image-20220308153406619" style="zoom:60%;" />

##### 另外三个推理规则

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308155923071.png" alt="image-20220308155923071" style="zoom:67%;" />

#### FD 与关键码的联系

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308160717162.png" alt="image-20220308160717162" style="zoom:67%;" />

##### 找候选键的方法

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308161331535.png" alt="image-20220308161331535" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308161440201.png" alt="image-20220308161440201" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308161447918.png" alt="image-20220308161447918" style="zoom:67%;" />

#### 属性集的闭包

人话：属性 X 可以推出的所有属性的集合

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308161457792.png" alt="image-20220308161457792" style="zoom:67%;" />

##### 求闭包

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308161928927.png" alt="image-20220308161928927" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308161942842.png" alt="image-20220308161942842" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308162000436.png" alt="image-20220308162000436" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308162008294.png" alt="image-20220308162008294" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308162421014.png" alt="image-20220308162421014" style="zoom: 67%;" />

#### FD 的最小依赖集

##### 函数依赖集的等价

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220308162436812.png" alt="image-20220308162436812" style="zoom:67%;" />

##### 最小函数依赖集

最大函数依赖集就是闭包

- 保证右边都是单属性
- 消除左边的多余属性

- 消除多余的函数依赖

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315151127771.png" alt="image-20220315151127771" style="zoom:67%;" />

##### 例

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315151412567.png" alt="image-20220315151412567" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315151417206.png" alt="image-20220315151417206" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315153009173.png" alt="image-20220315153009173" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315153021337.png" alt="image-20220315153021337" style="zoom:67%;" />

### 关系模式的分解特性

#### 模式分解问题

分解：把一张表拆成多张表

投影定义重要！

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315154036857.png" alt="image-20220315154036857" style="zoom: 67%;" />



函数依赖保持性：

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315154427612.png" alt="image-20220315154427612" style="zoom:67%;" />

#### 无损分解

无损连接：分解后的表进行自然连接之后的表与原表的内容不多不少

<img src="C:\Users\Tyeah\AppData\Roaming\Typora\typora-user-images\image-20220315154616981.png" alt="image-20220315154616981" style="zoom:67%;" />

#### 无损分解的测试方法

<img src="http://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160031794.png" alt="image-20220315160031794" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160151601.png" alt="image-20220315160151601" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160202135.png" alt="image-20220315160202135" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160209405.png" alt="image-20220315160209405" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160217009.png" alt="image-20220315160217009" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160236362.png" alt="image-20220315160236362" style="zoom:67%;" /><img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315160241704.png" alt="image-20220315160241704" style="zoom:67%;" />

##### 第二种方法

只分解成两个子模式时适用

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161148857.png" alt="image-20220315161148857" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161820582.png" alt="image-20220315161820582" style="zoom: 67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161848712.png" alt="image-20220315161848712" style="zoom:67%;" />

#### 保持函数依赖的分解

函数依赖保持性：F 在 Z 这个属性集合上的投影得到的小函数依赖集们的并集是否与 F 等价

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161858815.png" alt="image-20220315161858815" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161907624.png" alt="image-20220315161907624" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161915181.png" alt="image-20220315161915181" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220315161923688.png" alt="image-20220315161923688" style="zoom:67%;" />

### 关系模式的范式

#### 第一范式 1NF

##### 反例

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322150648406.png" alt="image-20220322150648406" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322150805914.png" alt="image-20220322150805914" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322150818141.png" alt="image-20220322150818141" style="zoom:50%;" />

##### 定义

原子性：每一个属性都不可分解

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322150848377.png" alt="image-20220322150848377" style="zoom: 67%;" />

##### 修改后的例子

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322150953681.png" alt="image-20220322150953681" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322151003707.png" alt="image-20220322151003707" style="zoom:67%;" />

#### 第二范式 2NF

##### 定义

第一范式有部分依赖的问题，而第二范式**消除了部分依赖**

在满足第一范式的条件下，其他属性都必须**完全依赖**于某个候选键属性

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322151718007.png" alt="image-20220322151718007" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322151741366.png" alt="image-20220322151741366" style="zoom: 67%;" />

#### 第三范式 3NF

第二范式会有传递依赖的问题，而第三范式**消除了传递依赖**

在满足第二范式的前提下，**每一个非主属性都不传递依赖于候选键（主属性）**。

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322152917085.png" alt="image-20220322152917085" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322152926667.png" alt="image-20220322152926667" style="zoom:67%;" />

##### 例

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322154419167.png" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322154517415.png" alt="image-20220322154517415" style="zoom: 67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322154654654.png" alt="image-20220322154654654" style="zoom:67%;" />

#### 巴克斯范式 BCNF

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322160029125.png" alt="image-20220322160029125" style="zoom: 67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322160222855.png" alt="image-20220322160222855" style="zoom: 67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322160458916.png" alt="image-20220322160458916" style="zoom:67%;" />

#### 分解成 BCNF 模式集的方法

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161210743.png" alt="image-20220322161210743" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161220977.png" alt="image-20220322161220977" style="zoom:67%;" />

#### 分解成 3NF 模式集的方法

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161229166.png" alt="image-20220322161229166" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161233794.png" alt="image-20220322161233794" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161242727.png" alt="image-20220322161242727" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161936938.png" alt="image-20220322161936938" style="zoom:67%;" />

<img src="https://markdown-1303167219.cos.ap-shanghai.myqcloud.com/image-20220322161941646.png" alt="image-20220322161941646" style="zoom:67%;" />
